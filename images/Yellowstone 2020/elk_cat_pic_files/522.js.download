(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[522],{1834:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(3),i=n(1),r=n(1516),o=n(1449),s=n(1533),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.a)(t,e),t.prototype.render=function(){return i.createElement(s.e,Object(a.e)({},this.props,{primary:!0,onRenderDescription:r.t}))},Object(a.n)([Object(o.e)("PrimaryButton",["theme","styles"],!0)],t)}(i.Component)},2031:function(e,t,n){"use strict";n.r(t),n.d(t,"ConfirmationDialog",function(){return m});var a=n(1),i=n(1677),r=n(541),o=n(1340),s=n(1834),c=n(1533),d=n(1106),l=n(2393),u=n(1116),f=n(2032),p=n(338).n.isFeatureEnabled({ODC:"DialogNextEnabled",ODB:60768})?f.e:{},m=function(e){var t=e.onConfirm,n=e.onCancel,f=e.defaultToYes,m=void 0!==f&&f,_=e.defaultFocusToYes,h=void 0!==_&&_,b=e.yesText,g=void 0===b?l.t:b,v=e.noText,y=void 0===v?l.e:v,S=function(e){e&&e.focus()},D=m?s.e:c.e,I=m?c.e:s.e,x=h?void 0:S,C=h?S:void 0;return a.createElement(d.e,null,a.createElement(u.e,{scopedSettings:p},a.createElement(i.e,{dialogContentProps:{type:r.e.close,subText:e.prompt?e.prompt:""},onDismiss:n,hidden:!1,title:e.title,maxWidth:e.maxWidth},e.children,a.createElement(o.e,null,a.createElement(D,{"data-automationid":"confirmbutton",onClick:t,componentRef:C},g),a.createElement(I,{"data-automationid":"cancelbutton",onClick:n,componentRef:x},y)))))}},2032:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a,i=n(0),r={height:"100%",display:"flex",flexDirection:"column"},o={width:"440px",minWidth:"none",maxWidth:"none"},s={Modal:{styles:{main:Object(i.__assign)({selectors:(a={},a["@media (min-width: 480px)"]=Object(i.__assign)({},o),a),minHeight:"240px"},o)}},DialogContent:{styles:{content:r,inner:r,innerContent:r}},DialogFooter:{styles:{actions:{minHeight:"none"}}}}},2294:function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"t",function(){return s});var a=n(20);Object(a.n)([{rawString:".field_00202b6e{display:inline-block;-webkit-box-sizing:border-box;box-sizing:border-box;max-width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.field_00202b6e.block_00202b6e{display:block}.pathSection_00202b6e{display:inline;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}@media screen and (-ms-high-contrast: active), screen and (forced-colors: active){.pathSection_00202b6e{color:WindowText}}@media screen and (-ms-high-contrast: active), screen and (forced-colors: active){.ms-DetailsRow.is-selected .ms-DetailsRow-cell .pathSection_00202b6e{color:HighlightText}}.chevron_00202b6e{font-size:12px;margin:3px 1px;-webkit-transform:scale(0.5);transform:scale(0.5);vertical-align:middle;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}@media screen and (-ms-high-contrast: active), screen and (forced-colors: active){.chevron_00202b6e{color:WindowText}}@media screen and (-ms-high-contrast: active), screen and (forced-colors: active){.ms-DetailsRow.is-selected .ms-DetailsRow-cell .chevron_00202b6e{color:HighlightText}}\n"}]);var i="field_00202b6e",r="block_00202b6e",o="pathSection_00202b6e",s="chevron_00202b6e"},2392:function(e,t,n){"use strict";n.d(t,"n",function(){return r}),n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i});var a,i,r={applyPanel:"filtersPane-applyInPanel",pinnedToFiltersPaneChanged:"filtersPane-pinnedToFiltersPaneChanged",showInFiltersPaneChanged:"filtersPane-showInFiltersPaneChangedChanged",sectionInfosChanged:"filtersPane-sectionInfosChanged",canvasFilterChanged:"filtersPane-canvasFilterChanged"};!function(e){e[e.user=0]="user",e[e.date=1]="date",e[e.fileType=2]="fileType",e[e.choice=3]="choice",e[e.hierarchy=4]="hierarchy"}(a||(a={})),function(e){e[e.none=0]="none",e[e.last3Months=1]="last3Months",e[e.last30Days=2]="last30Days",e[e.last7Days=3]="last7Days",e[e.yesterday=4]="yesterday",e[e.today=5]="today",e[e.tomorrow=6]="tomorrow",e[e.next7Days=7]="next7Days",e[e.next30Days=8]="next30Days",e[e.next3Months=9]="next3Months",e[e.nextYear=10]="nextYear"}(i||(i={}))},2466:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(286),r=n(100),o=n(1162),s=n(298),c=n(13).t.isActivated("cade488d-480a-444f-a1ea-d3d121529bb7","11/01/2021","Set one minute timeout for API requests");function d(e){var t=this,n=e.itemKey,d=e.itemSetKeyFacet,l=e.getUrl,u=e.sortChildItems,f=e.qosName,p=e.preprocessResponse,m=e.expectedErrors,_=e.disableRemoteItem,h=void 0!==_&&_,b=e.scenarioInfo,g=d.deserialize(n),v=g.driveItemKey,y=v.endpoint,S=v.driveId;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,d,_,v,D,I;return Object(a.__generator)(this,function(x){switch(x.label){case 0:t=Object(i.n)(g.driveItemKey),x.label=1;case 1:return x.trys.push([1,4,,5]),[4,n(Object(r.n)({url:l(g),driveUrl:t,driveId:S,qosName:"getChildren".concat(f?".".concat(f):""),endpoint:y,headers:e.additionalHeaders,expectedErrors:m,timeout:c?void 0:6e4,scenarioInfo:b}))];case 2:return d=x.sent(),_=Object(a.__spreadArray)([],d.value,!0),v=p&&p(_)||d.value,D=u&&u(v)||v,[4,n(Object(o.e)(Object(a.__assign)(Object(a.__assign)({},e),{disableRemoteItem:h,childItemsResponse:Object(a.__assign)(Object(a.__assign)({},d),{value:D})})))];case 3:return[2,{itemResolver:x.sent().itemResolver}];case 4:throw I=x.sent(),new s.e(Object(a.__assign)({code:"UnknownError"},I instanceof Error?{innerError:I}:{message:JSON.stringify(I)}));case 5:return[2]}})})}}},2467:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(1),i=n(551),r=n(1590),o=n(49),s=n(42),c=n(2294),d=n(76),l=function(e){var t=e.displayPathSegments,n=e.parentLink,i=e.target,l=e.onClick,p=e.className,m="",_=[];if(t){var h=t.join(" ".concat(d.w," "));m=s.format(d.E,h),_=function(e,t,n){var a=[];if(!e.length)return a;var i=0,r=60,o="â€¦",s=e.map(function(e){return e.trim()}),c=s[0],d=s.length>=2?s[1]:"",l=d?c.length+d.length+3+o.length-r:0,p=s[s.length-1],m=c.length+p.length+2*(3+o.length)-r;if(c.length>r){var _=c.substr(0,59).trim()+o;a.push(u(_,++i,t))}else if(1===e.length||c.length+3+o.length>r||s.length>2&&c.length+2*(3+o.length)>r)a.push(u(c,++i,t));else if(2===s.length&&l>1)a.push(u(c,++i,t)),a.push(f(++i,n)),a.push(u(o+d.substr(l).trim(),++i,t));else if(s.length>2&&m>1){var h=p.substr(m).trim();a.push(u(c,++i,t)),a.push(f(++i,n)),a.push(u(o,++i,t)),h.length>0&&(a.push(f(++i,n)),a.push(u(o+h,++i,t)))}else{var b=0;a.push(u(c,++i,t)),b+=c.length;for(var g=1;g<e.length;++g){a.push(f(++i,n));var v=s[g];a.push(u(v,++i,t)),b+=3+v.length}for(b>r&&(s.splice(1,1),a.splice(2,1,u(o,++i,t)),b-=d.length-o.length);b>r;){var y=s.splice(1,1)[0];a.splice(3,2),b-=y.length+3}}return a}(t)}return l||n?a.createElement(r.e,{dir:"auto",className:Object(o.e)(c.n,p),"aria-label":m,href:n,target:i,onClick:l,title:d.A},_):a.createElement("div",{dir:"auto","aria-label":m,className:Object(o.e)(c.n,p)},_)};function u(e,t,n){return a.createElement("div",{key:t,className:Object(o.e)(c.a,n)},e)}function f(e,t){return a.createElement(i.e,{key:e,className:Object(o.e)(c.t,t),iconName:"ChevronRightSmall"})}},2468:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=n(13).e.isActivated("EB854331-5340-42D0-8893-9E093DC56A47","03/10/2022","Use standard Open command for Office files")},2553:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(5),i=new a.e("itemPathField",{displayPathSegments:a.t,openUrl:a.t,action:a.t})},2630:function(e,t,n){"use strict";n.d(t,"n",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"t",function(){return c});var a=n(2),i=n(542),r=n(1014),o=new a.e("removeItemsFromSharedList"),s=new i.e("removeItemsFromSharedList"),c=Object(r.e)({operationTypeFacet:o,progressKeyFacet:s})},2741:function(e,t,n){"use strict";n.d(t,"e",function(){return E});var a=n(0),i=n(291),r=n(1),o=n(2467),s=n(2294),c=n(6),d=n(26),l=n(264),u=n(343),f=n(187),p=n(13),m=n(2553),_=p.e.isActivated("AB1B9B00-C482-451A-A5DA-500AC7533605","1/31/2022","Require Name to be clickable for parent path to be clickable"),h=[];function b(e,t){var n=t.itemKey,a=t.renderer,i=e.demandItemFacet(c.k,n),u=e.demandItemFacet(c.A,null==i?void 0:i.itemKey)||"",p=e.demandItemFacet(m.e,null==i?void 0:i.itemKey),b=m.e.evaluate(p)(e,{itemKey:null==i?void 0:i.itemKey,displayPathSegments:u?g(u):h,openUrl:u,action:i&&u?Object(f.a)(e,r.createElement(l.e,{itemKey:i.itemKey})):null}),v=b.displayPathSegments,y=void 0===v?h:v,S=b.action,D=b.openUrl;return{renderer:function(e,t,n){var i=a?a(e,t,n):null;return r.createElement(r.Fragment,null,i?r.createElement(r.Fragment,{key:"content"},i):null,y.length>0?r.createElement(d.n,{key:"path",action:S},function(t){var n=t.execute,a=t.isAvailable&&(_||e.isInvokable)?function(e){n({event:e}).catch(function(){}),e.preventDefault(),e.stopPropagation()}:void 0;return r.createElement(o.e,{className:s.e,displayPathSegments:y,parentLink:a?D:void 0,onClick:a})}):null)}}}function g(e){for(var t=[],n=0,a=new u.e(e).segments.slice(1);n<a.length;n++){var i=a[n];try{t.push(decodeURIComponent(i))}catch(e){t.push(i)}}return t}var v=n(169),y=n(122),S=n(832),D=n(1175),I=n(1156),x=n(1157),C=n(1143),O=n(336),w=p.e.isActivated("A8ABE184-9647-42E8-BBAD-7AC7F51995D6","5/20/2022","Fix signals positioning in nameAndPathColumn")?[C.t,b]:[b,C.t],E=Object(S.e)({key:v.s,name:i.c,fieldName:"",isCollapsible:!1,minWidth:445,maxWidth:445,sortProps:y.a,data:{facets:Object(a.__assign)({},O.e.pack("nameAndPath"))}},Object(a.__spreadArray)(Object(a.__spreadArray)([D.e],w,!0),[I.e,x.e],!1))},2880:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(638),i=n(30),r=n(196),o=n(313),s=n(247),c=n(109),d=n(0),l=n(592);function u(e,t){var n=t.itemsScopeItemKey,a=t.engagement,i=a&&a.name;return{engagement:{objectType:"SharedWithMe",datasource:"Graph",extraData:Object(d.__assign)({},"ItemsView.Load"===i?Object(l.e)(e,{itemsScopeItemKey:n}):{})}}}function f(e,t){return{engagement:{currentPage:"SharedWithMe"}}}var p=Object(i.t)(function(){return function(e){e(Object(a.e)(c.e,r.e)(u)),e(Object(a.e)(s.e,r.e)(u)),e(Object(a.e)(c.e,o.e)(f))}})},2906:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(3145),i=(a.T,a.l,a.F,a.H,a.U,a.i,a.p,a.L,a.C,a.M,a.P,a.k,a.v,a.E,a.y,a.g,a.I,a._,a.x,a.D,a.S,a.h,a.A,a.w,a.O,a.b,[a.r,a.a,a.c,a.e,a.d,a.s,a.o,a.t,a.m,a.f,a.u,a.n])},2908:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(109),i=n(247),r=n(397),o=n(470),s=n(2880),c=Object(o.e)(a.e,function(e){return function(){return{defaultChildItemSet:{itemKey:i.e.serialize({driveItemKey:e,sortBy:"",isAscending:!0})},displayName:r.o,icon:"People"}}},s.e)},2909:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(5),i=new a.e("removeFromShardListAction",{isAvailable:a.t})},4125:function(e,t,n){"use strict";n.r(t),n.d(t,"graphSharedWithMeWebAddon",function(){return Ft});var a,i=n(30),r=n(305),o=n(394),s=n(1092),c=n(638),d=n(0),l=n(309),u=n(430),f=n(567),p=n(1222),m=n(37),_=n(2),h=n(1),b=n(579),g=n(1190),v={action:h.createElement(m.t,null,h.createElement(g.t,null)),automationId:"removeShortcutFromSharedWithMeCommand",title:b.p,iconProps:{iconName:"FabricFolderLink"},key:new _.e("RemoveShortcutFromSWM").id,name:b.f},y=n(142),S=n(244),D=n(2031),I=n(1014),x=n(2630),C=n(6),O=n(57),w=n(83),E=n(132),A=n(26),L=n(39),k=n(17),M=n(2909),P=n(64),T=n(247),U=n(13),F=Object(O.t)(function(e,t){var n=t.itemKeys,a=t.removeFromSharedListWizard,i=t.removeItemsFromSharedList,r=void 0===i?x.t:i,o=Object(w.e)(e)||"",s=e.demandItemFacet(T.e,o);if(0===n.length)return null;for(var c=s&&n.length<=200,l=a,u=0,f=n;u<f.length;u++){var p=f[u],m=e.demandItemFacet(M.e,p),_=!U.t.isActivated("6c28a705-1f14-4f06-97c7-ee39b2d66e9e","11/5/2020","Action should be available unless otherwise stated in control handler");M.e.evaluate(m)(e,{itemKey:p,isAvailable:_}).isAvailable||(c=!1)}var b=e.dispatch,g=function(){return Object(d.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(d.__generator)(this,function(a){switch(a.label){case 0:return e={itemSetKey:o},t=Object(E.e)(n,function(){return e}),[4,b(r({items:t}))];case 1:return a.sent(),[2]}})})},v=Object(A.o)(function(e){return h.createElement(l,Object(d.__assign)({},e,{onItemRemoved:g,itemKeys:n}))});return h.createElement(L.e,Object(d.__assign)({isAvailable:c,onExecute:v},Object(P.t)(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:n.length}}})))}),H=Object(k.r)()(F),R=n(3495),N=n(3146),B=n(42),j=n(65),V=n(503),z=n(176),G=((a={})[j.a.started]=function(e){return Object(B.formatToArray)(Object(B.getLocalizedCountValue)(N.r,N.t,e)||"",e)},a[j.a.completed]=function(e){return Object(B.formatToArray)(Object(B.getLocalizedCountValue)(N.e,N.t,e)||"",e)},a[j.a.failed]=function(e){return Object(B.formatToArray)(Object(B.getLocalizedCountValue)(N.n,N.a,e)||"",e)},a[j.a.canceled]=function(e){return Object(B.formatToArray)(Object(B.getLocalizedCountValue)(N.n,N.a,e)||"",e)},a),K=Object(i.t)(function(){return function(e){e(Object(c.e)(x.e,V.e)(W))}});function W(e,t){var n,a=Object(z.a)(e,t),i=a.phase,r=a.count;return n=G[i](r),Object(d.__assign)({},n&&"item"!==t.format?{title:n}:{})}var q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(d.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.resolve,a=t.reject,i=t.onItemRemoved,r=t.itemKeys,o=function(){return Object(d.__awaiter)(e,void 0,void 0,function(){return Object(d.__generator)(this,function(e){switch(e.label){case 0:return n(),[4,i()];case 1:return e.sent(),[2]}})})},s=function(){return Object(d.__awaiter)(e,void 0,void 0,function(){return Object(d.__generator)(this,function(e){return a(new y.e),[2]})})};return h.createElement(S.e,null,function(e){var t=e.itemCache,n=Q(t,r),a=n.title,i=n.prompt;return h.createElement(D.ConfirmationDialog,{onCancel:s,onConfirm:o,yesText:N.i,noText:R.o,defaultToYes:!0,title:a,prompt:i})})},t}(h.PureComponent),Q=function(e,t){if(t.length>1)return{title:R.r,prompt:R.i};if(1===t.length){var n=e.demandItemFacet(C._,t[0]);return{title:n?R.a:R.t,prompt:n?R.n:R.e}}return{title:"",prompt:""}},Y=Object(I.e)({operationTypeFacet:x.n,progressKeyFacet:x.e,initializeBatch:function(){return K}}),J=Object(O.e)(function(){return{removeFromSharedListWizard:q,removeItemsFromSharedList:Y}})(H),X={key:n(1278).e,automationId:"removeFromSharedListCommand",name:b.S,action:h.createElement(m.t,null,h.createElement(J,null)),iconProps:{iconName:"Cancel"}},Z=n(260),$=n(981),ee=n(2468),te=!U.t.isActivated("A62AD86A-B7EB-4EF6-A7F2-CC139D544AE7","",""),ne={name:"-",key:"divider_1",itemType:Z.e.Divider};function ae(e,t){return{commands:Object(d.__spreadArray)(Object(d.__spreadArray)(Object(d.__spreadArray)(Object(d.__spreadArray)([ee.e?l.e:$.t,u.n,u.t],te?[ne]:[],!0),[p.e],!1),te?[f.e]:[],!0),[v,X],!1)}}var ie=n(109),re=!U.t.isActivated("A62AD86A-B7EB-4EF6-A7F2-CC139D544AE7","","");function oe(e,t){return{commands:Object(d.__spreadArray)(Object(d.__spreadArray)([ee.e?l.e:$.e,u.n,u.t,p.e],re?[f.e]:[],!0),[v,X],!1)}}var se,ce=n(216),de=n(310),le=n(169),ue=n(100),fe=((se={})[le.a]=!0,se[le.n]=!0,se[le.s]=!0,se[de.l]=!0,se[de.e]=!0,se[de.c]=!0,se);function pe(e,t){return{isAvailable:!0,sortHandler:function(e,t){var n=t.itemSetKey,a=t.handler,i=a.columnKey,r=a.isAscending;if(!fe[i])return{};var o=e.demandItemFacet(T.e,n);if(!o)return{};var s=de.a[i];if(!s)return{};var c=o.driveItemKey.endpoint,l=o.sortBy;return Object(ue.a)(e,c)&&!l&&i===le.n&&r?{newItemSetKey:n}:{newItemSetKey:T.e.serialize(Object(d.__assign)(Object(d.__assign)({},o),{sortBy:s,isAscending:r}))}}}}var me,_e=n(390),he=n(492),be=n(1025);function ge(e,t){var n=t.itemKey,a=e.demandItemFacet(T.e,n),i=a&&a.driveItemKey.endpoint,r=i&&a&&Object(be.t)(e,{itemSetKey:T.e.serialize(a),parentItemKey:ie.e.serialize({endpoint:i}),stageItem:t.stageItem});return Object(d.__assign)({},r?{stageItem:r}:{})}var ve=((me={})[de.l]=!0,me[de.e]=!0,me);function ye(e,t){var n=t.itemSetKey,a=t.handler.columnKey;if(!ve[a])return{};var i=e.demandItemFacet(T.e,n);if(!i)return{};var r=de.a[a];return r?{newItemSetKey:T.e.serialize(Object(d.__assign)(Object(d.__assign)({},i),{groupBy:r}))}:{}}function Se(e,t){var n=t.itemSetKey,a=e.demandItemFacet(T.e,n);return a?{newItemSetKey:T.e.serialize(Object(d.__assign)(Object(d.__assign)({},a),{groupBy:void 0}))}:{}}var De=n(2908),Ie=n(2466),xe=n(314),Ce=n(1459),Oe=n(499),we=n(983);function Ee(e,t){var n=new Date(e.valueOf());return n.setDate(n.getDate()-t),n}var Ae=n(2392),Le=new Map([["code",xe.e.text],["csv",xe.e.excel],["docx",xe.e.word],["dotx",xe.e.word],["one",xe.e.onenote],["onepkg",xe.e.onenote],["onetoc",xe.e.onenote],["pdf",xe.e.pdf],["photo",xe.e.media],["potx",xe.e.powerpoint],["ppsx",xe.e.powerpoint],["pptx",xe.e.powerpoint],["rtf",xe.e.text],["txt",xe.e.text],["video",xe.e.media],["xlsx",xe.e.excel],["xltx",xe.e.excel],["zip",xe.e.zip]]);function ke(e,t,n){var a=e.lastModifiedDateTime,i=t.lastModifiedDateTime,r=a&&i&&new Date(a).getTime()-new Date(i).getTime()||0,o=a&&i&&new Date(i).getTime()-new Date(a).getTime()||0;return n?r:o}function Me(e,t,n){var a=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,i=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime,r=a&&i&&new Date(a).getTime()-new Date(i).getTime()||0,o=a&&i&&new Date(i).getTime()-new Date(a).getTime()||0;return n?r:o}function Pe(e,t,n){var a=e.name,i=t.name,r=a&&i&&a.localeCompare(i)||0,o=a&&i&&i.localeCompare(a)||0;return n?r:o}function Te(e,t,n){var a,i,r,o,s,c,d=(null===(a=e.remoteItem)||void 0===a?void 0:a.shared)&&(null!==(i=e.remoteItem.shared.sharedBy)&&void 0!==i?i:e.remoteItem.shared.owner),l=null===(r=null==d?void 0:d.user)||void 0===r?void 0:r.displayName,u=(null===(o=t.remoteItem)||void 0===o?void 0:o.shared)&&(null!==(s=t.remoteItem.shared.sharedBy)&&void 0!==s?s:t.remoteItem.shared.owner),f=null===(c=null==u?void 0:u.user)||void 0===c?void 0:c.displayName,p=l&&f&&l.localeCompare(f)||0,m=l&&f&&f.localeCompare(l)||0;return n?p:m}function Ue(e,t,n,a){return function(e,i){return Object(d.__spreadArray)([],e,!0).sort(function(e,i){var r,o,s,c,d=e.folder||(null===(r=e.remoteItem)||void 0===r?void 0:r.folder)||(null===(o=e.remoteItem)||void 0===o?void 0:o.bundle),l=i.folder||(null===(s=i.remoteItem)||void 0===s?void 0:s.folder)||(null===(c=i.remoteItem)||void 0===c?void 0:c.bundle);return n&&d&&!l?-1:n&&!d&&l?1:a(e,i,t)})}(e)}var Fe=n(54),He=n(259),Re=n(9),Ne=n(31),Be=n(14),je=new Ne.e("SharedByPersonKeyFacet",{displayName:Be.e,email:Be.e,id:Be.e}),Ve=new Ne.e("dateSharedGroupKeyFacet",{relativeTime:Be.e,sharedDateTime:Be.e}),ze=new Ne.e("relativeTimeGroupKeyFacet",{relativeTime:Be.e}),Ge=n(323),Ke=n(69),We=n(18),qe=n(3494),Qe=n(786),Ye=n(51),Je=n(2906),Xe=U.t.isActivated("1E74BB9A-47A2-40F6-89FA-C628928BEC2F","04/12/2022","Enable grouping of items that are missing the email or display name of the person who shared an item");var Ze=n(829),$e=n(678),et=Object(i.i)()(function e(t){var n=this,a=T.e.deserialize(t.itemKey),i=a.filters,r=a.sortBy,o=a.isAscending;return function(a){return Object(d.__awaiter)(n,void 0,void 0,function(){var n,s,c,l,u,f,p,m,_,h;return Object(d.__generator)(this,function(b){switch(b.label){case 0:return n=function(e){if(T.e.matches(e)){var t=T.e.deserialize(e).groupBy;if(t===de.a[de.l])return function(e){var t={},n=function(a){for(var i,r,o=new Ge.e({publisher:n}),s=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n];if(!je.matches(i))return e;var r=je.deserialize(i);t.push(r)}return t.sort(function(e,t){return e&&t&&e.displayName.localeCompare(t.displayName)}).map(function(e){return je.serialize(e)})}(Object.keys(t)),c=[],l=0,u=s;l<u.length;l++){var f=u[l];if(je.matches(f)){var p=je.deserialize(f);o.resolveItems({items:(i={},i[f]=Object(d.__assign)(Object(d.__assign)(Object(d.__assign)({},C.u.pack(p.displayName)),Ke.r.pack(!0)),We.e.pack({itemKeys:t[f]})),i)}),c.push(f)}}return o.resolveItems({items:(r={},r[e]=Object(d.__assign)(Object(d.__assign)({},We.e.pack({itemKeys:c})),Ye.e.pack(!0)),r)}),{itemResolver:o}};return{onProcessResponse:function(e){var n,a,i,r,o,s=e.driveItemKey,c=e.item;if(c&&s){var l=c.remoteItem,u=l&&l.shared&&(null!==(n=l.shared.sharedBy)&&void 0!==n?n:l.shared.owner),f=(null===(a=null==u?void 0:u.user)||void 0===a?void 0:a.displayName)||(Xe?"":(null===(i=null==u?void 0:u.user)||void 0===i?void 0:i.email)||qe.s),p=Object(d.__assign)(Object(d.__assign)({},null!==(r=null==u?void 0:u.user)&&void 0!==r?r:{}),{displayName:f}),m=Re.e.serialize(s);if(!Xe||p.email||p.id){var _=je.serialize({displayName:p.displayName,email:p.email||"",id:p.id||""});o=_,t.hasOwnProperty(o)||(t[_]=[]),t[_].push(m)}}},groupChildItems:n}}(e);if(t===de.a[de.e])return function(e){var t={},n=function(a){for(var i,r,o=new Ge.e({publisher:n}),s=function(e){for(var t={},n=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n];if(!Ve.matches(i))return e;var r=Ve.deserialize(i);t.push(r)}return t.sort(function(e,t){return e&&t&&new Date(t.sharedDateTime).getTime()-new Date(e.sharedDateTime).getTime()}).map(function(e){return Ve.serialize(e)})}(Object.keys(e)),a=function(e){return t.hasOwnProperty(e)},i=0,r=n;i<r.length;i++){var o=r[i];if(Ve.matches(o)){var s=Ve.deserialize(o).relativeTime,c=ze.serialize({relativeTime:s});if(a(c))for(var d=0,l=e[o];d<l.length;d++){var u=l[d];t[c].push(u)}else{t[c]=[];for(var f=0,p=e[o];f<p.length;f++)u=p[f],t[c].push(u)}}}return t}(t),c=[],l=0,u=Object.keys(s);l<u.length;l++){var f=u[l];if(ze.matches(f)){var p=ze.deserialize(f).relativeTime;o.resolveItems({items:(i={},i[f]=Object(d.__assign)(Object(d.__assign)(Object(d.__assign)({},C.u.pack(p)),Ke.r.pack(!0)),We.e.pack({itemKeys:s[f]})),i)}),c.push(f)}}return o.resolveItems({items:(r={},r[e]=Object(d.__assign)(Object(d.__assign)({},We.e.pack({itemKeys:c})),Ye.e.pack(!0)),r)}),{itemResolver:o}};return{onProcessResponse:function(e){var n,a=e.driveItemKey,i=e.item;if(i&&a){var r=i.remoteItem,o=r&&r.shared&&r.shared.sharedDateTime,s=Re.e.serialize(a);if(o){var c=function(e,t){if(!e)return qe.n;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return Qe.today;if(n.setDate(n.getDate()-1),e>=n)return Qe.yesterday;if(n.setDate(t.getDate()-t.getDay()),e>=n)return qe.i;if(n.setDate(n.getDate()-7),e>n)return qe.t;var a=new Date(t.getFullYear(),t.getMonth(),1);if(e>=new Date(t.getFullYear(),t.getMonth()-1,1)&&e<a)return qe.e;if(n.setDate(n.getDate()-7),e>n)return qe.o;if(n.setDate(n.getDate()-7),e>n)return qe.r;if(e>=a)return qe.a;var i=t.getFullYear()===e.getFullYear(),r=Je.e[e.getMonth()];return i?r:B.format(Qe.MonthAndYear,r,e.getFullYear())}(new Date(o),new Date),d=Ve.serialize({relativeTime:c,sharedDateTime:o});n=d,t.hasOwnProperty(n)||(t[d]=[]),t[d].push(s)}}},groupChildItems:n}}(e)}return{onProcessResponse:void 0,groupChildItems:void 0}}(t.itemKey),s=n.onProcessResponse,c=n.groupChildItems,l=T.e.deserialize(t.itemKey),u=l.driveItemKey.endpoint,f=a(Object(He.e)({graphSharedWithMeEndpoint:Fe.D})).graphSharedWithMeEndpoint,u=f||u,U.e.isActivated("C8633E26-C16D-4D6D-ABE5-BE1A2C3C256A","02/23/2022","Use OneDrive endpoint for Shared with me")?[3,3]:f&&f!==l.driveItemKey.endpoint?(l=Object(d.__assign)(Object(d.__assign)({},l),{driveItemKey:Object(d.__assign)(Object(d.__assign)({},l.driveItemKey),{endpoint:f})}),[3,3]):[3,1];case 1:return[4,a(Object(Ze.e)({endpoint:u}))];case 2:(p=b.sent())!==l.driveItemKey.endpoint&&(l=Object(d.__assign)(Object(d.__assign)({},l),{driveItemKey:Object(d.__assign)(Object(d.__assign)({},l.driveItemKey),{endpoint:p})})),b.label=3;case 3:return(m=a(Object(ue.i)(l.driveItemKey.endpoint)))&&!r&&(r=de.o,o=!0),_=T.e.serialize(l),[4,a(Object(Ie.e)(Object(d.__assign)(Object(d.__assign)({},t),{qosName:"sharedWithMe",itemKey:_,itemSetKeyFacet:T.e,parentItemKeyFacet:ie.e,disableRemoteItem:!1,getUrl:function(e){var t=e.driveItemKey.endpoint;return m?"".concat(t,"/drive/oneDrive.sharedWithMe?select=*,webDavUrl"):!U.e.isActivated("211F049A-DF94-41B3-99C3-E71620C63E23","05/31/2022","Remove me from request Url")&&p?"".concat(t,"/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500"):"".concat(t,"/me/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500")},filterChildItems:function(e){return!function(e,t){return void 0===t&&(t=[]),t.every(function(t){var n,a=!("sharedByName"===t.type)||function(e,t){var n,a,i,r=(null===(n=e.remoteItem)||void 0===n?void 0:n.shared)&&(null!==(a=e.remoteItem.shared.sharedBy)&&void 0!==a?a:e.remoteItem.shared.owner),o=null===(i=null==r?void 0:r.user)||void 0===i?void 0:i.displayName;return!!o&&t.indexOf(o)>-1}(e,t.values),i=!("fileName"===t.type)||function(e,t){return!!e.name&&function(e,t){var n,a,i=(n=e,a=Object(Ce.t)(n,!0),Object(Oe.n)(a)),r=Le.get(i);return!!r&&Object(xe.t)(t.filters,r)}(e.name,t)}(e,Object(we.t)(t.values)),r=!("dateModified"===t.type)||function(e,t){var n=e.lastModifiedDateTime||"";return(n&&new Date(n))>=t}(e,function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case Ae.e.today:return n;case Ae.e.yesterday:return Ee(n,1);case Ae.e.last7Days:return Ee(n,7);case Ae.e.last30Days:return Ee(n,30);case Ae.e.last3Months:return Ee(n,90);default:return new Date(0)}}((n=t.values).length<1||-1===Object.keys(Ae.e).indexOf(n[0])?Ae.e.none:Ae.e[n[0]]));return a&&i&&r})}(e,i)},sortChildItems:function(e){return function(e,t,n,a){void 0===a&&(a=!1);var i=de.a[de.e],r=de.a[de.l],o=de.a[le.a],s=de.a[le.n],c=de.a[de.c],d=de.a[le.s];switch(t){case i:return Ue(e,n,a,Me);case r:return Ue(e,n,a,Te);case o:case s:case d:return Ue(e,n,a,Pe);case c:return Ue(e,n,a,ke);default:return e}}(e,r,o,!0)},onProcessResponse:s,groupChildItems:c,mapItemSetKey:function(){var n,a=new Ge.e({publisher:e});return a.mapKeys({mappings:(n={},n[_]=t.itemKey,n)}),{itemResolver:a}},scenarioInfo:{scenario:$e.e.PopulateSharedWithMe,scenarioType:$e.t.ActiveUserOperation}})))];case 4:return h=b.sent().itemResolver,a(h.execute()),[2]}})})}}),tt=n(202),nt=n(371),at=n(2880),it=Object(i.t)(function(){return function(e){e(Object(tt.t)({keyFacet:T.e,facets:[T.e,We.e]})),e(De.e),e(Object(r.a)(T.e,nt.e)(et)),e(at.e)}}),rt=n(580),ot=n(2741),st=n(469),ct=n(565),dt=n(2759),lt=n(122),ut=n(365),ft=n(984),pt=n(38),mt=n(215),_t=U.t.isActivated("d4cb8ed6-56a5-4c23-8c49-2f352054edd9","12/15/2021","Use cultureName instead of cultureUIName to display the date"),ht=Object(lt.i)({name:dt.e,key:de.e,fieldName:"",minWidth:lt.e.regularMin,maxWidth:lt.e.regularMax,isCollapsable:!0,sortProps:lt.t},ft.e)(function(e,t){var n=e.demandItemFacet(ut.e,t),a=n&&new Date(n.sharedDateTime).getTime();if("number"!=typeof a||isNaN(a))return{text:""};var i=e.demandItemFacet(pt.O,mt.e),r=!_t&&(null==i?void 0:i.cultureLCID)||(null==i?void 0:i.language)||window.navigator.language;return r?{text:Object(ct.n)(new Date(a),r)}:{dateValue:a}}),bt=n(1206),gt=n(340),vt=n(1292),yt=n(864),St=new Ne.e("topCollaboratorSetKeyFacet",{endpoint:Be.e}),Dt=n(1516),It=n(551),xt=n(1591),Ct=n(3496),Ot=n(20);Object(Ot.n)([{rawString:".topCollaPlaceHolder_7990aeb5{display:-webkit-box;display:-ms-flexbox;display:flex;min-width:13px;height:21px}[dir='ltr'] .topCollaPlaceHolder_7990aeb5{padding-right:10px}[dir='rtl'] .topCollaPlaceHolder_7990aeb5{padding-left:10px}.topCollaboratorIcon_7990aeb5{color:#0078d4;font-size:13px;line-height:21px;text-align:center}.topCollaboratorUserName_7990aeb5{font-weight:700}.topCollaboratorTooltip_7990aeb5{padding:0 2px}.userWithTopCollaborator_7990aeb5{display:-webkit-box;display:-ms-flexbox;display:flex}.userWithTopCollaborator_7990aeb5 .topCollaPlaceHolder_7990aeb5{min-width:13px}[dir='ltr'] .userWithTopCollaborator_7990aeb5 .topCollaPlaceHolder_7990aeb5{padding-right:7px}[dir='rtl'] .userWithTopCollaborator_7990aeb5 .topCollaPlaceHolder_7990aeb5{padding-left:7px}[dir='ltr'] .columnHeader_7990aeb5{margin-left:20px}[dir='rtl'] .columnHeader_7990aeb5{margin-right:20px}\n"}]);var wt=function(e){function t(t){return e.call(this,t)||this}return Object(d.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.userName,n=e.isPlaceholder,a=h.createElement(It.e,{className:"topCollaboratorIcon_7990aeb5",iconName:"TeamFavorite"}),i=h.createElement("span",{className:"topCollaboratorUserName_7990aeb5"},t),r=h.createElement("div",{className:"topCollaboratorTooltip_7990aeb5"},B.formatToArray(Ct.e,i));return h.createElement("div",{className:"topCollaPlaceHolder_7990aeb5"},n?null:t?h.createElement(xt.e,{content:r},a):a)},t}(Dt.e),Et=Object(lt.i)({name:dt.a,key:de.l,fieldName:"",minWidth:lt.e.regularMin,maxWidth:lt.e.regularMax,isCollapsable:!0,sortProps:lt.a,headerClassName:"columnHeader_7990aeb5"},bt.e)(function(e,t){var n,a=e.demandItem({shareByPerson:vt.e},t).shareByPerson,i=e.demandItem({sharedBy:ut.e},t).sharedBy,r=null==a?void 0:a.itemKey,o=i&&(null!==(n=i.sharedBy)&&void 0!==n?n:i.owner),s=(null==a?void 0:a.displayValue)||o&&o.user&&o.user.displayName,c=!1;if(r&&yt.e.matches(r)){var d=yt.e.deserialize(r).email,l=e.demandItemFacet(We.e,St.serialize({endpoint:"https://graph.microsoft.com/beta"}));l&&(c=l.itemKeys.slice(0,3).some(function(t){var n=e.demandItemFacet(gt.e,t);return!!n&&n===d}))}return r||s?{people:[{itemKey:r||"",displayValue:s}],onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),a=e.user;return h.createElement("div",{className:"userWithTopCollaborator_7990aeb5"},h.createElement(wt,{userName:a.title,isPlaceholder:!c}),n)}}:{people:[]}},function(e,t){return"".concat(e.demandItemFacet(gt.e,t))}),At=!U.e.isActivated("261491DC-B6D7-4FB8-85F3-EBAA7EA472B0","05/31/2022",'Enables the "Shared Date" column in ODC Shared with me');function Lt(e,t){var n=t.itemSetKey,a=!1,i=e.demandItemFacet(T.e,n);if(i){var r=i.driveItemKey.endpoint;a=Object(ue.a)(e,r)}return{columns:Object(d.__spreadArray)(Object(d.__spreadArray)([],a?Object(d.__spreadArray)([rt.e,st.t],At?[ht]:[],!0):[rt.t,ot.e,ht],!0),[Et],!1)}}var kt=n(335),Mt=new Ne.e("topCollaboratorItemKeyFacet",{id:Be.e}),Pt=Object(i.i)()(function e(t){var n=this,a=t.itemKey;return function(i){return Object(d.__awaiter)(n,void 0,void 0,function(){var n,r,o,s,c,l,u,f,p,m,_,h,b,g,v,y;return Object(d.__generator)(this,function(S){switch(S.label){case 0:return n=new Ge.e({publisher:e}),r=i(Object(He.e)({graphEndpoint:Fe.b})).graphEndpoint,o=St.deserialize(a),s=r||o.endpoint,c="".concat(s,"/me/people/"),[4,i(Object(ue.t)({url:c,qosName:"getTopCollaborator",endpoint:s}))];case 1:for(l=S.sent(),u=[],f=0,p=l.value;f<p.length;f++)m=p[f],_=m.id,h=m.displayName,b=m.userPrincipalName,g=Mt.serialize({id:_}),i(Object(tt.e)({items:(v={},v[g]=Object(d.__assign)(Object(d.__assign)({},C.u.pack(h)),gt.e.pack(b)),v)})),u.push(g);return n.resolveItems({items:(y={},y[t.itemKey]=Object(d.__assign)({},We.e.pack({itemKeys:u})),y)}),i(n.execute()),[2]}})})}});function Tt(e,t){return{isAvailable:!1}}function Ut(e,t){return{isAvailable:!1}}var Ft=Object(i.t)(function(){return function(e){e(it),e(Object(c.e)(ie.e,o.e)(oe)),e(Object(c.e)(ie.e,s.e)(ae)),e(Object(c.e)(T.e,ce.t)(pe)),e(Object(c.e)(T.e,_e.e)(ge)),e(Object(c.e)(T.e,he.e)(ye)),e(Object(c.e)(T.e,he.t)(Se)),e(Object(c.e)(T.e,kt.e)(Lt)),e(Object(c.e)(je,_e.e)(Tt)),e(Object(c.e)(ze,_e.e)(Ut)),e(Object(r.a)(St,nt.e)(Pt))}})}}]);