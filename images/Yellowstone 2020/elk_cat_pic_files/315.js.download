(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[315,221],{1704:function(e,t,n){"use strict";n.r(t),n.d(t,"encodeItemSetParentKeyKey",function(){return M}),n.d(t,"resourceKey",function(){return T});var a=n(0),i=(n(780),n(55)),r=n(1061),o=n(450),s=n(1054),c=n(59),d=n(23),l=n(62),u=n(1778),f=n(127),p=n(781),m=n(449),_=n(1781),h=n(1779),b=n(1759),g=n(1361),v=n(8),y=n(112),S=n(1730),D=n(203),I=n(1760),x=n(22),C="__next__",O=function(){function e(e,t,n,a){this._context=e,this._store=t,this._isTokenBaseApi=n,this._tokenBasedExtraItemCount=a}return e.prototype.initialize=function(e,t){if(this._skipDataFetch=!1,!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,a=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,a)}e&&e.isExpired&&(this._context.group=null),this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&this._context.group.groupingId!==C&&!this._context.groupReplace,this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&this._context.group.groupingId===C;var i=e&&e.content.peek().groupings;this._isAllCollapsedQuery=i&&i.length>0&&i[0].isAllCollapsed&&i[0].isAllCollapsed.peek()&&!this._isExpandingGroup},e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;return n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&b.e(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length)),n},e.prototype.computeNewChildren=function(e,t,n,a,i){var r,o=!1;if(this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken),r=i&&!n.isExpired?n.content.peek().items:[],e.nextRequestToken?(!t.requestToken&&r.length>e.totalChildren&&(r[e.totalChildren]=null),e.totalChildren+=this._tokenBasedExtraItemCount,this._store.setNextRequestToken(t.parentKey,a,e.nextRequestToken),o=!0,n&&(n.isTokenBasedApi=o)):this._store.setNextRequestToken(t.parentKey,a,"end"),t.requestToken&&(t.startIndex=r.length-this._tokenBasedExtraItemCount,e.totalChildren+=r.length-this._tokenBasedExtraItemCount),this._isFetchingNextGroup||this._isAllCollapsedQuery){var s=e.children.length,c=e.startIndex+s;e.nextRequestToken&&(c+=this._tokenBasedExtraItemCount),e.totalChildren=Math.max(e.totalChildren,Math.max(r.length,c))}if(e.item&&e.totalChildren>=0){var d;this._isExpandingGroup||(r.length>0&&0===e.totalChildren?r=[]:r.length=e.totalChildren),d=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var l=0,u=0;l<r.length;l++)l>=d&&u<e.children.length&&(r[l]=this._store.getItem(e.children[u].key),(t.remoteItem||t.isMountPointFolder)&&(r[l].peek().isMountPointFolder=!0,r[l].peek().remoteWebUrl=t.isMountPointFolder?t.remoteWebUrl:t.remoteItem.SiteUrl),u++)}return{allChildren:r,hasNextRequestToken:o}},e.prototype.computeNewGroupings=function(e,t,n,a,i){var r=this._isExpandingGroup?a.group:null,o=a.itemsPerGroup,s=e&&e.length>0?e[0].itemGroups:null,c=null;s&&s.length>0&&s[s.length-1].isPlaceholder&&(c=s.pop());var d=this._mergeGroupings(e,t,i,n);if(r&&d&&(d[0].isAllCollapsed(!1),r.state({isCollapsed:!1})),n&&n.length>0&&!n[n.length-1]&&(s=d&&d.length>0?d[0].itemGroups:null)&&s.length>0){var l=s[s.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(l.hasMoreData=!0);var u=n[l.startIndex+(-1!==o?Math.min(l.count,o):l.count)-1]&&!(this._context.groupReplace&&l.count<o),f=d[0].isAllCollapsed.peek();if(u||this._isFetchingNextGroup||f){var p=l.startIndex+l.count;c?c.startIndex=p:c={groupingId:C,startIndex:p,count:1,isPlaceholder:!0,state:x.observable({isCollapsed:!1})},n.length<p&&(n.length=p+1),s.push(c)}}return d},e.prototype._mergeGroupings=function(e,t,n,a){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var r=0;r<t.length;r++){var o=i[r].isAllCollapsed.peek();i[r].itemGroups=n?this._retainItemGroupState(i[r].itemGroups,t[r].itemGroups):this._mergeItemGroups(i[r].itemGroups,t[r].itemGroups,o,null,a)}}else i=t;return i},e.prototype._mergeItemGroups=function(e,t,n,a,i){var r=e;if(e&&e.length>0){if(t&&t.length>0)for(var o=function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var o=function(i){var o=r[i];if(e.groupingId===o.groupingId){if(s._context.noIndexBasedDataFetch||!s._context.isTokenBasedApi)if(s._context.groupReplace?(o.count+=e.count,o.hasMoreData&&i<r.length-1&&(o.hasMoreData=!1)):o.count=e.count,o.children=s._mergeItemGroups(o.children,e.children,n,o),0===i)o.startIndex=a?a.startIndex:0;else{var c=r[i-1],d=c.startIndex+c.count-o.startIndex;o.startIndex+=d,o.children&&o.children.forEach(function(e){e.startIndex+=d})}else{var l=e.startIndex+s._context.startIndex,u=e.startIndex+s._context.startIndex+e.count;o.startIndex=Math.min(o.startIndex,l),o.count=Math.max(u,o.startIndex+o.count)-o.startIndex}return t=!0,"break"}},c=0;c<r.length&&"break"!==o(c);c++);if(!t){var d=r[r.length-1],l=d.startIndex+d.count-e.startIndex;e.startIndex+=l,e.children&&e.children.forEach(function(e){e.startIndex+=l});var u=Math.min(e.count,30),f=0;if(i)for(var p=e.startIndex;p<e.startIndex+u;p++)i[p]||f++;f&&(e.emptyItemCount=f),r.push(e)}},s=this,c=0,d=t;c<d.length;c++)o(d[c])}else r=t;return r},e.prototype._retainItemGroupState=function(e,t,n){var a=t;if(t&&t.length>0&&e&&e.length>0){for(var i={},r=0,o=e;r<o.length;r++){var s=o[r];i[s.groupingId]=s}for(var c=0,d=a;c<d.length;c++){var l=d[c],u=i[l.groupingId];u&&(l.state(u.state.peek()),l.children=this._retainItemGroupState(u.children,l.children,u))}}return a},e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var a=t[n];if(!(a&&a.startIndex<=e))break;var i=a.startIndex+a.count-1;if(a.children){if(i>=e)return this._getGroupStartingOnIndex(e,a.children)}else{if(a.startIndex===e)return a.state.peek().isCollapsed?null:a;if(i>=e){var r=n<t.length-1?t[n+1]:null;if(r&&!r.state.peek().isCollapsed)return this._skipDataFetch=!0,null}}}return null},e}(),w=n(1724),E=n(7),A=n(263),L=n(13),k=100,M=new v.t({name:"".concat("ItemProvider",".encodeItemSetParentKey"),factory:new v.e(Object(E.Dr)(E.ar))}),P=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._registeredProjections={},a._pendingGetItemRequests={},a._store=n.itemsStore,a._operationProvider=n.operationProvider,a._schemaDataSource=n.schemaDataSource,a._updateQuota=n.updateQuota,a._groupThrottle=n.groupThrottle,a._encodeItemSetParentKey=n.encodeItemSetParentKey||!1,a._smartFiltersStore=n.smartFiltersStore,a}return Object(a.__extends)(t,e),t.prototype.getItem=function(e){return this._getItem(e)},t.prototype.getItemSetKey=function(e,t){var n="parentKey="+(this._encodeItemSetParentKey?encodeURIComponent(e.parentKey):e.parentKey);function a(e,t){t&&(n+="&".concat(e,"=").concat(t))}a("ownerId",e.ownerId),a("groupingType",e.groupingType),n+="&sortField="+(e.sortField||""),n+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var i=e.filters;if(i)for(var r in i)n+="&"+r+"="+i[r];a("groupBy",e.groupBy),a("viewId",e.baseViewId),a("viewXml",e.viewXml),a("additionalFiltersXml",e.additionalFiltersXml);var o=!t&&e.itemSetProjections;if(o){var s="";for(var c in o)s+=c+"_"+o[c];n+="&projection="+s}return e.supportsNestedGroups&&(n+="&ng=1"),n},t.prototype.getSpecifiedItems=function(e){return e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey),this._getItemDataSource().then(function(t){return t.getSpecifiedItems(e)})},t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,a=this._store.getItem(n),i=this._getItemSet(t,e);if(!a){var r=new o.e(n),s=e.queryType,c=void 0===s?r.queryType:s;r.queryType=c,this._store.setItem(r),a=this._store.getItem(n)}if(!i){var d=a.peek(),l=d&&d.folder,u=l&&l.childCount||0;(i=new h.e(t,e,u)).item=a;var f=e.needSchema;if(void 0===f||f){var p=this._schemaDataSource,m=p&&p.getColumns(d);m&&m.length>0&&i.schema(m)}this._store.setItemSet(t,i)}return i},t.prototype.invalidateItem=function(e,t){var n=void 0===t?{}:t,i=n.triggerFetch,r=void 0!==i&&i,o=n.emptyAllOtherSets,s=void 0!==o&&o,c=n.refreshSchema,d=void 0!==c&&c,l=n.updateGrouping,u=void 0!==l&&l,f=n.purgeCache,p=void 0!==f&&f;if(s&&this._store.emptyAllOtherSets([e]),d&&(m=this._store.getItemSetFromItemKey(e))&&m.schema([]),u||this._store.invalidateItem(e,{purgeCache:p}),this._smartFiltersStore&&this._smartFiltersStore.invalidate(e),r){var m=this._store.getItemSetFromItemKey(e);this._getItem(Object(a.__assign)(Object(a.__assign)({parentKey:e},m&&m.context||{}),{skipCache:!0,updateGrouping:u}))}},t.prototype.removeFromRecent=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromRecent(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.removeMountPoint=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeMountPoint(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.createMountPoint=function(e){return this._getItemDataSource().then(function(t){return t.createMountPoint(e)}).then(function(e){return e},function(e){return c.n.wrapError(e)})},t.prototype.createDocument=function(e,t,n,a,i){var r=this;return this._getItemDataSource().then(function(o){return o.createDocument(e,t,n,a).then(function(t){if(i&&o.updateContentType){var n=t.match(/{(.*)}/),a=n&&n[1];return a?o.updateContentType(e,a,i).then(function(){return r.invalidateItem(e),r._updateQuota(!0),t}):t}return r.invalidateItem(e),r._updateQuota(!0),t})})},t.prototype.createCustomDocument=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.createCustomDocument(e,t,n)}).then(function(t){return t?(a.invalidateItem(e),a._updateQuota(!0),a.getItem({parentKey:e}).then(function(e){return a.peekUnwrapObservable(a._store.getItem(t))})):c.n.wrapError()})},t.prototype.updateBundle=function(e,t){var n=this,a=[new S.e(e.item.key,e.item)];return t.update(a),this._getItemDataSource().then(function(t){return t.updateBundle(e)}).then(function(){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key),a=a.map(function(e){return e.succeed()}),t.update(a)},function(i){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key);var r=new Error(i);return a=a.map(function(e){return e.fail(r)}),t.update(a),c.n.wrapError(r)})},t.prototype.removeFromSharedList=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromSharedList(e)}).then(function(n){return t.invalidateItem(e.parentKey),t.resources.consume(A.e)&&t.resources.consumeAsync(l.M).then(function(t){t.invalidateItems(e.parentKey)}),n})},t.prototype.updateViewCount=function(e){return this._getItemDataSource().then(function(t){return t.updateViewCount(e)})},t.prototype.reportAbuse=function(e){var t=new p.e,n=this._operationProvider.register({name:e.item.name||"",type:m.e.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),a=this._getItemDataSource().then(function(t){return t.reportAbuse(e)});return n.state(f.e.started),n.progress.maximum(1),a.then(function(e){return n.state(f.e.completed),n.progress.current(1),e},function(e){return n.state(f.e.failed),n.error(new _.e({message:e})),c.n.wrapError(e)})},t.prototype.requestReview=function(e){for(var t=this,n=new p.e,a=e.items.map(function(e){var a=t._operationProvider.register({name:e.name||"",type:m.e.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});return a.progress.maximum(1),a.progress.current(0),a}),i=this._getItemDataSource().then(function(t){return t.requestReview(e)}),r=0,o=a;r<o.length;r++)o[r].state(f.e.started);return i.then(function(n){for(var i=0,r=a;i<r.length;i++){var o=r[i];o.progress.current(1),o.state(f.e.completed)}var s=e.items[0].UNSAFE_parent;return s&&t.invalidateItem(s.key),n},function(e){for(var t=0,n=a;t<n.length;t++){var i=n[t];i.error(new _.e({message:e})),i.state(f.e.failed)}return c.n.wrapError(e)})},t.prototype.saveSortOrder=function(e){return this._getItemDataSource().then(function(t){return t.saveSortOrder(e)}).then(function(e){return e},function(e){})},t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,m.e.addCoverPhotos,this._addCoverPhotos)},t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,m.e.removeCoverPhotos,this._removeCoverPhotos)},t.prototype.changeFolderType=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.changeFolderType(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.updateItemProperty=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.updateItemProperty(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.getOpenInClientDetails=function(e){return this._getItemDataSource().then(function(t){return t.getOpenInClientDetails(e)}).then(function(e){return e},function(e){})},t.prototype.getWorkProgress=function(e){return this._getItemDataSource().then(function(t){return t.getWorkProgress(e)})},t.prototype.processReferral=function(e,t){return this._getItemDataSource().then(function(n){return n.processReferral(e,t)})},t.prototype.getItemOcrTextContent=function(e){return this._getItemDataSource().then(function(t){return t.getItemOcrTextContent(e)})},t.prototype.updateItemOcrInfo=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.updateItemOcrInfo(e,t,n)}).then(function(t){return a.invalidateItem(e.key,{triggerFetch:!0}),t},function(e){return e})},t.prototype.rotateItems=function(e,t){var n=this,a={},i=e.items.map(function(e){return a[e.key]=new S.e(e.key,e)});return t.update(i),this._getItemDataSource().then(function(t){return t.rotateItems(e)}).then(function(){i=i.map(function(e){return e.succeed()}),t.update(i)},function(e){var r=e.data||[];i=[];for(var o=0,s=r;o<s.length;o++){var c=s[o],d=a[c.key];n._store.setItem(d.input),delete a[c.key],i.push(d.fail(c.error))}for(var l in a)d=a[l],delete a[l],i.push(d.succeed());t.update(i)})},t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t},t.prototype.computeProjectedItemSet=function(e,t,n,a){var i=n.itemSetProjections,r=a?null:this._store.getItemSet(e),o=!r||r.isPlaceholder||r.isExpired||r.version!==t.version;if(!r||o){for(var s in r||((r=new h.e(e,n)).item=t.item,r.isTokenBasedApi=t.isTokenBasedApi,r.isPlaceholder=t.isPlaceholder,r.isExpired=t.isExpired,r.version=t.version),i){var c=this._registeredProjections[s];c&&c.projectItemSet(r,t,i[s])}a||this._store.setItemSet(e,r)}return r},t.prototype.redeemPermissionToken=function(e){return this._getItemDataSource().then(function(t){return t.redeemPermissionToken(e)})},t.prototype._getItem=function(e){var n,i=this,r=g.e(e),o=this._store;e.keyAlias?(n=this.getItemSync({parentKey:e.keyAlias}).item,e.parentKey=n.peek().key):n=this.getItemSync(e).item;var s=e.skipCache,d=void 0!==s&&s,u=this.getItemSetKey(e),f=e.itemSetProjections?this.getItemSetKey(e,!0):u,p=this._getItemSet(u,e),m=p&&p.content.peek().items,_=e.isTokenBasedApi||!!p&&!!p.isTokenBasedApi,v=!d&&n&&!n.peek().revision&&p&&!p.isExpired&&!p.isPlaceholder&&(!e.requestAllChildren||b.e(m,{start:0,end:m.length})),y=e.startIndex,S=void 0===y?0:y,I=e.pageSize,x=void 0===I?k:I,C=e.endIndex||S+x;C=m&&m.length>0&&!_?Math.min(m.length,C):C,S=Math.max(0,Math.min(C,S));var E=L.e.isActivated("73b2b18a-27b0-433f-95cf-c7f77326ff37","11/09/2021","Not set requestToken if itemSet is expired")||p&&!p.isExpired?o.getNextRequestToken(f):void 0;e.requestToken="end"===E?"":E;var A=new O(e,o,_,t.TOKEN_BASED_API_EXTRA_ITEMS);A.initialize(p,S);var M=!1,P=p&&p.content.peek();if(!P||1!==P.partialResultStatus&&2!==P.partialResultStatus||(M=!0,1===P.partialResultStatus&&p.content({items:P.items,groupings:P.groupings,partialResultRequestCount:0,partialResultStatus:2})),v&&!M&&A.isResultSetValid(m,{start:S,end:C}))return c.n.wrap(p);if(n&&n.peek().isStub){var T=e.startKey;if(T&&o.getItem(T)){p.content.peek().items=[o.getItem(T)],p.isPlaceholder=!0,p.isExpired=!1;var U=this._schemaDataSource,F=U&&U.getColumns(n.peek());F&&F.length>0&&p.schema(F),p.content.valueHasMutated&&p.content.valueHasMutated()}return c.n.wrap(p)}var H=p&&!p.isExpired&&p.content.peek().groupings;H&&H.length>0&&(e.isGrouped=!0),this._normalizeContext(e,m,S,C,!v);var R=this._getRequestKey(e),N=this._pendingGetItemRequests[R];return N?e.itemSetProjections?N.getPromise().then(function(t){return i.computeProjectedItemSet(u,t,e)}):N.getPromise():(_&&!E&&(e.startIndex=0),this._pendingGetItemRequests[R]=N=new D.e,this.resources.consumeAsync(l.v.bypass).then(function(t){return t.getItem(Object(a.__assign)(Object(a.__assign)({},e),{itemSetKey:u}))}).then(function(t){r.updateContextBasedOnResult&&e.updateContextBasedOnResult&&(r.updateContextBasedOnResult(r,t),e.updateContextBasedOnResult(e,t),u=i.getItemSetKey(r));var a=e.itemSetProjections?i.getItemSetKey(e,!0):u;n=o.getItem(e.parentKey);var s=o.getItemSet(a);v=!(!n||!s);var c=A.computeNewChildren(t,e,s,a,!!v),d=c.allChildren,l=c.hasNextRequestToken;if(l&&(_=l),t.item&&!e.ignoreChildren&&!e.skipStoreResults){v||((s=new h.e(a,e)).item=o.getItem(e.parentKey),s.isTokenBasedApi=_,o.setItemSet(a,s));var f=!!s.isExpired;s.sortField=t.sortField,s.isAscending=t.isAscending,s.isPlaceholder=!1,s.isExpired=!1;var p=e.needSchema;if(void 0===p||p){var m=t.schema;s.schema(m&&m.length>0&&m||[]),t.customViewRenderer?s.customViewRenderer=i.observables.create(t.customViewRenderer):s.customViewRenderer=i.observables.create(void 0)}var y=t.groupings;_&&e.mergeGroupings&&(y=A.computeNewGroupings(s.content.peek().groupings,t.groupings,d,e,f)),t.contentTypes&&s.contentTypes&&s.contentTypes(t.contentTypes);var S=s.content.peek(),D=S.partialResultStatus,I=S.partialResultRequestCount,x=void 0===I?0:I;if(!(y&&y.length&&y[0]))if(l&&(t.children&&t.children.length<30||!t.children)){var C=x+1;C<=5?x=C:D=1}else void 0===D||0===D||l?2===D&&t.children&&30===t.children.length&&(D=0):D=3;s.content({items:d,groupings:y,partialResultRequestCount:x,partialResultStatus:D});var O=s.version,w=void 0===O?0:O;s.version=w+1}if(delete i._pendingGetItemRequests[R],e.requestAllChildren&&!b.e(d,{start:0,end:t.totalChildren})){var E=g.e(e),L=E.startIndex,M=void 0===L?0:L;return E.startIndex=M+k,i._getItem(E)}return t.isFromBrowserCache?(r.skipCache=!0,i._getItem(r)):(e.itemSetProjections&&(s=i.computeProjectedItemSet(u,s,e)),s)},function(e){return delete i._pendingGetItemRequests[R],c.n.wrapError(e)}).then(function(e){N.complete(e)},function(t){i._groupThrottle&&!i._groupThrottle()&&t&&t.errorCode===Number(w.t.queryThrottled)&&!e.noGroupReplace?i._groupThrottle(!0):N.error(t)}),N.getPromise())},t.prototype._normalizeContext=function(e,t,n,a,i){var r=e.pageSize||k;if(!e.avoidSeamSnapping){if(!i&&n-n%r!=a-a%r&&t)for(;n<a&&t[n];)n++;e.startIndex=n-n%r}"number"!=typeof e.pageSize&&(e.pageSize=k);for(var o=e.startIndex,s=void 0===o?0:o;a-s>e.pageSize;)e.pageSize+=k},t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);return e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex,t+"&pageSize="+e.pageSize},t.prototype._getItemSet=function(e,t){var n=this._store,a=n.getItemSet(e);if(t.itemSetProjections){var i=this.getItemSetKey(t,!0),r=n.getItemSet(i);r&&(a=this.computeProjectedItemSet(e,r,t))}return a},t.prototype._updateCoverPhotos=function(e,t,n){for(var a=this,i=new p.e,r=e.target,o=e.items.map(function(e){var n=a._operationProvider.register({name:e.name||"",type:t,payloads:{coverPhotos:{parent:r,item:e}},iconName:e.iconName,batch:i});return n.progress.maximum(1),n.progress.current(0),n}),s=n.call(this,e),c=0,d=o;c<d.length;c++)d[c].state(f.e.started);return s.then(function(t){a.invalidateItem(r.key),(null==e?void 0:e.itemsScopeInvalidate)&&a.resources.consumeAsync(l.M).then(function(e){e.invalidateItems(null==r?void 0:r.key)});for(var n=0,i=o;n<i.length;n++){var s=i[n];s.progress.current(1),s.state(f.e.completed)}return t},function(){for(var e=0,t=o;e<t.length;e++)t[e].state(f.e.failed)})},t.prototype._addCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.addCoverPhotos(e)})},t.prototype._removeCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.removeCoverPhotos(e)})},t.prototype._getItemDataSource=function(){return c.n.resolve(this.resources.consumeAsync(l.U))},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{groupThrottle:d.b.optional,schemaDataSource:l.re.optional,itemsStore:s.e,operationProvider:r.resourceKey,smartFiltersStore:u.e.optional,updateQuota:I.e,encodeItemSetParentKey:M.optional}),t.TOKEN_BASED_API_EXTRA_ITEMS=2,t}(i.n),T=(t.default=P,Object(y.r)("ItemProvider",P))},1708:function(e,t,n){"use strict";n.d(t,"c",function(){return c}),n.d(t,"n",function(){return d}),n.d(t,"s",function(){return l}),n.d(t,"r",function(){return u}),n.d(t,"t",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"e",function(){return a}),n.d(t,"o",function(){return i}),n.d(t,"i",function(){return m});var a,i,r,o,s=n(8),c=new s.t("sortManager"),d=new s.t("dataManager"),l=(new s.t("listViewContextMenuCommandSet"),new s.t("topCommandSet"),new s.t("listViewContextMenuHelper")),u=new s.t("fileContent"),f=new s.t("contentRange"),p=new s.t("error");!function(e){var t,n,a,i,r;(r=e.leftNav||(e.leftNav={})).isLeftNavClosing=new s.t("base.leftNav.isLeftNavClosing"),r.isLeftNavVisible=new s.t("base.leftNav.isLeftNavVisible"),r.hideLeftNav=new s.t("base.leftNav.hideLeftNav"),r.isLeftNavUserExpanded=new s.t("base.leftNav.isLeftNavUserExpanded"),r.toggleIsLeftNavUserExpanded=new s.t("base.leftNav.toggleIsLeftNavUserExpanded"),(i=e.suiteNav||(e.suiteNav={})).context=new s.t("base.suiteNav.context"),i.isTopBarVisible=new s.t("base.suiteNav.isTopBarVisible"),i.isTopBarHamburgerVisible=new s.t("base.suiteNav.isTopBarHamburgerVisible"),i.isSuiteNavHamburgerVisible=new s.t("base.suiteNav.isSuiteNavHamburgerVisible"),i.supportHamburgerInSuiteNav=new s.t("base.suiteNav.supportHamburgerInSuiteNav"),i.isSuiteNavHidden=new s.t("base.suiteNav.isSuiteNavHidden"),(a=e.commandBar||(e.commandBar={})).transclusionProvider=new s.t("base.commandBar.transclusionProvider"),a.isDarkTheme=new s.t("base.commandBar.isDarkTheme"),a.isSearchHidden=new s.t("base.commandBar.isSearchHidden"),(n=e.infoPane||(e.infoPane={})).isInfoPaneAvailable=new s.t("base.infoPane.isInfoPaneAvailable"),n.hidePreview=new s.t("base.infoPane.hidePreview"),(e.filtersPane||(e.filtersPane={})).isFiltersPaneAvailable=new s.t("base.filtersPane.isFiltersPaneAvailable"),(t=e.columnCustomizationPane||(e.columnCustomizationPane={})).isColumnCustomizationPaneExpanded=new s.t("base.columnCustomizationPane.isColumnCustomizationPaneExpanded"),t.columnToFormat=new s.t("base.columnCustomizationPane.columnToFormat"),t.viewToFormat=new s.t("base.columnCustomizationPane.viewToFormat"),(e.oneUpOverlay||(e.oneUpOverlay={})).isPhotosOnly=new s.t("base.oneUpOverlay.isPhotosOnly"),(e.footer||(e.footer={})).hasFooter=new s.t("base.footer.hasFooter"),e.isSPLightSpeed=new s.t("base.isSPLightSpeed"),e.isScrollbarHidden=new s.t("base.isScrollbarHidden"),e.addPaddingBottom=new s.t("base.addPaddingBottom"),e.makeFlexBox=new s.t("base.makeFlexBox"),e.contextMenuHelper=new s.t("base.contextMenuHelper"),e.isRetrievingData=new s.t("base.isRetrievingData"),e.isSmartBannerVisible=new s.t("base.isSmartBannerVisible")}(a||(a={})),function(e){e.layoutType=new s.t("files.layoutType"),e.isArrangeControlVisible=new s.t("files.isArrangeControlVisible")}(i||(i={})),function(e){e.layoutType=new s.t("photos.layoutType")}(r||(r={})),function(e){e.layoutType=new s.t("storageInfo.layoutType")}(o||(o={}));var m=new s.t("eventScope")},1709:function(e,t,n){"use strict";var a=n(779);n.d(t,"e",function(){return a.t}),n.d(t,"t",function(){return a.n}),n.d(t,"n",function(){return a.a}),n.d(t,"a",function(){return a.r}),n.d(t,"i",function(){return a.o}),n.d(t,"r",function(){return a.s})},1724:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"i",function(){return s}),n.d(t,"t",function(){return b});var a={};n.r(a),n.d(a,"fileNotFound",function(){return c}),n.d(a,"invalidView",function(){return d}),n.d(a,"listNotFound",function(){return l}),n.d(a,"docAlreadyExists",function(){return u}),n.d(a,"queryThrottled",function(){return f}),n.d(a,"newExperieceRenderingNotSupported",function(){return p}),n.d(a,"onePageNavigationViewMismatch",function(){return m}),n.d(a,"onePageNavigationError",function(){return _}),n.d(a,"offline",function(){return h});var i,r,o,s,c=-2147024894,d=-2147024809,l=-1,u=-2130575257,f=-2147024860,p=-2,m=-3,_=-4,h=-5;!function(e){e[e.icon=16]="icon",e[e.iconMin=16]="iconMin",e[e.bigIcon=48]="bigIcon",e[e.bigIconMin=48]="bigIconMin",e[e.regularMin=90]="regularMin",e[e.regular=130]="regular",e[e.nameMin=220]="nameMin",e[e.nameODC=440]="nameODC",e[e.nameODB=280]="nameODB",e[e.originalLocation=300]="originalLocation",e[e.custom=900]="custom",e[e.sharedWith=150]="sharedWith",e[e.note=250]="note",e[e.dateModifiedMl=150]="dateModifiedMl",e[e.dotDotDot=32]="dotDotDot",e[e.ratingsMin=110]="ratingsMin"}(i||(i={})),function(e){e[e.none=0]="none",e[e.icon=1]="icon",e[e.name=2]="name",e[e.title=3]="title",e[e.calloutInvoker=4]="calloutInvoker",e[e.shareHeroCommand=5]="shareHeroCommand",e[e.modified=6]="modified",e[e.url=7]="url"}(r||(r={})),function(e){e[e.none=0]="none",e[e.notify=1]="notify",e[e.block=2]="block",e[e.notifyAndBlock=3]="notifyAndBlock",e[e.blockSharing=4]="blockSharing"}(o||(o={})),function(e){e[e.Auto=0]="Auto",e[e.Pinned=1]="Pinned",e[e.Removed=2]="Removed"}(s||(s={}));var b=a},1730:function(e,t,n){"use strict";var a=function(){function e(e,t){!function(e){return!!e&&"object"==typeof e}(e)?(this.key=e,this.input=t,this.status=0):(this.key=e.key,this.input=e.input,this.output=e.output,this.status=e.status,this.error=e.error)}return e.prototype.succeed=function(t){var n=new e(this);return n.output=t,n.status=1,delete n.error,n},e.prototype.fail=function(t){var n=new e(this);return n.error=t,n.status=2,n},e.prototype.cancel=function(){var t=new e(this);return delete t.error,t.status=3,t},e.prototype.restart=function(){return new e(this.key,this.input)},e.prototype.changeInput=function(t){var n=t(this.input),a=new e(this.key,n);return a.output=this.output,a.status=this.status,a.error=this.error,a},e.prototype.changeOutput=function(t){var n=t(this.output),a=new e(this.key,this.input);return a.output=n,a.status=this.status,a.error=this.error,a},e.prototype.compare=function(e){return e&&this.input===e.input&&this.output===e.output&&this.error===e.error&&this.status===e.status?null:{previous:e,current:this}},e}();t.e=a},1731:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(55),r=n(112),o=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a._recordsByThumbnailKey={},a._bucketsByImageKey={};var i=a.observables;a.lastAccessedDate=i.create(new Date);var r=n.pruneThumbnailsExtenders,o=void 0===r?{rateLimit:{timeout:6e5}}:r;return i.backgroundCompute(a._pruneThumbnails).extend(o),a}return Object(a.__extends)(t,e),t.prototype.getCoveragePercent=function(e,t){var n=l(e),a=l(t);return Math.sqrt(a/n)},t.prototype.register=function(e,t,n,a){void 0===n&&(n=t),void 0===a&&(a=!0);var i=this.lastAccessedDate;i(new Date);var r=d(this.getCoveragePercent(e,n)),o=c(e),s=c(t),l=this._recordsByThumbnailKey,u=this._bucketsByImageKey,f=l[o]||{lastAccessed:void 0,buckets:{}};f.lastAccessed=i.peek();var p=f.buckets[r];(!p||this.getCoveragePercent(p.size,n)>1)&&(p&&delete u[p.key],p=f.buckets[r]={key:s,size:n,image:t,isLoaded:a,lastAccessed:i.peek()}),u[s]=p,l[o]=f},t.prototype.record=function(e){var t=this.lastAccessedDate;t(new Date);var n=c(e),a=this._bucketsByImageKey,i=a[n];i?i.isLoaded=!0:a[n]={key:n,size:e,image:e,isLoaded:!0,lastAccessed:t.peek()}},t.prototype.isLoaded=function(e){var t=this.lastAccessedDate;t(new Date);var n=c(e),a=this._bucketsByImageKey[n];return a&&(a.lastAccessed=t.peek()),!!a&&a.isLoaded},t.prototype.retrieve=function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=t);var a=c(e),i=this._recordsByThumbnailKey[a],r=this.lastAccessedDate;if(r(new Date),i){var o=i.buckets;i.lastAccessed=r.peek();var s=d(t),l=d(n),u=-1/0,f=!1;for(var p in o){var m=Number(p);m<=s&&m>=l&&o[m].isLoaded&&(u=Math.max(u,m),f=!0)}var _=f&&o[u];return _&&_.image}},t.prototype._pruneThumbnails=function(){var e=this.lastAccessedDate().getTime();u(this._recordsByThumbnailKey,e),u(this._bucketsByImageKey,e)},t}(i.n),s=Object(r.r)("ThumbnailCache",o);function c(e){var t=e.url,n=e.width,a=e.height;return JSON.stringify({url:t,width:n,height:a})}function d(e){return Math.floor(Math.log(e)/Math.log(2)*4)}function l(e){return e.width*e.height}function u(e,t){for(var n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];t-e[i].lastAccessed.getTime()>432e5&&delete e[i]}}},1732:function(e,t,n){"use strict";n.d(t,"s",function(){return v}),n.d(t,"c",function(){return S}),n.d(t,"a",function(){return I}),n.d(t,"i",function(){return x}),n.d(t,"t",function(){return O}),n.d(t,"o",function(){return w}),n(779);var a,i,r,o,s,c=n(276),d=n(25),l=n(1709);n.d(t,"e",function(){return l.e}),n.d(t,"n",function(){return l.t}),n.d(t,"r",function(){return l.n}),n.d(t,"d",function(){return l.a}),n.d(t,"l",function(){return l.i}),n.d(t,"u",function(){return l.r});var u="ms-word",f="onenote|UsePlain",p="ms-powerpoint",m="ms-excel",_="ms-visio",h="ms-publisher",b="ms-project",g=((a={})[u]=d.OpenInWordOnline,a[f]=d.OpenInOneNoteOnline,a[p]=d.OpenInPowerPointOnline,a[m]=d.OpenInExcelOnline,a[_]=d.OpenInVisioOnline,a);function v(e){return g[e]||""}var y=((i={})[u]=d.OpenInWord,i[f]=d.OpenInOneNote,i[p]=d.OpenInPowerPoint,i[m]=d.OpenInExcel,i[_]=d.OpenInVisio,i[h]=d.OpenInPublisher,i[b]=d.OpenInProject,i["ms-infopath"]=d.OpenInInfoPath,i);function S(e){return y[e]}var D=((r={})[u]="Word",r[f]="OneNote",r[p]="PowerPoint",r[b]="Project",r[_]="Visio",r[m]="Excel",r);function I(e){var t=e.extension;return t&&".pdf"===t.toLowerCase()?"WordPdf":D[e.appMap]||"Word"}function x(e){return D[e]}(o={})[u]="WordLogo",o[f]="OneNoteLogo",o[p]="PowerPointLogo",o[m]="ExcelLogo",o[_]="VisioLogo",o[h]="Page";var C=((s={})[u]="svg/word_16x1.svg",s[f]="svg/onenote_16x1.svg",s[p]="svg/powerpoint_16x1.svg",s[m]="svg/excel_16x1.svg",s[_]="svg/visio_16x1.svg",s[h]="Page",s),O={"svg/word_16x1.svg":"svg/word_white_stroke_18x1.svg","svg/onenote_16x1.svg":"svg/onenote_white_stroke_18x1.svg","svg/powerpoint_16x1.svg":"svg/powerpoint_white_stroke_18x1.svg","svg/excel_16x1.svg":"svg/excel_white_stroke_18x1.svg","svg/visio_16x1.svg":"svg/visio_white_stroke_18x1.svg"};function w(e){var t=C[e];return t&&new c.e(t)}},1737:function(e,t,n){"use strict";var a,i=n(0),r=n(161),o=n(55),s=n(203),c=n(112),d=n(1813),l=n(1757),u=n(637),f=n(32),p=n(120);!function(e){e[e.none=0]="none",e[e.queue=1]="queue",e[e.server=2]="server"}(a||(a={}));var m=a,_=Object(u.e)({eventName:"ImageLoad,Qos,",shortEventName:"ImageLoad"},{loadType:{typeRef:a,type:f.e.Enum}},p.e),h=n(48),b=n(1731),g=n(79),v=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._semaphore=new l.e(16),a._thumbnailCache=n.thumbnailCache,a}return Object(i.__extends)(t,e),t.prototype.loadImage=function(e){var t=this,n=e.url,a=e.imageElement,i=void 0===a?document.createElement("img"):a,r=e.scenarioName,o={url:n,width:0,height:0},s=this._thumbnailCache,c=function(){return d.e.authenticate(n).then(function(){return t._waitForImageLoad(i,n,r)}).then(function(e){if(s.record(o),i.complete&&!e)return t._waitForTimeout(300)}).then(function(){var e=i.naturalWidth||i.width,t=i.naturalHeight||i.height;return{url:n,width:e,height:t}})};return s.isLoaded(o)?c():this._semaphore.enqueue(c)},t.prototype._waitForImageLoad=function(e,t,n){var a,i,r,o=this.async,c=this.events,d=function(){r&&o.clearTimeout(r),c.off(e)},l=new s.e(function(){d(),e.setAttribute("src","")}),u=t&&t.indexOf("&encodeFailures=1")>=0;return c.onAll(e,{load:function(){if(d(),u&&1===e.naturalWidth&&e.naturalHeight>6e4){var t=e.naturalHeight-6e4,n=406===t||412===t;i&&i.end({resultType:n?h.e.ExpectedFailure:h.e.Failure,resultCode:"".concat(t),error:"Encoded failure"}),l.error(new g.e({code:"".concat(t),isExpected:n,message:"Server returned encoded failure ".concat(t)}))}else i&&i.end({resultType:h.e.Success}),l.complete(a)},error:function(){d(),i&&i.end({resultType:h.e.Failure}),l.error(new Error("Image '".concat(t,"' failed to load")))}}),r=o.setTimeout(function(){l.cancel()},3e4),n&&(i=new _({name:n,loadType:m.server})),e.setAttribute("src",t),a=!!e.complete,this.trackPromise(l.getPromise())},t.prototype._waitForTimeout=function(e){var t,n=this.async,a=new s.e(function(){t&&n.clearTimeout(t)});return t=n.setTimeout(function(){a.complete()},e),a.getPromise()},t.dependencies=Object(i.__assign)(Object(i.__assign)({},o.n.dependencies),{thumbnailCache:b.e}),t}(o.n),y=Object(c.r)("ImageLoader",v),S=n(783),D=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t)||this;a._debouncer=new S.e,a._imageLoader=a.resources.consume(y);var i=a.valueAccessor(),r=i.src,o=i.image,s=i.error,c=i.isLoaded,d=i.isError,l=i.actualSize,u=i.scenarioName;a._src=a.wrapObservable(r),a._image=a.wrapObservable(o),a._error=a.wrapObservable(s),a._scenarioName=u;var f=n.outputExtenders,p=void 0===f?{deferred:!0}:f;return a.createComputed(a._computeLoadImage),a.createBackgroundComputed(function(){var e=a._image();if(c&&c(!!e),l){var t=void 0;e&&(t={width:e.width,height:e.height}),l(t)}o&&o(e)}).extend(p),a.createBackgroundComputed(function(){var e=a._error();s&&s(e),d&&d(!!e)}).extend(p),a}return Object(i.__extends)(t,e),t.prototype._computeLoadImage=function(){var e,t=this,n=this.unwrapObservable(this._src);this._image(void 0),this._scenarioName&&(e=new _({name:this._scenarioName,loadType:m.queue})),this._debouncer.debounce(this.trackPromise(this._imageLoader.loadImage({url:n,imageElement:this.element,scenarioName:this._scenarioName}))).then(function(n){t._image(n),t._error(void 0),e&&e.end({resultType:h.e.Success})},function(n){t._error(n),e&&e.end({resultType:n.isExpected?h.e.ExpectedFailure:h.e.Failure})})},t}(r.t);t.e=D},1748:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return S});var a,i=n(2017),r=n(332);!function(e){e[e.cover=0]="cover",e[e.center=1]="center",e[e.fit=2]="fit",e[e.fitExpand=3]="fitExpand",e[e.fitExpandHeight=4]="fitExpandHeight",e[e.fitExpandWidth=5]="fitExpandWidth",e[e.fitWidth=6]="fitWidth",e[e.fitHeight=7]="fitHeight",e[e.top=8]="top"}(a||(a={}));var o=function(e,t){this.name=e,this.getTransform=t};function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new o(e.map(function(e){return e.name}).join("-"),function(t,n){for(var a=i.e.IDENTITY,r=0,o=e;r<o.length;r++){var s=o[r],c={width:t.width*a.scale,height:t.height*a.scale};a=s.getTransform(c,n).multiply(a)}return a})}var c=new o(a[a.center],function(e,t){var n=new r.e((t.width-e.width)/2,(t.height-e.height)/2);return new i.e(n)}),d=new o(a[a.top],function(e,t){var n=new r.e((t.width-e.width)/2,0);return new i.e(n)}),l=new o(a[a.fitWidth],function(e,t){var n=t.width/e.width;return new i.e(r.e.ORIGIN,Math.min(n,1))}),u=new o(a[a.fitHeight],function(e,t){var n=t.height/e.height;return new i.e(r.e.ORIGIN,Math.min(n,1))}),f=new o(a[a.fit],function(e,t){return(e.width/e.height>t.width/t.height?l:u).getTransform(e,t)}),p=new o(a[a.fitExpandWidth],function(e,t){var n=t.width/e.width;return new i.e(r.e.ORIGIN,n)}),m=new o(a[a.fitExpandHeight],function(e,t){var n=t.height/e.height;return new i.e(r.e.ORIGIN,n)}),_=new o(a[a.fitExpand],function(e,t){return(e.width/e.height>t.width/t.height?p:m).getTransform(e,t)}),h=new o(a[a.cover],function(e,t){return(e.width/e.height>t.width/t.height?u:l).getTransform(e,t)}),b=s(f,c),g=s(_,c),v=s(h,c);function y(e){var t,n;if("string"==typeof e)t=a[e];else{if(function(e){return"object"==typeof e}(e))return e;t=e}switch(t){case a.top:n=d;break;case a.fitHeight:n=u;break;case a.fitWidth:n=l;break;case a.fit:n=b;break;case a.fitExpand:n=g;break;case a.center:n=c;break;default:n=v}return n}function S(e){var t;return t=e instanceof Array?e:[e],s.apply(void 0,t.map(y))}},1751:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return i}),function(e){e[e.none=0]="none",e[e.right=1]="right",e[e.flip=2]="flip",e[e.left=3]="left"}(a||(a={}));var i=a},1755:function(e,t,n){"use strict";n.d(t,"e",function(){return S});var a=n(0),i=n(55),r=n(106),o=n(63),s=n(112),c=n(62),d=n(60),l=n(1732),u=n(11),f=n(1255),p=n(13),m=n(59);function _(e,t){return e.preferences[(t||"").toLowerCase()]}function h(e){return!!(e=e&&e.toLowerCase().replace(".",""))&&!l.e[e]||"pdf"===e}function b(e,t,n,i){var r=_(e,t);if(r)for(var o=0,s=Object(a.__spreadArray)(Object(a.__spreadArray)([],r.preview,!0),r.open,!0).filter(g);o<s.length;o++){var c=s[o],d=n&&c[n]||i&&c.handler[i];if(d)return d}}function g(e){return!e.handler.isPromoted}function v(e){return e.filter(g)[0]}var y=function(e){function t(t,n){var a,i=e.call(this,t,n)||this,s=Object(u.isFeatureEnabled)(u.FileHandlersV2),l="data",_=new r.e("FileHandlers",o.e.session);if(s)try{var h=_.getValue(l);a=h&&JSON.parse(h)}catch(e){}var b=i.observables,g=i.data=b.create(a);return g.equalityComparer=f.e,a&&4===a.version&&s||(g({actions:{custom:[],create:[],open:[],preview:[]},preferences:{},version:4}),_.setValue(l,JSON.stringify(g.peek()))),s&&b.backgroundCompute(function(){i.trackPromise(m.n.resolve(i.resources.consumeAsync(c._.optional)).then(function(e){if(e)return e.getFileHandlerData({includePromotedApp:!0})}).then(function(e){return e||i.resources.consumeAsync(c.m.optional).then(function(e){if(e)return p.t.isActivated("a9c8b4cd-bc43-466c-aeeb-106eec05d057","07/07/2021","Will try to use cookie to get filehandler instead of tokens.")?e.getFileHandlerData({includePromotedApp:!0}):e.getFileHandlerData({includePromotedApp:!0,allowCookies:!0})})}).then(function(e){e&&(_.setValue(l,JSON.stringify(e)),g(e))},function(e){d.e.logError(e)}))}),i}return Object(a.__extends)(t,e),t.prototype.getFileTypeIconUrl=function(e,t){return h(e)?this.getIconUrl(b(this._getData(t),e||"","icon","fileTypeIcon")):void 0},t.prototype.getFileTypeName=function(e,t){return h(e)?b(this._getData(t),e||"",void 0,"fileTypeDisplayName"):void 0},t.prototype.getIconUrl=function(e){var t=window.devicePixelRatio||1;return e&&(e.svg||t>=1.75&&e.png2x||t>=1.25&&e.png1_5x||e.png1x)},t.prototype.getDefaultOpenHandler=function(e,t){var n=_(this._getData(t),e||"");return n&&v(n.open)},t.prototype.getDefaultPreviewHandler=function(e,t){var n=_(this._getData(t),e||"");return n&&v(n.preview)},t.prototype.isActionForExtension=function(e,t){var n=e.availableOn.file,a=n&&n.extensions;return!!n&&(!a||a.indexOf(t.toLowerCase())>=0||a.indexOf(".*")>=0)},t.prototype._getData=function(e){return e?this.data.peek():this.data()},t}(i.n),S=Object(s.r)("FileHandlerProvider",y)},1757:function(e,t,n){"use strict";var a=n(59),i=n(203),r=function(){function e(e){this.concurrency=e||1,this._running=0,this._queue=[],this._promiseComplete=this._promiseComplete.bind(this)}return e.prototype.enqueue=function(e){var t;if(this._running<this.concurrency)this._running++,(t=e()).then(this._promiseComplete,this._promiseComplete);else{var n={callback:e,signal:null,canceled:!1,result:null};n.signal=new i.e(function(){n.canceled=!0,a.n.is(n.result)&&n.result.cancel()}),this._queue.push(n),t=n.signal.getPromise()}return a.n.resolve(t)},e.prototype._promiseComplete=function(){var e=this;if(this._running--,this._running<this.concurrency&&this._queue.length){for(var t=this._queue.shift();t&&t.canceled;)t=this._queue.length?this._queue.shift():null;t&&(this._running++,t.result=t.callback(),t.result.then(function(n){t.signal.complete(n),e._promiseComplete()},function(n){t.signal.error(n),e._promiseComplete()}))}},e}();t.e=r},1758:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(55),i=n(8),r=n(1089),o=new i.t({name:"".concat("IsDetailsPaneExpanded",".isDetailsPaneExpanded"),factory:{dependencies:{detailsPaneId:r.e,observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})},1759:function(e,t,n){"use strict";function a(e,t){for(var n=t.start,a=Math.min(t.end,e.length),i=n;i<a;i++)if(!e[i])return!1;return!0}n.d(t,"e",function(){return a})},1760:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(55),i=new(n(8).t)({name:"".concat("UserStateProvider.key",".updateQuota"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},1764:function(e,t,n){"use strict";var a=n(20);Object(a.n)([{rawString:".od-LoadingSpinner{white-space:nowrap}.od-LoadingSpinner-loadingText{vertical-align:top}.od-LoadingSpinner-loadingGif{vertical-align:bottom}"}]);var i=n(0),r=n(22),o=n(175),s=n(1737),c=n(1862),d=function(e){function t(t){var n=e.call(this,t)||this;return t&&void 0!==t.loadingText?n.loadingText=t.loadingText:n.loadingText=c.e,n.addBindingHandlers({imageLoader:s.e}),n.isVisible=r.observable(!0),n.isImageLoaded=r.observable(!1),n.loadingImageUrl=window.require.toUrl("odsp-media/images/loading/loadingspinner.gif"),n}return Object(i.__extends)(t,e),t.prototype.hideSpinner=function(){this.isVisible(!1)},t}(o.t),l=n(379).e({tagName:"ms-loadingSpinner",template:'<div class="od-LoadingSpinner" data-automationid="ms-loadingSpinner"><img class="od-LoadingSpinner-loadingGif" role="presentation" data-bind="click:hideSpinner,visible:isVisible,imageLoader:{src:loadingImageUrl,isLoaded:isImageLoaded}"><span class="od-LoadingSpinner-loadingText" data-bind="text:loadingText"></span></div>',viewModel:d,synchronous:!0});t.e=l},1767:function(e,t,n){"use strict";var a=n(20);Object(a.n)([{rawString:".od-ImageFrame{display:block;position:absolute;top:0;left:0;bottom:0;right:0}"}]);var i=n(379),r=n(1829),o=Object(i.e)({tagName:"od-image-frame",template:'<span class="od-ImageFrame" data-bind="component:{name:$component.imageStackTagName,params:$component.imageStackParams}"></span>',viewModel:r.t,synchronous:!0});t.e=o},1768:function(e,t,n){"use strict";n.d(t,"n",function(){return c}),n.d(t,"e",function(){return d}),n.d(t,"t",function(){return l}),n.d(t,"a",function(){return u});var a,i=n(499),r=n(664),o=n(204),s=n(454);function c(e,t,n){var a=r.e[t]&&r.e[t].iconType||"png",i=e&&"png"===a;return"".concat(s.n).concat(n).concat(i?"_2x":"","/").concat(t,".").concat(a)}function d(e,t,n){return c(e.consume(o.e).isRetinaSupported,t,n)}function l(e,t,n){return d(e,i.n(t),n)}function u(e,t,n){return n&&n.vault&&n.vault.root?d(e,n.vault.isLocked?a.vaultClosed:a.vaultOpen,t):n&&n.folder&&"SamsungGallery"===n.specialFolderCanonicalName?d(e,"samsunggallery",t):void 0}!function(e){e.vaultOpen="vaultopen",e.vaultClosed="vaultclosed"}(a||(a={}))},1769:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(1054),i=n(112),r=function(){function e(e,t){this._itemsStore=t.itemsStore}return e.prototype.getParent=function(e){if(e){var t=this._itemsStore.getItem(e.key),n=t&&t.peek(),a=n&&(n.parentKey||n.UNSAFE_parent&&n.UNSAFE_parent.key);return a?this._itemsStore.getItem(a):void 0}},e.prototype.getFacetedAncestorOrSelf=function(e,t,n){return void 0===n&&(n=""),this.getAncestorOrSelf(e,function(e){return n?e[t]&&e[t][n]:!!e[t]})},e.prototype.getAncestorOrSelf=function(e,t){for(var n,a=e&&e.key;a;){var i=this._itemsStore.getItem(a),r=i&&i.peek();if(!r)break;if(t(r)){n=i;break}a=r&&(r.parentKey||r.UNSAFE_parent&&r.UNSAFE_parent.key)}return n},e.dependencies={itemsStore:a.e},e}(),o=Object(i.r)("ItemParentHelper",r)},1776:function(e,t,n){"use strict";var a=n(20);Object(a.n)([{rawString:".FileTypeIcon{position:relative;display:inline-block}.FileTypeIcon--clickable{cursor:pointer}.FileTypeIcon-icon{display:inline-block;vertical-align:middle;position:relative;overflow:hidden}.FileTypeIcon-icon::before{display:block}.FileTypeIcon-overlay{display:block;border:0;position:relative;left:9px;bottom:9px;height:9px;width:9px}"}])},1778:function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(8),i=(new a.t("dataStore"),new a.t("userSettingsStore")),r=new a.t("userInfoStore"),o=new a.t("smartFiltersStore")},1781:function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return n.errorType=t.errorType||0,n.payloads=t.payloads||{},n}return Object(a.__extends)(t,e),t}(n(79).e);t.e=i},1789:function(e,t,n){"use strict";var a=n(0),i=n(161),r=n(151),o=n(96),s=new r.e,c=new o.t(window),d=0,l=[],u={};function f(){for(var e in u)m(u[e])}function p(){for(;l.length;){var e=l.pop();e.isDisposed||(u[e.id]=e,m(e))}}function m(e){if(void 0!==e.element.getBoundingClientRect){var t=e.element.getBoundingClientRect(),n=t.top<window.innerHeight&&t.bottom>=0;(e.allowHiddenSizeUpdates||n)&&e.size&&e.size(e.includePosition?{bottom:t.bottom,left:t.left,right:t.right,top:t.top,height:t.height,width:t.width}:{height:t.height,width:t.width}),e.isOnScreen&&e.isOnScreen(n)}}c.onAll(window,{resize:s.debounce(f,50),scroll:s.throttle(f,50,{leading:!1})}),c.on(document,"transitionend",s.debounce(f,300),!0);var _=function(e){function t(t){var n=e.call(this,t)||this,a=n.valueAccessor(),i={id:d++,element:n.element,isDisposed:!1,size:a.size,isOnScreen:a.isOnScreen,allowHiddenSizeUpdates:a.allowHiddenSizeUpdates,includePosition:!!a.includePosition};return a.trigger&&n.createComputed(function(){a.trigger(),m(i)}),l.push(i),s.setTimeout(p,0),n.addDisposable({dispose:function(){i.isDisposed=!0,delete u[i.id]}}),n}return Object(a.__extends)(t,e),t}(i.t);t.e=_},1792:function(e,t,n){"use strict";var a=n(0),i=n(175),r=n(1768),o=n(1755),s=function(e){function t(t){var n=e.call(this,t)||this,a=t.iconFieldAriaLabel,i=void 0===a?"":a,s=t.iconName,c=t.extension,d=t.item,l=t.desiredSize||16;n.hoverText=t.hoverText,n.onClick=t.onClick;var u=n,f=u.observables,p=u.resources,m=f.create(""),_=f.create(i);if(t.iconUrl)m(t.iconUrl);else if(s){var h=t.iconSize||l,b=r.e(p,s,h);if(m(b),c){var g=p.consume(o.e.optional);g&&f.backgroundCompute(function(){m(g.getFileTypeIconUrl(c)||b),_(g.getFileTypeName(c)||i)})}var v=r.a(p,h,d);v&&m(v)}var y=t.desiredSizeRem?"rem":"px",S=t.desiredSizeRem?t.desiredSizeRem:l;return n.size="".concat(m.peek()?S:0).concat(y),n.iconUrl=m,n.iconFieldAriaLabel=_,t.overlayType?n.overlayUrl=window.require.toUrl("odsp-media/images/overlays/".concat(t.overlayType.toLowerCase())):n.overlayUrl="",n}return Object(a.__extends)(t,e),t}(i.t);t.e=s},1808:function(e,t,n){"use strict";n(1776);var a=n(1792),i=n(379),r={tagName:"ms-file-type-icon",template:'<span class="FileTypeIcon" data-bind="attr:{title:hoverText},click:onClick,css:{\'FileTypeIcon--clickable\':!!onClick}" tabindex="-1"><img class="FileTypeIcon-icon" data-bind="attr:{src:iconUrl,alt:iconFieldAriaLabel},style:{width:size,height:size,\'font-size\':size}">\x3c!--ko if:overlayUrl--\x3e<img class="FileTypeIcon-overlay" data-bind="attr:{src:overlayUrl}">\x3c!--/ko--\x3e</span>',viewModel:a.e,synchronous:!0};i.e(r),t.e=r},1812:function(e,t,n){"use strict";var a=n(1076);n.d(t,"e",function(){return a.e}),n.d(t,"t",function(){return a.t}),n.d(t,"n",function(){return a.n})},1813:function(e,t,n){"use strict";var a=n(59),i=n(203),r=[],o=function(){function e(e,t,n){this.complete=!1,this.pending=!1,this.eventName="cookieToss",this._lastAttempt=0,this.domainRegex=e,this.iframeSrc=t,this.complete=n}return e.initializeAuthenticators=function(t,n){if(n)if(window.$Config.aadClientId&&"live.com"===window.$Config.domain);else{for(var a=n.s,i=n.r,o=0;a&&o<a.length;o++)r.push(new e(t[o],a[o],!i[o]));n.c=function(e){r[e].onAuthComplete()},e.authenticate("https://livefilestore.com/"),e.authenticate("https://1drv.com/")}},e.authenticate=function(e){for(var t,n=0;n<r.length;n++){var i=r[n];if(i.requiresAuth(e)){t=i.authenticate(e);break}}for(var o=[t||a.n.wrap(!0)],s=0,c=this._cookieCheckers;s<c.length;s++){var d=c[s];d.isApplicable(e)&&o.push(d.check(e))}return a.n.all(o).then(function(e){return e.reduce(function(e,t){return e&&t})})},e.registerCookieChecker=function(e){this._cookieCheckers.push(e)},e.prototype.requiresAuth=function(e){return this.domainRegex.test(e)},e.prototype.authenticate=function(e){var t=(new Date).getTime();if(t-this._lastAttempt>6e5&&(this._authPromise=null,this._lastAttempt=t),!this._authPromise){this._authPromise=new i.e;var n=document.createElement("IFRAME");n.src=this.iframeSrc,n.style.display="none",document.body.appendChild(n)}return this._authPromise.getPromise()},e.prototype.onAuthComplete=function(){this._authPromise.complete(!0)},e._cookieCheckers=[],e}();t.e=o},1829:function(e,t,n){"use strict";n.d(t,"e",function(){return v});var a=n(0),i=n(175),r=n(1751),o=n(42),s=n(1731),c=n(1748),d=n(1255);function l(e,t){return e===t||!e&&!t||!(!e||!t)&&e.url===t.url}var u=n(20);Object(u.n)([{rawString:".od-ImageStack{display:block;position:absolute;top:0;left:0;bottom:0;right:0;overflow:hidden}.od-ImageStack-tile{display:block;position:absolute;top:0;left:0;bottom:0;right:0;opacity:0}.od-ImageStack-tile--isLoaded{opacity:1}.od-ImageStack--fade .od-ImageStack-tile--isLoaded{transition:opacity 217ms linear 50ms}"}]);var f=n(379),p=(n(780),n(55)),m=n(1857),_=function(e){function t(t){var n=e.call(this,t)||this,a=t.hasAnimated,i=t.fadeIn,r=t.image,o=t.referenceImage,s=t.referenceRotation;return n._fadeIn=i,n._image=r,n._referenceImage=o,n._referenceRotation=s,n.isLoaded=n.createObservable(!1),n._hasAnimated=n._getHasAnimated(),n.rotation=n.createPureComputed(n._computeRotation),n.createBackgroundComputed(function(){return a(n._hasAnimated())}),n}return Object(a.__extends)(t,e),t.prototype._getHasAnimated=function(){var e=this,t=this.createObservable(!1);return this.createPureComputed(function(){var n;return e.isLoaded.peek()?(n=t())||e.async.setTimeout(function(){return t(!0)},e._fadeIn.peek()?2e3:50):(e.isLoaded(),n=!1),n})},t.prototype._computeRotation=function(){var e=this.rotation.peek();return(l(this._image,this._referenceImage())||void 0===e)&&(e=this._referenceRotation()),e},t}(p.n),h=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.imageTileTagName=m.e.tagName;var i=t.image,r=t.rotation,o=t.desiredSize,s=t.scale,c=void 0===s?1:s,u=t.fadeIn,f=void 0===u||u,p=t.allowLoading,h=void 0===p||p,b=t.isLoaded,g=t.isCurrent,v=t.alignment,y=t.position,S=t.loadedImage,D=t.error,I=t.loadImageScenarioName,x=n.outputExtenders,C=void 0===x?{deferred:!0}:x,O=n.AnimationTracker,w=void 0===O?_:O;return a._animationTrackerType=w,a._image=a.wrapObservable(i),a._rotation=a.wrapObservable(r),a._desiredSize=o,a._scale=c,a.fadeIn=a.wrapObservable(f),a._allowLoading=a.wrapObservable(h),a._alignment=v,a._scenarioName=I,a._tileDefinitions=a.createPureComputed(a._computeTileDefinitions),a._position=a.createPureComputed(a._computePosition),a._position.equalityComparer=d.e,a._loadedImage=a.createPureComputed(a._computeLoadedImage),a._loadedImage.equalityComparer=l,a._error=a.createPureComputed(a._computeError),a._error.equalityComparer=d.e,a.tiles=a._getTiles(),y&&a.createBackgroundComputed(function(){return y(a._position())}).extend(C),S&&a.createBackgroundComputed(function(){return S(a._loadedImage())}).extend(C),b&&a.createBackgroundComputed(function(){return b(!!a._loadedImage())}).extend(C),g&&a.createBackgroundComputed(function(){return g(l(a._loadedImage(),a._image()))}).extend(C),D&&a.createBackgroundComputed(function(){return D(a._error())}).extend(C),a}return Object(a.__extends)(t,e),t.prototype._computeError=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var a=t[n],i=a.isLoaded,r=a.error;if(i())break;if(r()){e=r();break}}return e},t.prototype._computePosition=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var a=t[n],i=a.isLoaded,r=a.position;if(i()){e=r();break}}return e},t.prototype._computeLoadedImage=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var a=t[n],i=a.isLoaded,r=a.image;if(i()){e=this.unwrapObservable(r);break}}return e},t.prototype._computeTileDefinitions=function(){var e=this._image(),t=this._tileDefinitions.peek(),n=void 0===t?[]:t;if(e){if(this._allowLoading()){var i=void 0,r=void 0,o=void 0,s=n[n.length-1];s?(i=l(s.image,e),r=s.hasAnimated.peek(),o=!!s.error.peek()):(i=!1,r=!1),i?r?n=[s]:s.hasAnimated():((!s||r||o)&&(s={image:e,error:this.createObservable(),hasAnimated:this.createObservable(!1)},n=Object(a.__spreadArray)(Object(a.__spreadArray)([],n,!0),[s],!1)),s.hasAnimated(),s.error())}}else n=[];return n},t.prototype._getTiles=function(){var e=this,t=this.observables.createArray(),n=this.addDisposable(t.map({mappingWithDisposeCallback:function(t){var n=t.image,a=t.error,i=t.hasAnimated,r=new(e.managed(e._animationTrackerType))({hasAnimated:i,image:n,referenceRotation:e._rotation,referenceImage:e._image,fadeIn:e.fadeIn});return{mappedValue:{image:n,rotation:r.rotation,isLoaded:r.isLoaded,error:a,scale:e._scale,desiredSize:e._desiredSize,alignment:e._alignment,position:e.createObservable(),loadImageScenarioName:e._scenarioName},dispose:function(){r.dispose()}}}}));return this.createBackgroundComputed(function(){t.splice.apply(t,Object(a.__spreadArray)([0,t.peek().length],e._tileDefinitions(),!1))}),n},t}(i.t),b=Object(f.e)({tagName:"od-image-stack",template:'<span class="od-ImageStack" data-bind="css:{\'od-ImageStack--fade\':fadeIn},template:{foreach:tiles}"><span class="od-ImageStack-tile" data-bind="css:{\'od-ImageStack-tile--isLoaded\':$data.isLoaded},component:{name:$component.imageTileTagName,params:$data}"></span></span>',viewModel:h,synchronous:!0}),g=n(13),v=300,y=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.imageStackTagName=b.tagName;var i=t.image,o=t.rotation,u=void 0===o?r.e.none:o,f=t.alignment,p=t.desiredSize,m=t.isLoaded,_=t.isCurrent,h=t.error,v=t.coverage,y=void 0===v?{minimum:1,maximum:1}:v,S=t.scale,D=t.fadeIn,I=t.allowLoading,x=t.position,C=t.loadImageScenarioName,O=n.thumbnailCache,w=void 0===O?a.resources.consume(s.e):O,E=n.outputExtenders,A=void 0===E?{deferred:!0}:E;return a._thumbnailCache=w,a._image=a.wrapObservable(i),a._rotation=a.wrapObservable(u),a._alignment=c.t(f),a._desiredSize=a.wrapObservable(p),a._isLoaded=m,a._coverage=a.wrapObservable(y),a._loadedImage=a.createObservable(),a._blobImage=a.createObservable(),a._isNoCacheTriggered=!1,a._effectiveDesiredSize=a.createPureComputed(a._computeEffectiveDesiredSize),a._effectiveDesiredSize.equalityComparer=d.e,a._idealSize=a.createPureComputed(a._computeIdealSize),a._idealSize.equalityComparer=d.e,a._idealImage=a.createPureComputed(a._computeIdealImage),a._idealImage.equalityComparer=l,a._fallbackImage=a.createPureComputed(a._computeFallbackImage),a._fallbackImage.equalityComparer=l,a._cachedImage=a.createPureComputed(a._computeCachedImage),a._cachedImage.equalityComparer=l,a._currentImage=a.createPureComputed(a._computeCurrentImage),a._currentImage.equalityComparer=l,a._isCurrent=a.createPureComputed(a._computeIsCurrent),a.imageStackParams={image:a._currentImage,rotation:a._rotation,desiredSize:a._desiredSize,loadedImage:a._loadedImage,isLoaded:a._isLoaded,error:h,scale:S,alignment:a._alignment,fadeIn:D,allowLoading:I,position:x,loadImageScenarioName:C},_&&a.createBackgroundComputed(function(){return _(a._isCurrent())}).extend(A),g.t.isActivated("f4bfd21f-f2f1-4d89-94f9-242765ec8a9a","07/16/2021","one up thumbnail link not secure (pre auth)")||a.addDisposable({dispose:function(){a._blobImage.peek()&&a._blobImage.peek().url&&URL.revokeObjectURL(a._blobImage.peek().url)}}),a}return Object(a.__extends)(t,e),t.prototype._computeIsCurrent=function(){return l(this._loadedImage(),this._idealImage())},t.prototype._computeCurrentImage=function(){var e=this._loadedImage(),t=this._idealImage(),n=this._cachedImage(),a=this._fallbackImage();return e?l(e,t)?this._currentImage.peek():t:n||a||t},t.prototype._computeEffectiveDesiredSize=function(){var e,t=this._desiredSize(),n=window.devicePixelRatio||1;return t&&(e={width:t.width*n,height:t.height*n}),e},t.prototype._computeIdealSize=function(){var e,t=this._image();if(t){var n=t.width,a=t.height,i=this._effectiveDesiredSize();if(i&&i.width&&i.height){if(n&&a){var r=this._alignment.getTransform(t,i);e={width:r.scale*t.width,height:r.scale*t.height}}}else e={width:n,height:a}}return e},t.prototype._computeIdealImage=function(){var e,t=this._image(),n=this._idealSize();return!g.t.isActivated("f4bfd21f-f2f1-4d89-94f9-242765ec8a9a","07/16/2021","one up thumbnail link not secure (pre auth)")&&this._blobImage()?this._blobImage.peek():(t&&(n?(e=this._getDerivedImage(t,n))!==this._idealImage.peek()&&this._thumbnailCache.register(t,e,n,!1):e=t.getAligned?t.getAligned(this._effectiveDesiredSize(),this._alignment):t,g.t.isActivated("f4bfd21f-f2f1-4d89-94f9-242765ec8a9a","07/16/2021","one up thumbnail link not secure (pre auth)")||this._convertImageUrlToBlobUrlViaXhttp(e)),e)},t.prototype._convertImageUrlToBlobUrlViaXhttp=function(e){var t=this;if(e&&e.url&&-1!==e.url.indexOf("access_token")){var n=new XMLHttpRequest;n.onload=function(){if(n.status>=200&&n.status<300&&n.response){var i=URL.createObjectURL(n.response);t._blobImage(Object(a.__assign)(Object(a.__assign)({},e),{url:i})),t._isNoCacheTriggered=!1}},n.onerror=function(){t._isNoCacheTriggered||(t._isNoCacheTriggered=!0,t._convertImageUrlToBlobUrlViaXhttp(e))},n.open("GET",e.url,!0),n.responseType="blob",this._isNoCacheTriggered&&(n.setRequestHeader("cache-control","no-cache"),n.setRequestHeader("pragma","no-cache")),n.send()}},t.prototype._computeFallbackImage=function(){var e,t=this._image(),n=this._idealSize();if(n&&t&&t.width){var a=(this._coverage()||{}).fallback,i=void 0===a?0:a;if(i){var r={width:n.width*i,height:n.height*i};(e=this._getDerivedImage(t,r))!==this._fallbackImage.peek()&&this._thumbnailCache.register(t,e,r,!1)}}return e},t.prototype._computeCachedImage=function(){var e,t=this._image(),n=this._idealSize();if(n&&t&&t.width){var a=this._thumbnailCache.getCoveragePercent(t,n),i=this._coverage()||{},r=i.minimum,o=void 0===r?1:r,s=i.maximum,c=o*a,d=(void 0===s?1:s)*a;e=this._thumbnailCache.retrieve(t,d,c)}return e},t.prototype._getDerivedImage=function(e,t){return{url:e.getAligned?e.getAligned(t,this._alignment).url:o.format(e.url,Math.ceil(t.width),Math.ceil(t.height)),width:e.width,height:e.height}},t}(i.t);t.t=y},1843:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(1812),i=new a.e("Item",a.t.subject)},1851:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(55),i=new(n(8).t)({name:"".concat("UseItemCacheData.key",".useItemCacheData"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},1852:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(55),i=new(n(8).t)({name:"".concat("UseItemsScope.key",".useItemsScope"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},1857:function(e,t,n){"use strict";var a=n(20);Object(a.n)([{rawString:".od-ImageTile{display:block;position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden}.od-ImageTile img{display:block}.od-ImageTile--cover .od-ImageTile-background{top:0;left:0;bottom:0;right:0;width:100%;height:100%;margin:auto;background-size:cover;background-repeat:no-repeat;background-position:center}.od-ImageTile--fit .od-ImageTile-background{top:0;left:0;bottom:0;right:0;width:100%;height:100%;margin:auto;background-size:contain;background-repeat:no-repeat;background-position:center}.od-ImageTile-image{display:block;opacity:0;position:absolute;box-sizing:border-box}.od-ImageTile-image,a .od-ImageTile-image{border:none}.od-ImageTile-background{display:block;opacity:0;position:absolute;box-sizing:border-box}.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isAligned .od-ImageTile-background{opacity:1}@media screen and (-ms-high-contrast:active){.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isAligned .od-ImageTile-background{opacity:0}}.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isCustom .od-ImageTile-image{opacity:1}@media screen and (-ms-high-contrast:active){.od-ImageTile--isLoaded.od-ImageTile--isDimensioned .od-ImageTile-image{opacity:1}}.od-ImageTile--isRotating .od-ImageTile-image{transition:transform 167ms cubic-bezier(.1,.25,.75,.9)}"}]);var i=n(379),r=n(0),o=n(175),s=n(1751),c=n(1737),d=n(161),l=n(55),u=n(203),f=n(112),p=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=a._images=[];return a.async.setInterval(function(){i.length>300&&i.splice(300,1/0)},6e4),a}return Object(r.__extends)(t,e),t.prototype.checkOutImage=function(){return this._images.shift()||document.createElement("img")},t.prototype.checkInImage=function(e){var t=this,n=new u.e,a=this.async;return a.setTimeout(function(){e.setAttribute("src","data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="),e.removeAttribute("style"),e.removeAttribute("class"),a.setTimeout(function(){e.removeAttribute("src"),t._images.push(e),n.complete()},1e3)},0),n.getPromise()},t}(l.n),m=Object(f.r)("ImageRecycler",p),_=n(22),h=function(e){function t(t){var n=e.call(this,t)||this,a=n.resources.consume(m),i=n.valueAccessor(),o=a.checkOutImage(),s=n.bindingContext,d=i.attr,l=void 0===d?{}:d,u=i.style,f=i.css,p=i.class;return _.applyBindingsToNode(o,{attr:Object(r.__assign)({alt:""},l)},s),u&&_.applyBindingsToNode(o,{style:u},s),f&&_.applyBindingsToNode(o,{css:f},s),p&&_.applyBindingsToNode(o,{class:p},s),new(n.managed(c.e))({element:o,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return i.imageLoader},bindingContext:s}),_.virtualElements.setDomNodeChildren(n.element,[o]),n.addDisposable({dispose:function(){o&&(_.cleanNode(o),a.checkInImage(o).done())}}),n.controlsDescendantBindings=!0,n}return Object(r.__extends)(t,e),t.supportsVirtualElements=!0,t}(d.t),b=n(42),g=n(2017),v=n(666),y=n(1748),S=n(1731),D=n(1255),I=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.addBindingHandlers({imageLoader:c.e,imageRecycler:h});var i=t.image,r=t.rotation,o=void 0===r?s.e.none:r,d=t.desiredSize,l=t.scale,u=void 0===l?1:l,f=t.isLoaded,p=void 0===f?a.createObservable(!1):f,m=t.position,_=t.loadedImage,b=t.error,g=t.loadImageScenarioName,v=n.thumbnailCache,I=void 0===v?a.resources.consume(S.e):v,x=n.outputExtenders,C=void 0===x?{deferred:!0}:x;return a._image=a.wrapObservable(i),a._rotation=a.wrapObservable(o),a._scale=a.wrapObservable(u),a._desiredSize=a.wrapObservable(d),a._alignment=y.t(t.alignment),a._thumbnailCache=I,a._loadedImage=a.wrapObservable(_),a._error=a.wrapObservable(b),a.isRotating=a._getIsRotating(),a.alignmentName=a.createPureComputed(a._computeAlignmentName),a.actualSize=a.createPureComputed(a._computeActualSize),a.actualSize.equalityComparer=D.e,a.isLoaded=a.createPureComputed(a._computeIsLoaded),a._imageUrl=a.createPureComputed(a._computeImageUrl),a._finalSize=a.createPureComputed(a._computeFinalSize),a._finalSize.equalityComparer=D.e,a._position=a.createPureComputed(a._computePosition),a._position.equalityComparer=D.e,a.imageElementStyle=a.createPureComputed(a._computeImageElementStyle),a.imageElementStyle.equalityComparer=D.e,a.imageBackgroundStyle=a.createPureComputed(a._computeImageBackgroundStyle),a.imageBackgroundStyle.equalityComparer=D.e,a.createBackgroundComputed(a._computeRecordImage),a.imageLoaderParams={src:a._imageUrl,image:a._loadedImage,error:a._error,scenarioName:g},m&&a.createBackgroundComputed(function(){return m(a._position())}).extend(C),p&&a.createBackgroundComputed(function(){return p(a.isLoaded())}).extend(C),a}return Object(r.__extends)(t,e),t.prototype._computeImageUrl=function(){var e=this._image();return e&&e.url&&b.format(e.url,e.width,e.height)||""},t.prototype._computeFinalSize=function(){var e,t=this._image(),n=this._scale();if(t&&!t.width){var a=this.actualSize(),i=window.devicePixelRatio||1;e=a&&{width:a.width*n/i,height:a.height*n/i}}else e=t&&{width:t.width*n,height:t.height*n};return e},t.prototype._computeImageElementStyle=function(){var e,t=this._desiredSize(),n=this._finalSize(),a=this._rotation();if(n){var i;i=t&&t.width&&t.height?t:n;var r=this._alignment.getTransform(n,i),o=r.translate.x/i.width,s=r.translate.y/i.height,c=r.scale*n.width/i.width,d=void 0;if(a){var l=void 0;if(a%2==1){var u={width:n.height,height:n.width};l=this._alignment.getTransform(u,i).multiply(r.invert())}else l=g.e.IDENTITY;d="rotate(".concat(90*a,"deg) scale(").concat(l.scale.toFixed(6),")")}else d="";e={left:"".concat((100*o).toFixed(2),"%"),top:"".concat((100*s).toFixed(2),"%"),width:"".concat((100*c).toFixed(2),"%"),"-webkit-transform":d,"-ms-transform":d,transform:d}}else e={left:"",top:"",width:"","-webkit-transform":"","-ms-transform":"",transform:""};return e},t.prototype._computeImageBackgroundStyle=function(){var e=this._finalSize(),t=this._imageUrl();return{"max-width":e?"".concat(e.width.toFixed(2),"px"):"","max-height":e?"".concat(e.height.toFixed(2),"px"):"","background-image":'url("'.concat(t,'")')}},t.prototype._getIsRotating=function(){var e,t=this,n=this.createObservable(this._rotation.peek()),a=this.createPureComputed(function(){var a=t._rotation();return e&&t.async.clearTimeout(e),e=t.async.setTimeout(function(){return n(a)},300),n()});return this.createPureComputed(function(){return t._rotation()!==a()})},t.prototype._computeRecordImage=function(){var e=this._image();e&&this.isLoaded()&&this._thumbnailCache.record(e)},t.prototype._computeIsLoaded=function(){return!!this._loadedImage()},t.prototype._computeActualSize=function(){var e,t=this._loadedImage();return t&&(e={width:t.width,height:t.height}),e},t.prototype._computePosition=function(){var e,t=this._desiredSize(),n=this._finalSize(),a=this._rotation();if(n){var i,r;i=t&&t.width&&t.height?t:n,r=a%2==1?{width:n.height,height:n.width}:n;var o=this._alignment.getTransform(r,i),s=o.translate.x,c=o.translate.y,d=o.scale*r.width,l=o.scale*r.height;e=new v.e(s,c,d,l)}return e},t.prototype._computeAlignmentName=function(){var e;if(!this._rotation())switch(this._alignment.name){case"cover-center":e="cover";break;case"fit-center":e="fit"}return e},t}(o.t),x=Object(i.e)({tagName:"od-image-tile",template:"<span class=\"od-ImageTile\" data-bind=\"css:{'od-ImageTile--isLoaded':isLoaded,'od-ImageTile--isDimensioned':!!actualSize(),'od-ImageTile--isRotating':isRotating,'od-ImageTile--isAligned':!!alignmentName(),'od-ImageTile--isCustom':!alignmentName()},class:alignmentName()?'od-ImageTile--'+alignmentName():''\"><span class=\"od-ImageTile-background\" data-bind=\"style:imageBackgroundStyle\"></span>\x3c!--ko imageRecycler:{imageLoader:imageLoaderParams,class:'od-ImageTile-image',style:imageElementStyle}--\x3e\x3c!--/ko--\x3e</span>",viewModel:I,synchronous:!0});t.e=x},1872:function(e,t,n){"use strict";var a=n(0),i=n(55),r=n(424),o=n(25),s=n(498),c=n(276),d=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.responsiveUI=n.resources.consume(s.t),n.commands=n.observables.createArray(),t.disableOverflowHost||(n.overflowHostCommand=new(n.managed(r.e))({text:o.OverflowCommandLabel,tooltip:o.OverflowCommandTooltip,accessibleLabel:o.OverflowCommandTooltip,renderLabel:0,requiredChildren:1,hidesMenuChevron:!0,collapseSingleChildCommands:!1,icon:new c.e("More"),hasIconOnly:!0,children:n.observables.createArray(),location:3})),n}return Object(a.__extends)(t,e),t}(i.n);t.e=d},1879:function(e,t,n){"use strict";var a=n(20);Object(a.n)([{rawString:".od-IconGlyph.ms-Icon{display:none;font-size:16px;text-align:center;white-space:nowrap;position:relative}.od-IconGlyph.ms-Icon.od-IconGlyph--visible{display:inline-block}.od-IconGlyph.ms-Icon.ms-Icon--Add{font-size:15px}.od-IconGlyph-badge.ms-Icon{display:none;position:absolute;top:-.2em;font-size:.7em;width:1em;height:1em;text-align:center;white-space:nowrap}[dir=ltr] .od-IconGlyph-badge.ms-Icon{right:-.2em}[dir=rtl] .od-IconGlyph-badge.ms-Icon{left:-.2em}.od-IconGlyph-badge.ms-Icon.ms-Icon--StatusErrorFull{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-radius:50%;margin-top:0;font-size:12px}.od-IconGlyph-badge.ms-Icon.ms-Icon--StatusErrorFull:before{position:relative;top:-2px}.od-IconGlyph.ms-Icon.od-IconGlyph--badged .od-IconGlyph-badge.ms-Icon{display:inline-block}"}]);var i=n(0),r=n(175),o=n(22),s=function(e){function t(t){var n=e.call(this,t)||this;return n.icon=o.isObservable(t.icon)?t.icon:o.observable(t.icon),n.badge=o.isObservable(t.badge)?t.badge:o.observable(t.badge),n.iconClasses=n.createComputed(function(){return n.icon()&&n.icon().getClass()||""}),n.badgeClasses=n.createComputed(function(){return n.badge()&&n.badge().getClass()||""}),n}return Object(i.__extends)(t,e),t}(r.t),c=n(379).e({tagName:"od-icon-glyph",template:"<i class=\"od-IconGlyph\" data-bind=\"class:iconClasses,attr:{'data-icon-name':icon},css:{'od-IconGlyph--badged':badge,'od-IconGlyph--visible':icon},with:badge\"><i class=\"od-IconGlyph-badge\" data-bind=\"class:$component.badgeClasses,attr:{'data-icon-name':$component.badge}\"></i></i>",viewModel:s,synchronous:!0});t.e=c},1883:function(e,t,n){"use strict";var a=n(20);Object(a.n)([{rawString:".od-PanelHost{display:none}.SPPageChrome .od-Panel{top:0}.od-Panel{outline:1px solid transparent;position:absolute;top:48px;bottom:0;width:100%;max-width:100%;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;transition:width .3s ease-out;box-shadow:-30px 0 30px -30px "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";box-shadow:0 25.6px 57.6px 0 rgba(0,0,0,.22),0 4.8px 14.4px 0 rgba(0,0,0,.18)}[dir=ltr] .od-Panel{right:0}[dir=rtl] .od-Panel{left:0}.od-Panel.od-Panel--reactSuiteNav{top:48px}html[dir=rtl] .od-Panel{box-shadow:30px 0 30px -30px "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:"}.od-BasePage--noSuiteNav .od-Panel{top:0}.od-Panel.od-Panel--sm{width:100%}.lg .od-Panel.od-Panel--sm,.md .od-Panel.od-Panel--sm,.xlg .od-Panel.od-Panel--sm,.xxlg .od-Panel.od-Panel--sm,.xxxlg .od-Panel.od-Panel--sm,.xxxxlg .od-Panel.od-Panel--sm{width:340px}.lg .od-Panel.od-Panel--lg,.lg .od-Panel.od-Panel--xlg,.xlg .od-Panel.od-Panel--lg,.xlg .od-Panel.od-Panel--xlg,.xxlg .od-Panel.od-Panel--lg,.xxlg .od-Panel.od-Panel--xlg,.xxxlg .od-Panel.od-Panel--lg,.xxxlg .od-Panel.od-Panel--xlg,.xxxxlg .od-Panel.od-Panel--lg,.xxxxlg .od-Panel.od-Panel--xlg{width:auto}[dir=ltr] .lg .od-Panel.od-Panel--lg,[dir=ltr] .lg .od-Panel.od-Panel--xlg,[dir=ltr] .xlg .od-Panel.od-Panel--lg,[dir=ltr] .xlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--xlg{left:48px}[dir=rtl] .lg .od-Panel.od-Panel--lg,[dir=rtl] .lg .od-Panel.od-Panel--xlg,[dir=rtl] .xlg .od-Panel.od-Panel--lg,[dir=rtl] .xlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--xlg{right:48px}.lg .od-Panel.od-Panel--md,.xlg .od-Panel.od-Panel--md,.xxlg .od-Panel.od-Panel--md,.xxxlg .od-Panel.od-Panel--md,.xxxxlg .od-Panel.od-Panel--md{width:643px}[dir=ltr] .lg .od-Panel.od-Panel--md,[dir=ltr] .xlg .od-Panel.od-Panel--md,[dir=ltr] .xxlg .od-Panel.od-Panel--md,[dir=ltr] .xxxlg .od-Panel.od-Panel--md,[dir=ltr] .xxxxlg .od-Panel.od-Panel--md{left:auto}[dir=rtl] .lg .od-Panel.od-Panel--md,[dir=rtl] .xlg .od-Panel.od-Panel--md,[dir=rtl] .xxlg .od-Panel.od-Panel--md,[dir=rtl] .xxxlg .od-Panel.od-Panel--md,[dir=rtl] .xxxxlg .od-Panel.od-Panel--md{right:auto}.lg .od-Panel.od-panel-md-listform,.xlg .od-Panel.od-panel-md-listform,.xxlg .od-Panel.od-panel-md-listform,.xxxlg .od-Panel.od-panel-md-listform,.xxxxlg .od-Panel.od-panel-md-listform{width:800px}[dir=ltr] .lg .od-Panel.od-panel-md-listform,[dir=ltr] .xlg .od-Panel.od-panel-md-listform,[dir=ltr] .xxlg .od-Panel.od-panel-md-listform,[dir=ltr] .xxxlg .od-Panel.od-panel-md-listform,[dir=ltr] .xxxxlg .od-Panel.od-panel-md-listform{left:auto}[dir=rtl] .lg .od-Panel.od-panel-md-listform,[dir=rtl] .xlg .od-Panel.od-panel-md-listform,[dir=rtl] .xxlg .od-Panel.od-panel-md-listform,[dir=rtl] .xxxlg .od-Panel.od-panel-md-listform,[dir=rtl] .xxxxlg .od-Panel.od-panel-md-listform{right:auto}[dir=ltr] .xxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg{left:428px}[dir=rtl] .xxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg{right:428px}[dir=ltr] .xxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg{left:980px}[dir=rtl] .xxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg{right:980px}[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg{left:1620px}[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg{right:1620px}[dir=ltr] .xxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--xlg{left:176px}[dir=rtl] .xxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--xlg{right:176px}.lg .od-Panel.od-Panel--fullScreen,.md .od-Panel.od-Panel--fullScreen,.xlg .od-Panel.od-Panel--fullScreen,.xxlg .od-Panel.od-Panel--fullScreen,.xxxlg .od-Panel.od-Panel--fullScreen,.xxxxlg .od-Panel.od-Panel--fullScreen{width:100%}.sm .od-Panel.od-Panel--lightDismiss{width:272px}.od-Panel--FullPagePanel{top:0;width:100%;height:100%}.od-Panel--hasPadding{padding:74px 16px 20px}.lg .od-Panel--hasPadding,.xlg .od-Panel--hasPadding,.xxlg .od-Panel--hasPadding,.xxxlg .od-Panel--hasPadding,.xxxxlg .od-Panel--hasPadding{padding:74px 24px 20px}.xlg .od-Panel--hasPadding,.xxlg .od-Panel--hasPadding,.xxxlg .od-Panel--hasPadding,.xxxxlg .od-Panel--hasPadding{padding-top:74px}.xxlg .od-Panel--hasPadding,.xxxlg .od-Panel--hasPadding,.xxxxlg .od-Panel--hasPadding{padding:74px 24px 20px}.od-Panel--autoScroll{overflow:auto}.od-Panel--hiddenScroll{overflow:hidden}.od-Panel--alwaysScroll{overflow-y:scroll}.od-Panel-title{margin-bottom:19px;font-size:"},{theme:"xLargeFontSize",defaultValue:"20px"},{rawString:";font-weight:"},{theme:"xLargeFontWeight",defaultValue:"600"},{rawString:";max-width:240px}html[dir=ltr] .od-Panel-title{margin-right:26px}html[dir=rtl] .od-Panel-title{margin-left:26px}.lg .od-Panel-title,.md .od-Panel-title,.sm .od-Panel-title{line-height:normal}.od-Panel--hidden{visibility:hidden}.od-Panel-content--titleFill{width:100%;height:calc(100% - 48px - 8px)}.od-Panel-content--noTitleFill{width:100%;height:100%}.od-Panel-button--close{position:absolute;outline:0;margin:0;border:0;background:0 0;cursor:pointer;height:32px;width:32px;line-height:32px;padding:0;top:16px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:"}[dir=ltr] .od-Panel-button--close{right:16px}[dir=rtl] .od-Panel-button--close{left:16px}.od-Panel-button--close:hover{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.isFluentVNext .od-Panel-button--close:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Panel-button--close:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-Panel-button--close .ms-Icon--Cancel{font-size:16px;margin-top:0;color:inherit}.md .od-Panel-button--close .ms-Icon--Cancel,.sm .od-Panel-button--close .ms-Icon--Cancel{font-size:16px}.od-Panel--hasCommandBar .od-Panel-button--close{z-index:600;padding:0;top:6px}[dir=ltr] .od-Panel--hasCommandBar .od-Panel-button--close{right:8px}[dir=rtl] .od-Panel--hasCommandBar .od-Panel-button--close{left:8px}[dir=ltr] .od-Panel--stickyCloseButton .od-Panel-button--close{right:20px}[dir=rtl] .od-Panel--stickyCloseButton .od-Panel-button--close{left:20px}[dir=ltr] .md .od-Panel-button--close,[dir=ltr] .sm .od-Panel-button--close{right:20px}[dir=rtl] .md .od-Panel-button--close,[dir=rtl] .sm .od-Panel-button--close{left:20px}[dir=ltr] .sm .od-Panel-button--close{right:12px}[dir=rtl] .sm .od-Panel-button--close{left:12px}.od-Panel-button--close:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Panel--stickyCloseButton .od-Panel-content{position:absolute;top:0;bottom:0;left:0;right:0;overflow:auto}[dir=ltr] .od-Panel--stickyCloseButton .od-Panel-content{padding-right:40px}[dir=rtl] .od-Panel--stickyCloseButton .od-Panel-content{padding-left:40px}.od-OverlayHost-overlay .od-Panel{opacity:0}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{opacity:1}[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{animation-name:ms-fadeIn,ms-slideLeftIn40;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{animation:none}}[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{animation-name:ms-fadeIn,ms-slideRightIn40;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{animation:none}}[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Panel{animation-name:ms-fadeOut,ms-slideRightOut40;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Panel{animation:none}}[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Panel{animation-name:ms-fadeOut,ms-slideLeftOut40;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Panel{animation:none}}.od-PanelOverlay.ms-ModalOverlay{top:48px}.od-BasePage--noSuiteNav .od-PanelOverlay.ms-ModalOverlay{top:0}.SPPageChrome .od-PanelOverlay.ms-ModalOverlay{top:0}[dir=ltr] .od--hasFlexPane .od-Panel{right:320px}[dir=rtl] .od--hasFlexPane .od-Panel{left:320px}"}])},1885:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"n",function(){return o});var a=n(8),i=(new a.t("idle"),new a.t("beforeUnload"),new a.t("syncActiveXClient"),new a.t("attributionHelper"),new a.t("educationAndUpsells"),new a.t("fileHandlerHelper")),r=new a.t("clientSideExtensionHelper"),o=new a.t("needsAttentionViewHelper");new a.t("shyConductor")},1886:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(0),i=n(55),r=n(112),o=n(59),s=n(22),c=function(){function e(e){var t=this,n=e.noTitle,a=void 0!==n&&n,i=e.title,r=void 0===i?s.observable(""):i,c=e.elementDescribedBy,d=void 0===c?"":c,l=e.hasCommandBar,u=void 0!==l&&l,f=e.size,p=void 0===f?"Small":f,m=e.scrollMode,_=void 0===m?"auto":m,h=e.showCloseButton,b=void 0===h||h,g=e.includePadding,v=void 0===g||g,y=e.preserveLightDismiss,S=void 0!==y&&y,D=e.stickyCloseButton,I=void 0!==D&&D,x=e.component,C=void 0===x?null:x,O=e.maximizePanelContent,w=void 0!==O&&O,E=e.panelContentSize,A=void 0===E?s.observable({width:0,height:0}):E,L=e.isBlocking,k=e.disableEscape,M=void 0!==k&&k,P=e.overridePanelStyle;this.size=p,this.title=s.isObservable(r)?r:s.observable(r),this.elementDescribedBy=d,this.maximizePanelContent=w,this.panelContentSize=A,this.noTitle=a,this.hasCommandBar=u,this.component=C,this.scrollMode=_,this.showCloseButton=b,this.includePadding=v,this.preserveLightDismiss=S,this.stickyCloseButton=I,this.isBlocking=L,this.disableEscape=M,this.overridePanelStyle=P,this.state=s.observable(0),this._promise=new o.n(function(e){var n=s.computed(function(){1===t.state()&&(e(!0),n.dispose())},t)})}return e.prototype.wait=function(){return this._promise},e}(),d=n(785),l=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.currentPanels=a.observables.createArray(),a._needsOverlayContent=n.needsOverlayContent,a}return Object(a.__extends)(t,e),t.prototype.requestPanel=function(e){this._needsOverlayContent.needsOverlayContent.set(!0);var t=new c(e),n=this.currentPanels;n.push(t);var a=function(){return n.remove(t)};return t.wait().then(a,a),t},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{needsOverlayContent:d.e}),t}(i.n),u=Object(r.r)("PanelProvider",l)},1890:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(112),r=new a.t({name:"CommandBar.key",loader:new i.t(function(){return n.e(440).then(n.bind(null,2055)).then(function(e){return e.resourceKey.local})})})},1898:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(8),i=n(1074),r=n(1108),o=n(1105),s=new a.t({name:"".concat("isOfflineStateObservable.key",".isOfflineStateObservable"),factory:{dependencies:{offlineDetection:i.e},create:function(e){var t=new r.e,n=new o.e(e.offlineDetection.offline);return t.attach(e.offlineDetection.onChange(function(e){n.set(e)})),{instance:n,disposable:t}}}})},1940:function(e,t,n){"use strict";var a=n(0),i=n(161),r=n(22),o=n(1669),s=function(e){function t(t){var n=e.call(this,t)||this,a=n.valueAccessor(),i=function(e){return!!e.context}(a)?a:{context:a},s=i.context,c=i.virtualChildElement,d=void 0===c?n.element:c;return n._context=s,s.parentElement&&Object(o.e)(d,s.parentElement),r.applyBindingsToNode(n.element,{template:{nodes:s.templateNodes}},s.bindingContext),s.renderCount(s.renderCount.peek()+1),n.controlsDescendantBindings=!0,n}return Object(a.__extends)(t,e),t.prototype.dispose=function(){this._context.renderCount(this._context.renderCount.peek()-1),e.prototype.dispose.call(this)},t.supportsVirtualElements=!0,t}(i.t);t.e=s},1973:function(e,t,n){"use strict";var a=n(96),i=n(189),r={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},o={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},s=function(){function e(e,t){this._scope=new i.e,this._events=new(this._scope.attached(a.t))(this),this._events.on(window,"resize, orientationchange",this._onContainerResize.bind(this));var n=t.breakpoints;this._breakpoints="function"==typeof n?n:function(){return n},this._windowWidth=0,this._windowHeight=0,this._onContainerResize()}return e.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}},e.determineWindowSize=function(e,t){if(void 0===t&&(t=o),0===e)return"Medium";for(var n in o)if(e<t[n])return n},e.determineCssClass=function(e){return r[e]},e.getScrollbarWidth=function(){var e=document.createElement("div"),t=document.createElement("div"),n=e.style;n.visibility="hidden",n.width="100px",n.msOverflowStyle="scrollbar",n.overflow="scroll",t.style.width="100%",document.body.appendChild(e),e.appendChild(t);var a=e.offsetWidth,i=t.offsetWidth;e.parentNode.removeChild(e);var r=a-i;return this.getScrollbarWidth=function(){return r},r},Object.defineProperty(e.prototype,"windowWidth",{get:function(){return this._windowWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"windowHeight",{get:function(){return this._windowHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formFactorSize",{get:function(){return this._formFactorSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHamburgerVisible",{get:function(){return this._isHamburgerVisible},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"showLabels",{get:function(){return this._showLabels},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cssClass",{get:function(){return this._cssClass},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._scope.dispose()},e.prototype.compareSize=function(e,t){var n=this._breakpoints();return n[e]-n[t]},e.prototype._afterContainerResize=function(){},e.prototype._onContainerResize=function(){var t=document.body,n=document.documentElement,a=this._windowHeight=n.clientWidth||t.clientWidth;this._windowWidth=n.clientHeight||t.clientHeight;var i=this._formFactorSize,r=this._formFactorSize=e.determineWindowSize(a,this._breakpoints());this._cssClass=e.determineCssClass(r);var s=this._isHamburgerVisible;this._isHamburgerVisible=a<o.Large;var c=this._showLabels;this._showLabels=this.compareSize(r,"Medium")>0,i&&r!==i&&this._events.raise("formFactorChange"),"boolean"==typeof s&&s!==this._isHamburgerVisible&&this._events.raise("hamburgerVisibilityChange"),"boolean"==typeof c&&c!==this._showLabels&&this._events.raise("showCommandLabelsChange"),this._afterContainerResize()},e.DEFAULT_BREAKPOINTS=o,e.MAC_SCROLL_BAR_WIDTH=8,e}();t.e=s},1984:function(e,t,n){"use strict";var a=n(20);Object(a.n)([{rawString:".od-DialogOverlay{display:none}.od-Dialog{background-color:transparent;position:absolute;top:48px;bottom:0;width:100%;display:block;font-size:0;line-height:100vh;text-align:center;display:flex;align-items:center}[dir=ltr] .od-Dialog{left:0}[dir=rtl] .od-Dialog{right:0}.od-Dialog::before{vertical-align:middle;display:inline-block;content:'';height:100%;width:0}.sm .od-Dialog{align-items:flex-start;box-sizing:border-box;padding:0}.od-Dialog-main{vertical-align:middle;display:inline-block;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;line-height:normal;width:100%;min-height:100px;outline:0;visibility:hidden;box-shadow:0 25.6px 57.6px 0 rgba(0,0,0,.22),0 4.8px 14.4px 0 rgba(0,0,0,.18);border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";overflow:hidden}.sm .od-Dialog-main{height:100%}html[dir=ltr] .od-Dialog-main{text-align:left}html[dir=rtl] .od-Dialog-main{text-align:right}@media screen and (-ms-high-contrast:active){.od-Dialog-main{box-shadow:0 0 0 3px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}}@media screen and (-ms-high-contrast:black-on-white){.od-Dialog-main{box-shadow:0 0 0 3px "},{theme:"black",defaultValue:"#000000"},{rawString:" inset}}.od-Dialog-main:focus{outline:0}.od-Dialog-main--dialog{margin:auto;position:relative}.od-Dialog-main--callout{position:absolute}.od-Dialog-main--visible{visibility:visible}.od-Dialog-main--sm{width:360px}.od-Dialog-main--sm.od-Dialog-main-style--blocker{width:340px}.od-Dialog-main--sm.od-Dialog-main-style--vaultBlocker{width:620px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel{top:0;width:auto;position:absolute;bottom:0;left:0;right:0}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button{display:inline-flex;align-items:center}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary{border:none}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary:disabled,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary:disabled{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary:disabled:before,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary:disabled:before{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary .od-Button-label,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary .od-Button-label{display:inline-block;font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel.od-Dialog--close .od-Dialog-button.od-Dialog-button--close,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{top:8px}.od-Dialog-main--md{max-width:480px}.od-Dialog-main--lg{max-width:640px}.od-Dialog-main--xlg{max-width:1024px}.od-Dialog-main--xxlg{max-width:1366px}.od-Dialog-main--xxxlg{max-width:1920px}.isFluentVNext .od-Dialog-main{border-radius:4px;box-shadow:0 6.4px 14.4px 0 rgba(0,0,0,.132),0 1.2px 3.6px 0 rgba(0,0,0,.108)}.od-Dialog-button.od-Dialog-button--close{display:none}.sm .od-Dialog-button.od-Dialog-button--close{top:8px}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{display:block;position:absolute;margin:0;border:0;background:0 0;cursor:pointer;top:5px;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";line-height:32px;height:32px;width:32px;padding:0;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}[dir=ltr] .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{right:5px}[dir=rtl] .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{left:5px}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close:hover{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close .ms-Icon.ms-Icon--Cancel{font-size:16px;color:inherit}.sm .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{top:8px;line-height:20px}.sm .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close .ms-Icon.ms-Icon--Cancel{font-size:20px}.od-Dialog-subText{margin:0 0 20px 0;font-weight:300;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-Dialog-subText.od-Dialog-subText--s{font-size:12px}.od-Dialog-subText.od-Dialog-subText--m{font-size:14px}.od-Dialog-subText.od-Dialog-subText--l{font-size:17px}.od-Dialog-content{position:relative;width:100%}.sm .od-Dialog-content{height:100%}.od-Dialog-content .od-Button.od-Button--compound:not(:last-child){margin-bottom:20px}.ms-ModalOverlay{display:block;position:absolute;cursor:pointer;left:0;right:0;top:0;bottom:0;background-color:"},{theme:"whiteTranslucent40",defaultValue:"rgba(255,255,255,.4)"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-ModalOverlay{display:none}}.od-Dialog--multiline{width:95%}[dir=ltr] .od-Dialog-button--close{right:14px}[dir=rtl] .od-Dialog-button--close{left:14px}[dir=ltr] .od-Dialog-button--close{left:auto}[dir=rtl] .od-Dialog-button--close{right:auto}.od-Dialog-content{font-size:14px;line-height:20px}.od-OverlayHost-overlay .ms-ModalOverlay{animation-name:ms-fadeIn;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay .ms-ModalOverlay{animation:none}}.od-OverlayHost-overlay .od-Dialog-main{animation-name:ms-fadeIn,ms-slideDownIn10;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay .od-Dialog-main{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .ms-ModalOverlay{animation-name:ms-fadeOut;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .ms-ModalOverlay{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Dialog-main{animation-name:ms-fadeOut,ms-slideUpOut10;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Dialog-main{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Dialog{visibility:hidden;transition:visibility 0s linear 267ms}"}])},1987:function(e,t,n){"use strict";n.d(t,"t",function(){return o});var a=n(0),i=n(175),r=n(48);function o(e){if(!e)return{resultCode:"unknown",resultType:r.e.Failure};var t=e.correlationId;return{resultCode:e.code||e.name,resultType:e.isExpected?r.e.ExpectedFailure:r.e.Failure,error:e.message||"".concat(e),extraData:t?{CorrelationId:t}:{}}}var s=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.slide=t.slide,a.oneUp=t.oneUp,a}return Object(a.__extends)(t,e),t}(i.t);t.e=s},1989:function(e,t,n){"use strict";var a="\x3c!--ko template:templateName--\x3e\x3c!--/ko--\x3e",i=n(379),r=n(0),o=n(175),s=n(1714),c=n(1940),d="od-transclusion-host-default",l="od-transclusion-host-custom",u=n(419),f=function(e){function t(t,n){void 0===n&&(n={});var a,i=e.call(this,t,n)||this;return i.addBindingHandlers({host:s.e,transclusionHost:c.e}),i._provider=t.provider,i._renderCount=t.renderCount,i.contexts=i._provider.contexts,i.currentContext=i.createPureComputed(i._computeCurrentContext),i.currentContext.equalityComparer=u.n,a=t.useCustomTemplate?l:d,i.templateName=a,i._renderCount&&i.createComputed(i._computeSetRenderCount),i}return Object(r.__extends)(t,e),t.prototype._computeCurrentContext=function(){return this.contexts()[this.contexts().length-1]||null},t.prototype._computeSetRenderCount=function(){this._renderCount(this.contexts().length)},t}(o.t),p=n(156),m=i.e({tagName:"od-transclusion-host",template:a,viewModel:f,synchronous:!0});i.t(d,"\x3c!--ko with:currentContext--\x3e\x3c!--ko transclusionHost:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"),i.t(l,"\x3c!--ko host:{data:{contexts:contexts}}--\x3e\x3c!--/ko--\x3e"),Object(p.t)({name:"TransclusionHost",template:a,automationName:"od-transclusion-host",viewModelType:f}),t.e=m},2001:function(e,t,n){"use strict";n.r(t),n.d(t,"shareFocusItemResourceKey",function(){return s}),n.d(t,"copyLinkFocusItemResourceKey",function(){return c}),n.d(t,"copyFormLinkFocusItemResourceKey",function(){return d}),n.d(t,"shareFromDetailPaneFocusItemResourceKey",function(){return l}),n.d(t,"shareFromGrantAccessItemResourceKey",function(){return u}),n.d(t,"hasFollowedAnItemKey",function(){return f});var a=n(55),i=n(419),r=n(8),o=function(e){return{dependencies:{observablesFactoryType:a.i},create:function(t){var n=new(0,t.observablesFactoryType)({}),a=n.create();return e&&(a.equalityComparer=i.n),{instance:a,disposable:n}}}},s=new r.t({name:"".concat("ShareCommandKeys",".shareFocusItem"),factory:o(!0)}),c=new r.t({name:"".concat("ShareCommandKeys",".copyLinkFocusItem"),factory:o()}),d=new r.t({name:"".concat("ShareCommandKeys",".copyFormLinkFocusItem"),factory:o()}),l=new r.t({name:"".concat("ShareCommandKeys",".copyLinkFocusItem"),factory:o()}),u=new r.t({name:"".concat("ShareCommandKeys",".shareFromGrantAccess"),factory:o()}),f=new r.t({name:"".concat("ShareCommandKeys",".hasFollowedAnItemKey"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})},2003:function(e,t,n){"use strict";var a='<div class="od-DialogHost">\x3c!--ko with:dialog--\x3e\x3c!--ko component:{name:$component.dialogOverlayTagName,params:{dialog:$component.dialog}}--\x3e\x3c!--ko if:$component.isStandard--\x3e\x3c!--ko component:{name:$component.standardDialogTagName,params:{}}--\x3e\x3c!--ko if:!!component--\x3e\x3c!--ko with:component--\x3e\x3c!--ko component:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:!!control--\x3e\x3c!--ko control:control--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot:$component.isStandard--\x3e\x3c!--ko with:component--\x3e\x3c!--ko component:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>',i=n(20);Object(i.n)([{rawString:".od-DialogHost{display:none}"}]);var r=n(1725),o=n(0),s=n(175),c=(n(1984),n(22)),d=n(332),l=n(205),u=n(666),f=n(1099),p=n(1714),m=n(778),_=n(498),h=n(1729),b=n(1053),g=n(1723),v=n(1750),y=n(967),S=n(775),D=function(e){function t(t){var n=e.call(this,t)||this;return n.addBindingHandlers({dismiss:m.e,automation:y.e,element:b.e,focusTrap:h.e,interactionScope:S.t,preserveFocus:v.e,recoverFocus:g.e,host:p.e}),n.dialog=t.dialog,n.overlayComponent=n.createPureComputed(n._computeOverlayComponent),n.contentRoot=c.observable(),n._launchPoint=new d.e(-1,-1),n.isVisible=c.observable(!1),n.title=n.createObservable(n.dialog().title()),n.dialogStyle=n.createComputed(n._computeDialogStyle),n.sizeClass=n.createComputed(n._computeSizeClass),n.styleClass=n.createComputed(n._computeStyleClass),n}return Object(o.__extends)(t,e),t.prototype.dismiss=function(){var e=this.dialog();return!e||!e.isDismissable||(e.dismiss(),!1)},t.prototype._computeOverlayComponent=function(){var e=this.dialog();return{name:r.e.tagName,params:{animation:{beforeRemove:500},alignToParent:e.isCallout}}},t.prototype._computeDialogStyle=function(){var e=this.dialog(),t={};return e?this.unwrapObservable(e.calloutHeight)&&e.isCallout&&(this.ensureLaunchPointCalculated(),t.left=this._launchPoint.x+"px",t.top=this._launchPoint.y+"px"):(t.left="-1000px",t.top="-1000px"),e.isCallout&&!this.unwrapObservable(e.calloutHeight)||this.isVisible(!0),t},t.prototype.ensureLaunchPointCalculated=function(){var e=this.dialog.peek().invokerEvent;if(e&&this.contentRoot()){var t=this.contentRoot().getBoundingClientRect(),n=e.clientX,a=e.clientY;if(n<=0&&a<=0||!n&&!a){var i=e.target.getBoundingClientRect();n=i.left,a=i.bottom}var r=l.e.isRightToLeft?n-t.width:n,o=a,s=new u.e(r,o,t.width,t.height),c=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,d=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,f=new u.e(0,0,c,d),p=s.nudge(f);this._launchPoint.x=p.getLeft(),this._launchPoint.y=p.getTop()}},t.prototype._computeSizeClass=function(){return _.e.determineCssClass(this.dialog().size)},t.prototype._computeStyleClass=function(){return f.e[this.dialog().style]},t}(s.t),I=n(379),x=I.e({tagName:"od-dialog-overlay",template:"<div class=\"od-DialogOverlay\" data-bind=\"css:{'is-active':dialog}\">\x3c!--ko with:dialog--\x3e\x3c!--ko component:$component.overlayComponent--\x3e<div class=\"od-Dialog\" data-bind=\"css:{'od-Dialog--close':isDismissable},focusTrap:{}\"><div class=\"ms-ModalOverlay\" data-bind=\"visible:!isCallout&&!isOverlayHidden,style:{backgroundColor:overlayColor}\"></div><div class=\"od-Dialog-main\" tabindex=\"-1\" role=\"dialog\" data-bind=\"interactionScope:{isScope:true},preserveFocus:shouldPreserveFocus,recoverFocus:{isEnabled:$host.isOpen},dismiss:{isEnabled:isSoftDismissable,close:isDismissable&&$component.dismiss.bind($component),dismissOnScroll:isDismissableOnScroll,dismissOnResize:isDismissableOnResize},class:'od-Dialog-main--'+$component.sizeClass()+' '+'od-Dialog-main-style--'+$component.styleClass()+(customCssClasses?' '+customCssClasses:''),css:{'od-Dialog-main--allowPanel':!stayAsPopup,'od-Dialog-main--callout':isCallout,'od-Dialog-main--dialog':!isCallout,'od-Dialog-main--visible':$component.isVisible()},automation:automationId,style:$component.dialogStyle,attr:{'aria-labelledby':'od-Dialog-title','aria-describedby':'od-Dialog-content'},element:$parent.contentRoot\"><div class=\"od-Dialog-content\" data-bind=\"host:{}\"></div></div></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>",viewModel:D,synchronous:!0}),C=n(1057);Object(i.n)([{rawString:".od-Link{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none;cursor:pointer;outline:0}.od-Link:focus,.od-Link:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-Link:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Link[disabled]{cursor:default;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-Dialog-actionsLoading{display:inline-block;padding-bottom:7px;vertical-align:bottom}[dir=ltr] .od-Dialog-actionsLoading{padding-right:5px}[dir=rtl] .od-Dialog-actionsLoading{padding-left:5px}.od-Dialog-main--callout .od-Dialog-inner{padding:0}.od-Dialog-main--callout .od-Dialog-header{padding:0}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions{position:absolute;top:0;left:0;right:0;margin-top:0;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";padding:0 10px 0 0;height:44px}html[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions,html[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions{padding:0 0 0 10px}html[dir=ltr] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight,html[dir=ltr] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight{float:left}html[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight,html[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight{float:right}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions .ms-Icon--Save,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions .ms-Icon--Save{font-size:20px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{background:0 0;height:44px}[dir=ltr] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=ltr] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-right:16px}[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-left:16px}[dir=ltr] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=ltr] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-left:16px}[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-right:16px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-icon,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-icon{display:inline-block;margin-top:5px;margin-right:6px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-label,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-label{font-weight:400;font-size:14px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action:hover,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action:hover{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-header,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-header{padding:48px 16px 0 16px}html[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-header,html[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-header{padding:48px 16px 0 16px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-inner,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-inner{padding:16px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button:disabled .od-Button-icon,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button:disabled .od-Button-icon{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button:disabled .od-Button-label,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button:disabled .od-Button-label{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--back{padding:5px 10px 5px 0;background:0 0;border:0;cursor:pointer}html[dir=rtl] .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--back{padding:5px 0 5px 10px}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--back .ms-Icon.ms-Icon--Back{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:16px}.ms-Dialog-button--close{position:absolute;top:12px;background:0 0;border:none;cursor:pointer}[dir=ltr] .ms-Dialog-button--close{right:8px}[dir=rtl] .ms-Dialog-button--close{left:8px}.ms-Dialog-button--close .ms-Icon{font-size:16px}.od-Dialog-header{position:relative;width:100%;box-sizing:border-box;word-wrap:break-word;padding:24px 40px 0 24px}.od-Dialog-header .od-Dialog-title{margin:0;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";display:inline;font-size:"},{theme:"xLargeFontSize",defaultValue:"20px"},{rawString:";font-weight:"},{theme:"xLargeFontWeight",defaultValue:"600"},{rawString:"}.od-Dialog-header .od-Dialog-title .od-Dialog-titleIcon::after{content:''}[dir=ltr] .od-Dialog-header .od-Dialog-title .od-Dialog-titleIcon::after{margin-right:16px}[dir=rtl] .od-Dialog-header .od-Dialog-title .od-Dialog-titleIcon::after{margin-left:16px}.od-Dialog-header .od-Dialog-title .od-Dialog-titleIcon .od-IconGlyph{display:inline-block;top:8px;font-size:28px}.od-Dialog-header.od-Dialog-header--large{padding:30px 20px;margin-bottom:10px;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Dialog-header.od-Dialog-header--large .od-Dialog-title{font-weight:100;font-size:28px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-Dialog-inner{height:100%;padding:18px 24px 24px}.od-Dialog-actions{position:relative;width:100%;height:32px;margin-top:24px;zoom:1}.od-Dialog-actions::after,.od-Dialog-actions::before{display:table;content:'';line-height:0}.od-Dialog-actions::after{clear:both}.od-Dialog-action .od-Button-icon{display:none}.od-Dialog-action.od-Dialog-action--link{border:0;cursor:pointer;box-sizing:border-box;box-shadow:none;margin:0;padding:0;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none;cursor:pointer;outline:0;padding:0 0 0 4px;background:0 0}.od-Dialog-action.od-Dialog-action--link:focus,.od-Dialog-action.od-Dialog-action--link:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-Dialog-action.od-Dialog-action--link:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Dialog-action.od-Dialog-action--link[disabled]{cursor:default;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}html[dir=rtl] .od-Dialog-action.od-Dialog-action--link{padding:0 4px 0 0}.od-Dialog-action.od-Dialog-action--link .od-Button-label{font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Dialog-action.od-Dialog-action--link:hover .od-Button-label{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.sm .od-Dialog-action .od-Button-label{font-size:12px}html[dir=ltr] .od-Dialog-actionsRight{float:right}html[dir=rtl] .od-Dialog-actionsRight{float:left}[dir=ltr] .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-right:8px}[dir=rtl] .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-left:8px}html[dir=ltr] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight{float:right}html[dir=rtl] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight{float:left}[dir=ltr] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-right:15px}[dir=rtl] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-left:15px}"}]);var O=n(1052),w=n(253),E=n(32),A=Object(w.e)({eventName:"DialogAction,",shortEventName:"DialogAction"},{dialogName:E.e.String,actionName:E.e.String}),L=n(2118),k=n(1764),M=n(1879),P=function(e){function t(t){var n=e.call(this,t)||this;return n.loadingSpinnerTagName=k.e.tagName,n.iconGlyphTagName=M.e.tagName,n.addBindingHandlers({keyboard:O.e,automation:y.e,host:p.e,element:b.e}),n.closeLabel=L.e,n.dialog=n.resources.consume(C.e).currentDialog,n.actionButton=n.observables.create(null),n.createComputed(function(){var e=n.actionButton();e&&n.dialog.peek().focusOnPrimaryAction&&e.focus()}),n}return Object(o.__extends)(t,e),t.prototype.dismiss=function(){var e=this.dialog();return!e||!e.isDismissable||(e.dismiss(),!1)},t.prototype.executeDefaultAction=function(){var e=this.dialog();if(e&&e.executeDefaultAction){var t=c.utils.arrayFirst(e.actions,function(e){return e.isDefault});if(t)return this._logEvent(t),this.execute(t)}return!0},t.prototype.execute=function(e){var t=this.dialog();return!t||!e.isAvailable()||(e.isExecuting(!0),this._logEvent(e),e.execute().done(function(n){e.isExecuting(!1),t.state(n)}),!1)},t.prototype._logEvent=function(e){var t=this.dialog.peek();e.instrumentationId&&t.instrumentationId&&A.logData({actionName:e.instrumentationId,dialogName:t.instrumentationId})},t}(s.t),T=I.e({tagName:"od-standard-dialog",template:'\x3c!--ko with:dialog--\x3e<div data-bind="keyboard:{allowInputEvents:true,allowButtonEvents:false,mappings:{Enter:$component.executeDefaultAction.bind($component)}},css:\'od-StandardDialog\'"><div class="od-Dialog-header od-Dialog-header--s"><p class="od-Dialog-title" id="od-Dialog-title" data-bind="attr:{\'aria-label\':title}" role="heading" aria-level="1">\x3c!--ko if:titleAction&&titleAction.isVisible()--\x3e<button class="od-Dialog-button od-Dialog-button--back" data-bind="attr:{\'aria-label\':titleAction.name,title:titleAction.name},click:titleAction.execute">\x3c!--ko if:titleAction.icon--\x3e<span data-bind="component:{name:$component.iconGlyphTagName,params:{icon:titleAction.icon}}"></span>\x3c!--/ko--\x3e</button>\x3c!--/ko--\x3e\x3c!--ko if:titleIcon&&!titleAction--\x3e<span class="od-Dialog-titleIcon" data-bind="component:{name:$component.iconGlyphTagName,params:{icon:titleIcon}},attr:{\'aria-label\':titleIconAriaLabel}"></span>\x3c!--/ko--\x3e\x3c!--ko text:title--\x3e\x3c!--/ko--\x3e</p></div><div class="od-Dialog-inner"><div class="od-Dialog-content" id="od-Dialog-content" data-bind="host:{}"></div>\x3c!--ko if:actions.length&&actionsVisible--\x3e<div class="od-Dialog-actions" data-bind="automation:\'actionsSection\'"><div class="od-Dialog-actionsRight" data-bind="foreach:actions">\x3c!--ko if:isVisible--\x3e<button class="od-Dialog-action" data-bind="css:{\'od-Button--primary\':isDefault,\'od-Button\':!isLink,\'od-Dialog-action--link\':isLink},click:$component.execute.bind($component),enable:isAvailable,automation:automationId,element:$component.actionButton">\x3c!--ko if:icon--\x3e<span class="od-Button-icon" data-bind="component:{name:$component.iconGlyphTagName,params:{icon:icon}}"></span>\x3c!--/ko--\x3e<span class="od-Button-label" data-bind="text:name"></span></button>\x3c!--/ko--\x3e\x3c!--ko if:isVisible()&&isExecuting()--\x3e<div class="od-Dialog-actionsLoading" data-bind="component:{name:$component.loadingSpinnerTagName,params:{loadingText:\'\'}}"></div>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e</div><button class="od-Dialog-button od-Dialog-button--close" data-bind="attr:{\'aria-label\':$component.closeLabel,title:$component.closeLabel},click:isDismissable&&$component.dismiss.bind($component)"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button></div>\x3c!--/ko--\x3e',viewModel:P}),U=n(156),F=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.addBindingHandlers({control:U.n}),a.dialog=a.resources.consume(C.e).currentDialog,a.dialogOverlayTagName=x.tagName,a.standardDialogTagName=T.tagName,a.isStandard=a.createPureComputed(a._computeIsStandard),a.hasDialog=a.createPureComputed(a._computeHasDialog),a}return Object(o.__extends)(t,e),t.prototype._computeIsStandard=function(){var e=this.dialog();return e&&1===e.template},t.prototype._computeHasDialog=function(){return!!this.dialog()},t}(s.t),H=I.e({tagName:"od-dialog-host",template:a,viewModel:F,synchronous:!0});t.e=H,Object(U.t)({name:"DialogHost",template:a,automationName:"od-dialog-host",viewModelType:F})},2004:function(e,t,n){"use strict";n.d(t,"t",function(){return C});var a='<div class="od-Error"><div class="od-Error-image"><img data-bind="attr:{src:imageUrl,alt:errorTitle,class:errorClassName}"></div><div class="od-Error-title" data-bind="text:errorTitle"></div>\x3c!--ko if:errorDetailedText--\x3e<div class="od-Error-subText" data-bind="text:errorDetailedText,css:{\'od-Error-subtext--accessremoved\':isAccessRemoved}"></div>\x3c!--/ko--\x3e\x3c!--ko if:errorHtml--\x3e<div class="od-Error-subText" data-bind="html:errorHtml"></div>\x3c!--/ko--\x3e\x3c!--ko if:showAction--\x3e<form class="od-Error-button" data-bind="attr:{action:actionUrl}" method="get"><button class="od-Button" data-bind="click:onButtonClick" type="submit"><span class="od-Button-label" data-bind="text:actionText"></span></button></form>\x3c!--/ko--\x3e<div class="od-Error-code" data-bind="visible:correlationIdText,text:correlationIdText"></div><div class="od-Error-code" data-bind="visible:showErrorCode,text:errorCodeText"></div></div>',i=n(20);Object(i.n)([{rawString:".od-Error{text-align:center}.od-Error-image{padding-top:52px;height:208px;width:auto;margin:0 auto}.od-Error-image .od-Error-imageTag{height:208px;width:auto}.od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:113px}.md .od-Error-image,.sm .od-Error-image{padding-top:20px;height:168px;width:auto}.md .od-Error-image .od-Error-imageTag,.sm .od-Error-image .od-Error-imageTag{height:168px;width:auto}.md .od-Error-image .od-Error-vaultImage,.sm .od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:80px}.od-Error-title{padding:16px 16px 0 16px;font-size:21px;font-weight:100;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-title{padding:16px 16px 0 16px}.md .od-Error-title,.sm .od-Error-title{font-size:17px;font-weight:300}.od-Error-subText{padding:6px 16px 0 16px;font-size:14px;font-weight:400;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-subText{padding:6px 16px 0 16px}.od-Error-subtext--accessremoved{max-width:410px}.od-Error-code{padding-top:8px;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";-webkit-touch-callout:text;-webkit-user-select:text;-ms-user-select:text;user-select:text;font-size:12px;font-weight:400}.od-Error-button{padding-top:16px;font-size:14px;font-weight:400}"}]);var r=n(0),o=n(175),s=n(1846),c=n(60),d=n(89),l=n(42),u=n(1758),f=n(81),p=n(112),m=n(62),_=function(){function e(e,t){this._errorDataSource=t.errorDataSource,this._defaultErrorAction={text:s.n,url:t.urlDataSource.getRootUrl()}}return e.prototype.getAction=function(e){return this._errorDataSource?this._errorDataSource.getAction(e):this._defaultErrorAction},e}(),h=Object(p.r)("ErrorProvider",_,{errorDataSource:m.f.optional,urlDataSource:m.Se}),b=n(23),g=n(455),v=n(11),y=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this,i=t.error;a._navigation=a.resources.consume(f.e),a._actionMap=a.resources.consume(b.e.optional);var r,o,p,m,_,g,y=a.resources.consume(h);return a.errorClassName="od-Error-imageTag",S(i)?(r=i.errorTitle,o=i.errorCode,p=i.errorDetailedText,m=i.errorDetailedHtml,_=i.correlationId,g=y.getAction(i)):i.message&&(p=i.message),r||(r=s.i),a.errorTitle=r,a.errorDetailedText=p,a.errorHtml=m,a.errorCode=o,Object(v.isFeatureEnabled)(v.EmbedAccessOnEmbedAspx)&&Object(v.isFeatureEnabled)(v.EmbedLinkSupportOnEmbedAspx)&&"403"===o||p||m||(p=s.a),a.errorDetailedText=p,a.showAction=!!g&&!g.hideButton&&!t.hideAction,g&&(a.actionText=g.text,a.actionUrl=g.url),a.showErrorCode=o&&a.errorTitle===s.i,a.showErrorCode?(c.e.log(i,"ServerError","".concat(o)),a.errorCodeText=l.format(s.S,o)):a.errorCodeText="",a.correlationIdText=_?l.format(s.D,_):"","accessremoved"===o?(a.isAccessRemoved=!0,a.imageUrl=window.require.toUrl("odsp-media/images/error/error2.svg")):(a.isAccessRemoved=!1,a.imageUrl=a._getRandomImage()),S(i)&&i.actionUrl&&161===i.errorCode&&(a.resources.consume(u.e)(!1),a.actionText=s.g,a.errorDetailedText=s.v,a.errorCodeText="",a.errorTitle=s.y,a.imageUrl=window.require.toUrl("odsp-media/images/error/vault/vaultclosed.svg"),a.errorClassName="od-Error-vaultImage",d.e.logData({name:"Vault.Bookmarked.Loaded"})),a}return Object(r.__extends)(t,e),t.prototype.onButtonClick=function(){return this.showAction&&(161===this.errorCode&&this._actionMap?(d.e.logData({name:"Vault.Bookmarked.Unlock"}),new(this.managed(this._actionMap.VaultAction))({actionType:g.e.Unlock}).execute(null)):Object(v.isFeatureEnabled)(v.EmbedAccessOnEmbedAspx)&&Object(v.isFeatureEnabled)(v.EmbedLinkSupportOnEmbedAspx)&&self!==top&&this.actionUrl?(d.e.logData({name:"Error.RequesAccess.Click"}),this._popupCenter(this.actionUrl,"",860,500)):this._navigation.navigateTo(this.actionUrl)),!1},t.prototype._getRandomImage=function(){var e=Math.ceil(3*Math.random());return window.require.toUrl("odsp-media/images/error/error".concat(e,".svg"))},t.prototype._popupCenter=function(e,t,n,a){var i=void 0!==window.screenLeft?window.screenLeft:screen.left,r=void 0!==window.screenTop?window.screenTop:screen.top,o=(window.outerWidth?window.outerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-n/2+i,s=(window.outerHeight?window.outerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-a/2+r,c=window.open(e,t,"scrollbars=yes, width="+n+", height="+a+", top="+s+", left="+o);return window.focus&&c&&c.focus(),c},t}(o.t);function S(e){return!(!e||!e.errorTitle&&void 0===e.errorCode)}var D=n(379),I=n(156),x=D.e({tagName:"ms-error",template:a,viewModel:y,synchronous:!0}),C=Object(I.t)({name:"Error",automationName:"ms-error",template:a,viewModelType:y});t.e=x},2017:function(e,t,n){"use strict";var a=n(332),i=n(666),r=function(){function e(e,t){void 0===e&&(e=new a.e),void 0===t&&(t=1),this.translate=e,this.scale=t}return e.areEqual=function(e,t,n){return void 0===n&&(n=1e-6),a.e.areEqual(e.translate,t.translate,n)&&Math.abs(Math.log(e.scale/t.scale))<n},e.zoom=function(t,n,a){return new e(t.subtract(n).scale(a-1),a)},e.centerWithinBounds=function(t,n,r){return new e(new i.e(a.e.ORIGIN,t).getCenter().subtract(a.e.getCenter([n,r])))},e.prototype.apply=function(e){return e.scale(this.scale).add(this.translate)},e.prototype.multiply=function(t){return new e(this.translate.add(t.translate.scale(this.scale)),this.scale*t.scale)},e.prototype.invert=function(){return new e(this.translate.scale(-1/this.scale),1/this.scale)},e.prototype.toString=function(){return"[Transform (".concat(this.translate.x,", ").concat(this.translate.y,") ").concat(this.scale,"]")},e.IDENTITY=new e,e}();t.e=r},2024:function(e,t,n){"use strict";var a='<div class="od-PanelHost" data-bind="foreach:panels">\x3c!--ko component:{name:$parent.overlayTagName,params:{animation:{afterAdd:1,beforeRemove:500},alignToParent:false}}--\x3e\x3c!--ko focusTrap:{}--\x3e<div class="ms-ModalOverlay od-PanelOverlay"></div><div class="od-Panel" role="dialog" tabindex="-1" data-bind="interactionScope:{isScope:true},preserveFocus,recoverFocus:{isEnabled:$host.isOpen},scrollContainer,dismiss:{close:$component.closePanel.bind($component),disableEscape:disableEscape},class:$component.determinePanelCssClass($data)+\' \'+$component.getScrollBarMode($data),css:{\'od-Panel--hasCommandBar\':hasCommandBar,\'od-Panel--hasPadding\':includePadding,\'od-Panel--lightDismiss\':preserveLightDismiss,\'od-Panel--stickyCloseButton\':stickyCloseButton,\'od-Panel--reactSuiteNav\':$component.isReactSuiteNav},attr:{\'aria-label\':title,\'aria-describedby\':elementDescribedBy},element:$parent.contentRoot">\x3c!--ko ifnot:noTitle--\x3e<div class="od-Panel-title" data-bind="text:title"></div>\x3c!--/ko--\x3e<div class="od-Panel-content" data-bind="component:component,css:{\'od-Panel--hasPadding\':stickyCloseButton&&includePadding,\'od-Panel-content--noTitleFill\':maximizePanelContent&&noTitle,\'od-Panel-content--titleFill\':maximizePanelContent&&!noTitle},clientRect:{size:panelContentSize}"></div>\x3c!--ko if:showCloseButton--\x3e<button class="od-Panel-button od-Panel-button--close" tabindex="0" data-bind="click:$component.closePanel.bind($component),attr:{\'aria-label\':$component.closePanelLabel,title:$component.closePanelLabel},keyboard:{mappings:{Enter:$component.onEnter.bind($component)}}"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>',i=(n(1883),n(379)),r=n(0),o=n(22),s=n(175),c=n(1886),d=n(778),l=n(498),u=n(11),f=n(1053),p=n(1729),m=n(1052),_=n(1750),h=n(1723),b=n(1789),g=n(1701),v=n(2018),y=n(775),S=n(1725),D=n(787),I=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.closePanelLabel=v.e,a.overlayTagName=S.e.tagName,a.addBindingHandlers({scrollContainer:g.e,dismiss:d.e,element:f.e,focusTrap:p.e,keyboard:m.e,interactionScope:y.t,preserveFocus:_.e,recoverFocus:h.e,clientRect:b.e}),a.contentRoot=o.observable(),a._panelProvider=a.resources.consume(c.e),a.panels=a._panelProvider.currentPanels,a.isReactSuiteNav=Object(u.isFeatureEnabled)(u.UseReactConsumerShell),a}return Object(r.__extends)(t,e),t.prototype.onEnter=function(e,t){return this.closePanel(e,!0),t.stopPropagation(),!1},t.prototype.closePanel=function(e,t){return e.isBlocking&&!t||e.state(1),!1},t.prototype.determinePanelCssClass=function(e){var t="od-Panel--"+l.e.determineCssClass(e.size);return Object(D.a)()?t+" od-Panel--FullPagePanel":e.overridePanelStyle?t+" "+e.overridePanelStyle:t},t.prototype.getScrollBarMode=function(e){return"od-Panel--"+e.scrollMode+"Scroll"},t.prototype.getClass=function(e){return"od-Panel--"+l.e.determineCssClass(e.size)},t}(s.t),x=n(156),C=i.e({tagName:"ms-panel-host",template:a,viewModel:I,synchronous:!0});t.e=C,Object(x.t)({name:"PanelHost",template:a,automationName:"od-panel-host",viewModelType:I})},2054:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n(489);function i(e,t){var n;e.extend({rateLimit:{timeout:1,method:"notifyWhenChangesStop"}});var i=e.subscribe(function(a){t.cancelAnimationFrame(n),n=t.requestAnimationFrame(function(){n=t.requestAnimationFrame(function(){n=void 0,e()})})},null,"beforeChange");return e=Object(a.e)(e,function(){i.dispose()})}function r(e,t){return e.equalityComparer=t,e}},2071:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(0),i=n(332),r=n(2017),o=n(161),s={0:function(e){return e},1:function(e){return 18*e},2:function(e){return.5*window.innerHeight}},c="function"==typeof PointerEvent,d=function(e){function t(t){var n=e.call(this,t)||this,a=t.valueAccessor(),i=n.observables,o=a.allowedModes,s=void 0===o?15:o;n._transformV=a.transform||i.create(r.e.IDENTITY),n._isActive=a.isActive||i.create(!1),n._isEnabled=a.isEnabled||i.create(!0),n._mayStartPan=a.mayStartPan||l,n._constrainScale=a.constrainScale||u,n._allowedModes=s,n._useNativePan=!!a.useNativePan,n._gestureMode=i.create(0),n._touchCount=0,n._pointers={},n._pointerCount=0,n._initialTransformV=i.create(r.e.IDENTITY),n._initialTransformV.equalityComparer=p,n._incrementTransformPx=i.create(r.e.IDENTITY),n._incrementTransformPx.equalityComparer=p,n._initialCenterPx=i.create(),n._initialCenterPx.equalityComparer=f,n._initialRadius=i.create(),n._incrementTransformV=i.compute(n._computeIncrementTransformV),n._incrementTransformV.equalityComparer=p,i.compute(n._computeResetTransform),i.compute(n._computeTransform);var d={};return c&&7&s?d.pointerdown=n._onPointerDown:(1&s&&(d.touchstart=n._onTouchStart),6&s&&(d.mousedown=n._onMouseDown)),8&s&&(n._isWheeling=i.compute(n._computeIsWheeling),i.compute(n._computeStopWheeling).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}}),i.compute(n._computeEndWheel),d.wheel=n._onWheel),d.contextmenu=function(e){if(n._isEnabled.peek())return 0!=(4&s)},n.events.onAll(n.element,d),n}return Object(a.__extends)(t,e),t.prototype._computeIncrementTransformV=function(){var e=this._size||i.e.ORIGIN,t=this._incrementTransformPx();return new r.e(new i.e(t.translate.x/e.x,t.translate.y/e.y),t.scale)},t.prototype._computeResetTransform=function(){this._initialCenterPx()||(this._initialTransformV(this._transformV()),this._incrementTransformPx(r.e.IDENTITY))},t.prototype._computeTransform=function(){this._isActive()&&this._transformV(this._incrementTransformV().multiply(this._initialTransformV.peek()))},t.prototype._computeIsWheeling=function(){return 8===this._gestureMode()},t.prototype._computeStopWheeling=function(){var e=this._isWheeling();this._transformV(),e&&this._gestureMode(0)},t.prototype._computeEndWheel=function(){this._isWheeling()||(this._clearGesture(),this._isActive(!1))},t.prototype._onWheel=function(e){if(this._isEnabled.peek()){e.preventDefault(),this._updateSize();var t=this._transformToElement(e),n=s[e.deltaMode](e.deltaY);this._handleWheel(t,n)}},t.prototype._handleWheel=function(e,t){var n=Math.pow(2,-t/300);this._initialCenterPx.peek()||(this._gestureMode(8),this._resetGesture([e.add(this._size.scale(-.5)),e.add(this._size.scale(.5))]));var a=r.e.zoom(e.subtract(this._initialCenterPx.peek()),e,n);8===this._gestureMode.peek()&&this._continueGesture(this._gesturePoints.map(function(e){return a.apply(e)}))},t.prototype._onMouseDown=function(e){if(this._isEnabled.peek()&&0===e.button){this._updateSize();var t=this._transformToElement(e);this._gestureMode(4);var n=e.ctrlKey?[this._size.subtract(t),t]:[t];this._resetGesture(n),this.events.off(this.element,"mousedown",this._onMouseDown),this.events.onAll(document,{mousedown:this._onMouseDown,mouseup:this._onMouseUp,click:this._onClick,mousemove:this._onMouseMove},!0)}},t.prototype._onMouseMove=function(e){e.preventDefault(),this._updateSize(!1);var t=this._transformToElement(e),n=e.ctrlKey?[this._size.subtract(t),t]:[t];4===this._gestureMode.peek()&&this._continueGesture(n)},t.prototype._onClick=function(e){Date.now()-this._lastActiveMouseUp<100&&e.stopPropagation()},t.prototype._onMouseUp=function(e){0===e.button&&(this._isActive()&&(this._lastActiveMouseUp=Date.now(),e.preventDefault()),this._updateSize(!1),4===this._gestureMode.peek()&&(this._clearGesture(),this._gestureMode(0)),this._isActive(!1),this.events.off(document,"mousedown",this._onMouseDown,!0),this.events.off(document,"mouseup",this._onMouseUp,!0),this.events.off(document,"mousemove",this._onMouseMove,!0),this.events.on(this.element,"mousedown",this._onMouseDown))},t.prototype._onTouchStart=function(e){if(this._isEnabled.peek()){this._isActive.peek()&&(!this._useNativePan||e.touches.length>1)&&e.preventDefault(),this._updateSize(0===this._touchCount);var t=this._touchCount;this._touchCount+=e.changedTouches.length,!t&&this._touchCount?(this._gestureMode(1),this.events.off(this.element,"touchstart",this._onTouchStart),this.events.onAll(document,{touchstart:this._onTouchStart,touchmove:this._onTouchMove,touchend:this._onTouchEnd,touchcancel:this._onTouchCancel},!0)):1===this._gestureMode.peek()&&this._clearGesture(),1===this._gestureMode.peek()&&this._resetGesture(this._getPointsFromTouches(e.touches))}},t.prototype._onTouchMove=function(e){(!this._useNativePan||e.touches.length>1)&&e.preventDefault(),this._updateSize(!1),this._continueGesture(this._getPointsFromTouches(e.touches))},t.prototype._onTouchEnd=function(e){this._isActive.peek()&&e.preventDefault(),this._updateSize(!1),this._removeTouches(e)},t.prototype._onTouchCancel=function(e){this._updateSize(!1),this._removeTouches(e)},t.prototype._removeTouches=function(e){var t=this._touchCount;this._touchCount-=e.changedTouches.length,1===this._gestureMode.peek()&&this._clearGesture(),t&&!this._touchCount?(1===this._gestureMode.peek()&&this._gestureMode(0),this._isActive(!1),this.events.off(document,"touchstart",this._onTouchStart,!0),this.events.off(document,"touchmove",this._onTouchMove,!0),this.events.off(document,"touchend",this._onTouchEnd,!0),this.events.off(document,"touchcancel",this._onTouchCancel,!0),this.events.on(this.element,"touchstart",this._onTouchStart)):1===this._gestureMode.peek()&&this._resetGesture(this._getPointsFromTouches(e.touches))},t.prototype._onPointerDown=function(e){if(this._isEnabled.peek()){var t=this._allowedModes,n=e.pointerType,a="mouse"===n?4:"pen"===n?2:1;if(t&a&&!this._pointers[e.pointerId]){var i=0===this._pointerCount;!this._isActive.peek()||this._useNativePan&&i||e.preventDefault(),this._updateSize(i),this._pointers[e.pointerId]=this._transformToElement(e),this._pointerCount++,i?(this._gestureMode(a),this.events.off(this.element,"pointerdown",this._onPointerDown),this.events.onAll(document,{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerup:this._onPointerUp,pointercancel:this._onPointerCancelOrLost,lostpointercapture:this._onPointerCancelOrLost},!0)):this._isPointerGesture()&&this._clearGesture(),this._isPointerGesture()&&this._resetGesture(this._getPointsFromPointers())}}},t.prototype._onPointerMove=function(e){this._pointers[e.pointerId]&&((!this._useNativePan||this._pointerCount>1)&&e.preventDefault(),this._updateSize(!1),this._pointers[e.pointerId]=this._transformToElement(e),this._isPointerGesture()&&this._continueGesture(this._getPointsFromPointers()))},t.prototype._onPointerUp=function(e){this._isActive()&&e.preventDefault(),this._onPointerCancelOrLost(e)},t.prototype._onPointerCancelOrLost=function(e){this._updateSize(!1),this._removePointers(e)},t.prototype._removePointers=function(e){this._pointers[e.pointerId]&&(delete this._pointers[e.pointerId],this._pointerCount--,this._isPointerGesture()&&this._clearGesture(),0===this._pointerCount?(this._isPointerGesture()&&this._gestureMode(0),this._isActive(!1),this.events.off(document,"pointerdown",this._onPointerDown,!0),this.events.off(document,"pointermove",this._onPointerMove,!0),this.events.off(document,"pointerup",this._onPointerUp,!0),this.events.off(document,"pointercancel",this._onPointerCancelOrLost,!0),this.events.off(document,"lostpointercapture",this._onPointerCancelOrLost,!0),this.events.on(this.element,"pointerdown",this._onPointerDown)):this._isPointerGesture()&&this._resetGesture(this._getPointsFromPointers()))},t.prototype._clearGesture=function(){this._gesturePoints=null,this._initialCenterPx(null)},t.prototype._continueGesture=function(e){this._gesturePoints=e,this._initialCenterPx.peek()||this._resetGesture(e);var t,n=i.e.getCenter(e),a=this._getRadius(e,n),o=this._initialRadius.peek();t=0!==a&&0!==o?a/o:1;var s=this._initialTransformV.peek().scale*t,c=this._constrainScale(s)/s,d=this._initialCenterPx.peek(),l=r.e.zoom(i.e.ORIGIN,d,t*c),u=new r.e(n.subtract(d));this._incrementTransformPx(u.multiply(l)),!this._isActive.peek()&&this._mayStartPan(this._incrementTransformPx.peek(),a-o,e)&&this._isActive(!0)},t.prototype._resetGesture=function(e){this._gesturePoints=e;var t=i.e.getCenter(e),n=this._getRadius(e,t);this._initialCenterPx(t),this._initialRadius(n)},t.prototype._getRadius=function(e,t){for(var n=0,a=0,i=e;a<i.length;a++)n+=i[a].distance(t);return n/e.length},t.prototype._getPointsFromTouches=function(e){for(var t=[],n=0;n<e.length;n++)t.push(this._transformToElement(e[n]));return t},t.prototype._getPointsFromPointers=function(){var e=[];for(var t in this._pointers)e.push(this._pointers[t]);return e},t.prototype._updateSize=function(e){if(void 0===e&&(e=!0),!this._size||e){var t=this.element.getBoundingClientRect();this._size=new i.e(t.width,t.height),this._clientToElementTransform=new r.e(new i.e(-t.left,-t.top))}},t.prototype._transformToElement=function(e){return this._clientToElementTransform.apply(new i.e(e.clientX,e.clientY))},t.prototype._isPointerGesture=function(){return 7&this._gestureMode.peek()},t}(o.t);function l(e,t,n){return e.translate.abs()>=10||Math.abs(t)>=10}function u(e){return e}function f(e,t){return e===t||!(!e||!t)&&e.x===t.x&&e.y===t.y}function p(e,t){return e===t||!(!e||!t)&&f(e.translate,t.translate)&&e.scale===t.scale}t.t=d},2084:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={sharepoint:0,microservice:1}},2090:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(112),i=function(){function e(e,t){this._itemRefreshMessages={},this._itemKeysRefreshed=[]}return e.prototype.getItemRefreshMessage=function(e){return this._itemRefreshMessages?this._itemRefreshMessages[e]:null},e.prototype.setRefreshMessages=function(e){this.clearRefreshMessages();for(var t=0,n=e;t<n.length;t++){var a=n[t];this._itemRefreshMessages[a.id]=a}},e.prototype.clearRefreshMessages=function(){this._itemRefreshMessages={}},e.prototype.hasItemRefreshedRecently=function(e){return-1!==this._itemKeysRefreshed.indexOf(e)},e.prototype.markRecentlyRefreshedItem=function(e){this._itemKeysRefreshed.push(e)},e.prototype.clearRecentlyRefreshedItems=function(){this._itemKeysRefreshed=[]},e.dependencies={},e}(),r=Object(a.r)("RefreshMessageHelper",i)},2099:function(e,t,n){"use strict";var a=n(0),i=n(55),r=n(419),o=function(e){function t(n){var a=e.call(this,n)||this;return a._clearFocusIsUserInput=function(){a.isDisposed||(a._focusIsUserInput=!1)},a._keyForItem=new Map,a._focusIsUserInput=!1,a.mode=n.mode||0,a.maximumSelectedCount=n.maximumSelectedCount,a.getItemKey=n.getItemKey,a._canSelectItem=n.canSelectItem||c,a._selectionModelGroup=n.selectionModelGroup,a._allSelectables={},a._items=[],a.selectedCount=a.createObservable(),a.selection=a.observables.createArray().extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}}),a.isAllSelected=a.createObservable(!1).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}}),a.focusedItem=a.createObservable(),a.focusedItem.equalityComparer=r.n,a.isActive=a.createObservable(!0),a.clear(!0),a._clearFocusIsUserInput=a.async.throttle(a._clearFocusIsUserInput,0,{trailing:!0}),a._selectionModelId="".concat(++t._nextSelectionModelId),a._selectionModelGroup&&a._selectionModelGroup.registerSelectionModel(a,a._selectionModelId),a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"getItemKey",{get:function(){return this._getItemKey},set:function(e){var t=this._keyForItem;t.clear(),this._getItemKey=function(n){var a=t.get(n);return a||(a=e(n),t.set(n,a)),a}},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._selectionModelGroup&&this._selectionModelGroup.unregisterSelectionModel(this._selectionModelId),this._allSelectables={},this._keyForItem.clear()},t.prototype.clear=function(e){this.isSelectedDefaultState=!1,this._keysExempt={},this._exemptCount=0,e&&(this._focusIndex=-1,this._anchorIndex=-1,this._anchorKey=null,this._focusIsUserInput=!1,this.focusedItem(null)),this.selection.removeAll(),this.isAllSelected(!1),this._updateAllSelectables(),this._updateSelectedCount()},t.prototype.setItems=function(e,t){this._items=e,this._selectableItems=this._items,t&&this.clear(!0),this._onItemsChanged(!0)},t.prototype.setAllFocusableItems=function(e){this._items=e,this._focusIndex=-1,this._onItemsChanged(!1)},t.prototype.getItems=function(){return this._items},t.prototype.canSelectItem=function(e){var t=this.getItemKey(e);return(!this.maximumSelectedCount||this.selectedCount()<this.maximumSelectedCount||this.isItemSelected(e))&&t&&this._selectableItemsMap[t]&&this._canSelectItem(e)},t.prototype.isItemSelected=function(e){var t=this.getItemKey(e),n=!!this._keysExempt[t];return this._canSelectItem(e)&&(this.isSelectedDefaultState&&!n||!this.isSelectedDefaultState&&n)},t.prototype.setSelectedKeys=function(e){var t=[];this._keysExempt={};for(var n=0,a=e;n<a.length;n++){var i=a[n],r=this._keyToIndex[i];if(r>=0){var o=this._items[r];this.canSelectItem(o)&&(this._keysExempt[i]=o,t.push(o))}}this._exemptCount=t.length,this.isSelectedDefaultState=!1,this.selection(t),this._updateIsAllSelected(),this._updateSelectedCount(),this._updateAllSelectables(),this._selectionModelGroup&&t.length&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)},t.prototype.isKeySelected=function(e){var t=!!this._keysExempt[e];return!!(this.selectedCount.peek()>0&&this.isAllSelected.peek()&&!t||!this.isAllSelected.peek()&&t)},t.prototype.getFocusedKey=function(){var e=this.focusedItem.peek();return e?this.getItemKey(e):null},t.prototype.isIndexSelected=function(e){var t=this._items[e];return this.isItemSelected(t)},t.prototype.setItemSelected=function(e,t){this._setItemSelectedCore(e,t,!0)},t.prototype.setIndexSelected=function(e,t){this.setItemSelected(this._items[e],t)},t.prototype.toggleItemSelected=function(e){this.setItemSelected(e,!this.isItemSelected(e))},t.prototype.toggleIndexSelected=function(e){this.toggleItemSelected(this._items[e])},t.prototype.setItemFocus=function(e,t){void 0===t&&(t={});var n=t.preventAnchor,a=void 0!==n&&n,i=t.isFocusInput,r=void 0===i||i,o=this.focusedItem.peek(),s=this.getItemKey(e),c=this._keyToIndex[s];if(this._focusIsUserInput=r,e!==o){var d=this.getItemKey(o);this._updateSelectable(d,{focusState:0,isFocused:!1})}c>=0?(d=this.getItemKey(e),this._focusIndex=c,this.focusedItem(e||null),d&&this._updateSelectable(d,{focusState:r?2:1,isFocused:!0})):this.focusedItem(null),a||(this._anchorIndex=c||-1,this._anchorKey=s),this._clearFocusIsUserInput()},t.prototype.setIndexFocus=function(e,t){void 0===t&&(t={}),this.setItemFocus(this._items[e],t)},t.prototype.invokeFocusedItem=function(e){var t=this.focusedItem.peek(),n=this.getItemKey(t),a=this._allSelectables[n];if(a&&a.length)for(var i=0;i<a.length;i++){var r=a[i];if(r.onInvoke)return r.onInvoke(e)}return!0},t.prototype.setIsActive=function(e){this.isActive(e)},t.prototype.selectToItem=function(e){if(1===this.mode)this.setItemSelected(e,!0);else{var t=this._items,n=this.getItemKey(e);if(n){var a=this._keyToIndex[n],i=Math.min(t.length-1,Math.max(0,this._anchorIndex)),r=Math.max(a,i),o=[];if(t.length&&r>=0)for(var s=Math.min(a,i);s<=r;s++)o.push(t[s]);this._setItemsSelected(o,!0)}}},t.prototype.selectToIndex=function(e){this.selectToItem(this._items[e])},t.prototype.selectAll=function(){if(!(this.maximumSelectedCount&&this.maximumSelectedCount<this._selectableItems.length)&&0===this.mode){this.isSelectedDefaultState=!0;for(var e=[],t=0,n=this._selectableItems;t<n.length;t++){var a=n[t];this._canSelectItem(a)&&e.push(a)}this.selection(e),this._keysExempt={},this._exemptCount=0,this._updateIsAllSelected(),this._updateAllSelectables(),this._updateSelectedCount(),this._selectionModelGroup&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)}},t.prototype.toggleSelectAll=function(){this.isAllSelected.peek()||this.maximumSelectedCount<this._selectableItems.length&&this.selectedCount.peek()||1===this.mode&&this.selectedCount.peek()>0?this.clear():this.selectAll()},t.prototype.registerSelectable=function(e,t){var n,a=this;if(!e)throw new Error("Need to specify key or targetItem to register the selectable.");n="string"==typeof e?e:this.getItemKey(e),this._allSelectables[n]||(this._allSelectables[n]=[]),this._allSelectables[n].push(t);var i=this._items[this._keyToIndex[n]],r=this.focusedItem.peek()===i,o=r?this._focusIsUserInput?2:1:0,s=this.isItemSelected(i);return this._updateSelectable(n,{focusState:o,isFocused:r,isSelected:s}),{dispose:function(){if(a._allSelectables&&a._allSelectables[n]){var e=a._allSelectables[n];if(1===e.length)delete a._allSelectables[n];else{var i=e.indexOf(t);i>=0&&e.splice(i,1)}}}}},t.prototype.getFocusIndex=function(){return this._focusIndex},t.prototype.getMissingIndicies=function(){for(var e=[],t=this._items,n=0;t&&n<t.length;n++){var a=t[n];this.isItemSelected(a)&&!this.getItemKey(a)&&e.push(n)}return e},t.prototype.getSelectionModelGroup=function(){return this._selectionModelGroup},t.prototype.getItemByKey=function(e){var t=e?this._keyToIndex[e]:-1;return this.getItemByIndex(t)},t.prototype.getItemByIndex=function(e){return e>=0?this._items[e]:null},t.prototype._setItemSelectedCore=function(e,t,n){var a=this,i=this.getItemKey(e);if(i&&i in this._keyToIndex&&t!==this.isItemSelected(e)){if(t&&!this.observables.ignore(function(){return a.canSelectItem(e)}))return;1===this.mode&&t&&this.clear(),this._keysExempt[i]?delete this._keysExempt[i]:this._keysExempt[i]=e;var r,o=this.selection.peek();r=t?o.concat([e]):o.filter(function(e){return a.getItemKey(e)!==i}),this.selection(r),this._updateSelectable(i,{isSelected:this.isItemSelected(e)}),this._exemptCount+=t?1:-1,this._updateIsAllSelected(),this._updateSelectedCount(),this._selectionModelGroup&&t&&n&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)}},t.prototype._setItemsSelected=function(e,t){var n,a=this,i=this.selection.peek(),r=[],o=[];e.forEach(function(e){var n=a.getItemKey(e);n&&n in a._keyToIndex&&t!==a.isItemSelected(e)&&a.canSelectItem(e)&&(r.push(n),t&&o.push(e),a._keysExempt[n]?delete a._keysExempt[n]:a._keysExempt[n]=e)}),n=t?i.concat(o):i.filter(function(e){return-1===r.indexOf(a.getItemKey(e))}),this.selection(n),r.forEach(function(e){a._updateSelectable(e,{isSelected:t}),a._exemptCount+=t?1:-1}),this._updateIsAllSelected(),this._updateSelectedCount(),this._selectionModelGroup&&t&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)},t.prototype._updateIsAllSelected=function(){if(!this._selectableItems||!this._selectableItems.length)return!1;var e=this.isSelectedDefaultState?this._selectableItems.length-this._exemptCount:this._exemptCount,t=0===this.mode?e===this._selectableItems.length:e>0;this.isAllSelected(t)},t.prototype._updateSelectable=function(e,t){var n=this._allSelectables[e];if(n)for(var a=0,i=n;a<i.length;a++){var r=i[a];for(var o in t){var s=t[o],c=r[o];this.isObservable(c)&&c(s)}}},t.prototype._updateAllSelectables=function(){var e=this;this.observables.ignore(function(){for(var t in e._allSelectables){var n=e._items[e._keyToIndex[t]];n&&e._canSelectItem(n)&&e._updateSelectable(t,{isSelected:e.isItemSelected(n)})}})},t.prototype._onItemsChanged=function(e){var t=this;this._keyToIndex={},this._keyForItem.clear(),e&&(this._selectableItemsMap={});var n=this._items,a=[],i=this.getItemKey(this.focusedItem.peek()),r=this._anchorKey;if(n){for(var o=0,s=function(s){var d=n[s],l=c.observables.ignore(function(){return t.getItemKey(d)});if(l&&(c._keyToIndex[l]=s,e&&(c._selectableItemsMap[l]=!0),i&&i===l&&(c._focusIndex=s),r&&r===l&&(c._anchorIndex=s)),c.isItemSelected(d)){if(c.onAddItem&&!1===c.onAddItem(d))return o++,c._keysExempt[l]=d,"continue";a.push(d)}},c=this,d=0;d<n.length;d++)s(d);this._exemptCount+=o,this._focusIndex=n.length?Math.min(n.length-1,this._focusIndex):-1,this.setIndexFocus(this._focusIndex,{preventAnchor:!0,isFocusInput:!1}),this.selection(a),this._updateIsAllSelected(),this._updateSelectedCount()}},t.prototype._updateSelectedCount=function(){var e=this.isSelectedDefaultState?this._selectableItems.length-this._exemptCount:this._exemptCount;this.selectedCount(e)},t._nextSelectionModelId=1,t}(i.n),s=o;function c(e){return!0}var d=n(1704),l=n(59),u=n(23),f=n(203),p=n(48),m=n(22),_=function(e){function t(t){var n=e.call(this,t)||this,a=t.itemSet,i=void 0===a?n.resources.consume(u.o):a,r=t.indexResolver;return n._itemSet=i,n._indexResolver=r,n}return Object(a.__extends)(t,e),t.prototype.resolveSelection=function(e){var t=this._getUnresolvedIndices(e);return t.length?this._resolveIndices(t):l.n.wrap()},t.prototype._isItemResolved=function(e){return this._indexResolver.isItemResolved(e)},t.prototype._resolveIndices=function(e){return this._indexResolver.resolveIndices(e)},t.prototype._getUnresolvedIndices=function(e){for(var t=this._itemSet.peek().content.peek().items,n=[],a=0,i=e;a<i.length;a++){var r=i[a],o=t[r];this._isItemResolved(o)||n.push(r)}return n},t}(i.n),h=n(1769),b=n(2090),g=n(1851),v=n(1054),y=n(1118),S=function(e){function t(t){void 0===t&&(t={});var n=this,a={getItemKey:I};m.utils.extend(a,t||{}),n=e.call(this,a)||this;var i=t.itemSet,r=void 0===i?n.resources.consume(u.o):i,o=t.indexResolver,s=t.enableSelectionResolution,c=void 0===s||s;return n.itemSet=r,n.itemProvider=n.resources.consume(d.resourceKey),n._enableSelectionResolution=c,n._itemParentHelper=n.resources.consume(h.e),n._refreshMessageHelper=n.resources.consume(b.e),n._currentItems=n.createPureComputed(n.computeCurrentItems),n._itemKey=n.createPureComputed(n._computeItemKey),n._useItemCacheData=n.resources.consume(g.e),n._itemsStore=n.resources.consume(v.e),n.createComputed(function(){n._onItemSetChanged(n._currentItems())}),n.createComputed(n._computeResetSelectionOnKeyChange),o&&(n._selectionResolver=new(n.managed(_))({itemSet:n.itemSet,indexResolver:o})),n._itemCacheToKOStoreDataSource=n._getItemCacheToKOStoreDataSource(),n.observables.backgroundCompute(n._computeOnItemCacheSelectionUpdate),n}return Object(a.__extends)(t,e),t.prototype.resolveSelection=function(){var e=this,t=this.itemSet.peek();if(!t)return l.n.wrap([]);if(this._enableSelectionResolution){if(this._selectionResolver){for(var n=[],a=this.getItems(),i=0;i<a.length;i++)(this.isIndexSelected(i)||!a[i]&&this.isAllSelected.peek())&&n.push(i);return this._selectionResolver.resolveSelection(n).then(function(){return e._unwrapSelection(e.selection.peek())})}var r={resolveAttempt:0,itemSet:t,missingRanges:null,pendingRanges:0,signal:new f.e,getItemPromises:[]};return this.validateResolvedSelection(r),r.signal.getPromise()}return l.n.wrap(this._unwrapSelection(this.selection.peek(),!0))},t.prototype.validateResolvedSelection=function(e){if(e.resolveAttempt++,e.resolveAttempt>4)e.signal.error({resultType:p.e.Failure,resultCode:"TooManyAttempts"});else{var t=this.getMissingRanges();if(e.getItemPromises=[],e.missingRanges=t,e.pendingCount=t.length,0===e.missingRanges.length)e.signal.complete(this._unwrapSelection(this.selection.peek()));else for(var n=0;n<5;n++)this.resolveNextRange(e)}},t.prototype.resolveNextRange=function(e){var t=this;if(e.missingRanges.length>0){var n=e.missingRanges.pop(),a=m.utils.extend({},e.itemSet.context);a.avoidSeamSnapping=!0,a.startIndex=n.start,a.endIndex=n.end,a.pageSize=n.end-n.start+1,e.getItemPromises.push(this.itemProvider.getItem(a).then(function(){e.pendingCount--,e.pendingCount?t.resolveNextRange(e):t.validateResolvedSelection(e)},function(n){t.cancelResolve(e,n)}))}},t.prototype.cancelResolve=function(e,t){for(var n=0;n<e.getItemPromises.length;n++)e.getItemPromises[n].cancel();t?e.signal.error(t):e.signal.cancel()},t.prototype.getMissingRanges=function(){var e=[],t=-1,n=-1,a=this.getMissingIndicies();if(a.length)for(t=a[0],n=a[a.length-1];t>-1;){var i=Math.min(n,t+1e3-1),r={start:t,end:i};e.push(r),t=i===n?-1:i+1}return e},t.prototype.computeCurrentItems=function(){var e=this.itemSet(),t=e&&e.content();return t&&t.items||[]},t.prototype._onItemSetChanged=function(e){var t=this,n=this.itemSet.peek(),a=n&&n.item&&this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(n.item.peek(),"list"));a&&a.list?this.getItemKey=D.bind(void 0,a.list.isDocumentLibrary):this.getItemKey=I;var i=n&&n.item&&n.item.peek()&&n.item.peek().key,r=!!i&&this._refreshMessageHelper.hasItemRefreshedRecently(i);this.onAddItem=r?function(e){return!t.isSelectedDefaultState||-1!==t.selection.indexOf(e)}:void 0,this.setItems(e,!1),this._refreshMessageHelper.clearRecentlyRefreshedItems()},t.prototype._computeResetSelectionOnKeyChange=function(){this._itemKey(),this.clear(!0)},t.prototype._unwrapSelection=function(e,t){void 0===t&&(t=!1);for(var n=[],a=0,i=e;a<i.length;a++){var r=i[a],o=this.peekUnwrapObservable(r);!o&&t||n.push(o)}return n},t.prototype._computeItemKey=function(){var e=this.itemSet(),t=e&&e.item();return t&&t.key},t.prototype._computeOnItemCacheSelectionUpdate=function(){var e=this._itemCacheToKOStoreDataSource();if(e){for(var t=[],n=0,a=e.selectedKOItemKeys();n<a.length;n++){var i=a[n];if(i){var r=this._itemsStore.getItem(i);t.push(this.getItemKey(r))}}0===t.length?this.clear():this.setSelectedKeys(t)}},t.prototype._getItemCacheToKOStoreDataSource=function(){var e=this,t=this.observables.create();return this.observables.backgroundCompute(function(){e._useItemCacheData.peek()?e.resources.consumeAsync(y.e.optional).then(function(e){e&&t(e)}):e._useItemCacheData()}),this.observables.pureCompute(function(){return e._useItemCacheData()?t():void 0})},t}(s);function D(e,t){var n=t&&t.peek&&t.peek();return n&&n.properties&&(e?n.properties.uniqueId:n.properties.ID)||n&&n.key||null}function I(e){var t=e&&e.peek&&e.peek();return t&&t.key||null}t.e=S},2124:function(e,t,n){"use strict";var a=n(0),i=n(48),r=n(42),o=n(1167),s=n(156),c=n(1987),d=n(2981),l=n(1808),u=n(2827),f=n(8),p=new f.t({name:"".concat("MalwareDetection.key",".allowInfectedFileDownloads"),factory:new f.e(!1)}),m=n(119),_=n(36),h=n(91),b=new f.t({name:"".concat("BlockDownloadPolicy.key",".m365GroupsBlockDownloadsExperienceEnabled"),factory:new f.e(!1)}),g=n(11),v=n(13),y='<a href="https://go.microsoft.com/fwlink/?linkid=862871" target="_blank">',S="</a>",D=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.strings=d,a.addBindingHandlers({activate:o.e,control:s.n});var i=t.slide.renderOptions,c=t.showActions,f=void 0===c?!i||!i.hideDownload:c;return a._isOneDriveWinApp=Object(m.e)(),a.showActions=a._isOneDriveWinApp?a.showActionInOneDriveWinApp(t.slide.item().queryType,t.slide.item().type):f,a._allowInfectedDownload=n.allowInfectedDownload,a.malwareDetectedSvgUrl=window.require.toUrl("odsp-media/images/atp/malware_icon_208x208.svg"),a.malwareDetectedIconAlt=d.malwareDetectedIconAriaLabel,a.itemMalwareDetected=a.createPureComputed(function(){var e=t.slide.item();return e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected},{deferEvaluation:!0}),a.fileTypeIconTagName=l.e.tagName,a.fileName=a.createPureComputed(function(){var e=t.slide.item();return e.displayName||e.name},{deferEvaluation:!0}),a.fileTypeIconViewModelParams=a.createPureComputed(function(){var e=t.slide.item();return{iconName:e.iconName,iconUrl:e.iconUrl,extension:e.extension,desiredSize:96}},{deferEvaluation:!0}),a.actionBarControl=Object(s.a)(u.e,{forceExternal:!!i,item:t.slide.item,hideOpenCommand:a.itemMalwareDetected}),a._m365GroupsBlockDownloadsExperienceEnabled=n.m365GroupsBlockDownloadsExperienceEnabled,a.message=a.createPureComputed(function(){var e=t.slide.item();return a.itemMalwareDetected()?a._allowInfectedDownload?r.format(d.malwareDetectedAllowDownloadMessage,y,S):r.format(d.malwareDetectedMessage,y,S):3===e.itemStatus?Object(g.isFeatureEnabled)(g.AuthZenBlockDownloadPolicyBanner)&&a._m365GroupsBlockDownloadsExperienceEnabled?d.blockDownloadPolicyActive:d.blockedByPolicy:d.notPreviewAvaible}),a}return Object(a.__extends)(t,e),t.prototype.activate=function(){var e=this.slide,t=3!==e.item().itemStatus||v.e.isActivated("3E947568-412A-4953-9D24-E87CB8F77760","08/01/2022","Add currentUserRole check for textviewer in itemoverride scenario due to download issue")?this.observables.create({resultType:i.e.ExpectedFailure,resultCode:"Fallback",error:"Fallback viewer loaded"}):this.observables.create({resultType:i.e.ExpectedFailure,resultCode:"BlockedFallback",error:"Fallback viewer loaded due to block policy"});this.scope.attach(e.loadResult.register(t)),e.loadState(3)},t.prototype.showActionInOneDriveWinApp=function(e,t){return e===_.e.SharedWithMe||t===h.e.Folder||t===h.e.Unknown||t===h.e.OneNote||t===h.e.File||t===h.e.Media},t.dependencies=Object(a.__assign)(Object(a.__assign)({},c.e.dependencies),{allowInfectedDownload:p,m365GroupsBlockDownloadsExperienceEnabled:b}),t}(c.e),I=Object(s.t)({automationName:"od-one-up-other",name:"OneUpOther",template:'<div class="OneUp-other" data-bind="activate:$component.activate.bind($component)"><div class="OneUp-other-content">\x3c!--ko if:itemMalwareDetected()--\x3e<div><img class="OneUp-other-malwareDetectedIcon" data-bind="attr:{src:malwareDetectedSvgUrl,alt:malwareDetectedIconAlt}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:itemMalwareDetected()--\x3e<div class="OneUp-other-fileIcon" data-bind="component:{name:fileTypeIconTagName,params:fileTypeIconViewModelParams}"></div>\x3c!--/ko--\x3e<div class="OneUp-other-fileName" data-bind="text:fileName"></div><div class="OneUp-other-message" data-bind="html:message"></div>\x3c!--ko if:showActions--\x3e<div class="OneUp-other-actions" data-bind="control:actionBarControl"></div>\x3c!--/ko--\x3e</div></div>',viewModelType:D});t.e=I},2152:function(e,t,n){"use strict";var a=n(20);Object(a.n)([{rawString:".Carousel{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.Carousel-platform{z-index:0;position:absolute;top:0;left:0;width:100%;height:100%;transform-origin:0 0;touch-action:none}.Carousel-platform.is-enabled{will-change:transform;-webkit-backface-visibility:hidden;backface-visibility:hidden;perspective:1000}.Carousel-slide{position:absolute;left:0;top:0;width:100%;height:100%;z-index:1;opacity:0;visibility:hidden;transition:opacity 0s linear .3s,visibility 0s linear .3s,transform 0s linear}.Carousel-slide.is-current.is-loaded{opacity:1;visibility:inherit;transition-delay:0s,0s,0s}.Carousel-slide.is-current.is-deleted,.Carousel-slide.is-deleted{z-index:0;opacity:0;visibility:hidden;transition-duration:0s,0s,0s;transition-delay:0s,0s,0s}.Carousel-platform.is-enabled .Carousel-slide{will-change:transform;-webkit-backface-visibility:hidden;backface-visibility:hidden;perspective:1000}.Carousel-platform.is-flipping .Carousel-slide{transition-duration:0s,0s,0s;transition-delay:0s,0s,0s}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='1']{z-index:10}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='1'].is-current.is-loaded{transition-duration:.3s,0s,.3s}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='2']{z-index:9}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='2'].is-loaded{transition-duration:.3s,0s,.3s;transition-delay:.3s,.6s,0s}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='3']{z-index:8}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='4']{z-index:7}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='5']{z-index:6}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='6']{z-index:5}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='7']{z-index:4}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='8']{z-index:3}html[dir=ltr] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction='1']{transform:translate(2%,0)}html[dir=rtl] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction='1']{transform:translate(-2%,0)}html[dir=ltr] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction='-1']{transform:translate(-2%,0)}html[dir=rtl] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction='-1']{transform:translate(2%,0)}.Carousel-platform.is-rotating .Carousel-slide{transition-delay:0s,0s,0s;transition-duration:0s,0s,0s}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='2']{transform:translate(204%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='1']{transform:translate(102%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='-1']{transform:translate(-102%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='-2']{transform:translate(-204%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='-1'],.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='-2'],.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='1'],.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='2']{visibility:inherit;opacity:1}.Carousel-platform.is-gliding{transition:transform .3s ease-out}.Carousel-platform.is-gliding .Carousel-slide[data-item-offset='-1'],.Carousel-platform.is-gliding .Carousel-slide[data-item-offset='-2'],.Carousel-platform.is-gliding .Carousel-slide[data-item-offset='1'],.Carousel-platform.is-gliding .Carousel-slide[data-item-offset='2']{transition-delay:.3s,.3s,0s}"}]);var i=n(379),r=n(0),o=n(22),s=n(332),c=n(2017),d=n(1255),l=n(2054),u=n(175),f=n(1714),p=function(e){function t(t){var n=e.call(this,t)||this;return n.addBindingHandlers({host:f.e}),n.item=t.item,n.offset=t.offset,n.loadState=t.loadState||n.observables.create(0),n.order=t.order||n.observables.create(1),n.direction=n.createComputed(n._computeDirection),n}return Object(r.__extends)(t,e),t.prototype._computeDirection=function(){var e=this.offset();return e>0?1:e<0?-1:0},t}(u.t),m=n(2071),_=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.addBindingHandlers({host:f.e,pan:m.t});var i=t.item,r=t.items,o=t.isEnabled,s=void 0===o||o,c=t.isRotating,l=void 0===c?a.createObservable(!1):c,u=t.loadState,p=void 0===u?a.createObservable(0):u,_=t.allocationRange,h=void 0===_?a.createObservable({start:0,end:0}):_;return a.item=i,a._items=r,a._slideAllocationCount=a.createPureComputed(function(){return!t.canNavigate||t.canNavigate()?15:1}),a._allocationRange=h,a.isEnabled=a.wrapObservable(s),a.isRotating=l,a.loadState=p,a._rotationThreshold=.3,a._velocityThreshold=1,a._index=a.createPureComputed(a._computeIndex),a._lastValidIndex=a.createPureComputed(a._computeLastValidIndex),a._itemsInSlides=a.observables.createArray(),a._itemHistory=a.observables.createArray(),a.createBackgroundComputed(a._computeUpdateItemHistory),a.createBackgroundComputed(a._computeCleanItemHistory).extend({rateLimit:{timeout:600,method:"notifyWhenChangesStop"}}),a._elementsToRemove=a.observables.createArray(),a._initializeSlides(),a._initializeMotion(),a.carouselTransform=a.createPureComputed(a._computeCarouselTransform),a.carouselTransform.equalityComparer=d.e,a._initializeDirection(),a.createBackgroundComputed(a._computeSwitchItemsOnItemRemoval),a.createBackgroundComputed(a._computeAllocationRange),a.createBackgroundComputed(a._computeItemsInSlides),a.createBackgroundComputed(a._computeElementsToRemove).extend({rateLimit:{timeout:1e3,method:"notifyWhenChangesStop"}}),a.platformStyle=a.createPureComputed(a._computePlatformStyle),a.panBindingParams={isActive:a.isPowered,isEnabled:a.isEnabled,transform:a.panTransform,mayStartPan:function(e,t,n){return a.isEnabled.peek()&&Math.abs(e.translate.x)>=10&&t<5&&n.length<2},allowedModes:7},a}return Object(r.__extends)(t,e),t.prototype.onSlideRemoved=function(e){o.utils.toggleDomNodeCssClass(e,"is-deleted",!0),o.utils.toggleDomNodeCssClass(e,"is-current",!1),this._elementsToRemove.push(e)},t.prototype._initializeMotion=function(){this.isFlipping=this.createObservable(!0),this.isPowered=this.createObservable(!1),this.isGliding=this.createObservable(!1),this.panTransform=this.createObservable(c.e.IDENTITY),this.panTransform.equalityComparer=d.e,this._initializeVelocity(),this.createBackgroundComputed(this._computeStartPowered),this.createBackgroundComputed(this._computeRotateToSlide),l.e(this.createBackgroundComputed(this._computeStartGlide),this.async),this.createBackgroundComputed(this._computeEndGlide).extend({rateLimit:{timeout:600,method:"notifyWhenChangesStop"}}),this.createBackgroundComputed(this._computeEndRotation)},t.prototype._computeStartPowered=function(){this.isPowered()&&(this.isRotating(!0),this.isGliding(!1),this.isFlipping(!1))},t.prototype._computeStartGlide=function(){var e=this.isPowered(),t=this.isFlipping.peek();e||t||(this.panTransform(c.e.IDENTITY),this.isGliding(!0),this.isRotating(!0))},t.prototype._computeEndGlide=function(){var e=this.isPowered.peek(),t=this.isGliding();!e&&t&&(this.isGliding(!1),this.isRotating(!1))},t.prototype._computeEndRotation=function(){this.isRotating()||this.isFlipping(!0)},t.prototype._initializeDirection=function(){var e=this,t=this._index.peek();this.addDisposable(this.item.subscribe(function(){t=e._index.peek()},this,"beforeChange")),this.createBackgroundComputed(function(){e.isFlipping()&&(t=e._index.peek())}),this.direction=this.createPureComputed(function(){var n=e._index();return e.isFlipping()&&n>-1&&t>-1?Math.max(-1,Math.min(1,n-t)):0})},t.prototype._initializeSlides=function(){var e=this,t=this.addDisposable(this._itemsInSlides.filter(function(t){return t&&(e._items.indexOf(t)>-1||t===e.item())}));this.slides=this.addDisposable(t.map({mappingWithDisposeCallback:function(t){var n=e.createObservable(0),a=e.createPureComputed(function(){return e._items.indexOf(t)}),i=e.createPureComputed(function(){return a()-e._index()}),r=e.createComputed(function(){i()||e.loadState(n())}),o=e.createPureComputed(function(){return e._itemHistory.indexOf(t)+1}),s=new(e.resources.injected(p))({item:t,offset:i,loadState:n,order:o});return{mappedValue:s,dispose:function(){s.dispose(),i.dispose(),a.dispose(),r.dispose(),o.dispose()}}}}))},t.prototype._computeAllocationRange=function(){var e=this.item(),t=this._items,n=t().length,a=this._itemsInSlides.peek(),i=t.indexOf(e),r=a.indexOf(e),o=this._slideAllocationCount();if((-1===r||i>=2&&r<2||i<=n-1-2&&r>a.length-1-2||n<=o&&n!==a.length)&&i>-1)if(o>1){var s=i+this.direction.peek()*(.8*(Math.floor(o/2)-2)),c=Math.max(0,Math.min(n-o,s-Math.floor(o/2))),d=Math.min(n,c+o);this._allocationRange({start:c,end:d})}else this._allocationRange({start:i,end:i+1})},t.prototype._computeItemsInSlides=function(){var e,t,n=this._allocationRange();if(this._index()>-1&&n.end-n.start>0)t=this._items.slice(n.start,n.end);else{var a=this.item();t=a?[a]:[]}(e=this._itemsInSlides).splice.apply(e,Object(r.__spreadArray)([0,this._itemsInSlides.peek().length],t,!1))},t.prototype._computeSwitchItemsOnItemRemoval=function(){var e=this.item.peek(),t=this._items.indexOf(e),n=this._lastValidIndex();if(-1===t&&e&&n>-1){var a=this._items.peek(),i=Math.max(0,Math.min(a.length-1,n));a[i]&&this.item(a[i])}},t.prototype._computeUpdateItemHistory=function(){var e=this.item();this._itemHistory.unshift(e)},t.prototype._computeCleanItemHistory=function(){this._itemHistory().length>1&&this._itemHistory.splice(1,this._itemHistory().length)},t.prototype._computeElementsToRemove=function(){var e;for(this.item(),this._itemsInSlides();e=this._elementsToRemove.shift();)o.removeNode(e)},t.prototype._initializeVelocity=function(){var e=this,t=this.panTransform.peek(),n=0;this.velocity=this.createPureComputed(function(){var a=e.panTransform(),i=(new Date).getTime(),r=a.translate.subtract(t.translate).scale(1e3/(i-n));return n=i,t=a,r}),this.velocity.equalityComparer=d.e},t.prototype._computeRotateToSlide=function(){var e=this.isPowered(),t=this.isFlipping.peek();if(!e&&!t){var n=this.panTransform.peek().translate.negate(),a=this.velocity.peek().negate(),i=this._index.peek(),r=this._calculateFractionalIndexOffset(n,a)+n.x;this.item(this._items.peek()[Math.max(0,Math.min(this._items.peek().length-1,i+Math.round(r)))]),this.panTransform(new c.e(new s.e(this._index.peek(),0).subtract(new s.e(i,0).add(n))))}},t.prototype._calculateFractionalIndexOffset=function(e,t){var n=0;return e.x>this._rotationThreshold&&e.x<.5?n+=.5:e.x<-this._rotationThreshold&&e.x>-.5&&(n-=.5),t.x>this._velocityThreshold&&e.x<.5?n+=.5:t.x<-this._velocityThreshold&&e.x>-.5&&(n-=.5),Math.max(-1,Math.min(1,n))},t.prototype._computeCarouselTransform=function(){var e=this.panTransform().translate,t=this._items.peek().length,n=this._index.peek();-1===n&&(n=0,t=1);var a=-e.x,i=a,r=n+a;if(r<0||r>t-1){var o=a>0?Math.floor:Math.ceil,d=Math.max(0-n,Math.min(t-1-n,o(a))),l=Math.PI;i=Math.atan(l*(a-d))/l+d}return new c.e(new s.e(-i,e.y))},t.prototype._computeIndex=function(){return this._items.indexOf(this.item())},t.prototype._computeLastValidIndex=function(){var e=this._items.indexOf(this.item());if(e<0){var t=this._lastValidIndex.peek();if("number"==typeof t)return t}return e},t.prototype._computePlatformStyle=function(){var e=this.carouselTransform(),t="translate(".concat(100*e.translate.x,"%, 0)");return{"-ms-transform":t,"-webkit-transform":t,transform:t}},t}(u.t),h=i.e({tagName:"ms-carousel",template:"<div class=\"Carousel\"><div class=\"Carousel-platform\" data-bind=\"template:{foreach:slides,beforeRemove:$component.onSlideRemoved.bind($component),dontLimitMoves:true},pan:panBindingParams,style:platformStyle,css:{'is-flipping':isFlipping,'is-rotating':isRotating,'is-enabled':isEnabled,'is-powered':isPowered,'is-gliding':isGliding,'is-rotating-forward':direction()>0,'is-rotating-backward':direction()<0}\"><div class=\"Carousel-slide\" data-bind=\"host:{},attr:{'data-item-offset':offset,'data-item-order':order,'data-item-direction':direction},css:{'is-current':item&&item===$component.item(),'is-loaded':!!loadState()}\"></div></div></div>",viewModel:_,synchronous:!0});t.e=h},2153:function(e,t,n){"use strict";var a=n(20);Object(a.n)([{rawString:".od-OverlayHost{position:absolute;z-index:600;top:0;left:0;bottom:0;right:0;visibility:hidden;overflow:hidden}.od-OverlayHost-content{visibility:visible}.od-OverlayHost-overlay--positioned{position:absolute}"}]);var i='\x3c!--ko focusTrap:{invert:true,isEnabled:hasOverlays}--\x3e<div class="od-OverlayHost" data-bind="clientRect:{size:clientRect,includePosition:true},component:{name:\'od-transclusion-host\',params:{provider:overlayProvider,useCustomTemplate:true}}">\x3c!--ko template:{foreach:getOverlaysInDomOrder.call($component,$host.contexts()),if:isReady,afterAdd:$component.onAddOverlayElement.bind($component),beforeRemove:$component.onRemoveOverlayElement.bind($component)}--\x3e<div class="od-OverlayHost-overlay" data-bind="css:{\'od-OverlayHost-overlay--positioned\':$component.isPositioned(options),\'od-OverlayHost-overlay--initial\':$component.isInitial.peek(),\'od-OverlayHost-overlay--opened\':options.animation&&options.animation.isOpen&&options.animation.isOpen(),\'od-OverlayHost-overlay--closed\':options.animation&&options.animation.isOpen&&!options.animation.isOpen()},style:$component.getOverlayStyle(options,parentElement)"><div class="od-OverlayHost-content" data-bind="focusTrap:{before:options.topTab,after:options.bottomTab}">\x3c!--ko transclusionHost:{context:$data,virtualChildElement:$element.parentNode}--\x3e\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e',r=(n(1989),n(379)),o=n(0),s=n(22),c=n(175),d=n(1877),l=n(243),u=n(1940),f=n(1729),p=n(1789),m=n(1102),_=n(150),h="od-OverlayHost-overlay--opened",b="od-OverlayHost-overlay--initial",g=s.utils.toggleDomNodeCssClass,v=s.removeNode;function y(e){for(var t,n=[];(t=Object(_.e)(e))&&t.children;){var a=Array.prototype.indexOf.call(t.children,e);n.unshift(a),e=t}return n}function S(e,t){return function(e,t){for(var n=0;n<e.length&&n<t.length;n++){if(e[n]<t[n])return-1;if(e[n]>t[n])return 1}return e.length<t.length?-1:e.length>t.length?1:0}(e.shadowPosition,t.shadowPosition)}var D=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.addBindingHandlers({transclusionHost:u.e,focusTrap:f.e,clientRect:p.e}),a._onAddOverlay=t.onAddOverlay,a._onRemoveOverlay=t.onRemoveOverlay;var i=a.observables;return a.overlayProvider=a.resources.consume(d.e),a.hasOverlays=i.pureCompute(a._computeHasOverlays),a.topTab=i.create(),a.bottomTab=i.create(),a.isReady=i.create(!1),a.isInitial=i.create(!0),a.clientRect=i.create(),a.async.requestAnimationFrame(a._onIsReadyTimeoutCompleted),a}return Object(o.__extends)(t,e),t.prototype.onAddOverlayElement=function(e,t,n){var a=this,i=n.options.animation,r=i&&i.afterAdd;void 0===(i&&i.isOpen)?r?this.async.setTimeout(function(){e.nodeType===Node.ELEMENT_NODE&&(g(e,h,!0),g(e,b,!1)),n.options.isOpen(!0),a._onAddOverlay&&a._onAddOverlay()},r):(e.nodeType===Node.ELEMENT_NODE&&(g(e,h,!0),g(e,b,!1)),n.options.isOpen(!0),this._onAddOverlay&&this._onAddOverlay()):this._onAddOverlay&&this._onAddOverlay()},t.prototype.onRemoveOverlayElement=function(e,t,n){var a=this,i=n.options.animation,r=i&&i.beforeRemove;void 0===(i&&i.isOpen)?r?(e.nodeType===Node.ELEMENT_NODE&&(g(e,b,!1),g(e,h,!1),g(e,"od-OverlayHost-overlay--closed",!0)),n.options.isOpen(!1),this.async.setTimeout(function(){v(e),a._onRemoveOverlay&&a._onRemoveOverlay()},r)):(n.options.isOpen(!1),v(e),this._onRemoveOverlay&&this._onRemoveOverlay()):this._onRemoveOverlay&&this._onRemoveOverlay()},t.prototype.getOverlaysInDomOrder=function(e){var t=e.map(function(e){return{overlay:e,shadowPosition:y(e.parentElement)}});return t.sort(S),t.map(function(e){return e.overlay})},t.prototype.isPositioned=function(e){return e.alignToParent()},t.prototype.getOverlayStyle=function(e,t){if(!this.isPositioned(e))return{};var n=this.clientRect(),a=l.e.calculateRect(e.parentElement||t);return e.parentElement||0!==a.x||(a=m.e.calculateParentRect(t,a)),n?{top:"".concat(a.getTop()-n.top,"px"),left:"".concat(a.getLeft()-n.left,"px"),right:"".concat(n.width-a.getRight(),"px"),bottom:"".concat(n.height-a.height,"px")}:void 0},t.prototype._onIsReadyTimeoutCompleted=function(){this.isReady(!0),this.isInitial(!1)},t.prototype._computeHasOverlays=function(){return this.overlayProvider.contexts().length>0},t}(c.t),I=n(156),x=r.e({tagName:"od-overlay-host",template:i,viewModel:D,synchronous:!0});t.e=x,Object(I.t)({name:"OverlayHost",template:i,automationName:"od-overlay-host",viewModelType:D})},2189:function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"t",function(){return d});var a=n(0),i={themeName:"Office",themeDescription:"Default theme",themePrimary:"#0078d4",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#005a9e",themeDarker:"#004578",neutralLighterAlt:"#f8f8f8",neutralLighter:"#f4f4f4",neutralLight:"#eaeaea",neutralQuaternaryAlt:"#dadada",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c8c8",neutralTertiary:"#a6a6a6",neutralSecondaryAlt:"#767676",neutralSecondary:"#666666",neutralPrimary:"#333",neutralPrimaryAlt:"#3c3c3c",neutralDark:"#212121",black:"#000000",white:"#fff",primaryBackground:"#fff",primaryText:"#333"},r={themeName:"Dark Mode",themeDescription:"(Dark) A dark theme based on the default.",themePrimary:"#2899f5",themeLighterAlt:"#0c2031",themeLighter:"#043862",themeLight:"#092C47",themeTertiary:"#185f00",themeSecondary:"#004C87",themeDarkAlt:"#3AA0F3",themeDark:"#6CB8F6",themeDarker:"#82c7ff",neutralLighterAlt:"#282828",neutralLighter:"#201f1e",neutralLight:"#252423",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondary:"#a19f9d",neutralPrimaryAlt:"#c8c6c4",neutralPrimary:"#f3f2f1",neutralDark:"#FAF9F8",black:"#ffffff",white:"#1b1a19",primaryBackground:"#1f1f1f",primaryText:"#f3f2f1",bodyBackground:"#1f1f1f",bodyText:"#ffffff",disabledBackground:"#1d1d1d",disabledText:"#797775"},o={themeName:"ODB Dark Mode",themeDescription:"ODB dark mode",themePrimary:"#2899f5",themeLighterAlt:"#092c47",themeLighter:"#043862",themeLight:"#004c87",themeTertiary:"#0078D4",themeSecondary:"#0078d4",themeDarkAlt:"#3aa0f3",themeDarker:"#82c7ff",themeDark:"#6cb8f6",neutralLighterAlt:"#201f1e",neutralLighter:"#252423",neutralLight:"#292827",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondaryAlt:"#979693",neutralSecondary:"#a19f9d",neutralPrimary:"#f3f2f1",neutralPrimaryAlt:"#c8c6c4",neutralDark:"#faf9f8",black:"#ffffff",white:"#1b1a19",redDark:"#F1707B",primaryBackground:"#1b1a19",primaryText:"#f3f2f1",whiteTranslucent40:"rgba(0,0,0,.5)",freOverlayColor:"rgba(0,0,0,.5)",shareSuccessIcon:"#92C353",wordColor:"#296FE6",powerpointColor:"#CA5010",excelColor:"#10893C",excelPrimaryColor:"#10893C",excelShade10Color:"#0F7937",excelShade20Color:"#0A5325",powerpointPrimaryColor:"#CA5010",powerpointShade10Color:"#B1470E",powerpointShade20Color:"#79310A",wordPrimaryColor:"#296FE6",wordShade10Color:"#2461CA",wordShade20Color:"#19428A",wordIconColor:"#598FEC",powerpointIconColor:"#D67540",excelIconColor:"#37A660",visoIconColor:"#598FEC",oneNoteIconColor:"#D0AFE2",oneUpPaneBackground:"rgba(27, 26, 25, .75)"},s={bodyBackground:o.primaryBackground,bodyStandoutBackground:o.neutralLight,buttonText:o.black,buttonTextPressed:o.neutralDark,buttonTextHovered:o.neutralPrimary,bodySubtext:o.neutralSecondary,disabledBackground:o.neutralQuaternaryAlt,errorText:o.redDark,inputBackgroundChecked:o.themePrimary,menuBackground:o.neutralLighter,menuItemBackgroundHovered:o.neutralQuaternaryAlt,menuItemBackgroundPressed:o.neutralQuaternary,menuDivider:o.neutralTertiaryAlt,menuIcon:o.themeDarkAlt,menuHeader:o.black,menuItemText:o.neutralPrimary,menuItemTextHovered:o.neutralDark,messageText:o.neutralPrimary,primaryButtonBackground:o.themeTertiary,primaryButtonBackgroundHovered:o.themeLight,primaryButtonBackgroundPressed:o.themeLighter,primaryButtonText:o.black,primaryButtonTextHovered:o.black,primaryButtonTextPressed:o.black,variantBorder:o.neutralQuaternary,infoBackground:o.neutralQuaternaryAlt,infoIcon:o.neutralPrimaryAlt,errorIcon:o.redDark,warningIcon:o.neutralPrimaryAlt,blockingIcon:"#442726",severeWarningIcon:"#FCE100",successIcon:"#92C353",errorBackground:"#442726",blockingBackground:"#442726",warningBackground:"#433519",severeWarningBackground:"#4F2A0F",successBackground:"#393D1B"},c=Object(a.__assign)(Object(a.__assign)({},o),{white:"#252423",neutralLighterAlt:"#292827",neutralLighter:"#323130",neutralLight:"#3B3A39",neutralQuaternaryAlt:"#484644",themePrimary:"#3AA0F3",themeDarkAlt:"#6CB8F6",themeDark:"#82C7FF"}),d=(Object(a.__assign)(Object(a.__assign)({},s),{bodyStandoutBackground:c.neutralLight,disabledBackground:c.neutralQuaternaryAlt,inputBackgroundChecked:c.themePrimary,menuBackground:c.neutralLighter,menuItemBackgroundHovered:c.neutralQuaternaryAlt,menuIcon:c.themeDarkAlt}),{palette:o,semanticColors:s,isInverted:!0})},2196:function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a=n(0),i=n(11),r=n(55),o=n(112),s=n(106),c=n(63),d=n(81),l=n(99),u=n(459),f=n(311),p=n(281),m="CoachmarkTearDropSeen",_={campaignGuid:"00000000-0000-0000-0000-000000000000",endDate:new Date(1970,1,1),flag:i.Off,isCoachmark:!0},h=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;a._dataStore=new s.e("CoachmarkProvider",c.e.session),a._currentCampaign=a.createObservable(_),a._isVisible=a.createObservable(!1),a._navigation=n.navigation,a._firstRunExperienceStatus=n.firstRunExperienceStatus,a._currentTeachingBubble=a.createObservable({campaign:a._currentCampaign,isVisible:a._isVisible}),a._navigation.viewParams.resetAllBubbles&&a._dataStore.remove(m);var i=a.resources.consume(p.e);return a._teachingBubbleProviderPromise=i.waitForPLT().then(function(){return a.resources.consume(l.A)}),a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._isVisible},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentCampaign",{get:function(){return this._currentCampaign},enumerable:!1,configurable:!0}),t.prototype.hideCampaign=function(){this._isVisible(!1),this._currentCampaign(_)},t.prototype.setCampaign=function(e){var t=this;if(!e)return this._currentCampaign(_),void this._isVisible(!1);if(this._firstRunExperienceStatus.get()!==f.e.visible){var n="".concat(e.name).concat(m);this._dataStore.getValue(m)||this._teachingBubbleProviderPromise.then(function(a){a&&a.shouldBubbleBeAdded(e,!1).then(function(a){a&&(t._currentCampaign(e),t._isVisible(!0),t._dataStore.setValue(n,!0))})})}},t.prototype.getCurrentTeachingBubble=function(){return this._currentTeachingBubble},t.dependencies=Object(a.__assign)(Object(a.__assign)({},r.n.dependencies),{navigation:d.e,firstRunExperienceStatus:u.e}),t}(r.n),b=Object(o.r)("CoachmarkProvider",h)},2206:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n(55),r=n(23),o=n(99),s=n(112),c=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._getCurrentPageName=t.getCurrentPageName,a._getFocusPageName=t.getFocusPageName||d,a._itemSet=t.itemSet,a._focusItem=t.focusItem,a._isOneUp=a.observables.wrap(t.isOneUp),a._instrumentationProvider=n.instrumentationProvider,a._viewParams=n.viewParams,a._initializeReportPageView(),a}return Object(a.__extends)(t,e),t.prototype._initializeReportPageView=function(){var e=this;this.observables.backgroundCompute(function(){if(e._itemSet){var t=e._viewParams.peek();if(e._isOneUp()&&e._focusItem){i=(a=e._itemSet.peek()).item.peek();var n=e._focusItem();n&&(n.peek().isPlaceholder?n():e._instrumentationProvider.userViewPage({viewParams:t,item:n.peek(),name:"".concat(e._getCurrentPageName({currentItem:i,viewParams:t}),"-").concat(e._getFocusPageName({currentItem:i,focusItem:n.peek(),viewParams:t}))}))}else{var a,i;(i=(a=e._itemSet()).item.peek()).isPlaceholder?a.item():a.isPlaceholder?a.content():e._instrumentationProvider.userViewPage({viewParams:t,item:i,name:e._getCurrentPageName({currentItem:i,viewParams:t})})}}else t=e._viewParams.peek(),e._instrumentationProvider.userViewPage({viewParams:t,name:e._getCurrentPageName({viewParams:t})})}).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{instrumentationProvider:o.d,viewParams:r.F}),t}(i.n);function d(){return"OneUp"}var l=Object(s.o)("PageViewReporter",c)},2209:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(112),r=new a.t({name:"LegacyDetailsPaneHost.key",loader:new i.t(function(){return n.e(145).then(n.bind(null,2541)).then(function(e){return e.resourceKey.local})})})},2217:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(8),i=n(55),r=n(1898),o=n(1139),s=new a.t({name:"".concat("isOfflineStateLegacyKOObservable.key",".isOfflineStateLegacyKOObservable"),factory:{dependencies:{observablesFactoryTypeKey:i.i,isOfflineStateObservable:r.e},create:function(e){var t=e.isOfflineStateObservable,n=new o.e,a=n.attach(new e.observablesFactoryTypeKey).create(t.get());return n.attach({dispose:t.subscribe(function(){a(t.get())})}),{instance:a,disposable:n}}}})},2244:function(e,t,n){"use strict";var a=n(1767),i=n(0),r=n(1751),o=n(223),s=n(1748),c=n(2054),d=n(48),l=n(156),u=n(2124),f=n(1987),p=n(79),m=n(11),_=n(251),h=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:l.n}),r.thumbnailTagName=a.e.tagName;var s=r,d=s.observables,f=s.slide,p=t.slide.renderOptions,h=t.scale,b=void 0===h?d.create(1):h,g=t.size,v=void 0===g?r.oneUp.size:g,y=t.allowLoading,S=void 0===y?d.create(!0):y,D=t.fallbackThumbnail,I=t.showErrorActions,x=void 0===I?!p||!p.hideDownload:I,C=t.allowError,O=void 0===C||C,w=t.item,E=void 0===w?f.item:w,A=t.isPreview,L=t.expectLoadingFailure,k=void 0===L||L;r._item=E,r._scale=b,r._size=v,r._fallbackThumbnail=D,r._allowError=d.wrap(O),r._expectLoadingFailure=!!k,r._isLoaded=d.create(!1),r._isRendered=d.create(!1),d.backgroundCompute(r._updateSlideLoadState);var M=r._getImageAndRotation(),P=M.image,T=M.rotation;r._image=P,r._desiredSize=d.pureCompute(r._computeDesiredSize),r._desiredSize.equalityComparer=_.t,r._rotation=T,r._markAccess=Object(m.isFeatureEnabled)(m.ReportOneUpFileAccess)&&d.pureCompute(function(){return!A&&!f.offset()}),r._error=d.create(),r._fadeIn=d.pureCompute(function(){return Math.abs(r.slide.offset())<2}),r._allowLoading=d.pureCompute(function(){var e=S(),t=r.oneUp.isRotating();return e&&!t}),r._coverage=c.t(d.pureCompute(r._computeImageFrameCoverage),_.t),r.hasThumbnail=d.pureCompute(r._computeHasThumbnail),r.thumbnailParams=d.pureCompute(r._computeThumbnailParams),r.hasError=d.pureCompute(r._computeHasError);var U=Object(i.__assign)(Object(i.__assign)({},t),{showActions:x,slide:Object(i.__assign)(Object(i.__assign)({},t.slide),{loadResult:d.createCallback(Object(o.t)())})});r.fallbackControl=Object(l.a)(u.e,U);var F=r._result=d.pureCompute(r._computeResult);return r.scope.attach(t.slide.loadResult.register(F)),r}return Object(i.__extends)(t,e),t.prototype._getImageAndRotation=function(){var e=this.observables.pureCompute(this._computeImage);e.equalityComparer=_.t;var t=this.observables.pureCompute(this._computeRotation),n=this.observables.create(e.peek());n.equalityComparer=_.t;var a=this.observables.create(t.peek());return this.observables.backgroundCompute(function(){var i=e(),r=t();n(i),a(r)}),{image:n,rotation:a}},t.prototype._computeImage=function(){var e=this._item(),t=(e.orientedThumbnail||e).thumbnail||this.unwrapObservable(this._fallbackThumbnail),n=this._markAccess;if(n){var a=t&&t.url;if(a&&a.indexOf("provider=spo")>=0){var r=a.replace(/&(width|height)=[^&]*/g,""),o=n()?"Access":"Preview";return Object(i.__assign)(Object(i.__assign)({},t),{action:o,getAligned:function(e){return{width:e.width,height:e.height,url:"".concat(r,"&width=").concat(0|e.width,"&height=").concat(0|e.height,"&action=").concat(o)}}})}}return t},t.prototype._computeRotation=function(){var e=this._item().orientedThumbnail;return e?e.rotation:r.e.none},t.prototype._computeImageFrameCoverage=function(){var e,t=this._image(),n=this._size();return t.width&&t.height&&(t.width>n.width||t.height>n.height)&&(e=.25),{minimum:0,maximum:1,fallback:e}},t.prototype._computeHasThumbnail=function(){return!(!this._size().width||!this._image()||!this.slide.loadState()&&this.hasError())},t.prototype._computeResult=function(){var e=this._result.peek();if(e)return e;var t=this._error();if(t){var n=void 0,a=!("personal"!==(this._item().graph||{}).driveType),i=this._expectLoadingFailure&&a;return t instanceof p.e&&(n=t.code,i=t.isExpected),{resultType:i?d.e.ExpectedFailure:d.e.Failure,resultCode:n||"LoadFailure",error:"Unable to load image"}}return this._isLoaded()?{resultType:d.e.Success}:void 0},t.prototype._computeHasError=function(){var e=this.hasError.peek();if(!e){e=this._allowError()&&!!this._error();var t=this._error();if(t&&t instanceof Array)for(var n=0;n<t.length;n++)if(t[n]&&"NeedAccessToken"===t[n].message)return!1}return e},t.prototype._computeDesiredSize=function(){var e=this._size(),t=this._image();if("Preview"!==(t&&t.action))return e;var n=Math.max(e.width,e.height),a=t&&Math.max(t.width,t.height)||0;if(a&&n>a)return b(a);for(var i=0,r=[400,960,1600,2560];i<r.length;i++){var o=r[i];if(a&&o>a)return b(a);if(o>n)return b(o)}return b(2560)},t.prototype._computeThumbnailParams=function(){var e;return this.hasThumbnail()&&(e={image:this._image,rotation:this._rotation,desiredSize:this._desiredSize,scale:this._scale,error:this._error,alignment:s.e.fit,fadeIn:this._fadeIn,isCurrent:this._isLoaded,isLoaded:this._isRendered,coverage:this._coverage,allowLoading:this._allowLoading}),e},t.prototype._updateSlideLoadState=function(){var e=this.slide.loadState;this._isLoaded()?e(3):this._isRendered()&&e(2)},t}(f.e);function b(e){return{width:e,height:e}}var g=Object(l.t)({automationName:"od-one-up-thumbnail",name:"OneUpThumbnail",template:"\x3c!--ko if:hasError--\x3e\x3c!--ko control:fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:!hasError()&&hasThumbnail()--\x3e\x3c!--ko component:{name:thumbnailTagName,params:thumbnailParams}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e",viewModelType:h});t.e=g},2264:function(e,t,n){"use strict";var a=n(0),i=n(161),r=n(775),o=n(22),s=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;return a._isActive=a.observables.create(!0),new(a.managed(r.t))({element:a.element,allBindingsAccessor:a.allBindingsAccessor,bindingContext:a.bindingContext,valueAccessor:function(){return{isActive:a._isActive}}}),o.applyBindingsToNode(a.element,{attr:{"aria-hidden":a.observables.pureCompute(function(){return a._isActive()?void 0:"true"})}},a.bindingContext),a}return Object(a.__extends)(t,e),t}(i.t);t.e=s},2292:function(e,t,n){"use strict";n.d(t,"n",function(){return I}),n.d(t,"e",function(){return x});var a=n(0),i=n(424),r=n(25),o=n(2352),s=n(42),c=n(23),d=n(11),l=n(55),u=n(276),f=n(8),p=n(112),m=new f.t({name:"Share.key",loader:new p.t(function(){return n.e(399).then(n.bind(null,4329)).then(function(e){return e.resourceKey.local})})}),_=m,h=n(1054),b=n(2217),g=n(183),v=n(2001),y=n(1043),S=n(787),D=n(59),I=v.shareFocusItemResourceKey,x=v.copyLinkFocusItemResourceKey,C=v.copyFormLinkFocusItemResourceKey,O=v.shareFromDetailPaneFocusItemResourceKey,w=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this,i=a,r=i.observables,o=i.resources,s=t.renderLabel,l=void 0===s?0:s,u=t.mode,f=t.item,p=t.engagementName,m=t.automationId,_=t.location;return a._automationId=m,a._mode=u,a._overrideSelectedItem=f&&f.peek(),a._overrideEngagementName=p,a._copyLinkShortcut=1===a._mode||3===a._mode,a._hideShareDialogOverflowButton=2===a._mode,a._actionMap=o.consume(c.e),a._itemsStore=o.consume(h.e),Object(d.isFeatureEnabled)(d.ShareV3)&&(a._focusItemResourceKey=a._getShareItemResourceKey(),a._itemBeingShared=o.consume(a._focusItemResourceKey),r.backgroundCompute(a._computeIsOpen)),a._renderLabel=l,a._location=_,a._initializeCommand(),a}return Object(a.__extends)(t,e),t.prototype._initializeCommand=function(){var e=this._getCommandProperties();this.command=new(this.managed(i.e))(e)},t.prototype._computeIsOpen=function(){this._itemBeingShared()&&this.command.isOpen(!0)},t.prototype._computeShouldClearItem=function(){this.command.isOpen()||this._itemBeingShared(void 0)},t.prototype._resizeShare=function(){this._registeredClear||(this._registeredClear=!0,this.observables.backgroundCompute(this._computeShouldClearItem))},t.prototype._dismissShare=function(){this._itemBeingShared(void 0)},t.prototype._getPayload=function(){var e=this,t=this.observables,n=this.createPureComputed(this._computeShareParams),a=this.createPureComputed(function(){return!!e._itemBeingShared()}),i=t.create();return t.backgroundCompute(function(){a.peek()?e.trackPromise(D.n.resolve(e.resources.consumeAsync(_.local))).done(function(e){i(e)}):a()}),this.createPureComputed(function(){var e=i(),t=n();if(e&&t)return e.toSpecification(t)})},t.prototype._computeShareParams=function(){var e=this._itemBeingShared(),t=e?this._itemsStore.getItem(e.items[0].key):void 0;if(t)return{item:t,copyLinkShortcut:this._copyLinkShortcut,onDismiss:this._dismissShare.bind(this),onResize:this._resizeShare.bind(this),hideShareDialogOverflowButton:this._hideShareDialogOverflowButton,mode:4===this._mode?y.e.addPeople:void 0,scenarioId:e.scenarioId,defaultRecipients:e.defaultRecipients,isEdit:e.isEdit,isSecureShare:e.isSecureShare,clickTime:Date.now()}},t.prototype._getShareItemResourceKey=function(){switch(this._mode){default:return I;case 1:return x;case 2:return O;case 3:return C;case 4:return v.shareFromGrantAccessItemResourceKey}},t.prototype._getCommandProperties=function(){var e,t={text:void 0,accessibleLabel:void 0,tooltip:void 0,icon:void 0,keys:void 0,action:void 0,payload:void 0,engagementName:void 0,renderLabel:this._renderLabel,enableRecoverFocusBinding:void 0,beakColor:void 0,location:void 0,automationId:this._automationId},n=Object(d.isFeatureEnabled)(d.ShareV3);4===this._mode?(t.text=r.grantAccess,t.icon=new u.e("PlayerSettings"),e=r.grantAccessCommandLabel):this._copyLinkShortcut?(t.text=n?r.CopyLinkCommandText:r.GetLink,e=r.CopyLinkCommandTooltipV3,t.icon=new u.e("Link")):(t.text=r.Share,e=r.ShareCommandTooltipV3,t.icon=new u.e("Share"),t.keys=["S"]),this._overrideEngagementName?t.engagementName=this._overrideEngagementName:this._copyLinkShortcut?t.engagementName="GetLink":t.engagementName="Share",n?(t.action=new(this.managed(this._actionMap.ShowShareAction))({focusItemResourceKey:this._focusItemResourceKey,overrideItem:this._overrideSelectedItem}),t.payload={control:this._getPayload(),timeout:36e5,announce:!1,autoDismiss:!0,preventDismissOnScroll:!0,preventDismissOnResize:!0},t.enableRecoverFocusBinding=!1,t.beakColor=g.e.neutralLighterAlt):this._copyLinkShortcut?t.action=new(this.managed(this._actionMap.GetLinkAction)):t.action=new(this.managed(this._actionMap.ShareByLinkAction))({sharingMethod:2}),t.location=Object(S.a)()?4:this._location;var a=this.resources.consume(b.e),i=this.createPureComputed(function(){return a()}),c=this.createPureComputed(function(){return a()?s.format(o.i,e):e}),l=this.createPureComputed(function(){return a()?s.format(o.i,t.text):t.text});return t.isDisabled=i,t.tooltip=c,t.accessibleLabel=l,t.prependTextToAccessibleLabel=!1,t},t}(l.n);t.t=w},2337:function(e,t,n){"use strict";var a=n(0),i=n(1056),r=n(1769),o=n(773),s=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=t.item,s=n.getItemSelectionHelperType,c=void 0===s?a.resources.consume(o.e.lazy):s,d=n.itemParentHelper,l=void 0===d?a.resources.consume(r.e):d;return a.isItemSpecified=!!i,a.item=i||new(a.scope.attached(c()))({canFallback:!0,ignoreSelection:!0}).currentItem,a.itemParentHelper=l,a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return!!this.item()},t.prototype.getParent=function(e,t,n){var a=this.itemParentHelper.getFacetedAncestorOrSelf(e,t);return n?this.peekUnwrapObservable(a):this.unwrapObservable(a)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.e.dependencies),{getItemSelectionHelperType:o.e.lazy,itemParentHelper:r.e}),t}(i.e);t.e=s},2366:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return Pt});var a=n(20);Object(a.n)([{rawString:".OneUp{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden;outline:0;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.OneUp.OneUp--darkBackground{background-color:#1b1a19}.OneUp-detailsBar{visibility:hidden;opacity:0}.OneUp-detailsBar .CommandBarItem{flex:0 0 auto}html[dir=ltr] .OneUp-detailsBar .CommandBarItem{margin-right:0}html[dir=rtl] .OneUp-detailsBar .CommandBarItem{margin-left:0}.OneUp-detailsBar .CommandBarItem .CommandBarItem-icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.OneUp-detailsBar .CommandBarItem{background-color:"},{theme:"menuItemBackgroundHovered",defaultValue:"#f3f2f1"},{rawString:";opacity:.9}.OneUp-detailsBar .CommandBarItem.is-toggled,.OneUp-detailsBar .CommandBarItem.is-toggled:hover,.OneUp-detailsBar .CommandBarItem:hover{background-color:"},{theme:"menuItemBackgroundPressed",defaultValue:"#edebe9"},{rawString:";opacity:1}.OneUp-toolbarHost{display:flex;flex-flow:column-reverse nowrap;justify-content:center;align-items:center}.OneUp-toolbar{background-color:transparent;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";height:44px;display:flex;align-items:stretch;justify-content:center;flex-flow:row nowrap}.lg .OneUp-toolbar,.xlg .OneUp-toolbar,.xxlg .OneUp-toolbar,.xxxlg .OneUp-toolbar,.xxxxlg .OneUp-toolbar{height:40px}.OneUp-commandBar{position:absolute;left:0;right:0;top:-44px;z-index:2;visibility:hidden;height:44px;transition:visibility 267ms linear,top 267ms linear;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem:hover{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Word{background-color:"},{theme:"wordColor",defaultValue:"#2b579a"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Word .ms-Icon--WordLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Word .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Excel{background-color:"},{theme:"excelColor",defaultValue:"#217346"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Excel .ms-Icon--ExcelLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Excel .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint{background-color:"},{theme:"powerpointColor",defaultValue:"#d24726"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint .ms-Icon--PowerPointLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PDF{background-color:#c90304;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PDF .ms-Icon--PDF:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PDF .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PrimaryButton{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PrimaryButton:hover{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .ms-CommandBar{padding:0}.sm .OneUp-commandBar{top:-44px;height:44px}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar{padding-right:2px;border:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar{margin:0 4px}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.hide-label .ms-Button-label{display:none}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton{margin:6px 14px 6px 10px;padding:8px;border-radius:"},{theme:"roundedCorner4",defaultValue:"4px"},{rawString:"}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton .ms-Button-textContainer{padding-bottom:4px}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--editPhoto{width:82px;margin:6px 14px 6px 18px;background:#0078d4;color:#fff;height:auto;padding:10px 0;border-radius:4px}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--editPhoto::after{outline:#fff 1px solid}.md .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar,.sm .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar{height:auto}.md .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar .ms-Button-icon,.sm .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar .ms-Button-icon{font-size:16px}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar i[data-icon-name=More]{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.is-disabled i[data-icon-name=Next],.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.is-disabled i[data-icon-name=Previous]{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";opacity:.3}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--separator{margin:0;padding:0;min-width:29px}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar i[data-icon-name=Separator]{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--pageCount{margin:0 8px}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar i[data-icon-name=Cancel]{color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:"}.md .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar,.sm .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar{height:44px}.CommandBar-center{text-align:center}.OneUp-accessibleItemAnnouncement{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.OneUp-content{position:absolute;left:0;top:0;bottom:0;right:0;transition:top 267ms linear,left 367ms cubic-bezier(.1,.9,.2,1),right 367ms cubic-bezier(.1,.9,.2,1)}.OneUp-carousel{position:absolute;left:0;right:0;top:0;bottom:0;z-index:1;transition:top 267ms linear}.sm .OneUp--hasCommandBar .OneUp-paneHost{top:44px}.OneUp--hasCommandBar .ms-Button--commandBar .ms-Button-menuIcon{background-color:inherit}.OneUp--hasCommandBar .ms-Button--commandBar.is-disabled{background-color:inherit;color:inherit}.OneUp--hasCommandBar .OneUp-content,.OneUp--hasCommandBar .OneUp-paneHost{top:44px}.OneUp--hasCommandBar .OneUp-commandBar{visibility:visible;top:0}html[dir=ltr] .OneUp--hasCommandBar .OneUp-commandBar{padding-left:16px}html[dir=rtl] .OneUp--hasCommandBar .OneUp-commandBar{padding-right:16px}.OneUp-detailsBar{transition:visibility 0s linear 267ms,opacity 267ms linear,bottom 267ms linear;position:absolute;left:0;right:0;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";z-index:1}[dir=ltr] .lg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .md .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xlg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xxlg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xxxlg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xxxxlg .OneUp--hasInfoPane .OneUp-content{right:320px}[dir=rtl] .lg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .md .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xlg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xxlg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xxxlg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xxxxlg .OneUp--hasInfoPane .OneUp-content{left:320px}[dir=ltr] .OneUp--hasInfoPane .OneUp-paneHost{right:0}[dir=rtl] .OneUp--hasInfoPane .OneUp-paneHost{left:0}.sm .OneUp--hasInfoPane .OneUp-infoPane,.sm .OneUp--hasInfoPane .OneUp-paneHost{width:100%}.OneUp--slideShowOn .OneUp-commandBar{visibility:hidden}.OneUp--slideShowOn .OneUp-content{top:0}.OneUp--awake .OneUp-detailsBar{visibility:inherit;opacity:1;transition-delay:0s,0s,0s}.OneUp--awake.OneUp--slideShowOn .OneUp-commandBar{visibility:inherit}.OneUp-caption-container{display:flex;align-items:center;justify-content:center;width:100%;background-color:"},{theme:"oneUpPaneBackground",defaultValue:"rgba(255,255,255,.75)"},{rawString:"}.OneUp-caption{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";flex:1 1 auto;height:30px;border:0;padding:0;background:0 0;text-align:center;width:100%;max-width:600px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;vertical-align:middle;font-size:14px;font-weight:400}.OneUp-caption--editable{cursor:pointer}.OneUp-caption-clipper{display:table-cell;max-width:600px;height:30px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;vertical-align:middle;font-size:14px;font-weight:400}.lg .OneUp-caption-clipper{max-width:510px}.md .OneUp-caption-clipper{max-width:345px}.sm .OneUp-caption-clipper{max-width:150px}.OneUp-options{position:absolute;top:0;bottom:0;text-align:right}[dir=ltr] .OneUp-options{right:8px}[dir=rtl] .OneUp-options{left:8px}.OneUp-info{position:absolute;top:0;display:block;padding:20px 8px;height:40px}[dir=ltr] .OneUp-info{right:0}[dir=rtl] .OneUp-info{left:0}.OneUp-paneHost{position:absolute;width:320px;top:0;bottom:0;overflow:hidden;z-index:1}[dir=ltr] .OneUp-paneHost{right:-321px}[dir=rtl] .OneUp-paneHost{left:-321px}.OneUp-infoPane{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:absolute;top:0;bottom:0;right:0;width:320px}.od-userSelect--enabled .OneUp-infoPane{-webkit-touch-callout:text;-webkit-user-select:text;-ms-user-select:text;user-select:text}.OneUp .od-Panel,.OneUp .od-PanelOverlay{top:0}.isFluentVNext .OneUp-commandBar{top:-48px;height:48px}.isFluentVNext .sm .OneUp-commandBar{top:-48px;height:48px}.isFluentVNext .sm .OneUp--hasCommandBar .OneUp-paneHost{top:48px}.isFluentVNext .OneUp--hasCommandBar .OneUp-content,.isFluentVNext .OneUp--hasCommandBar .OneUp-paneHost{top:48px}.isFluentVNext .OneUp--hasCommandBar .OneUp-commandBar{top:0}.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar{background-color:"},{theme:"bodyStandoutBackground",defaultValue:"#faf9f8"},{rawString:"}.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton{padding:0 8px}.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton .ms-Button-textContainer{padding-bottom:0;height:16px}.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--editPhoto{padding:0}.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton,.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--editPhoto{margin-top:4px;margin-bottom:4px}.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton:active .ms-Button-flexContainer,.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton:focus .ms-Button-flexContainer,.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton:hover .ms-Button-flexContainer,.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--editPhoto:active .ms-Button-flexContainer,.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--editPhoto:focus .ms-Button-flexContainer,.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--editPhoto:hover .ms-Button-flexContainer{background-color:inherit}.ms-Fabric--isFocusVisible .isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton:focus,.ms-Fabric--isFocusVisible .isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--editPhoto:focus{box-shadow:none;outline:0}.ms-Fabric--isFocusVisible .isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton:focus::after,.ms-Fabric--isFocusVisible .isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--editPhoto:focus::after{top:0;bottom:0;left:0;right:0;outline-offset:-1px;outline:2px solid "},{theme:"focusBorder",defaultValue:"#605e5c"},{rawString:";border:2px solid "},{theme:"primaryButtonText",defaultValue:"#ffffff"},{rawString:"}.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.is-disabled i[data-icon-name=Next],.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.is-disabled i[data-icon-name=Previous]{color:"},{theme:"buttonTextDisabled",defaultValue:"#a19f9d"},{rawString:"}.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar i[data-icon-name=Separator]{line-height:20px;width:20px;height:20px;font-size:20px}.md .isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar,.sm .isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar{height:48px}"}]);var i=n(0),r=n(175),o=n(23),s=n(2099),c=n(22),d=n(1872),l=n(1755),u=n(1768),f=n(25),p=n(160),m=n(424),_=n(219),h=n(11),b=n(276),g=n(1732),v=n(962),y=n(55),S=n(2337),D=n(1704),I=n(48),x=n(59),C=n(62),O=n(1885),w=n(36),E=function(e){function t(t){var n=e.call(this,t)||this;n.name="FileHandlerCreate";var a=n._fileHandlerAction=t.fileHandlerAction;return n._itemProvider=n.resources.consume(D.resourceKey),n._urlDataSource=n.resources.consume(C.Se),a&&a.handler&&a.handler.isPromoted&&(n.name="PromotedFileHandlerCreate"),n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){if(!this._fileHandlerAction)return!1;var e=this._urlDataSource.getKeyParams(this.item().key);return this._urlDataSource.isCurrentQuery(w.e.Files,e)},t.prototype.onExecute=function(e,t){var n=this,a=this._fileHandlerAction;if(!a)return x.n.reject(new Error("No action registered for file handler"));var i=a.availableOn.file,r=i&&i.extensions&&i.extensions[0].replace(".","");if(!a.handler.isPromoted){var o=window.open("","_blank");o&&(o.opener=null)}var s=this.item.peek().key;return this._itemProvider.createCustomDocument(s,r).then(function(e){return e?n.resources.consumeAsync(O.t).then(function(t){return t.invokeAction({items:[e],action:a})}):x.n.wrapError()}).then(function(){return x.n.wrap({resultType:I.e.Success})},function(e){return x.n.wrap({resultType:x.n.isCanceled(e)?I.e.ExpectedFailure:I.e.Failure})})},t}(S.e),A=n(1056),L=n(773),k=function(e){function t(t){var n=e.call(this,t)||this;n.name="FileHandlerCustom";var a=n._fileHandlerAction=t.fileHandlerAction;n._fileHandlerProvider=n.resources.consume(l.e);var i=a.availableOn;return n._itemSelectionHelper=new(n.child(L.e))({overrideItem:t.item,allowMultiSelect:!!i.allowMultiSelect,canFallback:!!i.folder}),a&&a.handler&&a.handler.isPromoted&&(n.name="PromotedFileHandlerCustom"),n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){if(!this._fileHandlerAction)return!1;var e=this._itemSelectionHelper.selection();return!!e&&!!e.length&&e.every(this._acceptItemObservable,this)},t.prototype.onExecute=function(e){var t,n=this,a=this._fileHandlerAction;if(!a)return x.n.reject("No action registered for file handler");if(!a.handler.isPromoted){if(!(t=window.open("","_blank")))return x.n.reject({resultType:I.e.ExpectedFailure,resultCode:"window.open"});t.opener=null}return this._itemSelectionHelper.resolveSelection().then(function(e){n.resources.consumeAsync(O.t).then(function(n){return n.invokeAction({items:e,action:a,target:t})})}).then(function(){return x.n.wrap({resultType:I.e.Success})},function(e){return x.n.wrap({resultType:x.n.isCanceled(e)?I.e.ExpectedFailure:I.e.Failure})})},t.prototype._acceptItemObservable=function(e){var t=e.peek(),n=this._fileHandlerAction;return!(!n||!t.graph)&&(t.folder?!!n.availableOn.folder&&!t.isRootFolder:this._fileHandlerProvider.isActionForExtension(n,t.extension))},t}(A.e),M=function(e){function t(t){var n=e.call(this,t)||this;n.name="FileHandlerOpen";var a=n._fileHandlerAction=t.fileHandlerAction;return n._fileHandlerProvider=n.resources.consume(l.e),n._itemSelectionHelper=new(n.child(L.e))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1}),n._defaultHandlerAction=n.observables.pureCompute(n._computeDefaultHandlerAction),a&&a.handler&&a.handler.isPromoted&&(n.name="PromotedFileHandlerOpen"),n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e||!e.graph)return!1;var t=e.extension,n=this._fileHandlerProvider,a=this._fileHandlerAction;return a?n.isActionForExtension(a,t):!!this._defaultHandlerAction()},t.prototype.onExecute=function(e){var t,n=this,a=this._fileHandlerAction;if(!a||!a.handler.isPromoted){if(!(t=window.open("","_blank")))return x.n.reject({resultType:I.e.ExpectedFailure,resultCode:"window.open"});t.opener=null}return this._itemSelectionHelper.resolveFirst().then(function(e){var i=a||n._defaultHandlerAction.peek();return i?n.resources.consumeAsync(O.t).then(function(n){return n.invokeAction({items:[e],action:i,target:t})}):x.n.reject("No action available for file handler")}).then(function(){return x.n.wrap({resultType:I.e.Success})},function(e){return x.n.wrap({resultType:x.n.isCanceled(e)?I.e.ExpectedFailure:I.e.Failure})})},t.prototype._computeDefaultHandlerAction=function(){if(!this._fileHandlerAction){var e=this._itemSelectionHelper.firstItem();if(e&&e.graph)return this._fileHandlerProvider.getDefaultOpenHandler(e.extension)}},t}(A.e),P=n(99),T=n(42),U=n(8),F=n(112),H=function(e){function t(t,n){var a=e.call(this,t,n)||this,r=t.sourceEngagementName,o=t.item,s=t.includeLegacyActions;a._sourceEngagementName=r,a._overrideItem=o;var c=a.observables;a._legacyCommandMap=c.create({}),a._commandViewModelType=a.managed(m.e),a._actionMap=n.actionMap,a._customActionProvider=n.customActionProvider,a._fileHandlerProvider=n.fileHandlerProvider,a._commonParams={renderLabel:2,location:10},s&&a._loadLegacyCommandMap(),a._commandMap=c.pureCompute(a._computeCommandMap),a._fullCommandMap=c.pureCompute(a._computeFullCommandMap),a._flatten=c.pureCompute(a._computeFlatten),a.newFileCommands=c.pureCompute(a._computeNewFileCommands),a.openWithCommands=c.pureCompute(a._computeOpenWithCommands);var d=c.createArray(),l=a.scope.attach(d.filter(function(e){return e.isVisible()}));a.actionsCommand=new a._commandViewModelType({text:f.Actions,icon:c.pureCompute(function(){return l().length>1?new b.e("SetAction"):void 0}),renderLabel:2,requiredChildren:1,collapseSingleChildCommands:!0,children:d});var u=c.pureCompute(a._computeCustomCommands);return c.backgroundCompute(function(){d.splice.apply(d,Object(i.__spreadArray)([0,1/0],u(),!1))}),a}return Object(i.__extends)(t,e),t.prototype._computeNewFileCommands=function(){var e=this._fileHandlerProvider;return e?e.data().actions.create.map(this._createNewFileCommand,this):[]},t.prototype._createNewFileCommand=function(e,t){var n=e.handler,a={text:e.handler.fileTypeDisplayName||T.format(f.CreateFileWithExtension,e.availableOn.file.extensions[0]),action:new(this.managed(E))({fileHandlerAction:e}),renderLabel:2,engagementName:"FileHandlerCreate",source:this._sourceEngagementName};0===t&&(a.hasLineBreakBefore=!0);var i=this._fileHandlerProvider.getIconUrl(e.icon||n.fileTypeIcon);return i?a.iconUrl=i:a.icon=new b.e("Page"),new this._commandViewModelType(a)},t.prototype._computeOpenWithCommands=function(){var e=this._fileHandlerProvider;return e?e.data().actions.open.map(this._createOpenFileCommand,this):[]},t.prototype._createOpenFileCommand=function(e){var t=e.handler,n={fileHandlerAction:e};this._overrideItem&&(n.item=this._overrideItem);var a={text:e.displayName||T.format(f.OpenWithFileHandler,t.displayName),collapsedText:this.createObservable(f.Open),action:new(this.managed(M))(n),renderLabel:2,engagementName:t.isPromoted?"PromotedFileHandlerOpen":"FileHandlerOpen",source:this._sourceEngagementName,iconUrl:this._fileHandlerProvider.getIconUrl(e.icon||t.fileTypeIcon)};return new this._commandViewModelType(a)},t.prototype._computeCommandMap=function(){for(var e=this,t=this._fileHandlerProvider,n=t?t.data().actions.custom:[],a=this._commonParams,r={},o=this.observables,s=function(n){var s=n.handler,d=s.appId,l=r[d]||(r[d]=new c._commandViewModelType(Object(i.__assign)(Object(i.__assign)({},a),{iconUrl:t.getIconUrl(s.appIcon),text:s.actionMenuDisplayName||s.displayName,requiredChildren:1,collapseSingleChildCommands:!0}))),u=new c._commandViewModelType(Object(i.__assign)(Object(i.__assign)({},a),{text:o.pureCompute(function(){return!e._flatten()&&n.shortDisplayName||n.displayName}),collapsedText:o.create(n.displayName),iconUrl:t.getIconUrl(n.icon),action:new(c.managed(k))({fileHandlerAction:n}),engagementName:"FileHandlerCustom",source:c._sourceEngagementName}));l.children.push(u)},c=this,d=0,l=n;d<l.length;d++)s(l[d]);return r},t.prototype._loadLegacyCommandMap=function(){var e=this,t=this._customActionProvider,n=this._actionMap;t&&n&&t.getCustomActionData().then(function(a){var r={},o=[],s=a.ContextMenu;if(s&&0!==s.length){for(var c=e._commandViewModelType,d=e.managed(n.CustomActionNavigationAction),l=e.observables,u=e._commonParams,p=0,m=s;p<m.length;p++){var _=m[p],h=Object(i.__assign)(Object(i.__assign)({},u),{text:_.text});if(t.isGroup(_)){var b=_.children.map(function(e){return new c({text:e.text,engagementName:"CustomActionRibbonTab",iconUrl:e.iconUrl,renderLabel:2,action:new d({customAction:e})})});o.push(new c(Object(i.__assign)(Object(i.__assign)({},h),{tooltip:_.tooltip,requiredChildren:1,children:l.createArray(b)})))}else o.push(new c(Object(i.__assign)(Object(i.__assign)({},h),{iconUrl:_.iconUrl,engagementName:"CustomActionECB",action:new d({customAction:_})})))}r["Add-ins"]=new c(Object(i.__assign)(Object(i.__assign)({},u),{text:f.AddIns,children:l.createArray(o),requiredChildren:1})),e._legacyCommandMap(r)}})},t.prototype._computeFullCommandMap=function(){return Object(i.__assign)(Object(i.__assign)({},this._commandMap&&this._commandMap()||{}),this._legacyCommandMap&&this._legacyCommandMap()||{})},t.prototype._computeCustomCommands=function(){var e=this._fullCommandMap(),t=[],n=[],a=this._flatten();for(var i in e){for(var r=e[i],o=r.visibleChildren(),s=0,c=o;s<c.length;s++){var d=c[s];d.parentCommand=a?void 0:r,a&&(d.visibleChildren().length>1?t:n).push(d)}!a&&r.isVisible()&&(o.length>1?t:n).push(r)}return t.concat(n)},t.prototype._computeFlatten=function(){var e=this._fullCommandMap(),t=0,n=0,a=0;for(var i in e){var r=e[i].visibleChildren().length;if(r>1&&a++,r&&n++,t+=r,a>0&&n>1&&t>4)return!1}return!0},t.dependencies=Object(i.__assign)(Object(i.__assign)({},y.n.dependencies),{actionMap:o.e.optional,customActionProvider:P.t.optional,fileHandlerProvider:l.e.optional}),t}(y.n),R=new U.t({name:"FileHandlerCommands",factory:new F.a(H)}),N=n(2292),B=n(2590),j=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="AccessibilityMode",a._accessibilityMode=t.accessibilityMode,a._itemSelectionHelper=new(a.child(L.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&!!e.officeBundle&&e.appMap===g.u},t.prototype.onExecute=function(e,t){return this._accessibilityMode(!this._accessibilityMode.peek()),x.n.resolve({resultType:I.e.Success})},t}(A.e),V=(n(1474),n(2196)),z=n(2352),G=new U.t({name:"OneUpSharingDialog.key",loader:new F.t(function(){return n.e(463).then(n.bind(null,4264)).then(function(e){return e.resourceKey.local})})}),K=n(1054),W=n(2217),q=n(183),Q=n(2001),Y=n(787),J=n(2832),X=n(205),Z=n(514),$=n(74),ee=n(1973),te=n(38),ne=n(308),ae=n(33),ie=n(120),re=n(798),oe=n(1043),se=n(2084),ce=n(113),de=[{flightStringId:"FamilySharing",flightEnabled:Object(h.isFeatureEnabled)(h.FamilySharing)},{flightStringId:"ManageAccessRevampConsumer",flightEnabled:Object(h.isFeatureEnabled)(h.ManageAccessRevampConsumer)},{flightStringId:"ODCHideNonPremiumLinkFeatures",flightEnabled:Object(h.isFeatureEnabled)(h.ODCHideNonPremiumLinkFeatures)},{flightStringId:"ODCRequestAccess",flightEnabled:Object(h.isFeatureEnabled)(h.ODCRequestAccess)},{flightStringId:"SharingTooltipCalloutKS",flightEnabled:Object(h.isFeatureEnabled)(h.SharingTooltipCalloutKS)}],le=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this,i=a,r=i.observables,s=i.resources,c=t.renderLabel,d=void 0===c?0:c,l=t.mode,u=t.engagementName,f=t.automationId,p=t.location;return a._urlDataSource=s.consume(C.Se),a._pageContext=s.consume(_.s.optional),a._itemUrlHelper=s.consume(re.t.optional),a._automationId=f,a._mode=l,a._overrideEngagementName=u,a._isConsumer=!a._pageContext,a._actionMap=s.consume(o.e),a._itemsStore=s.consume(K.e),a._focusItemResourceKey=a._getShareItemResourceKey(),a._itemBeingShared=s.consume(a._focusItemResourceKey),a._shareAuthToken=a.createObservable(),a.resources.consumeAsync(C.I).then(function(e){return(a._isConsumer?e.getGraphToken({forceRefresh:!0}):e.getSharePointToken(new $.t(a._pageContext.webAbsoluteUrl).getAuthority())).then(function(e){a._shareAuthToken(e.accessToken)})}),r.backgroundCompute(a._computeIsOpen),a._renderLabel=d,a._location=p,a._initializeCommand(),a}return Object(i.__extends)(t,e),t.prototype._initializeCommand=function(){var e=this._getCommandProperties();this.command=new(this.managed(m.e))(e)},t.prototype._computeIsOpen=function(){this._itemBeingShared()&&this.command.isOpen(!0)},t.prototype._getPayload=function(){var e=this,t=this.observables,n=this.createPureComputed(this._computeShareParams),a=this.createPureComputed(function(){return!!e._itemBeingShared()}),i=t.create();return t.backgroundCompute(function(){a.peek()?e.trackPromise(x.n.resolve(e.resources.consumeAsync(G.local))).done(function(e){i(e)}):a()}),this.createPureComputed(function(){var e=i(),t=n();if(e&&t)return e.toSpecification(t)})},t.prototype._computeShareParams=function(){var e,t,a,r=this,s=this._itemBeingShared(),c=s?this._itemsStore.getItem(s.items[0].key):void 0;if(c){var d=c.peek(),l=this.resources.consume(o.F).peek(),u=l&&l[Z.t.idParamKey],f=l[Z.t.listUrlKey]||(null===(e=this._pageContext)||void 0===e?void 0:e.listUrl),p=(null===(t=this._urlDataSource)||void 0===t?void 0:t.isItemCrossList)&&(null===(a=this._urlDataSource)||void 0===a?void 0:a.isItemCrossList(d.key)),m=function(){var e;return r._isConsumer?"odc":(null===(e=r._pageContext)||void 0===e?void 0:e.listBaseTemplate)===ce.t.mySiteDocumentLibrary?"odb":"sharepoint"},_=function(){r._itemBeingShared.peek()&&r._itemBeingShared(void 0)};return{getSharingInformation:function(){var e,t,n,a;if(r._isConsumer){var i="https://"+new $.t(location.href).getAuthority();return Promise.resolve({authToken:r._shareAuthToken(),webAbsoluteUrl:i,isODB:!r._isConsumer,itemName:d.name,itemId:d.itemId,listUrl:f||i,serverRelativeItemUrl:u})}return p?Promise.resolve({authToken:r._shareAuthToken(),webAbsoluteUrl:r._itemUrlHelper.getItemUrlParts(d.key).fullWebUrl,listUrl:f,serverRelativeItemUrl:u,isODB:!r._isConsumer,itemName:d.name,cookieAuthIframeUrlForCrossDomain:"".concat(r._pageContext.webAbsoluteUrl,"/_layouts/15/sharedialog.aspx?crossdomain=true&clickTime=").concat(Date.now(),"&policyTip=").concat(null!==(e=d.policyTip)&&void 0!==e?e:"")}):Promise.resolve({cookieAuthIframeUrl:"".concat(r._pageContext.webAbsoluteUrl,"/_layouts/15/sharedialog.aspx?listId=").concat(null!==(t=r._pageContext.listId)&&void 0!==t?t:"","&listItemId=").concat(null!==(n=d.properties.ID)&&void 0!==n?n:"","&clientId=").concat(m(),"&policyTip=").concat(null!==(a=d.policyTip)&&void 0!==a?a:"","&clickTime=").concat(Date.now())})},getClientId:m,initializeShareFrame:function(e){var t,a,o=e.parentElement,c=e.calloutProps,l=e.sharingInformation,u=l.webAbsoluteUrl,f=l.serverRelativeItemUrl,m=l.listUrl,h=l.authToken,b=c.defaultRecipients,g=c.itemName,v=c.locale,y=c.theme,S=c.getClientId,D={authToken:h||"",clientId:S(),mode:r._mode===J.e.share?oe.e.share:oe.e.copy,listItemId:d.itemId||"",itemName:g,itemAppmap:d.appMap,itemType:d.type,itemExtension:d.extension,correlationId:null!==(a=null===(t=r._pageContext)||void 0===t?void 0:t.CorrelationId)&&void 0!==a?a:ne.e.generate(),scenarioId:s.scenarioId||"OneUp",hostOptions:{showCloseButton:!0,hideShareDialogOverflowButton:!0},hostMethod:r._isConsumer?se.e.microservice:se.e.sharepoint,serverRelativeItemUrl:f,listUrl:m,webAbsoluteUrl:u||"",defaultRecipients:b,theme:y||Object(ae.L)(),locale:v,fullScreenIframe:p,consumerFlightContexts:r._isConsumer?de:[]},x=new ie.e({name:"OneUp.LoadShare",extraData:{clientId:S(),scenarioId:D.scenarioId||"",correlationId:D.correlationId||"",mode:r._mode}});Object(i.__awaiter)(r,void 0,void 0,function(){var e;return Object(i.__generator)(this,function(t){switch(t.label){case 0:return[4,n.e(325).then(n.bind(null,2149))];case 1:return[4,new(0,t.sent().SharePrefetch)({element:o,environment:this._isConsumer?te.e.prod:null!==(e=this._pageContext.env2)&&void 0!==e?e:te.e.prod,locale:v,disableIframeDomainCheck:!0,isConsumer:this._isConsumer,context:D,styles:{minWidth:window.innerWidth>=ee.e.DEFAULT_BREAKPOINTS.Medium?"480px":void 0},options:{onError:function(e){x.data=Object(i.__assign)(Object(i.__assign)({},x.data),{resultType:I.e.Failure,error:e.message,resultCode:e.resultCode+"."+e.name,extraData:Object(i.__assign)(Object(i.__assign)({},x.data.extraData),{error:e})}),x.end()},onReady:function(){x.data=Object(i.__assign)(Object(i.__assign)({},x.data),{resultType:I.e.Success}),x.end()},onTimeout:function(){x.data=Object(i.__assign)(Object(i.__assign)({},x.data),{resultType:I.e.Failure,error:"Timeout initializing Share in OneUp",resultCode:"TIMEOUT",extraData:Object(i.__assign)({},x.data.extraData)}),x.end()},onDismiss:_}}).initializeUI()];case 2:return t.sent(),[2]}})})},mode:this._mode,locale:X.e.language||"en-US",itemName:d.name,resolve:_,reject:_}}},t.prototype._getShareItemResourceKey=function(){var e=new U.t({name:"share",factory:new U.e(this.observables.create())});switch(this._mode){case J.e.share:return this._isConsumer?e:Q.shareFocusItemResourceKey;case J.e.copyLink:return Q.copyLinkFocusItemResourceKey;default:return this._isConsumer?e:Q.shareFocusItemResourceKey}},t.prototype._getCommandProperties=function(){var e,t={text:void 0,accessibleLabel:void 0,tooltip:void 0,icon:void 0,keys:void 0,action:void 0,payload:void 0,engagementName:void 0,renderLabel:this._renderLabel,enableRecoverFocusBinding:void 0,beakColor:void 0,location:void 0,automationId:this._automationId};this._mode===J.e.copyLink?(t.text=f.CopyLinkCommandText,e=f.CopyLinkCommandTooltipV3,t.icon=new b.e("Link")):(t.text=f.Share,e=f.ShareCommandTooltipV3,t.icon=new b.e("Share"),t.keys=["S"]),this._overrideEngagementName?t.engagementName=this._overrideEngagementName:this._mode===J.e.copyLink?t.engagementName="GetLink":t.engagementName="Share",t.action=this._isConsumer?new(this.managed(this._actionMap.ShowShareMultiItemAction))({focusItems:this._itemBeingShared}):new(this.managed(this._actionMap.ShowShareAction))({focusItemResourceKey:this._focusItemResourceKey}),t.payload={control:this._getPayload(),timeout:36e5,announce:!1,autoDismiss:!1,preventDismissOnScroll:!0,preventDismissOnResize:!0,preventDismissOnLostFocus:!0},t.enableRecoverFocusBinding=!1,t.beakColor=q.e.neutralLighterAlt,t.location=Object(Y.a)()?4:this._location;var n=this.resources.consume(W.e),a=this.createPureComputed(function(){return n()}),i=this.createPureComputed(function(){return n()?T.format(z.i,e):e}),r=this.createPureComputed(function(){return n()?T.format(z.i,t.text):t.text});return t.isDisabled=a,t.tooltip=i,t.accessibleLabel=r,t.prependTextToAccessibleLabel=!1,t},t}(y.n),ue=n(13),fe=["S"],pe=" od-Command--PrimaryButton",me=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=n.resources;n._actionMap=a.consume(o.e),n._selection=a.consume(o.w),n._coachmarkProvider=n.resources.consume(V.e.optional),n._focusItem=a.consume(o._);var r=a.consume(_.s.optional),s=n.scope.attach(new(a.consume(R.local))({})),d=n.createPureComputed(n._computeOpenInOfficeOnlineText),l=n.createPureComputed(n._computeOpenInOfficeClientText),u=n.createPureComputed(n._computOpenInOfficeSuffixClass),g=n.createPureComputed(n._computeOfficeIcon),v=[new(n.managed(m.e))({text:d,renderLabel:1,icon:g,classSuffix:u,action:new(n.managed(n._actionMap.OpenInOfficeOnlineAction))}),new(n.managed(m.e))({text:l,renderLabel:1,icon:g,classSuffix:u,action:new(n.managed(n._actionMap.OpenInOfficeClientAction))})],y=[new(n.managed(m.e))({text:f.OpenInBrowser,renderLabel:1,icon:new b.e("PDF"),classSuffix:"PDF"+pe,action:new(n.managed(n._actionMap.OpenPdfInBrowserAction))}),new(n.managed(m.e))({text:f.OpenInTextEditor,renderLabel:1,icon:new b.e("Edit"),action:new(n.managed(n._actionMap.OpenInTextEditorAction))})];Object(h.isFeatureEnabled)(h.EnableNewStreamWebAppInStreamAspx)&&y.push(new(n.managed(m.e))({text:f.OpenInSWA,renderLabel:1,tooltip:f.StreamTooltip,icon:new b.e("StreamLogo"),action:new(n.managed(n._actionMap.OpenSWAAction))})),Object(h.isFeatureEnabled)(h.EnableOpenInImmersiveReader)&&y.push(new(n.managed(m.e))({text:f.OpenInImmersiveReader,renderLabel:1,icon:new b.e("ReadOutLoud"),action:new(n.managed(n._actionMap.OpenInImmersiveReaderAction))}));var S=n.observables.createArray([]);n.createBackgroundComputed(function(){S.splice.apply(S,Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)([0,S.peek().length],v,!1),s.openWithCommands(),!1),y,!1))});var D=!ue.e.isActivated("87A98177-29BF-4F14-87EA-D65E55C9BE0B","07/12/2022","allow to use new share dialog from oneup command bar"),I=D&&Object(h.isFeatureEnabled)(h.OneUpNewShareDialog)?new(n.managed(le))({renderLabel:2,mode:J.e.share,location:3,automationId:"share"}).command:r?Object(h.isFeatureEnabled)(h.ShareV3)?new(n.managed(N.t))({renderLabel:2,mode:0,automationId:"share"}).command:new(n.managed(m.e))({text:f.Share,tooltip:f.ShareCommandTooltipV3,renderLabel:2,icon:new b.e("Share"),automationId:"share",action:Object(h.isFeatureEnabled)(h.UseNewSharingDialog)&&"21"===r.webTemplate?new(n.managed(n._actionMap.ShareByLinkAction))({sharingMethod:2}):new(n.managed(n._actionMap.ShareAction))({activeTab:1}),keys:fe}):new(n.managed(m.e))({text:f.Share,renderLabel:2,icon:new b.e("Share"),automationId:"share",action:new(n.managed(n._actionMap.ShareByLinkAction)),keys:fe}),x=n.createPureComputed(function(){var e,t=n._focusItem&&n._focusItem(),a=t&&t(),i=n._computeFileIconUrl(a),r=null!==(e=null==a?void 0:a.displayName)&&void 0!==e?e:"",o=r.replace(/(.{21}).+(\..+)/,"$1...$2");return{title:r,compressedTitle:o,iconUrl:i}}),C=n.createPureComputed(function(){return x().title}),O=n.createPureComputed(function(){return x().compressedTitle}),w=n.createPureComputed(function(){return x().iconUrl}),E=a.consume(B.e);return n.commands(Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)([new(n.managed(m.e))({text:f.Open,classSuffix:u,renderLabel:1,requiredChildren:1,collapseSingleChildCommands:!1,location:3,children:S}),new(n.managed(m.e))({text:f.Edit,classSuffix:"editPhoto",tooltip:f.EditPhotoTooltip,renderLabel:1,action:new(n.managed(n._actionMap.OpenInImageEditorAction)),teachingBubble:!Object(h.isFeatureEnabled)(h.EnableEditControlTeachingBubble)||Object(h.isFeatureEnabled)(h.MentionTeachingUIAA)||Object(h.isFeatureEnabled)(h.EnableExpirationSectionForTMR)?void 0:n._coachmarkProvider.getCurrentTeachingBubble()}),new(n.managed(m.e))({text:f.SaveTextFile,classSuffix:"saveTextFile",tooltip:f.SaveTextFileTooltip,icon:new b.e("Save"),automationId:"save",renderLabel:2,action:new(n.managed(n._actionMap.SaveAction))}),I,D&&Object(h.isFeatureEnabled)(h.OneUpNewShareDialog)?new(n.managed(le))({renderLabel:2,mode:J.e.copyLink,location:3,automationId:"copy-link"}).command:Object(h.isFeatureEnabled)(h.ShareV3)?new(n.managed(N.t))({renderLabel:2,mode:1,location:3,automationId:"copy-link"}).command:new(n.managed(m.e))({text:f.GetLink,renderLabel:2,icon:new b.e("Link"),location:3,automationId:"copy-link",action:new(n.managed(n._actionMap.GetLinkAction))({useOldSharingDialog:r&&"21"!==r.webTemplate})}),new(n.managed(m.e))({text:f.AddToAlbum,icon:new b.e("Photo2Add"),renderLabel:2,action:new(n.managed(n._actionMap.AddToAlbumAction))({})}),new(n.managed(m.e))({text:f.Download,icon:new b.e("Download"),renderLabel:2,action:new(n.managed(n._actionMap.DownloadAction))({}),automationId:"download"}),new(n.managed(m.e))({text:f.DeleteItem,icon:new b.e("Delete"),renderLabel:0,location:2,action:new(n.managed(n._actionMap.DeleteAction))({}),automationId:"delete"}),new(n.managed(m.e))({text:f.print,renderLabel:0,icon:new b.e("Print"),location:2,keys:["CtrlP"],action:new(n.managed(n._actionMap.PrintPdfAction))}),new(n.managed(m.e))({text:f.playSlideshow,icon:new b.e("Play"),classSuffix:"play",location:2,renderLabel:0,action:new(n.managed(n._actionMap.PlaySlideShowAction))({})}),new(n.managed(m.e))({text:f.rotate,icon:new b.e("rotate"),location:2,renderLabel:0,action:new(n.managed(n._actionMap.RotateAction))({})}),new(n.managed(m.e))({text:f.applyOfficeLens,renderLabel:0,location:2,icon:new b.e("LightningBolt"),action:new(n.managed(n._actionMap.ApplyOfficeLensAction))}),new(n.managed(m.e))({text:f.removeOfficeLens,renderLabel:0,icon:new b.e("Undo"),location:2,action:new(n.managed(n._actionMap.RemoveOfficeLensAction))}),new(n.managed(m.e))({text:f.addToSharedList,renderLabel:0,icon:new b.e("Add"),location:2,action:new(n.managed(n._actionMap.AddToSharedListAction))}),new(n.managed(m.e))({text:f.removeFromSharedList,renderLabel:0,icon:new b.e("Cancel"),location:2,action:new(n.managed(n._actionMap.RemoveFromSharedListAction))}),new(n.managed(m.e))({text:f.viewOriginal,icon:new b.e("Picture"),renderLabel:0,location:2,action:new(n.managed(n._actionMap.ViewOriginalAction))({})}),new(n.managed(m.e))({text:f.viewInFolder,icon:new b.e("Folder"),renderLabel:0,location:2,action:new(n.managed(n._actionMap.ViewInFolderAction))}),new(n.managed(m.e))({text:f.Embed,icon:new b.e("Embed"),classSuffix:"embed",renderLabel:0,location:2,action:new(n.managed(n._actionMap.EmbedAction))({})}),new(n.managed(m.e))({text:f.OrderPrints,icon:new b.e("Print"),renderLabel:0,location:2,action:new(n.managed(n._actionMap.OrderPrintsAction))({})}),new(n.managed(m.e))({text:f.editTags,icon:new b.e("Tag"),keys:["T"],renderLabel:0,location:2,action:new(n.managed(n._actionMap.EditTagsAction))}),new(n.managed(m.e))({text:f.Copy,icon:new b.e("Copy"),automationId:"copy",renderLabel:0,location:2,action:new(n.managed(n._actionMap.LaunchMoveCopyPanelAction))({isMove:!1})}),new(n.managed(m.e))({text:p.s,icon:new b.e("StackIndicator"),renderLabel:0,location:2,automationId:"version-history",action:new(n.managed(n._actionMap.ShowVersionHistoryAction))})],Object(h.isFeatureEnabled)(h.EnableAnonReportConcernCommand)?[new(n.managed(m.e))({text:p.l,icon:new b.e("EditNote"),renderLabel:0,location:2,automationId:"reportConcern",action:new(n.managed(n._actionMap.ReportAbuseAction))({})})]:[],!0),[new(n.managed(m.e))({text:n.createPureComputed(function(){return E()?f.ViewMode:f.AccessibilityMode}),icon:n.createPureComputed(function(){return E()?new b.e("Page"):new b.e("EaseOfAccess")}),renderLabel:0,location:2,action:new(n.managed(j))({accessibilityMode:E})})],!1),r&&r.allowInfectedDownload?[new(n.managed(m.e))({text:f.Download,icon:new b.e("Download"),renderLabel:0,location:2,action:new(n.managed(n._actionMap.ShowMalwareDetectedAction))({})})]:[],!0),[s.actionsCommand,n.overflowHostCommand,new(n.managed(m.e))({role:"text",automationId:"fileTitle",iconUrl:w,text:O,tooltip:C,location:16,isDisabled:c.observable(!0)})],!1)),n}return Object(i.__extends)(t,e),t.prototype._computeOpenInOfficeOnlineText=function(){return g.s(Object(v.e)(this._selection,!0))||f.Open},t.prototype._computeOpenInOfficeClientText=function(){return g.c(Object(v.e)(this._selection,!0))},t.prototype._computOpenInOfficeSuffixClass=function(){return g.r(Object(v.e)(this._selection,!0))+pe},t.prototype._computeOfficeIcon=function(){var e,t=Object(v.e)(this._selection,!0);return t&&(e=g.o(t)),e||new b.e("Page")},t.prototype._computeFileIconUrl=function(e){var t=(null==e?void 0:e.iconName)||"genericfile",n=this.resources.consume(l.e.optional);return(null==e?void 0:e.iconUrl)||this.getFileHandlerIcon(n,null==e?void 0:e.extension)||u.e(this.resources,t,32)},t.prototype.getFileHandlerIcon=function(e,t){return e&&e.getFileTypeIconUrl(t,!0)},t}(d.e),_e=n(1117),he=n(2239),be=function(e){function t(t){var n=e.call(this,t)||this;return n.name="Conditional",n.isQosLogged=!1,n._action=t.action,n._condition=t.condition,n}return Object(i.__extends)(t,e),t.prototype.onExecute=function(e,t){return this._action.execute(e)},t.prototype.onIsAvailable=function(){return this._condition()&&this._action.isAvailable()},t}(A.e),ge=n(2920),ve={ignoreHistory:!0,openRelation:1},ye=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,ve,n)||this;return a._isUsingOriginalTheme=t.isUsingOriginalTheme,a._originalTheme=t.originalTheme,a.name="ClosePreviewer",a}return Object(i.__extends)(t,e),t.prototype.onExecute=function(t,n){return ue.e.isActivated("9b004be7-6252-434e-a687-f22bd0363ed1","11/08/2021","Move theme recover time from dispose to close action.")||this._isUsingOriginalTheme&&!this._isUsingOriginalTheme.peek()&&this._originalTheme&&Object(ae.P)(this._originalTheme),Object(h.isFeatureEnabled)(h.RefreshOnPreviewClose)?(document.body.style.display="none",e.prototype.onExecute.call(this,t,n).then(function(e){return window.location.reload(),e})):e.prototype.onExecute.call(this,t,n)},t}(ge.e),Se=function(e){function t(t){var n=e.call(this,t)||this;n._legend=t.legend;var a=n.createPureComputed(function(){return!t.canNavigate()}),i=new(n.managed(be))({action:t.previous,condition:t.canNavigate}),r=new(n.managed(be))({action:t.next,condition:t.canNavigate});return n.commands.push(new(n.managed(_e.e))({renderLabel:0}).command,new(n.managed(m.e))({text:he.previousTooltip,icon:new b.e(X.e.isRightToLeft?"Next":"Previous"),renderLabel:0,location:12,isPermanent:c.observable(!0),isInvisibleWhenDisabled:!1,automationId:"previousButton",keys:[X.e.isRightToLeft?"Right":"Left"],action:i}),new(n.managed(m.e))({text:n._legend,prependTextToAccessibleLabel:!1,location:12,automationId:"oneUpPageCount",classSuffix:"pageCount",isDisabled:c.observable(!0),isHidden:a,role:"text"}),new(n.managed(m.e))({text:he.nextTooltip,icon:new b.e(X.e.isRightToLeft?"Previous":"Next"),renderLabel:0,location:12,positionIconRight:!0,isPermanent:c.observable(!0),isInvisibleWhenDisabled:!1,automationId:"nextButton",keys:[X.e.isRightToLeft?"Left":"Right"],action:r}),new(n.managed(m.e))({role:"text",icon:new b.e("Separator"),renderLabel:0,classSuffix:"separator",location:12,isDisabled:c.observable(!0)}),new(n.managed(m.e))({icon:new b.e("Cancel"),text:f.Close,renderLabel:0,action:new(n.managed(ye))({isUsingOriginalTheme:t.isUsingOriginalTheme,originalTheme:t.originalTheme}),automationId:"close",keys:["Esc"],location:12})),n}return Object(i.__extends)(t,e),t}(d.e),De=n(1089),Ie=n(1758),xe=n(568),Ce=n(779),Oe=n(91),we=n(360),Ee=n(224),Ae=new U.t({name:"ExpirationStore.key",loader:new F.t(function(){return n.e(274).then(n.bind(null,3432)).then(function(e){return e.resourceKey})})}),Le=n(283),ke=function(e){function t(t){var n=e.call(this,t)||this,a=n.resources;n._actionMap=a.consume(o.e);var i=a.consume(De.e),r=a.consume(Ie.e),s=a.consume(Ee.e);return Object(h.isFeatureEnabled)(h.MentionTeachingUIAA)&&(n._selection=a.consume(o.w),n._coachmarkProvider=n.resources.consume(V.e.optional),n._identityDataSource=n.resources.consume(C.I.optional),n._checkAndSetCommentsCampaign(n._selection.selection(),r),n._subscribeToSelectedItemEvent(r)),Object(h.isFeatureEnabled)(h.EnableExpirationSectionForTMR)&&(n._focusItem=a.consume(o._),n._coachmarkProvider=n.resources.consume(V.e.optional),n._expirationSectionStore=n.resources.consumeAsync(Ae),n._checkAndSetTMRExpirationDateCampaign(n._focusItem&&n._focusItem(),r)),n.commands.push(new(n.managed(m.e))({text:s?p.n:p.e,icon:new b.e(s?"OpenPane":"Info"),location:12,action:new(n.managed(n._actionMap.ShowPropertiesAction))({useToggleBehavior:!0}),ariaControls:i,ariaExpanded:r,renderLabel:s?1:0,hasIconOnly:!s,keys:["I"],automationId:"showProperties",teachingBubble:Object(h.isFeatureEnabled)(h.MentionTeachingUIAA)||Object(h.isFeatureEnabled)(h.EnableExpirationSectionForTMR)?n._coachmarkProvider.getCurrentTeachingBubble():void 0}),new(n.managed(m.e))({role:"text",icon:new b.e("Separator"),renderLabel:0,classSuffix:"separator",location:12,isDisabled:c.observable(!0)})),n}return Object(i.__extends)(t,e),t.prototype._subscribeToSelectedItemEvent=function(e){var t=this;this.observables.subscribe(this._selection.selection,function(n){t._checkAndSetCommentsCampaign(n,e)})},t.prototype._checkAndSetCommentsCampaign=function(e,t){t()||(this._checkIfCommentCampaignIsApplicable(e)?xe.ODC_WEB_COMMENTS!==this._coachmarkProvider.currentCampaign()&&this._coachmarkProvider.setCampaign(xe.ODC_WEB_COMMENTS):xe.ODC_WEB_COMMENTS===this._coachmarkProvider.currentCampaign()&&this._coachmarkProvider.hideCampaign())},t.prototype._isOfficeItem=function(e){var t=e.extension&&e.extension.replace(/^\./,"");return t&&Ce.t[t]&&".pdf"!==e.extension||e.type===Oe.e.OneNote},t.prototype._checkIfCommentCampaignIsApplicable=function(e){var t,n;if(!e||1!==e.length||!e[0]())return!1;var a=e[0]();return void 0===a.dateDeleted&&a.graph&&!a.isRootFolder&&!this._isOfficeItem(a)&&!a.vault&&(0===a.sharingRole||2===a.sharingRole)&&!(null===(n=null===(t=a.comments)||void 0===t?void 0:t.settings)||void 0===n?void 0:n.isCommentDisabled)&&this._identityDataSource&&this._identityDataSource.getIdentity().type!==we.e.anonymous},t.prototype._checkAndSetTMRExpirationDateCampaign=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,function(){var n=this;return Object(i.__generator)(this,function(a){return t()||this._checkIfTMRExpirationIsApplicable(e).then(function(e){e?xe.TMR_EXPIRATION_DATE_EDIT!==n._coachmarkProvider.currentCampaign()&&n._coachmarkProvider.setCampaign(xe.TMR_EXPIRATION_DATE_EDIT):xe.TMR_EXPIRATION_DATE_EDIT===n._coachmarkProvider.currentCampaign()&&n._coachmarkProvider.hideCampaign()}),[2]})})},t.prototype._checkIfTMRExpirationIsApplicable=function(e){var t;if(!e)return Promise.resolve(!1);var n=e();return n.isRootFolder||n.type!==Oe.e.Media||"Media.Meeting"!==(null===(t=null==n?void 0:n.properties)||void 0===t?void 0:t.ProgId)?Promise.resolve(!1):Object(h.isFeatureEnabled)(h.EnableCheckExpirationDateForTMR)?this._checkIfTMRHasExpirationDate(n):Promise.resolve(!0)},t.prototype._checkIfTMRHasExpirationDate=function(e){var t=new ie.e({name:"TMR.FRE.GetExpirationDate"});return this._expirationSectionStore.then(function(n){return n.getItemExpirationDate(e).then(function(e){return t.end({resultType:I.e.Success}),e}).catch(function(e){return t.end(Object(Le.e)(e)),Promise.reject(e)})})},t}(d.e),Me=["S"],Pe=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=n.resources;n._actionMap=a.consume(o.e),n._selection=a.consume(o.w),n._coachmarkProvider=n.resources.consume(V.e.optional);var r=a.consume(_.s.optional),s=n.scope.attach(new(a.consume(R.local))({})),c=n.createPureComputed(n._computeOpenInOfficeOnlineText),d=n.createPureComputed(n._computeOpenInOfficeClientText),l=n.createPureComputed(n._computOpenInOfficeSuffixClass),u=n.createPureComputed(n._computeOfficeIcon),v=[new(n.managed(m.e))({text:c,renderLabel:2,icon:u,classSuffix:l,action:new(n.managed(n._actionMap.OpenInOfficeOnlineAction))}),new(n.managed(m.e))({text:d,renderLabel:2,icon:u,classSuffix:l,action:new(n.managed(n._actionMap.OpenInOfficeClientAction))})],y=[new(n.managed(m.e))({text:f.OpenInBrowser,renderLabel:2,icon:new b.e("PDF"),classSuffix:"PDF",action:new(n.managed(n._actionMap.OpenPdfInBrowserAction))}),new(n.managed(m.e))({text:f.OpenInTextEditor,renderLabel:2,icon:new b.e("Edit"),action:new(n.managed(n._actionMap.OpenInTextEditorAction))})];Object(h.isFeatureEnabled)(h.EnableOpenInImmersiveReader)&&y.push(new(n.managed(m.e))({text:f.OpenInImmersiveReader,renderLabel:2,icon:new b.e("ReadOutLoud"),action:new(n.managed(n._actionMap.OpenInImmersiveReaderAction))}));var S=n.observables.createArray([]);n.createBackgroundComputed(function(){S.splice.apply(S,Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)([0,S.peek().length],v,!1),s.openWithCommands(),!1),y,!1))});var D=n.createPureComputed(function(){for(var e={},t=0,n=S();t<n.length;t++){var a=n[t];if(a.isVisible()){var i=a.icon(),r=a.iconUrl(),o=i&&i.toString();if(o&&"Page"!==o||r){var s=g.t[o];return e.iconSize=18,e.icon=s?new b.e(s):i,e.iconUrl=r,e}}}return e.icon=new b.e("Page"),e}),I=n.createPureComputed(function(){return D().icon}),x=n.createPureComputed(function(){return D().iconUrl}),O=n.createPureComputed(function(){return D().iconSize}),w=r?Object(h.isFeatureEnabled)(h.ShareV3)?new(n.managed(N.t))({renderLabel:2,mode:0,automationId:"share"}).command:new(n.managed(m.e))({text:f.Share,tooltip:f.ShareCommandTooltipV3,renderLabel:2,icon:new b.e("Share"),automationId:"share",action:Object(h.isFeatureEnabled)(h.UseNewSharingDialog)&&"21"===r.webTemplate?new(n.managed(n._actionMap.ShareByLinkAction))({sharingMethod:2}):new(n.managed(n._actionMap.ShareAction))({activeTab:1}),keys:Me}):new(n.managed(m.e))({text:f.Share,renderLabel:2,icon:new b.e("Share"),automationId:"share",action:new(n.managed(n._actionMap.ShareByLinkAction)),keys:Me}),E=a.consume(B.e),A=a.consume(De.e),L=a.consume(Ie.e);return Object(h.isFeatureEnabled)(h.MentionTeachingUIAA)&&(n._identityDataSource=n.resources.consume(C.I.optional),n._checkAndSetCommentsCampaign(n._selection.selection(),L),n._subscribeToSelectedItemEvent(L)),n.commands(Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)([new(n.managed(m.e))({text:f.Open,icon:I,iconUrl:x,iconSize:O,classSuffix:l,renderLabel:2,requiredChildren:1,collapseSingleChildCommands:!1,location:3,children:S}),w,Object(h.isFeatureEnabled)(h.ShareV3)?new(n.managed(N.t))({renderLabel:2,mode:1,automationId:"copy-link"}).command:new(n.managed(m.e))({text:f.GetLink,renderLabel:2,icon:new b.e("Link"),automationId:"copy-link",action:new(n.managed(n._actionMap.GetLinkAction))({useOldSharingDialog:r&&"21"!==r.webTemplate})}),new(n.managed(m.e))({text:f.print,renderLabel:2,icon:new b.e("Print"),keys:["CtrlP"],action:new(n.managed(n._actionMap.PrintPdfAction))}),new(n.managed(m.e))({text:f.addToSharedList,renderLabel:2,icon:new b.e("Add"),action:new(n.managed(n._actionMap.AddToSharedListAction))}),new(n.managed(m.e))({text:f.removeFromSharedList,renderLabel:2,icon:new b.e("Cancel"),action:new(n.managed(n._actionMap.RemoveFromSharedListAction))}),new(n.managed(m.e))({text:f.AddToAlbum,icon:new b.e("Photo2Add"),renderLabel:2,action:new(n.managed(n._actionMap.AddToAlbumAction))({})}),new(n.managed(m.e))({text:f.playSlideshow,icon:new b.e("Play"),renderLabel:2,action:new(n.managed(n._actionMap.PlaySlideShowAction))({})}),new(n.managed(m.e))({text:f.rotate,icon:new b.e("rotate"),renderLabel:2,action:new(n.managed(n._actionMap.RotateAction))({})}),new(n.managed(m.e))({text:f.Edit,tooltip:f.EditPhotoTooltip,renderLabel:2,icon:new b.e("EditPhoto"),action:new(n.managed(n._actionMap.OpenInImageEditorAction)),teachingBubble:!Object(h.isFeatureEnabled)(h.EnableEditControlTeachingBubble)||Object(h.isFeatureEnabled)(h.MentionTeachingUIAA)||Object(h.isFeatureEnabled)(h.EnableExpirationSectionForTMR)?void 0:n._coachmarkProvider.getCurrentTeachingBubble()}),new(n.managed(m.e))({text:f.applyOfficeLens,renderLabel:2,icon:new b.e("LightningBolt"),action:new(n.managed(n._actionMap.ApplyOfficeLensAction))}),new(n.managed(m.e))({text:f.removeOfficeLens,renderLabel:2,icon:new b.e("Undo"),action:new(n.managed(n._actionMap.RemoveOfficeLensAction))}),new(n.managed(m.e))({text:f.Download,icon:new b.e("Download"),renderLabel:2,action:new(n.managed(n._actionMap.DownloadAction))({}),automationId:"download"}),new(n.managed(m.e))({text:f.DeleteItem,icon:new b.e("Delete"),renderLabel:2,action:new(n.managed(n._actionMap.DeleteAction))({}),automationId:"delete"}),new(n.managed(m.e))({text:f.viewOriginal,icon:new b.e("Picture"),renderLabel:2,action:new(n.managed(n._actionMap.ViewOriginalAction))({})}),new(n.managed(m.e))({text:f.viewInFolder,icon:new b.e("Folder"),action:new(n.managed(n._actionMap.ViewInFolderAction)),renderLabel:2}),new(n.managed(m.e))({text:f.OrderPrints,icon:new b.e("Print"),renderLabel:2,action:new(n.managed(n._actionMap.OrderPrintsAction))({})}),new(n.managed(m.e))({text:f.Embed,icon:new b.e("Embed"),renderLabel:2,action:new(n.managed(n._actionMap.EmbedAction))({})}),new(n.managed(m.e))({text:f.editTags,renderLabel:2,icon:new b.e("Tag"),keys:["T"],action:new(n.managed(n._actionMap.EditTagsAction))}),new(n.managed(m.e))({renderLabel:2,text:n.createPureComputed(function(){return E()?f.ViewMode:f.AccessibilityMode}),icon:n.createPureComputed(function(){return E()?new b.e("Page"):new b.e("EaseOfAccess")}),action:new(n.managed(j))({accessibilityMode:E})}),new(n.managed(m.e))({text:f.Copy,renderLabel:2,icon:new b.e("Copy"),automationId:"copy",action:new(n.managed(n._actionMap.LaunchMoveCopyPanelAction))({isMove:!1})}),new(n.managed(m.e))({text:p.s,renderLabel:2,icon:new b.e("StackIndicator"),automationId:"version-history",action:new(n.managed(n._actionMap.ShowVersionHistoryAction))})],Object(h.isFeatureEnabled)(h.EnableAnonReportConcernCommand)?[new(n.managed(m.e))({text:p.l,icon:new b.e("EditNote"),renderLabel:2,automationId:"reportConcern",action:new(n.managed(n._actionMap.ReportAbuseAction))({})})]:[],!0),r&&r.allowInfectedDownload?[new(n.managed(m.e))({text:f.Download,renderLabel:2,icon:new b.e("Download"),action:new(n.managed(n._actionMap.ShowMalwareDetectedAction))({})})]:[],!0),[s.actionsCommand,n.overflowHostCommand,new(n.managed(m.e))({tooltip:p.e,icon:new b.e("Info"),location:12,action:new(n.managed(n._actionMap.ShowPropertiesAction))({useToggleBehavior:!0}),ariaControls:A,ariaExpanded:L,renderLabel:0,hasIconOnly:!0,keys:["I"],automationId:"showProperties",teachingBubble:Object(h.isFeatureEnabled)(h.MentionTeachingUIAA)?n._coachmarkProvider.getCurrentTeachingBubble():void 0})],!1)),n}return Object(i.__extends)(t,e),t.prototype._subscribeToSelectedItemEvent=function(e){var t=this;this.observables.subscribe(this._selection.selection,function(n){t._checkAndSetCommentsCampaign(n,e)})},t.prototype._checkAndSetCommentsCampaign=function(e,t){t()||(this._checkIfCommentCampaignIsApplicable(e)?xe.ODC_WEB_COMMENTS!==this._coachmarkProvider.currentCampaign()&&this._coachmarkProvider.setCampaign(xe.ODC_WEB_COMMENTS):xe.ODC_WEB_COMMENTS===this._coachmarkProvider.currentCampaign()&&this._coachmarkProvider.hideCampaign())},t.prototype._isOfficeItem=function(e){var t=e.extension&&e.extension.replace(/^\./,"");return t&&Ce.t[t]&&".pdf"!==e.extension||e.type===Oe.e.OneNote},t.prototype._checkIfCommentCampaignIsApplicable=function(e){var t,n;if(!e||1!==e.length||!e[0]())return!1;var a=e[0]();return void 0===a.dateDeleted&&a.graph&&!a.isRootFolder&&!this._isOfficeItem(a)&&!a.vault&&(0===a.sharingRole||2===a.sharingRole)&&!(null===(n=null===(t=a.comments)||void 0===t?void 0:t.settings)||void 0===n?void 0:n.isCommentDisabled)&&this._identityDataSource&&this._identityDataSource.getIdentity().type!==we.e.anonymous},t.prototype._computeOpenInOfficeOnlineText=function(){return g.s(Object(v.e)(this._selection,!0))||f.Open},t.prototype._computeOpenInOfficeClientText=function(){return g.c(Object(v.e)(this._selection,!0))},t.prototype._computOpenInOfficeSuffixClass=function(){return g.r(Object(v.e)(this._selection,!0))},t.prototype._computeOfficeIcon=function(){var e,t=Object(v.e)(this._selection,!0);return t&&(e=g.o(t)),e||new b.e("Page")},t}(d.e),Te=function(e){function t(t){var n=e.call(this,t)||this;n._legend=t.legend;var a=n.createPureComputed(function(){return!t.canNavigate()}),i=n.createPureComputed(function(){return t.canNavigate()&&t.areFlippersPermanent()}),r=new(n.managed(be))({action:t.previous,condition:t.canNavigate}),o=new(n.managed(be))({action:t.next,condition:t.canNavigate});return n.commands.push(new(n.managed(_e.e))({renderLabel:2}).command,new(n.managed(m.e))({text:he.previousTooltip,icon:new b.e(X.e.isRightToLeft?"ChevronRight":"ChevronLeft"),renderLabel:2,location:12,isPermanent:i,isInvisibleWhenDisabled:!0,automationId:"previousButton",keys:[X.e.isRightToLeft?"Right":"Left"],action:r}),new(n.managed(m.e))({text:n._legend,location:12,automationId:"oneUpPageCount",isDisabled:c.observable(!0),isHidden:a,role:"text"}),new(n.managed(m.e))({text:he.nextTooltip,icon:new b.e(X.e.isRightToLeft?"ChevronLeft":"ChevronRight"),renderLabel:2,location:12,positionIconRight:!0,isPermanent:i,isInvisibleWhenDisabled:!0,automationId:"nextButton",keys:[X.e.isRightToLeft?"Left":"Right"],action:o}),new(n.managed(m.e))({icon:new b.e("Cancel"),text:f.Close,hasIconOnly:!0,renderLabel:0,action:new(n.managed(ye)),automationId:"close",keys:["Esc"],location:12})),n}return Object(i.__extends)(t,e),t}(d.e),Ue=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._actionMap=n.resources.consume(o.e),n.commands=c.observableArray([new(n.managed(m.e))({text:f.pauseSlideshow,renderLabel:2,icon:new b.e("Pause"),action:new(n.managed(n._actionMap.StopSlideShowAction))({})})]),n}return Object(i.__extends)(t,e),t}(d.e),Fe=n(2822),He=n(1789),Re=n(1066),Ne=n(1052),Be=function(e){function t(t){var n=e.call(this,t)||this,a=t.valueAccessor();return n._callback=a.callback,n._delay=a.delay||500,n.events.on(n.element,"click",n._onClick),n}return Object(i.__extends)(t,e),t.prototype._onClick=function(e){this._timerID?(this.async.clearTimeout(this._timerID),this._timerID=void 0):this._timerID=this.async.setTimeout(this._onClickTimer,this._delay)},t.prototype._onClickTimer=function(){this._timerID=void 0,this._callback&&this._callback()},t}(n(161).t),je=n(1940),Ve=n(2980),ze=n(1708),Ge=n(1886),Ke=n(1877),We=n(2981),qe=n(1788),Qe=n(3008),Ye=n(1779),Je=n(1796),Xe=n(419),Ze=n(81),$e=n(498),et=n(2153),tt=n(2003),nt=n(2024),at=n(637),it=n(32),rt=Object(at.e)({eventName:"OneUpCarousel,",shortEventName:"OneUpCarousel"},{initialFileType:it.e.String,initialFileExtension:it.e.String,initialFileSize:it.e.Number,pagesViewed:it.e.Number,totalPages:it.e.Number,isFolderShownInSession:it.e.Boolean}),ot=n(156),st=n(2209),ct=n(2769),dt=n(3068),lt=n(2982),ut=n(2152),ft=n(1989),pt=n(96),mt=n(2264),_t=n(1057),ht=n(3009),bt=n(2521),gt=new U.t({name:"OneUpCommandBar.key",loader:new F.t(function(){return n.e(454).then(n.bind(null,4327)).then(function(e){return e.resourceKey.local})})}),vt=n(1890),yt=n(3010),St=n(140),Dt=n(2189),It=n(2923),xt=n(2922),Ct=n(2206),Ot=n(21),wt=n(1812),Et=n(1843),At=Dt.n.themePrimary,Lt=Dt.e.themePrimary,kt=new wt.e("OneUp",wt.t.component),Mt=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;a.overlayHostTagName=et.e.tagName,a.dialogHostTagName=tt.e.tagName,a.panelHostTagName=nt.e.tagName,a.carouselTagName=ut.e.tagName,a.oneUpSlideTagName=dt.e.tagName,a.addBindingHandlers({clientRect:He.e,keyboard:Ne.e,idle:Ve.e,throttledClick:Be,control:ot.n,childFocus:Re.e,hideWhenInactive:mt.e,transclusionHost:je.e}),a._originalTheme=Object(ae.L)(),a._darkThemeInLightMode=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},a._originalTheme||{}),Dt.t||{}),{isInverted:!1}),a._isUsingOriginalTheme=!0,a._isUsingOriginalThemeV2=c.observable(!0),a._isFirstLoadDarkThemeInLightMode=!0,a._carouselEvent=new rt,a._carouselEventData={initialFileType:"",initialFileExtension:"",initialFileSize:0,pagesViewed:0,totalPages:0,isFolderShownInSession:!1};var r=n.rateLimitExtenders,d=void 0===r?{rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}:r;a._rateLimitExtenders=d;var l=a,u=l.observables,f=l.resources;a.slideLoadState=u.create(0),a._onSlideLoaded=t.onSlideLoaded;var p=n.toolbarProvider;a.agentHost={name:ft.e.tagName,params:{provider:p}},a.showAgent=u.pureCompute(function(){if(Object(h.isFeatureEnabled)(h.EnableLivePhotoVideos)||Object(h.isFeatureEnabled)(h.EnableSamsungMotionPhotoVideos)){var e=a.item(),t=e&&e.peek();if(t&&t.video&&("AppleLivePhoto"===t.video.burstPhotoType||"SamsungMotionPhoto"===t.video.burstPhotoType))return!1}return p.contexts().length>0});var m=n.paneProvider;a.paneHost={name:ft.e.tagName,params:{provider:m,useCustomTemplate:!0}},Ot.e.isActivated("464730AD-2EA1-49F0-BEA4-0302565B9E83","06/29/2022","Override Engagement context in OneUp")||f.expose(wt.n,a.resources.consume(wt.n).withPart(kt).withPart(Et.e,{item:a.observables.pureCompute(function(){return a.observables.unwrap(a.item())})})),f.bind(N.n),f.bind(N.e),f.expose(B.e,u.create(!1)),f.bind(Ke.e),f.bind(Ge.e),f.bind(_t.e),a.isSlideShowModeEnabled=u.create(!1),f.expose(o.P,a),a.addCaptionLabel=u.create(""),a.isRotating=u.create(!1),a.isIdle=u.create(!1),a._actionMap=n.actionMap,a._initializeItem({item:n.focusItem});var _=n.currentItemSet;a._initializeItemSet({itemSet:n.focusItemSet||_}),a._parent=u.pureCompute(function(){return a._itemSet().item()}),f.block(o.c),a._selectionModel=f.expose(o.w,new(a.managed(s.e))({indexResolver:n.indexResolver})),a.allocationRange=t.requiredRange,a.size=u.create({width:0,height:0}),f.expose(ze.e.infoPane.hidePreview,u.create(!0)),f.bind(De.e);var b=a.isInfoPaneExpanded=f.consume(Ie.e);a._focusedInfoPaneSection=n.focusedInfoPaneSection,a.showPane=u.pureCompute(function(){return b()||m.contexts().length>0});var g={deferEvaluation:!0};a.isCommandBarVisible=u.create(!0),a.isNewDeisgnedCommandBarEnabled=a._shouldUseNewCommandBar(),a.isAwake=u.pureCompute(a._computeIsAwake,g),a.oneUp={currentPriority:u.createCallback(lt.e),isRotating:a.isRotating,isCommandBarVisible:a.isCommandBarVisible,isDarkThemeForMediaSenario:a._isDarkThemeForMediaSenario(),isDarkThemeForMediaEnabled:a._shouldUseDarkThemeForMedia(),isDarkMode:a._isDarkMode(),isInfoPaneExpanded:b,enableSlideControls:u.create(!1),size:a.size,slide:u.create(),shareLinkId:t.shareLinkId,isAwake:a.isAwake},a.isPhotosOnly=a._exposeIfNeeded(ze.e.oneUpOverlay.isPhotosOnly,u.create(!1)),a.isDarkBackgroundEnabled=u.pureCompute(function(){return a.isPhotosOnly()&&a._shouldUseDarkBackground(n.identityDataSource)}),a.canNavigate=u.pureCompute(a._computeCanNavigate,g),a.accessibleItemAnnouncementText=u.pureCompute(a._computeAccessibleItemAnnouncementText),a.caption=u.pureCompute(a._computeCaption,g),a.showEditCaption=u.pureCompute(a._computeIsEditCaptionEnabled,g),a._dataManagerMapper=n.dataManagerMapper,a._areFlippersPermanent=u.pureCompute(function(){return a.items().length>1}),a.legend=u.pureCompute(a._computeLegend,g),a._initializeActions(),a.commandBarSpecification=a.isNewDeisgnedCommandBarEnabled?Object(ot.a)(gt.bypass,{commandSet:a._getCommandSet(n),isMobile:!1}):Object(ot.a)(vt.e.bypass,{commandSet:a._getCommandSet(n),isMobile:!1}),a._initializeOpenParentWhenEmpty(),a.isIdleEnabled=u.pureCompute(a._computeIsIdleEnabled,g),a.isDetailsFocused=u.create(!1),a.isPanningEnabled=u.pureCompute(a._computeIsPanningEnabled,g);var v=$e.e.getScrollbarWidth()+"px";a.nextFlipperStyle={},a.nextFlipperStyle[X.e.safeRight]=v,a.previousFlipperStyle={},a.previousFlipperStyle[X.e.safeLeft]=v,a.detailsBarStyle=u.pureCompute(a._computeDetailsBarStyle,g);var y=u.pureCompute(function(){return a.slideLoadState()>=3});a.infoPaneSpecification=Object(ot.a)(st.e,{showSections:y}),t.isSlideshow&&u.compute(function(){t.isSlideshow(a.isSlideShowModeEnabled())}).extend({deferred:!0});var S=n.viewParams&&n.viewParams.peek();if(a._shouldShowActivityFeed(S)&&!a.isInfoPaneExpanded.peek()){var D=a._focusedInfoPaneSection;if(D&&D(9),S&&S.commentId){var I=S.commentId;a._navigation=a.resources.consume(Ze.e);var x=a._navigation.viewParams;x&&x.commentId&&(delete x.commentId,a._navigation.updateViewParams(x)),a.deeplinkCommentId=a.resources.consume(ct.e),a.deeplinkCommentId({commentId:I})}a._showPropertiesAction.execute(null)}return u.backgroundCompute(a._computeViewerTheme),u.backgroundCompute(a._computeSetCaptionLabel),u.backgroundCompute(a._computeClearCaptionFocus),u.backgroundCompute(a._computeSelectItem),u.backgroundCompute(a._computeTriggerClientRectUpdate),u.backgroundCompute(a._computeCommandBarShownOnIdleFullScreen),u.backgroundCompute(a._computeIsFirstSlideOpened),u.backgroundCompute(a._computePagesViewed),u.backgroundCompute(a._computeSlideLoadState),a}return Object(i.__extends)(t,e),t.prototype.executeAction=function(e,t){return!e.isAvailable.peek()||(e.execute(t),!1)},t.prototype.enterSlideshowMode=function(){return Qe.e.enterFullScreen(),!!this.isSlideShowModeEnabled.peek()&&(this._timeOutId=this.async.setTimeout(this._startSlideshow,3e3),!0)},t.prototype.exitSlideshowMode=function(){return Qe.e.exitFullScreen(),this.isSlideShowModeEnabled(!1),!!this._timeOutId&&(this.async.clearTimeout(this._timeOutId),!0)},t.prototype.onExitInfoPane=function(e){this.async.setTimeout(function(){c.removeNode(e)},500)},t.prototype.onContentClicked=function(e){var t=this.oneUp.slide,n=t&&t.peek();return!(!n||!n.isPanningEnabled.peek()||this.isSlideShowModeEnabled.peek())},t.prototype.toggleInfoPaneExpanded=function(e){return this._showPropertiesAction.execute(e),!1},t.prototype.editCaption=function(e){if(!this.isInfoPaneExpanded.peek()){var t=this._focusedInfoPaneSection;t&&t(1),this._showPropertiesAction.execute(e)}return!1},t.prototype.dispose=function(){var t=this.peekUnwrapObservable(this._itemSet);if(t){var n=t.content.peek();this._carouselEventData.totalPages=n.items.length}this._carouselEvent.end(this._carouselEventData),Qe.e.isFullScreen()&&Qe.e.exitFullScreen(),Ot.e.isActivated("9b004be7-6252-434e-a687-f22bd0363ed1","11/08/2021","Move theme recover time from dispose to close action.")&&(this._isUsingOriginalTheme||Object(ae.P)(this._originalTheme)),e.prototype.dispose.call(this)},t.prototype._startSlideshow=function(){return this.isInfoPaneExpanded.peek()&&this.toggleInfoPaneExpanded(null),!!this.isSlideShowModeEnabled.peek()&&(this._timeOutId=this.async.setTimeout(this._startSlideshow,3e3),!(!this.slideLoadState.peek()||this.executeAction(this._openNext,null))||void 0)},t.prototype._initializeItemSet=function(e){var t=this,n=e.itemSet;this._sourceItemSet=n;var a,i=this.observables;this.index=i.pureCompute(this._computeIndex),this._isPlaceholderItemSetRequired=i.pureCompute(function(){var e=n();return(!e.content()||e.isPlaceholder)&&-1===t.index()},{deferEvaluation:!0});var r=i.pureCompute(function(){var e;return t._isPlaceholderItemSetRequired()?((e=new Ye.e).item=n.peek().item,a&&a.dispose(),a=i.compute(function(){var n=new Je.e;n.items=[t.item()],e.content(n)})):e=n(),e});r.equalityComparer=Xe.n;var s=i.pureCompute(function(){return r().item()});s.equalityComparer=Xe.n,this.resources.expose(o.r,s),this._itemSet=this.resources.expose(o.o,r),this.items=i.createArray(),i.backgroundCompute(function(){t.items(t._itemSet().content().items)})},t.prototype._initializeItem=function(e){var t,n,a=this,i=e.item,r=this.observables,o=this.item=r.create();if(o.equalityComparer=Xe.n,i){if(Object(h.isFeatureEnabled)(h.EngagementTelemetryEnhancement)&&i&&(null===(n=null===(t=i.peek())||void 0===t?void 0:t.peek())||void 0===n?void 0:n.isPlaceholder)){this._isFastOneUp=!0;var s=this.resources.consume(Ct.e);this.scope.attach(new s({getCurrentPageName:function(){return"FastOneUp"},itemSet:this._itemSet}))}r.backgroundCompute(function(){o(i())}),r.backgroundCompute(function(){if(o()!==i.peek()){var e=a._openCurrent;e.isAvailable.peek()&&e.execute(null).done()}}).extend(this._rateLimitExtenders)}},t.prototype._computeIndex=function(){var e=this.item(),t=this._sourceItemSet().content().items;return e?t.indexOf(e):-1},t.prototype._computeAccessibleItemAnnouncementText=function(){var e=this.item(),t=e&&e().displayName;return t?T.format(We.accessibleItemAnnouncement,t):""},t.prototype._initializeActions=function(){var e=this,t=this.observables,n=t.pureCompute(function(){return t.unwrap(e.item())}),a=this._actionMap,r=this.managed(a.OpenAction),o={openRelation:2,urlType:"focus",itemSet:this._itemSet,ignoreHistory:!0};this._openCurrent=new r(Object(i.__assign)(Object(i.__assign)({},o),{item:n})),this._openPrevious=new r(Object(i.__assign)(Object(i.__assign)({},o),{item:t.pureCompute(this._computePreviousItem)})),this._openNext=new r(Object(i.__assign)(Object(i.__assign)({},o),{item:t.pureCompute(this._computeNextItem)})),this.updateCaptionAction=new(this.managed(a.UpdateCaptionAction))({item:n}),this._showPropertiesAction=new(this.managed(a.ShowPropertiesAction))({useToggleBehavior:!0}),this._openFastOneUp=new r(Object(i.__assign)(Object(i.__assign)({},o),{openOnly:!0,item:n}))},t.prototype._computePreviousItem=function(){var e=this.index();if(!(e<0))for(var t=this.isSlideShowModeEnabled.peek(),n=this.items(),a=e-1;a>=0;a--){var i=this.unwrapObservable(n[a]);if(!t||i&&!i.video)return i}},t.prototype._computeNextItem=function(){var e=this.index();if(!(e<0)){for(var t=this.isSlideShowModeEnabled.peek(),n=this.items(),a=e+1,i=n.length;a<i;a++){var r=this.unwrapObservable(n[a]);if(!t||r&&!r.video)return r}t&&this.exitSlideshowMode()}},t.prototype._initializeOpenParentWhenEmpty=function(){var e=this,t=new(this.managed(this._actionMap.OpenAction))({openRelation:2,item:this._parent,ignoreHistory:!0}),n=this.observables,a=n.pureCompute(function(){var t=e._itemSet();return t.content(),!t.isPlaceholder&&!t.item().isPlaceholder||t.item().error?e.items().length:a.peek()});n.backgroundCompute(function(){0===a()&&t.isAvailable.peek()&&t.execute(null)}).extend(this._rateLimitExtenders)},t.prototype._computeTriggerClientRectUpdate=function(){this.isInfoPaneExpanded(),this.isCommandBarVisible(),c.computedContext.isInitial()||this.async.setTimeout(function(){pt.t.raise(document.body,"resize",void 0,!0)},500)},t.prototype._computeClearCaptionFocus=function(){!this.isInfoPaneExpanded()&&this._focusedInfoPaneSection&&this._focusedInfoPaneSection(null)},t.prototype._computeCommandBarShownOnIdleFullScreen=function(){Qe.e.isFullScreen()&&this.isCommandBarVisible(!this.isIdle())},t.prototype._computePagesViewed=function(){var e=this.oneUp.slide();e&&(this._carouselEventData.pagesViewed++,e.item&&e.item.peek()&&e.item.peek().folder&&(this._carouselEventData.isFolderShownInSession=!0))},t.prototype._computeCanNavigate=function(){if(!Object(h.isFeatureEnabled)(h.RemoveOneUpSlideNavigation))return!0;var e=this.item.peek();if(!e)return this.item(),!1;var t=e.peek();return!t||t.isPlaceholder?(e(),!1):!!t.photo},t.prototype._computeIsFirstSlideOpened=function(){var e=this.oneUp.slide,t=e.peek();if(t){if(t.item){var n=t.item.peek();if(n){var a=this._carouselEventData;a.initialFileSize=n.size,a.initialFileType=n.iconName&&n.iconName.toLowerCase(),a.initialFileExtension=n.extension&&n.extension.toLowerCase()}}t.isFirstSlideOpened(!0)}else e()},t.prototype._computeSlideLoadState=function(){0!==this.slideLoadState()&&this._onSlideLoaded&&this._onSlideLoaded()},t.prototype._getCommandSet=function(e){var t=e.commandSet;return void 0===t?this.isNewDeisgnedCommandBarEnabled?this._createSelectableCommandSet(e):this._createSelectableCommandSetDeprecated(e):t},t.prototype._createSelectableCommandSet=function(e){var t=this,n=e.oneUpCommandSet,a=void 0===n?new(this.managed(me)):n,i=e.slideshowCommandSet,r=void 0===i?new(this.managed(Ue)):i,o=this.observables,s=new(this.managed(Se))({legend:this.legend,next:this._openNext,previous:this._openPrevious,areFlippersPermanent:this._areFlippersPermanent,canNavigate:this.canNavigate,parent:this._parent,isUsingOriginalTheme:this._isUsingOriginalThemeV2,originalTheme:this._originalTheme}),c=new(this.managed(ke))({}),d=o.pureCompute(function(){var e=t.oneUp.slide();if(t.isSlideShowModeEnabled())return[r,s];var n=e&&e.commandSet();if(n)return[n,s];var i=e&&e.augmentCommandSet();return i?[a,i,s,c]:[a,s,c]});return new(this.managed(Fe.e))({commandSets:d})},t.prototype._createSelectableCommandSetDeprecated=function(e){var t=this,n=e.oneUpCommandSet,a=void 0===n?new(this.managed(Pe)):n,i=e.slideshowCommandSet,r=void 0===i?new(this.managed(Ue)):i,o=this.observables,s=new(this.managed(Te))({legend:this.legend,next:this._openNext,previous:this._openPrevious,areFlippersPermanent:this._areFlippersPermanent,canNavigate:this.canNavigate,parent:this._parent}),c=o.pureCompute(function(){var e=t.oneUp.slide();if(t.isSlideShowModeEnabled())return[r,s];var n=e&&e.commandSet();if(n)return[n,s];var i=e&&e.augmentCommandSet();return i?[a,i,s]:[a,s]});return new(this.managed(Fe.e))({commandSets:c})},t.prototype._computeDetailsBarStyle=function(){var e=this.oneUp.slide(),t=$e.e.getScrollbarWidth(),n=e&&e.hasHorizontalScrollbar()?t:0,a=e&&e.hasVerticalScrollbar()?t:0,i={bottom:n+"px"};return i[X.e.safeRight]=a+"px",i},t.prototype._computeViewerTheme=function(){var e=this;if(!this._originalTheme.isInverted){var t=this.observables.unwrap(this.item());t&&this._shouldUseDarkThemeForMedia()&&(Ot.e.isActivated("9b004be7-6252-434e-a687-f22bd0363ed1","11/08/2021","Move theme recover time from dispose to close action.")?t.photo||t.audio||t.video?this._isUsingOriginalTheme&&(this._isFirstLoadDarkThemeInLightMode?(this._loadThemeTimeoutId=this.async.setTimeout(function(){Object(ae.P)(e._darkThemeInLightMode),e._isUsingOriginalTheme=!1},300),this._isFirstLoadDarkThemeInLightMode=!1):(this._loadThemeTimeoutId&&this.async.clearTimeout(this._loadThemeTimeoutId),Object(ae.P)(this._darkThemeInLightMode),this._isUsingOriginalTheme=!1)):this._isUsingOriginalTheme||(Object(ae.P)(this._originalTheme),this._isUsingOriginalTheme=!0):t.photo||t.audio||t.video?this._isUsingOriginalThemeV2.peek()&&(this._isFirstLoadDarkThemeInLightMode?(this._loadThemeTimeoutId=this.async.setTimeout(function(){Object(ae.P)(e._darkThemeInLightMode),e._isUsingOriginalThemeV2(!1)},300),this._isFirstLoadDarkThemeInLightMode=!1):(this._loadThemeTimeoutId&&(this.async.clearTimeout(this._loadThemeTimeoutId),this._loadThemeTimeoutId=null),Object(ae.P)(this._darkThemeInLightMode),this._isUsingOriginalThemeV2(!1))):this._isUsingOriginalThemeV2.peek()||(Object(ae.P)(this._originalTheme),this._isUsingOriginalThemeV2(!0)))}},t.prototype._computeSetCaptionLabel=function(){var e=this.item(),t=e&&e.peek(),n=t&&t.photo?qe.captionAddCaption:qe.captionAddDescription;this.addCaptionLabel(n)},t.prototype._computeLegend=function(){return this.isNewDeisgnedCommandBarEnabled?this._computeLegendWithFormat(We.legendFormat):this._computeLegendWithFormat(We.legendFormatDeprecated)},t.prototype._computeLegendWithFormat=function(e){var t=this.index(),n=this._dataManagerMapper,a=n&&n(),i=a?a.itemSet():this._itemSet(),r=a?a.getOriginalItemIndexByMappedIndex(t):t;if(r>-1)return T.format(e,r+1,i.content().items.length);var o=this.item(),s=o&&o();return s&&!s.isPlaceholder?T.format(e,1,1):""},t.prototype._computeCaption=function(){var e=this.unwrapObservable(this.item());return e&&e.caption},t.prototype._computeIsAwake=function(){return this.isDetailsFocused()||!this.isIdle()||!this.isIdleEnabled()},t.prototype._computeIsIdleEnabled=function(){var e=this.oneUp.slide();return!e||e.isIdleEnabled()},t.prototype._computeIsPanningEnabled=function(){if(!this.canNavigate())return!1;var e=this.oneUp.slide();return e&&e.isPanningEnabled()},t.prototype._computeIsEditCaptionEnabled=function(){var e=this.oneUp.slide();return e&&e.isEditCaptionEnabled()&&(this.updateCaptionAction.isAvailable()||!!this.caption())},t.prototype._computeSelectItem=function(){var e,t=this.item(),n=this._selectionModel;if(n.selection()[0]!==t){var a=n.getItemKey(t);n.setSelectedKeys([a])}else Object(h.isFeatureEnabled)(h.EngagementTelemetryEnhancement)&&this._isFastOneUp&&!(null===(e=t.peek())||void 0===e?void 0:e.isPlaceholder)&&this._openFastOneUp.execute(null).done()},t.prototype._shouldShowActivityFeed=function(e){return e&&(e.commentId||e.Nav&&e.Nav.indexOf("commentId")>=0)},t.prototype._shouldUseNewCommandBar=function(){return!!this.resources.consume(xt.e.optional)},t.prototype._shouldUseDarkThemeForMedia=function(){return this._isDarkThemeForMediaSenario()&&!!this.resources.consume(It.e.optional)},t.prototype._isDarkThemeForMediaSenario=function(){if(!this.isNewDeisgnedCommandBarEnabled)return!1;var e=this._originalTheme.palette.themePrimary;return e===At||e===Lt},t.prototype._isDarkMode=function(){return this._originalTheme.isInverted},t.prototype._shouldUseDarkBackground=function(e){if(Object(h.isFeatureEnabled)(h.DarkBackgroundForPhotosOneUp))return!0;if(Object(h.isFeatureEnabled)(h.DarkBackgroundForPhotosOneUpExperiment)){if(e){var t=e.getIdentity();t&&St.t.init({userLoginName:t.email})}return new St.t({name:"DarkBackgroundForPhotosOneUpExperiment",startDate:"3/20/2020",version:St.e.v2},h.DarkBackgroundForPhotosOneUpExperiment_ABTrigger).isOn()}return!1},t.prototype._exposeIfNeeded=function(e,t){return this.resources.isExposed(e)?this.resources.consume(e):this.resources.expose(e,t)},t.dependencies=Object(i.__assign)(Object(i.__assign)({},r.t.dependencies),{focusItem:o._.optional,focusItemSet:o.h.optional,currentItemSet:o.o.optional,indexResolver:o.M.optional,paneProvider:ht.e,toolbarProvider:bt.e,actionMap:o.e,focusedInfoPaneSection:yt.e.optional,dataManagerMapper:o.i.optional,viewParams:o.F,commandSet:void 0,oneUpCommandSet:void 0,slideshowCommandSet:void 0,rateLimitExtenders:void 0,identityDataSource:C.I}),t}(r.t),Pt=Object(ot.t)({automationName:"ms-one-up",name:"OneUp",template:'<div class="OneUp" data-bind="css:{\'OneUp--hasInfoPane\':showPane,\'OneUp--awake\':isAwake,\'OneUp--panningEnabled\':isPanningEnabled,\'OneUp--hasItems\':items().length,\'OneUp--hasCommandBar\':isCommandBarVisible,\'OneUp--newDesignedCommandBar\':isNewDeisgnedCommandBarEnabled,\'OneUp--slideShowOn\':isSlideShowModeEnabled,\'OneUp--darkBackground\':isDarkBackgroundEnabled}" role="presentation"><div class="OneUp-accessibleItemAnnouncement" aria-live="polite" data-bind="text:accessibleItemAnnouncementText"></div><div class="OneUp-commandBar" data-bind="hideWhenInactive,control:commandBarSpecification"></div><div class="OneUp-content" data-bind="hideWhenInactive,clientRect:{size:size}" role="presentation"><div class="OneUp-carousel" data-bind="component:{name:carouselTagName,params:{item:item,items:items,canNavigate:canNavigate,allocationRange:allocationRange,loadState:slideLoadState,isEnabled:isPanningEnabled,isRotating:isRotating}},idle:{isIdle:isIdle,isEnabled:isIdleEnabled},throttledClick:{callback:$component.onContentClicked.bind($component)},automation:\'carousel\'" role="presentation">\x3c!--ko component:{name:$component.oneUpSlideTagName,params:{slide:$host,oneUp:$component.oneUp}}--\x3e\x3c!--/ko--\x3e</div><div class="OneUp-detailsBar" data-bind="css:{\'OneUp-detailsBar--hasCaption\':showEditCaption},style:detailsBarStyle,childFocus:isDetailsFocused" role="presentation">\x3c!--ko if:showEditCaption--\x3e<div class="OneUp-caption-container">\x3c!--ko if:updateCaptionAction.isAvailable--\x3e<button class="OneUp-caption OneUp-caption--editable" data-bind="click:editCaption,css:{\'OneUp-caption--existing\':caption}"><span data-bind="text:caption()||addCaptionLabel"></span></button>\x3c!--/ko--\x3e\x3c!--ko ifnot:updateCaptionAction.isAvailable--\x3e<div class="OneUp-caption OneUp-caption--existing"><span data-bind="text:caption"></span></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:showAgent--\x3e<div class="OneUp-agent" data-bind="component:agentHost"></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if:showPane--\x3e<div class="OneUp-paneHost" data-bind="hideWhenInactive,component:paneHost" role="presentation">\x3c!--ko with:$host.contexts()[0]--\x3e\x3c!--ko transclusionHost:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot:$host.contexts().length--\x3e\x3c!--ko if:$component.isInfoPaneExpanded--\x3e<div class="OneUp-infoPane" data-bind="control:infoPaneSpecification"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko component:{name:panelHostTagName}--\x3e\x3c!--/ko--\x3e\x3c!--ko component:{name:dialogHostTagName}--\x3e\x3c!--/ko--\x3e\x3c!--ko component:{name:overlayHostTagName}--\x3e\x3c!--/ko--\x3e</div>',viewModelType:Mt});t.default=Pt},2421:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n(8),i=new a.t({name:"".concat("OneUpOnePlayerFlightResourceKeys",".isOnePlayerEnabled"),factory:new a.e(!1)}),r=new a.t({name:"".concat("OneUpOnePlayerFlightResourceKeys",".isOnePlayerVroomTranscriptsEnabled"),factory:new a.e(function(){return!1})})},2512:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s});var a=n(203),i=n(59),r=n(79);function o(e,t,n){return i.n.all([d(e),d(e,n)]).then(function(e){var n=e[0],a=e[1],i=a.length>n.length;return{text:i?n:a,mimeType:t,isSafeText:i||c(a)}},function(e){return e.filter(function(e){return!i.n.isCanceled(e)})[0]||e[0]})}function s(e,t){return d(e).then(function(e){return{text:e,mimeType:t,isSafeText:!0}})}function c(e){for(var t=0;t<e.length;t++)if(!((n=e.charCodeAt(t))<127||l[n]))return!1;var n;return!0}function d(e,t){var n=new a.e,i=new FileReader;return i.onload=function(){n.complete(i.result||"")},i.onerror=function(e){var t=i.error;n.error(new r.e({code:t&&(t.name||"Parse.".concat(t.code))||"Parse",isExpected:!1,message:t&&t.message||"Parsing error"}))},i.readAsText(e,t),n.getPromise()}var l={130:1,132:1,133:1,134:1,135:1,137:1,139:1,145:1,146:1,147:1,148:1,149:1,150:1,151:1,153:1,155:1,160:1,166:1,167:1,169:1,171:1,172:1,173:1,174:1,176:1,177:1,181:1,182:1,183:1,187:1}},2519:function(e,t,n){"use strict";var a=n(0),i=n(161),r=n(22),o=n(2589),s=n(2520),c=function(e){function t(t){var n=e.call(this,t)||this;return n.controlsDescendantBindings=!0,n.createComputed(n._computeUpdate),n}return Object(a.__extends)(t,e),t.prototype._computeUpdate=function(){var e,t,n,a=this,i=this.unwrapObservable(this.valueAccessor());if(!i)return r.virtualElements.emptyNode(this.element),void(this._iframe=void 0);switch(i.type){case"get":i.url&&(n=!0,t=function(e){e.src=i.url});break;case"content":n=!0,t=function(e){if(Object(s.e)())e.srcdoc=i.content;else{var t=new Blob([i.content],{type:"text/html"}),n=window.URL.createObjectURL(t);a.scope.attach({dispose:function(){window.URL.revokeObjectURL(n)}}),e.src=n}};break;case"post":i.url&&(n=!0,e=function(e){Object(o.e)({url:i.url,postdata:i.postdata,document:e.contentDocument})})}var c=n&&(this._iframe||document.createElement("iframe"));return function(e,t){e&&(t.className&&(e.className=t.className),t.title&&(e.title=t.title),t.role&&e.setAttribute("role",t.role),"string"==typeof t.sandbox&&e.setAttribute("sandbox",t.sandbox),e.frameBorder="0")}(c,i),t&&t(c),c&&!this._iframe&&(this._iframe=c,this.events.on(c,"load",this._onLoad),r.virtualElements.setDomNodeChildren(this.element,[c]),r.utils.domNodeDisposal.addDisposeCallback(c,function(){a.events.off(c,"load",a._onLoad),function(e){e.src="",e.srcdoc=""}(c)})),e&&e(c),c?void 0:(r.virtualElements.emptyNode(this.element),void(this._iframe=void 0))},t.prototype._onLoad=function(e){var t=this.peekUnwrapObservable(this.valueAccessor());t.onLoad&&t.onLoad(e)},t.supportsVirtualElements=!0,t}(i.t);t.e=c},2520:function(e,t,n){"use strict";var a;function i(){return"boolean"!=typeof a&&(a="srcdoc"in document.createElement("iframe")),a}n.d(t,"e",function(){return i})},2521:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(1835),r=new a.t({name:"ToolbarProvider.key",factory:i.e})},2589:function(e,t,n){"use strict";function a(e){var t=e.document;t.body||t.createElement("body");var n=t.createElement("form");n.action=e.url,n.method="POST",n.style.visibility="hidden",n.target="_self";var a=e.postdata;for(var i in a){var r=t.createElement("input");r.type="hidden",r.name=i,r.value=a[i],n.appendChild(r)}t.body.appendChild(n),n.submit()}n.d(t,"e",function(){return a})},2590:function(e,t,n){"use strict";var a=new(n(8).t)({name:"AccessibilityMode.key"});t.e=a},2769:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(22),r=new a.t({name:"DeeplinkCommentId.key",factory:{dependencies:{},create:function(){return{instance:i.observable({})}}}})},2822:function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=t.commandSets,i=void 0===a?[]:a;return n._commandSets=n.wrapObservable(i),n.createComputed(n._computeUpdateCommandSet),n}return Object(a.__extends)(t,e),t.prototype._computeUpdateCommandSet=function(){for(var e,t,n=[],i=[],r=[],o=0,s=this._commandSets();o<s.length;o++){for(var c=s[o],d=this.observables.unwrap(c),l=[],u=0,f=d.commands();u<f.length;u++){var p=f[u];p===d.overflowHostCommand?r.push.apply(r,p.children()):4==(4&p.location)?l.push(p):n.push(p)}i.unshift.apply(i,l)}var m=this.overflowHostCommand.children.peek();(e=this.overflowHostCommand.children).splice.apply(e,Object(a.__spreadArray)([0,m.length],r,!1)),n.push(this.overflowHostCommand),n.push.apply(n,i),(t=this.commands).splice.apply(t,Object(a.__spreadArray)([0,this.commands.peek().length],n,!1))},t}(n(1872).e);t.e=i},2827:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(112),r=new a.t({name:"ItemActionBar.key",loader:new i.t(function(){return n.e(459).then(n.bind(null,3406)).then(function(e){return e.resourceKey.local})})})},2828:function(e,t,n){"use strict";var a=function(){function e(){}return e.isMsPdfViewerSupported=function(){if(void 0===e._isWasmSupported){var t=!1;try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){var n=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));n instanceof WebAssembly.Module&&(t=new WebAssembly.Instance(n)instanceof WebAssembly.Instance)}}catch(e){}e._isWasmSupported=t}return e._isWasmSupported},e}();t.e=a},2832:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.share=1]="share",e[e.copyLink=2]="copyLink",e[e.manageAccess=5]="manageAccess",e[e.addPeople=7]="addPeople"}(a||(a={}))},2920:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(0),i=n(1056),r=n(59),o=n(48),s=n(1843),c=n(450),d=n(23),l=n(91),u=n(773),f=n(147),p=n(11),m=new c.e,_=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="Open";var i=t.item,r=t.openRelation,o=void 0===r?0:r,s=t.ignoreHistory,c=void 0!==s&&s,l=t.itemSet,f=t.openLocal,p=void 0!==f&&f,m=t.urlType,_=void 0===m?"default":m,h=t.preserveAction,b=void 0!==h&&h,g=t.nonFoldersOnly,v=void 0!==g&&g,y=t.openOnly,S=void 0!==y&&y;a._openRelation=o,a._nonFoldersOnly=v,a._urlType=a.wrapObservable(_),a._openOnly=S,a._itemSelectionHelper=new(a.child(u.e))({overrideItem:2===o?i:void 0,allowMultiSelect:!1,canFallback:0!==o,ignoreSelection:0!==o}),a.item=a.createComputed(a._computeItem,{deferEvaluation:!0,pure:!0});var D=a.resources.consume(d.e);return a._navigateToItemAction=new(a.managed(D.NavigateToItemAction))({item:a.item,itemSet:l,parentItem:a._itemSelectionHelper.currentItem,urlType:a._urlType,forceInSameWindow:p,isRedirect:c,shouldPreserveAction:b}),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.item();return(!this._nonFoldersOnly||!!e&&!e.folder)&&this._navigateToItemAction.isAvailable()},t.prototype.onExecute=function(t,n){if(Object(p.isFeatureEnabled)(p.EngagementTelemetryEnhancement)&&this._openOnly)return e.prototype.onExecute.call(this,t,n);var a=this.item.peek();return a?(a.type===l.e.Folder&&n&&n.data&&(n.data.folder=!0),n.data.extraData||(n.data.extraData={}),f.e(n.data.extraData,{uniqueId:a.properties?a.properties.uniqueId:void 0}),this._navigateToItemAction.execute(t).then(function(){var e={fileType:l.e[a.type||l.e.Unknown],extension:a.extension||""};return r.n.resolve({resultType:o.e.Success,extraData:e})})):r.n.resolve({resultType:o.e.ExpectedFailure})},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(s.e,{item:this.item})},t.prototype.trackUserAction=function(t){var n=this.item.peek();if(n)switch(n.type){case l.e.File:e.prototype.trackUserAction.call(this,"Open.File");break;case l.e.Media:e.prototype.trackUserAction.call(this,"Open.Media");break;default:e.prototype.trackUserAction.call(this,t)}},t.prototype._computeItem=function(){var e=this._itemSelectionHelper.firstItem();return(3===this._openRelation?e&&e.UNSAFE_parent:e)||m},t}(i.e);t.t=_},2922:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(11),r=new a.t({name:"EnableNewOneUpCommandBarResourceKey",factory:new a.e(Object(i.isFeatureEnabled)(i.EnableNewOneUpCommandBar))})},2923:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(11),r=new a.t({name:"EnableDarkThemeForOneUpMediaResourceKey",factory:new a.e(Object(i.isFeatureEnabled)(i.EnableDarkThemeForOneUpMediaViewer))})},2980:function(e,t,n){"use strict";var a=n(0),i=n(161),r=n(332),o=n(22),s=n(150),c="function"==typeof PointerEvent,d=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=t.valueAccessor();return a._isIdle=i.isIdle||o.observable(!1),a._isEnabled=i.isEnabled||o.observable(!0),a._isInIdleZone=o.observable(!1),a._idleZoneElement=i.idleZoneElement||a.element,a._shouldClicksWake=i.shouldClicksWake,a._lastTouchPosition=null,a._lastMousePosition=null,a._lastPointerExitPosition=null,a._pointerCount=0,a._pointers={},a._isMouseDown=!1,a._isSuspended=!1,a._idle=a.createComputed(a._computeIdle).extend({rateLimit:{timeout:4e3,method:"notifyWhenChangesStop"}}),a.createComputed(a._computeAwakenWhenNotEnabled),a.createComputed(a._computeSuspendIdleEvents),a.events.on(a._idleZoneElement,"click",a._onClick),a.events.on(document,"mousedown",a._onMouseDown,!0),a.events.on(document,"mousemove",a._onMouseMove,!0),a.events.on(document,"mouseup",a._onMouseUp,!0),a.events.on(document,"mouseout",a._onMouseOut,!0),a.events.on(document,"mousewheel",a._onMouseWheel,!0),a.events.on(window,"blur",a._onWindowBlur,!0),a.events.on(window,"focus",a._onWindowFocus,!0),c?(a.events.on(document,"pointerdown",a._onPointerDown,!0),a.events.on(document,"pointermove",a._onPointerMove,!0),a.events.on(document,"pointerup",a._onPointerUp,!0),a.events.on(document,"pointercancel",a._onPointerCancel,!0),a.events.on(document,"lostpointercapture",a._onLostPointerCapture,!0)):(a.events.on(document,"touchstart",a._onTouchStart,!0),a.events.on(document,"touchmove",a._onTouchMove,!0),a.events.on(document,"touchend",a._onTouchEnd,!0),a.events.on(document,"touchcancel",a._onTouchCancel,!0)),a}return Object(a.__extends)(t,e),t.prototype._computeIdle=function(){var e=this._isIdle(),t=this._isInIdleZone(),n=this._isEnabled();!e&&t&&n&&this._isIdle(!0)},t.prototype._computeAwakenWhenNotEnabled=function(){this._isEnabled()||this._isIdle(!1)},t.prototype._resetPosition=function(){this._lastMousePosition=null,this._lastTouchPosition=null},t.prototype._onClick=function(e){if(0===e.button){var t=this._lastMousePosition,n=new r.e(e.clientX,e.clientY);this._resetPosition(),t&&n.distance(t)>=10||(this._isInIdleZone(!0),!this._isSuspended&&this._isEnabled.peek()&&(this._shouldClicksWake?this._isIdle(!1):this._isIdle(!this._isIdle.peek())))}},t.prototype._onMouseDown=function(e){if(0===e.button){this._isMouseDown=!0;var t=new r.e(e.clientX,e.clientY);this._lastMousePosition=t}},t.prototype._onMouseMove=function(e){var t=this._lastTouchPosition,n=this._lastMousePosition,a=new r.e(e.clientX,e.clientY);if(!(t&&a.distance(t)<10)){var i=function(e,t){for(;e;){if(e===t)return!0;e=Object(s.e)(e)}return!1}(e.target,this._idleZoneElement);this._isInIdleZone(i),!this._isMouseDown&&!this._pointerCount&&n&&a.distance(n)>=10&&(this._resetPosition(),!this._isSuspended&&this._isEnabled.peek()&&this._isIdle(!1)),this._lastMousePosition||(this._lastMousePosition=a)}},t.prototype._onMouseUp=function(e){0===e.button&&(this._isMouseDown=!1)},t.prototype._onMouseOut=function(e){if(!this._isMouseDown){var t=this._lastPointerExitPosition,n=new r.e(e.clientX,e.clientY);if(this._resetPosition(),this._lastPointerExitPosition=null,!(t&&n.distance(t)<10)&&function(e){var t=e.relatedTarget||e.toElement;return!t||"HTML"===t.nodeName}(e)){var a=this._isInIdleZone.peek();this._isInIdleZone(!0),a&&this._idle()}}},t.prototype._onMouseWheel=function(e){this._isIdle(!1)},t.prototype._onWindowBlur=function(e){this._isIdle(!0)},t.prototype._onWindowFocus=function(e){this._isIdle(!1)},t.prototype._onTouchStart=function(e){this._pointerCount+=e.changedTouches.length,this._trackTouch(e),this._lastMousePosition=this._lastTouchPosition},t.prototype._onTouchMove=function(e){this._trackTouch(e)},t.prototype._onTouchEnd=function(e){this._pointerCount-=e.changedTouches.length,this._trackTouch(e)},t.prototype._onTouchCancel=function(e){this._pointerCount-=e.changedTouches.length},t.prototype._trackTouch=function(e){this._lastTouchPosition=new r.e(e.changedTouches[0].clientX,e.changedTouches[0].clientY)},t.prototype._onPointerDown=function(e){"mouse"!==e.pointerType&&(this._pointers[e.pointerId]||(this._pointerCount++,this._trackPointer(e),this._lastMousePosition=this._lastTouchPosition))},t.prototype._onPointerMove=function(e){"mouse"!==e.pointerType&&this._pointers[e.pointerId]&&this._trackPointer(e)},t.prototype._onPointerUp=function(e){"mouse"!==e.pointerType&&(this._trackPointer(e),this._removePointer(e))},t.prototype._onPointerCancel=function(e){"mouse"!==e.pointerType&&(this._trackPointer(e),this._removePointer(e))},t.prototype._onLostPointerCapture=function(e){"mouse"!==e.pointerType&&this._removePointer(e)},t.prototype._trackPointer=function(e){var t=new r.e(e.clientX,e.clientY);this._pointers[e.pointerId]=t,this._lastTouchPosition=t},t.prototype._removePointer=function(e){this._pointers[e.pointerId]&&(this._lastPointerExitPosition=this._pointers[e.pointerId],delete this._pointers[e.pointerId],this._pointerCount--)},t.prototype._computeSuspendIdleEvents=function(){this._isIdle(),this._isSuspended=!0,this.async.clearTimeout(this._suspendIdleEventsTimeoutId),this._suspendIdleEventsTimeoutId=this.async.setTimeout(this._onSuspensionCompleted,500)},t.prototype._onSuspensionCompleted=function(){this._isSuspended=!1},t}(i.t);t.e=d},2982:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={defaultValue:-1/0,reducer:function(e,t){return e>0?t:t>0?e:Math.max(e,t)}}},3008:function(e,t,n){"use strict";var a=function(){function e(){}return e.isFullScreen=function(){var e=window.document;return e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement},e.enterFullScreen=function(){var t=window.document.body;e.isFullScreen()||(t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen())},e.exitFullScreen=function(){var e=window.document;e.exitFullscreen?e.exitFullscreen():e.msExitFullscreen?e.msExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen&&e.webkitExitFullscreen()},e.isFullScreenAllowed=function(){var e=window.document;return e.fullscreenEnabled||e.webkitFullscreenEnabled||e.mozFullScreenEnabled||e.msFullscreenEnabled},e}();t.e=a},3009:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(1835),r=new a.t({name:"PaneProvider.key",factory:i.e})},3010:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(55),i=new(n(8).t)({name:"FocusedInfoPaneSection.key",factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create(),disposable:t}}}})},3068:function(e,t,n){"use strict";var a=n(20);Object(a.n)([{rawString:".OneUp-slide{position:absolute;left:0;right:0;top:0;bottom:0}.OneUp-slide:after,.OneUp-slide:before{display:block;position:absolute;width:2%;height:100%;content:''}html[dir=ltr] .OneUp-slide:before{right:100%}html[dir=rtl] .OneUp-slide:before{left:100%}html[dir=ltr] .OneUp-slide:after{left:100%}html[dir=rtl] .OneUp-slide:after{right:100%}.od-OneUpVideo{position:absolute;left:0;right:0;top:0;bottom:0}.OneUp-other{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}.OneUp-other .OneUp-other-content{text-align:center}.OneUp-other .OneUp-other-content .OneUp-other-fileName{font-size:21px}.OneUp-other .OneUp-other-content .OneUp-other-download{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-other .OneUp-other-content .OneUp-other-message{margin-top:15px;margin-bottom:15px}.OneUp-other .OneUp-other-content .OneUp-other-actions .od-ButtonBar-main{float:none}.OneUp-other .OneUp-other-content .OneUp-other-fileIcon .FileTypeIcon{outline:0}.OneUp-other .OneUp-other-content .od-ButtonBarCommand:not(.od-Button--primary){background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.OneUp-error{display:flex;justify-content:center;align-items:center;height:100%}.OneUp-slide-error{overflow-x:hidden;overflow-y:auto;position:absolute;left:0;right:0;top:0;bottom:0}.OneUp-photo .od-Projector--live .od-ImageTile-background{transition:max-width 267ms cubic-bezier(.1,.9,.2,1),max-height 267ms cubic-bezier(.1,.9,.2,1)}.OneUp-photo .od-Projector--live.od-Projector--panning .od-ImageTile-background{transition-duration:0s,0s}.OneUp-otherTile{width:240px;height:240px;margin:auto;position:relative}.OneUp-fileHandler,.OneUp-fileHandler-frame{border:0;width:100%;height:100%}.OneUp-other-malwareDetectedIcon{height:208px;width:208px}"}]);var i=n(379),r=n(0),o=n(175),s=n(974),c=n(120),d=n(48),l=n(1480),u=n(327),f=n(156),p=n(11),m=n(8),_=n(112),h=new m.t({name:"OneUp3d.key",loader:new _.t(function(){return n.e(456).then(n.bind(null,4227)).then(function(e){return e.resourceKey.local})})}),b=h,g=n(1987),v=n(2004),y=n(21),S=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.addBindingHandlers({control:f.n});var i=t.slide.item.peek(),r=i&&i.error&&i.error.data,o=t.slide.renderOptions,s=t.showErrorActions,c=void 0===s||s;return a.errorComponent={specification:Object(f.a)(v.t,{error:r,hideAction:Object(p.isFeatureEnabled)(p.EmbedAccessOnEmbedAspx)&&Object(p.isFeatureEnabled)(p.EmbedLinkSupportOnEmbedAspx)&&r.actionUrl?!c:!!o||!c}),afterRender:function(){return a._activate()}},a}return Object(r.__extends)(t,e),t.prototype._activate=function(){var e,t=this.slide,n=t.item.peek(),a=n&&n.error&&n.error.data;if(y.e.isActivated("e162d174-9d50-4dc0-b26a-0aba06a7560c","6/10/2021","Mark error as expected when error code is 404,403"))e=this.observables.create({resultType:d.e.Failure,resultCode:"".concat(a.errorCode),error:a&&a.errorDetailedText,extraData:{CorrelationId:a&&a.correlationId}});else{var i="".concat(a.errorCode),r=-1!==["403","404"].indexOf(i);e=this.observables.create({resultType:r?d.e.ExpectedFailure:d.e.Failure,resultCode:i,error:a&&a.errorDetailedText,extraData:{CorrelationId:a&&a.correlationId}})}this.scope.attach(t.loadResult.register(e)),t.loadState(3)},t}(g.e),D=Object(f.t)({automationName:"od-one-up-error",name:"OneUpError",template:'<div class="OneUp-error" data-bind="control:errorComponent"></div>',viewModelType:S}),I=new m.t({name:"OneUpFileHandler.key",loader:new _.t(function(){return n.e(457).then(n.bind(null,4263)).then(function(e){return e.resourceKey.local})})}),x=I;Object(a.n)([{rawString:".OneUp-html{position:absolute;top:0;left:0;right:0;bottom:0;margin:20px 20px;-webkit-overflow-scrolling:touch}.OneUp-html.iOS{overflow:auto}.OneUp-html iframe{width:100%;height:100%;background-color:#fff;border:0;box-shadow:0 0 7px 2px rgba(0,0,0,.15);overflow:auto;-webkit-overflow-scrolling:touch}"}]);var C=n(223),O=n(59),w=n(971),E=n(1081),A=n(2512),L=n(2519),k=n(2124),M=n(62),P=n(204),T=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.addBindingHandlers({control:f.n,iframe:L.e});var i=a,o=i.observables,s=i.slide,c=Object(r.__assign)(Object(r.__assign)({},s),{loadResult:o.createCallback(Object(C.t)())}),d=n.platformDetection.isIOS;a.className=d?"iOS":"",a.showError=o.create(!1),a.showHtml=o.pureCompute(a._computeShowHtml),a.fallbackControl=Object(f.a)(k.e,{slide:c,oneUp:a.oneUp}),a.iframeOptions=o.create(),a._downloadDataSource=n.downloadDataSource,a._graphDataSource=n.graphDataSource;var l=a._loadResult=o.create();return a.scope.attach(s.loadResult.register(l)),a._populateContent(d),a}return Object(r.__extends)(t,e),t.prototype._computeShowHtml=function(){return!this.slide.offset()&&!!this.iframeOptions()},t.prototype._populateContent=function(e){var t=this,n=this.slide.item.peek();this.showError(!1),this.trackPromise(this._getContents(n).then(function(n){n?t.iframeOptions({type:"content",sandbox:"",content:n,onLoad:function(n){t.slide.loadState(3),t._loadResult({resultType:d.e.Success});var a=n.target;if(e&&a){var i=a.clientWidth,r=a.clientHeight;a.style.width="".concat(i,"px"),a.style.height="".concat(r,"px")}}}):(t._loadResult({resultType:d.e.ExpectedFailure,resultCode:"NoContent",error:"HTML is empty"}),t._showError())},function(e){t._loadResult({resultType:e&&e.isExpected?d.e.ExpectedFailure:d.e.Failure,resultCode:e&&(e.code||e.name),error:e&&e.message}),t._showError()}))},t.prototype._showError=function(){this.showError(!0),this.slide.loadState(3)},t.prototype._getContents=function(e){var t=e.extension,n=e.htmlConversion,a=t&&t.toLowerCase();if(n&&".htm"!==a&&".html"!==a&&".svg"!==a){var i=this._graphDataSource,r=n.url||i.getAuthenticationParams(e).then(function(t){return"".concat(i.getItemUrl(e,{useDirectEndpoint:!0}),"/content?format=html&").concat(Object(w.e)(t))});return O.n.resolve(r).then(function(e){return E.e.startAndPostProcess({url:e},function(e,t){return e.responseText})}).catch(function(e){if(e instanceof XMLHttpRequest){var t=new Error("HTTP ".concat(e.status)),n=e.getResponseHeader("X-ErrorCode");return t.code="".concat(n||e.status),t.isExpected=406===e.status,O.n.reject(t)}return O.n.reject(e)})}return this._downloadDataSource.getItemContents(e).then(function(e){return A.t(e,"text/html")}).then(function(e){return e.text})},t.dependencies=Object(r.__assign)(Object(r.__assign)({},g.e.dependencies),{downloadDataSource:M.c,graphDataSource:M.y,platformDetection:P.e}),t}(g.e),U=Object(f.t)({automationName:"od-one-up-html",name:"OneUpHtml",template:'\x3c!--ko if:showError--\x3e\x3c!--ko control:fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:showHtml--\x3e<div class="OneUp-html" data-bind="iframe:iframeOptions,class:className" style="-webkit-overflow-scrolling: touch"></div>\x3c!--/ko--\x3e',viewModelType:T}),F=new m.t({name:"OneUpImage360.key",loader:new _.t(function(){return n.e(455).then(n.bind(null,4228)).then(function(e){return e.resourceKey.local})})}),H=F,R=new m.t({name:"OneUpOnePlayer.key",loader:new _.t(function(){return n.e(460).then(n.bind(null,4124)).then(function(e){return e.resourceKey.local})})}),N=R,B=new m.t({name:"OneUpPanorama.key",loader:new _.t(function(){return n.e(461).then(n.bind(null,4167)).then(function(e){return e.resourceKey.local})})}),j=B;Object(a.n)([{rawString:".od-Projector{position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden}.od-Projector-image{position:absolute;left:0;top:0;width:100%;height:100%;transform-origin:0 0;touch-action:none;will-change:transform;-webkit-backface-visibility:hidden;backface-visibility:hidden;perspective:1000}.od-Projector--gliding.od-Projector--preview .od-Projector-image{transition:transform 267ms cubic-bezier(.1,.9,.2,1)}.od-Projector--gliding.od-Projector--live .od-Projector-image{transition:left 267ms cubic-bezier(.1,.9,.2,1),top 267ms cubic-bezier(.1,.9,.2,1),width 267ms cubic-bezier(.1,.9,.2,1),height 267ms cubic-bezier(.1,.9,.2,1)}"}]);var V,z=n(1714),G=n(2071),K=n(1789),W=n(2017),q=n(666),Q=n(1397),Y=n(332),J=n(2054),X=new q.e(0,0,1,1),Z=X.getCenter(),$=100;!function(e){e[e.live=0]="live",e[e.preview=1]="preview"}(V||(V={}));var ee=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.addBindingHandlers({host:z.e,pan:G.t,clientRect:K.e});var i=t.isZoomed,r=void 0===i?a.createObservable(!1):i,o=t.isEnabled,s=void 0===o?a.createObservable(!0):o,c=t.mode,d=void 0===c?V.live:c;a.panTransform=a.createObservable(W.e.IDENTITY),a.panTransform.equalityComparer=G.e,a.contentTransform=a.createObservable(W.e.IDENTITY),a.contentTransform.equalityComparer=G.e,a.imageTransform=a.createObservable(W.e.IDENTITY),a.imageTransform.equalityComparer=G.e,a.isPanning=a.createObservable(!1),a.isGliding=a.createObservable(!1),a.isZoomed=r,a.isEnabled=s,a.size=a.createObservable(),a._lastZoomTogglePosition=null,a._mode=d,a.mode=V[a._mode],a.createBackgroundComputed(a._computeResetGlide),a.createBackgroundComputed(a._computePreviewTransform),a.createBackgroundComputed(a._computeCommitTransform);var l=a.createBackgroundComputed(a._computeStartGlide);a.createBackgroundComputed(a._computeEndGlide).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});var u=a.createBackgroundComputed(a._computeApplyTransformOnZoomed);return a.createBackgroundComputed(a._computeResetZoomOnTransformed),a.imageStyle=a.createPureComputed(a._computeImageStyle,{deferEvaluation:!0}),n&&n.disableFrameSkip||(J.e(l,a.async),J.e(u,a.async)),a.host={transform:a._mode===V.live?a.panTransform:a.contentTransform,isGliding:a.isGliding},a}return Object(r.__extends)(t,e),t.prototype.toggleIsZoomed=function(e,t){var n=this.size.peek(),a=n&&new Y.e(t.clientX/n.width,t.clientY/n.height)||Z;this._lastZoomTogglePosition=a,this.isZoomed(!this.isZoomed())},t.prototype.mayStartPan=function(e,t,n){return this.isEnabled.peek()&&(Math.abs(t)>=10&&n.length>=2||this.isZoomed.peek()&&e.translate.abs()>=10)},t.prototype.constrainPanScale=function(e){return Math.max(1,Math.min(4,e))},t.prototype._computeResetGlide=function(){this.isPanning()&&(this.isGliding(!1),this.isZoomed(!0))},t.prototype._computePreviewTransform=function(){if(this.isPanning()){var e=this.panTransform();e=te(e,!0),this.imageTransform(this.contentTransform().invert().multiply(e))}},t.prototype._computeCommitTransform=function(){if(!this.isPanning()&&!this.isGliding.peek()){var e=this.panTransform.peek();e=e.scale<W.e.IDENTITY.scale?W.e.IDENTITY:te(e),this._applyTransform(e)}},t.prototype._computeStartGlide=function(){this.isPanning()||W.e.areEqual(this.imageTransform(),W.e.IDENTITY)||(this.isGliding(!0),this.imageTransform(W.e.IDENTITY))},t.prototype._computeEndGlide=function(){var e=this.isPanning(),t=this.isGliding();!e&&t&&this.isGliding(!1)},t.prototype._computeApplyTransformOnZoomed=function(){var e=this.isZoomed(),t=this.isEnabled(),n=this.isPanning.peek(),a=this.contentTransform.peek();n||(e&&t?W.e.areEqual(a,W.e.IDENTITY)&&this._applyTransform(W.e.zoom(Y.e.ORIGIN,this._lastZoomTogglePosition||Z,3)):W.e.areEqual(a,W.e.IDENTITY)||this._applyTransform(W.e.IDENTITY)),this._lastZoomTogglePosition=null},t.prototype._computeResetZoomOnTransformed=function(){var e=this.isPanning(),t=this.contentTransform();!e&&W.e.areEqual(t,W.e.IDENTITY)&&this.isZoomed(!1)},t.prototype._computeImageStyle=function(){var e=this.contentTransform(),t=this.imageTransform();if(this._mode===V.live){var n=e.multiply(t);return{left:"".concat(n.translate.x*$,"%"),top:"".concat(n.translate.y*$,"%"),width:"".concat(n.scale*$,"%"),height:"".concat(n.scale*$,"%")}}var a="translate(".concat(t.translate.x*$,"%, ").concat(t.translate.y*$,"%)");return{left:e.translate.x*$+"%",top:e.translate.y*$+"%",width:e.scale*$+"%",height:e.scale*$+"%","-ms-transform":a,"-webkit-transform":a,transform:a}},t.prototype._applyTransform=function(e){var t=this.contentTransform.peek().multiply(this.imageTransform.peek());this.contentTransform(e),this.imageTransform(e.invert().multiply(t)),this.panTransform(e)},t}(o.t);function te(e,t){void 0===t&&(t=!1);var n=Math.max(W.e.IDENTITY.scale,e.scale),a=new q.e(e.apply(Z).subtract(new Y.e(n,n).scale(.5)),new Q.e(n,n)),i=X,r=i.nudge(a),o=i.getCenter().subtract(r.getCenter());return t&&(o=o.unit().scale(o.abs()-Math.atan(Math.PI*o.abs())/Math.PI*Math.log(e.scale/W.e.IDENTITY.scale))),new W.e(o).multiply(e)}var ne=i.e({tagName:"od-projector",template:'<div class="od-Projector" data-bind="class:\'od-Projector--\'+mode,css:{\'od-Projector--gliding\':isGliding,\'od-Projector--panning\':isPanning},pan:{isActive:isPanning,transform:panTransform,mayStartPan:$component.mayStartPan.bind($component),constrainScale:$component.constrainPanScale.bind($component)},clientRect:{size:size},event:{dblclick:$component.toggleIsZoomed.bind($component)}"><div class="od-Projector-image" data-bind="style:imageStyle,host:{data:host}"></div></div>',viewModel:ee,synchronous:!0}),ae=n(2244),ie=n(1255),re=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.addBindingHandlers({control:f.n}),a.slide.isEditCaptionEnabled(!0);var i=t.item,r=void 0===i?a.slide.item:i;a._item=r,a._isZoomed=a.createObservable(!1);var o={isEnabled:a.createPureComputed(function(){return!a.slide.offset()&&!a.oneUp.isRotating()}),isZoomed:a._isZoomed};return a.projector={name:ne.tagName,params:o},a.createBackgroundComputed(a._computeChangesOnZoom),a}return Object(r.__extends)(t,e),t.prototype.getThumbnailControl=function(e){var t=this,n=e.transform,a=e.isGliding,i=this.createPureComputed(function(){return n().scale}),r=this.createPureComputed(function(){var e=t.oneUp.size();return{width:e.width*n().scale,height:e.height*n().scale}});r.equalityComparer=ie.e;var o=this.createPureComputed(function(){return!a()});return Object(f.a)(ae.e,{slide:this.slide,oneUp:this.oneUp,size:r,scale:i,fallbackThumbnail:this.createPureComputed(this._computeFallbackThumbnail),allowLoading:o,item:this._item,expectLoadingFailure:!1})},t.prototype._computeFallbackThumbnail=function(){var e=this._item().photo;if(e){var t=e.originalUrl,n=e.width,a=e.height;if(t)return{url:t,width:n,height:a}}},t.prototype._computeChangesOnZoom=function(){var e=this._isZoomed();this.slide.isPanningEnabled(!e)},t}(g.e),oe=Object(f.t)({automationName:"od-one-up-photo",name:"OneUpPhoto",template:'<div class="OneUp-photo" data-bind="component:projector">\x3c!--ko control:getThumbnailControl($host)--\x3e\x3c!--/ko--\x3e</div>',viewModelType:re});n(1077).e.addConfig({map:{"*":{"../build/pdf.js":"pdfjs-dist/build/pdf"}}});var se=new m.t({name:"OneUpPdf.key",loader:new _.t(function(){return n.e(462).then(n.bind(null,4203)).then(function(e){return e.resourceKey.local})})}),ce=se,de=new m.t({name:"OneUpMSPdf.key",loader:new _.t(function(){return n.e(458).then(n.bind(null,4117)).then(function(e){return e.resourceKey.local})})}),le=de,ue=Object(p.isFeatureEnabled)(p.EnableOneUpTextFileV2)?new m.t({name:"OneUpTextFile.key",loader:new _.t(function(){return n.e(464).then(n.bind(null,4229)).then(function(e){return e.resourceKey.local})})}):new m.t({name:"OneUpTextFile.key",loader:new _.t(function(){return n.e(464).then(n.bind(null,4230)).then(function(e){return e.resourceKey.local})})}),fe=ue,pe=new m.t({name:"OneUpVideo.key",loader:new _.t(function(){return n.e(465).then(n.bind(null,4120)).then(function(e){return e.resourceKey.local})})}),me=pe,_e=new m.t({name:"OneUpWAC.key",loader:new _.t(function(){return n.e(466).then(n.bind(null,4204)).then(function(e){return e.resourceKey.local})})}),he=_e,be=new m.t({name:"OneUpWrs.key",loader:new _.t(function(){return n.e(467).then(n.bind(null,4161)).then(function(e){return e.resourceKey.local})})}),ge=be,ve=new m.t({name:"OneUpZip.key",loader:new _.t(function(){return n.e(468).then(n.bind(null,4205)).then(function(e){return e.resourceKey.local})})}),ye=ve,Se=n(419),De=n(1755),Ie=n(358),xe=n(2520),Ce=n(2828),Oe=n(2421),we=n(13),Ee={"3d":b,Audio:me,Error:D,FileHandler:x,Html:U,OnePlayerAudio:N,OnePlayerVideo:N,Other:k.e,Panorama:j,Image360:H,Pdf:ce,MSPdf:le,Photo:oe,TextFile:fe,Thumbnail:ae.e,Video:me,WAC:he,Wrs:ge,Zip:ye},Ae=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.addBindingHandlers({control:f.n}),a._offset=t.slide.offset;var i=a._oneUp=t.oneUp,r=t.renderOptions,o=a.observables,s=a._loadResult=o.createCallback({defaultValue:void 0,reducer:ke});t.loadResult&&a.scope.attach(t.loadResult.register(s)),a.slide={loadState:t.slide.loadState,offset:a._getSlideOffset(),item:t.slide.item,isIdleEnabled:o.create(!0),isEditCaptionEnabled:o.create(!1),isPanningEnabled:o.create(!r),hasHorizontalScrollbar:o.create(!1),hasVerticalScrollbar:o.create(!1),isFirstSlideOpened:o.create(!1),commandSet:o.create(),augmentCommandSet:o.create(),loadResult:s,renderOptions:r};var c=a.resources;a._fileHandlerProvider=c.consume(De.e.optional);var d=c.consume(P.e);a._enableHTML=Object(p.isFeatureEnabled)(p.UseSandboxHtmlViewer)&&(Object(xe.e)()||d.isEdge),a._enablePdf=Object(p.isFeatureEnabled)(p.UseWebPdfViewer),a._enableImage360=Object(p.isFeatureEnabled)(p.Image360Viewer)&&!d.isMobile,a._enablePriority=!we.e.isActivated("C721A5CD-435A-48E4-A155-1CAD6BD1F7FB","10/21/2021","Slide priority"),a._enableOnePlayer=!!c.consume(Oe.e.optional),a._enableMsPdfviewer=Object(p.isFeatureEnabled)(p.UseMsPdfViewer),a._enablePreviewTif=Object(p.isFeatureEnabled)(p.UsePdfViewerToPreviewTif);var l=a.priority=o.pureCompute(a._computePriority);return a.scope.attach(i.currentPriority.register(l)),a.name=o.pureCompute(a._computeName),a.isError=o.create(!1),a.name.equalityComparer=Se.n,a.key=o.pureCompute(a._computeKey),a.key.equalityComparer=Se.n,a.component=o.pureCompute(a._computeComponent),a._qos=o.compute(a._computeQos),a._engagementReported=!1,o.compute(a._computeUpdateOneUpSlide),o.backgroundCompute(a._computeCompleteQos),a}return Object(r.__extends)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._oneUp.slide.peek()===this.slide&&this._oneUp.slide(void 0)},t.prototype._computeComponent=function(){var e=this.key(),t={slide:this.slide,oneUp:this._oneUp};return e&&Object(f.a)(e.bypass,t)},t.prototype._computeName=function(){var e=this.slide.item(),t=this._extension(e),n=(this.slide.renderOptions||{}).viewer;return!e||e.isPlaceholder?void 0:e.error?(Object(p.isFeatureEnabled)(p.EmbedAccessOnEmbedAspx)&&Object(p.isFeatureEnabled)(p.EmbedLinkSupportOnEmbedAspx)&&self!==top&&2===e.error.type&&this.isError(!0),"Error"):e.folder||3===e.itemStatus||e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected?"Other":n||(e.officeBundle?"Wrs":e.wopiFrameUrl?"WAC":this._hasFileHandler(e,t)?"FileHandler":this._enableHTML&&e.htmlConversion?"Html":this._enablePdf&&(this._enablePreviewTif||".tif"!==t&&".tiff"!==t)&&(".pdf"===t||".ai"===t||e.pdfConversion)?this._enableMsPdfviewer&&Ce.e.isMsPdfViewerSupported()?"MSPdf":"Pdf":e.video?this._enableOnePlayer?"OnePlayerVideo":"Video":e.audio?this._enableOnePlayer?"OnePlayerAudio":"Audio":e.panorama?"Panorama":this._enableImage360&&e.image360?"Image360":e.model3d?"3d":e.zip?"Zip":this._useTextEditor(e)?"TextFile":e.photo?"Photo":e.thumbnail?"Thumbnail":"Other")},t.prototype._computeKey=function(){if(!(this._enablePriority&&this.priority()<this._oneUp.currentPriority())){var e=this.name();return e&&Ee[e]}},t.prototype._computePriority=function(){var e=this.slide,t=e.loadState()>=3,n=e.offset(),a=(n>0?n:n<0?-n:0)+1;return t?a:-a},t.prototype._useTextEditor=function(e){return Object(p.isFeatureEnabled)(p.UseOneUpTextEditor)&&Object(Ie.a)(e)},t.prototype._extension=function(e){return e&&e.extension&&e.extension.toLowerCase()||""},t.prototype._hasFileHandler=function(e,t){var n=this._fileHandlerProvider;return!!n&&!!e.graph&&!!n.getDefaultPreviewHandler(t)},t.prototype._computeUpdateOneUpSlide=function(){this._offset()?this._oneUp.slide.peek()===this.slide&&this._oneUp.slide(void 0):this._oneUp.slide(this.slide)},t.prototype._getSlideOffset=function(){var e=this,t=this.createPureComputed(function(){var n=t.peek();return void 0!==n&&e._oneUp.isRotating()?n:e._offset()});return t},t.prototype._computeQos=function(){var e=this.slide,t=this._qosValue,n=this.name();if(n){if(t&&t.loaded.data.extraData.viewer===n)return t;if(!e.offset()&&!(e.loadState()>0||e.loadResult())){var a=e.item.peek(),i=a.size,o=e.renderOptions,d=o&&o.qosEvent,u=a.urls?a.urls[s.e.mediaBaseUrl]:"",f=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},d&&d.data.extraData||{}),u?{mediaServiceRegion:u}:{}),{viewer:n,extension:this._extension(a),fileSize:i,fileSizeRange:Le(i)});return this._cpEvent=new l.e({scenario:"ItemViewer.".concat(n,".Load"),extraData:{extension:this._extension(a)}}),this._qosValue={loaded:new c.e({name:"LoadSlide",extraData:f}),loaded2:new c.e({name:"ItemViewer.".concat(n,".Load"),extraData:f}),rendered:new c.e({name:"ItemViewer.".concat(n,".Render"),extraData:f})}}}},t.prototype._computeCompleteQos=function(){var e,t=this.slide;if(!t.offset()){var n=this._qos();if(n){var a=n.loaded,i=n.loaded2,o=n.rendered,s=this.name.peek(),c=t.item.peek(),l={extension:this._extension(c),fileSizeRange:Le(c.size),viewer:s},f=this.key(),m=t.loadState();f&&m>=1&&o.end({resultType:d.e.Success,extraData:Object(r.__assign)(Object(r.__assign)({},o.data.extraData),l)});var _=this._loadResult();if(f&&_){var h=t.renderOptions,b=h&&h.qosEvent,g=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},a.data.extraData),l),_.extraData||{}),v=Object(r.__assign)(Object(r.__assign)({},_),{extraData:g});if(a.end(v),i.end(v),this._cpEvent&&this._cpEvent.end({resultType:_.resultType,errorCode:_.resultCode}),b&&(b.end(v),Object(p.isFeatureEnabled)(p.EngagementTelemetryEnhancement)&&!this._engagementReported&&(null===(e=this.resources.consume(u.e))||void 0===e||e.logData(b.data),this._engagementReported=!0)),this._oneUp.shareLinkId){var y={};try{y.previewLoaded=Date.now(),y.navigationStart=performance.timing.navigationStart,y.redirectStart=performance.timing.redirectStart,y.redirectEnd=performance.timing.redirectEnd}catch(e){}var S=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},_),g),y),{slrid:this._oneUp.shareLinkId});this.resources.consume(u.e).logData({name:"ShareLinkClicked.PreviewLoaded",extraData:S})}}}}},t}(o.t);function Le(e){if(!e)return"NA";if(e<0)return"Unknown";var t=Math.log(e)/Math.LN2|0;return"".concat(1<<t%10,"-").concat(1<<t%10+1).concat(t<10?" B":" ".concat("KMGTPEZY"[t/10-1|0],"iB"))}function ke(e,t){return t&&Object(r.__assign)(Object(r.__assign)({},t),{error:(n=t.error,n&&(n=(n=n.replace(/(tempauth|token|authkey)=[^&'"]+/g,"token=*")).replace(/[\w-]+:\/\/\S+/g,"*URI*")),n)});var n}var Me=i.e({tagName:"od-one-up-slide",template:"<div data-bind=\"control:component,css:{'OneUp-slide-error':isError(),'OneUp-slide':!isError()}\" role=\"presentation\"></div>",viewModel:Ae,synchronous:!0});t.e=Me},3088:function(e,t,n){"use strict";n.d(t,"e",function(){return K});var a=n(0),i=n(55),r=n(419),o=n(8),s=n(112),c=n(289),d=n(67),l=n(83),u=n(653),f=n(1087),p=n(500),m=n(62),_=n(450),h=n(1779),b=n(1796),g=n(458),v=n(191),y=n(361),S=n(18),D=n(341),I=new(n(73).e)("childItemKeys",function(e,t){var n=t.itemKey,a=e.demandItemFacet(y.e,n),i=e.demandItemFacet(S.e,n),r=i&&i.itemKeys;return y.e.evaluate(a)(e,{itemKey:n,itemKeys:r}).itemKeys});function x(e,t){return Object(D.t)(e.demandItemFacet(I,t.itemSetKey))}var C=n(69);function O(e,t){var n=t.maxLevels,a=[],i=function(t,r){for(var o=0,s=t;o<s.length;o++){var c=s[o];if(("number"!=typeof n||r<n)&&e.demandItemFacet(C.r,c,{suppressGetItems:!0})){var d=e.isItemFacetResolved(S.e,c),l=e.demandItemFacet(C.e,c,{suppressGetItems:!0}),u="number"==typeof l?l:1,f=e.demandItemFacet(I,c,{suppressGetItems:!d});if(f)i(f,r+1);else for(var p=0;p<u;p++)a.push(c)}else a.push(c)}};return i(t.itemKeys,0),Object(D.t)(a)}var w={suppressGetItems:!0};function E(e,t,n){return e.demandItemFacet(t,n,w)}var A=n(334),L=n(16),k=n(66),M=n(189),P=n(180),T=n(464),U=new o.t({name:"".concat("ItemCacheDataManager",".enableOneUpLensRouting"),factory:new o.e(!0)}),F=new _.e,H=[],R=function(){function e(e,t){var n=this;this._computeParentItemInner=function(e){var t=Object(d.e)(e,{itemsScopeItemKey:n._itemsScopeItemKey});return e.demandItemFacet(g.t,t)||n._emptyItem},this._computeParentItem=function(){var e=n._parentItemObservable,t=e&&e();return t&&t()},this._computeExpandedKeys=function(e){return O(e,{itemKeys:x(e,{itemSetKey:Object(l.e)(e,n._itemsScopeItemKey)})})},this._computeItems=function(e){return B(e,{itemsScopeItemKey:n._itemsScopeItemKey,urlDataSource:n._urlDataSource,enableOneUpLensRouting:n._enableOneUpLensRouting})?H:function(e,t,n){for(var a=new Set(n),i=[],r=0,o=t.length;r<o;r++){var s=t[r],c=E(e,S.a,s)||E(e,C.r,s),d=a.has(s);i[r]=c||!d?void 0:e.demandItemFacet(g.t,s)}return Object(D.t)(i)}(e,n.expandedChildKeys(),Object(P.e)(e,{itemsScopeItemKey:n._itemsScopeItemKey}))},this._computeCurrentItemSet=function(){var e=n._emptyItem,t=n._parentItemObservable(),a=new h.e;return a.item=t,a.isPlaceholder=t===e,a},this._computeOnItemSetContentChange=function(){var e=n.currentItemSet(),t=new b.e;t.items=n._itemsObservable(),e.content(t)},this._computeViewParams=function(e){return e.demandItemFacet(k.e,n._itemsScopeItemKey)};var a=t.itemsScopeItemKey,i=t.itemCacheObservablesFactory,o=t.urlDataSource,s=t.enableOneUpLensRouting,c=t.observablesFactoryType;this._itemsScopeItemKey=a,this._urlDataSource=o,this._enableOneUpLensRouting=s,this._scope=new M.e;var u=this._scope.attach(new c({owner:this}));this._parentItemObservable=this._scope.attach(i.pureCompute(this._computeParentItemInner)),this._parentItemObservable.equalityComparer=r.n;var f=u.pureCompute(this._computeParentItem);f.equalityComparer=r.n,this.currentItem=f,this.expandedChildKeys=this._scope.attach(i.pureCompute(this._computeExpandedKeys)),this.expandedChildKeys.equalityComparer=r.e,this._itemsObservable=this._scope.attach(i.pureCompute(this._computeItems)),this._itemsObservable.equalityComparer=r.e,this._emptyItem=u.create(F),this.currentItemSet=u.pureCompute(this._computeCurrentItemSet),u.compute(this._computeOnItemSetContentChange),(this.viewParams=this._scope.attach(i.pureCompute(this._computeViewParams))).equalityComparer=r.n}return e.prototype.dispose=function(){this._scope.dispose()},e.dependencies={itemsScopeItemKey:p.e,itemCacheObservablesFactory:f.e,observablesFactoryType:i.i,urlDataSource:m.Se,enableOneUpLensRouting:U},e}(),N=Object(s.r)("ItemCacheDataManager",R);function B(e,t){var n,a=t.itemsScopeItemKey,i=t.urlDataSource;if(t.enableOneUpLensRouting){var r=Object(T.e)(e,{itemsScopeItemKey:a});n=null==r?void 0:r.focusItemKey}else{var o=e.demandItemFacet(k.e,a),s=i.getFocusItemKey(o),d=s&&i.getKeyParams(s);if(!d)return;var l=e.demandItemFacet(A.e,L.i);n=A.e.evaluate(l)(e,{viewParams:d,isNavigation:!1}).itemKey}return n?Object(c.e)(e,{itemKey:n}):void 0}var j=new o.t({name:"".concat("OneUpItemCacheDataManager",".enableOneUpLensRouting"),factory:new o.e(!0)}),V=u.e,z=new _.e,G=function(e){function t(t,n){var a,i=e.call(this,t,n)||this,o=n.itemsScopeItemKey,s=n.urlDataSource,u=n.itemCacheObservablesFactory,f=n.itemCacheDataManager,p=n.enableOneUpLensRouting,m=i.observables;V||(a=function(e){var t;if(p){var n=Object(T.e)(e,{itemsScopeItemKey:o});t=null==n?void 0:n.focusItemKey}else{var a=e.demandItemFacet(k.e,o),i=s.getFocusItemKey(a),r=i&&s.getKeyParams(i);if(!r)return;var d=e.demandItemFacet(A.e,L.i);t=A.e.evaluate(d)(e,{viewParams:r,isNavigation:!1}).itemKey}return t?Object(c.e)(e,{itemKey:t}):void 0});var _,y,I=u.pureCompute(function(e){var t=a?a(e):B(e,{itemsScopeItemKey:o,urlDataSource:s,enableOneUpLensRouting:p});return e.demandItemFacet(g.t,t)});I.equalityComparer=r.n,a&&((y=u.pureCompute(function(e){var t=Object(d.e)(e,{itemsScopeItemKey:o});return e.demandItemFacet(g.t,t)})).equalityComparer=r.n,(_=u.pureCompute(function(e){return a&&a(e)?O(e,{itemKeys:x(e,{itemSetKey:Object(l.e)(e,o)})}):[]})).equalityComparer=r.e);var w,M=[],P=u.pureCompute(function(e){var t=a?a(e):B(e,{itemsScopeItemKey:o,urlDataSource:s,enableOneUpLensRouting:p});return t?function(e,t){var n=e.demandItemFacet(g.t,t.focusItemKey),a=t.itemKeys,i=t.fetchRadius,r=void 0===i?2:i;if(!n||!a.length)return D.e;for(var o=[],s=0,c=a.length;s<c;s++){var d=a[s];E(e,S.a,d)||E(e,C.r,d)?o[s]=void 0:o[s]=e.demandItemFacet(g.t,d)}var l=o.indexOf(n);if(l<0)return D.e;var u=Math.max(0,l-r),f=Math.min(l+r,o.length-1);for(s=u;s<=f;s++)o[s]||e.demandItemFacet(S.e,a[s]);return Object(D.t)(o)}(e,{itemKeys:_?_():f.expandedChildKeys(),focusItemKey:t}):M});P.equalityComparer=r.e,y&&((w=m.pureCompute(function(){var e=y&&y();return e&&e()})).equalityComparer=r.n);var U=new h.e;U.item=w||f.currentItem,m.compute(function(){var e=new b.e;e.items=P(),U.content(e)});var F,H,R=m.create(U);if(y){var N=m.create(z);H=m.pureCompute(function(){var e=y&&y()||N,t=new h.e;return t.item=e,t.isPlaceholder=!1,t}),(F=u.pureCompute(function(e){return e.demandItemFacet(k.e,o)})).equalityComparer=r.n}var j=u.pureCompute(function(e){var t=a?a(e):B(e,{itemsScopeItemKey:o,urlDataSource:s,enableOneUpLensRouting:p});return!!t&&Object(v.e)(e,t)});return i.currentItem=w||f.currentItem,i.focusItem=I,i.focusItemSet=R,i.viewParams=F||f.viewParams,i.currentItemSet=H||f.currentItemSet,i.isOneUp=j,i}return Object(a.__extends)(t,e),t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{itemsScopeItemKey:p.e,itemCacheObservablesFactory:f.e,urlDataSource:m.Se,itemCacheDataManager:N,enableOneUpLensRouting:j}),t}(i.n),K=Object(s.r)("OneUpItemCacheDataManager",G)},4261:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return f});var a=n(0),i=n(175),r=n(156),o=n(1761),s=n(2070),c=n(3088),d=n(23),l=n(1852),u=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.addBindingHandlers({control:r.n});var i=t.requiredRange,c=t.isSlideshow,l=a.resources;return a._dataManager=n.dataManager,l.expose(d.r,a.createComputed(a._computeCurrentItem)),l.expose(d.o,a.createComputed(a._computeCurrentItemSet)),l.expose(d._,a.createComputed(a._computeFocusItem)),l.expose(d.h,a.createComputed(a._computeFocusItemSet)),a.oneUpControlParams={specification:Object(r.a)(s.t,{requiredRange:i,isSlideshow:c}),placeholder:Object(r.a)(o.t,{})},a}return Object(a.__extends)(t,e),t.prototype._computeCurrentItem=function(){var e=this._dataManager.currentItem;return e&&e()},t.prototype._computeCurrentItemSet=function(){var e=this._dataManager.currentItemSet;return e&&e()},t.prototype._computeFocusItem=function(){var e=this._dataManager.focusItem;return e&&e()},t.prototype._computeFocusItemSet=function(){var e=this._dataManager.focusItemSet;return e&&e()},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.t.dependencies),{dataManager:c.e,useItemsScope:l.e,focusItem:d._.optional,focusItemSet:d.h.optional,currentItem:d.r.optional,currentItemSet:d.o.optional}),t}(i.t),f=Object(r.t)({name:"OneUpWithDataManager",template:"\x3c!--ko control:oneUpControlParams--\x3e\x3c!--/ko--\x3e",automationName:"ms-oneup-withManager-component",viewModelType:u});t.default=f}}]);