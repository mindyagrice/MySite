(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.odsp-common"],{1482:function(e,t,n){"use strict";n.r(t),n.d(t,"getFirstConsistentlyInteractive",function(){return i});var a=n(1580);function i(e){return void 0===e&&(e={}),"PerformanceLongTaskTiming"in window?new a.e(e).getFirstConsistentlyInteractive():Promise.resolve(null)}n.d(t,"restartLongTaskObserver",function(){return a.t})},1572:function(e,t,n){"use strict";n.r(t),n.d(t,"EngagementHelper",function(){return s}),n.d(t,"mergeEngagementData",function(){return c}),n.d(t,"EngagementPartType",function(){return i.a}),n.d(t,"EngagementPart",function(){return i.n}),n.d(t,"EngagementBuilder",function(){return i.t}),n.d(t,"ENGAGEMENT_ROOT",function(){return i.e}),n.d(t,"clickEngagementPart",function(){return l.e}),n.d(t,"keyPressEngagementPart",function(){return l.n}),n.d(t,"dropEngagementPart",function(){return l.t}),n.d(t,"getMostSpecificMatchingContext",function(){return u});var a=n(0),i=n(508),r=n(89),o=n(147),s=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.handlers,o=void 0===i?[]:i,s=n.logData,c=void 0===s?function(e){return r.e.logData(e)}:s;return a._handlers=o,a._logData=c,a}return Object(a.__extends)(t,e),t.prototype.logData=function(e){if(void 0===e&&(e={}),this.contexts.length||e.name){for(var t=this.contexts.map(function(e,t){return{context:e,order:t}}).sort(function(e,t){return e.context.part.type-t.context.part.type||e.order-t.order}).map(function(e){return e.context}),n=e.name,i=void 0===n?t.map(function(e){return e.part.name}).join("."):n,r=e.isIntentional,o=void 0!==r&&r,s=e.extraData,d=void 0===s?{}:s,l=Object(a.__rest)(d,[]),u=Object(a.__rest)(e,["name","isIntentional","extraData"]),f=Object(a.__assign)({name:i,isIntentional:o,extraData:l},u),p=0,m=t;p<m.length;p++){var _=m[p],h=_.part,b=_.extraData,g=void 0===b?{}:b,v={};for(var y in g)v["".concat(h.name,"_").concat(y)]=g[y];c(f,{extraData:v}),c(f,_.part.getEngagementData(_)||{})}for(var S=0,D=this._handlers;S<D.length;S++){var I=D[S],x=I.getEngagementData.apply(I,t);x&&c(f,x)}this._logData(f)}},t.prototype.clone=function(e){return new t({},{engagementSource:{contexts:e},handlers:this._handlers,logData:this._logData})},t}(i.t);function c(e,t){var n=t.extraData,i=void 0===n?{}:n,r=t.experiment;d(e,Object(a.__rest)(t,["extraData","experiment"])),Object(o.e)(e.extraData,i),void 0!==r&&(e.experiment=r)}function d(e,t){for(var n in t){var a=t[n];if("object"==typeof a&&a){var i="object"==typeof e[n]&&e[n]||{};e[n]=i,d(i,a)}else void 0!==a&&(e[n]=a)}}var l=n(2560);function u(e,t){for(var n=t.length-1;n>=0;n--){var a=t[n];if(e.matches(a))return a}}},1580:function(e,t,n){"use strict";n.d(t,"t",function(){return l}),n.d(t,"e",function(){return u});var a=n(0),i=0,r=["img","script","iframe","link","audio","video","source"];function o(e,t){for(var n=0,a=e;n<a.length;n++){var i=a[n];if(t.includes(i.nodeName.toLowerCase())||o(i.children,t))return!0}return!1}function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];c()&&console.log.apply(console,e)}function c(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableTTILogging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1}function d(e,t){if(e.length>2)return performance.now();for(var n=[],a=0,i=t;a<i.length;a++){var r=i[a];n.push({timestamp:r.start,type:"requestStart"}),n.push({timestamp:r.end,type:"requestEnd"})}for(var o=0,s=e;o<s.length;o++){var c=s[o];n.push({timestamp:c,type:"requestStart"})}n.sort(function(e,t){return e.timestamp-t.timestamp});for(var d=e.length,l=n.length-1;l>=0;l--){var u=n[l];switch(u.type){case"requestStart":d--;break;case"requestEnd":if(++d>2)return u.timestamp;break;default:throw Error("Internal Error: This should never happen")}}return 0}function l(){window.__tti&&window.__tti.o.observe({entryTypes:["longtask"]})}var u=function(){function e(e){void 0===e&&(e={});var t=this;this._useMutationObserver=!!e.useMutationObserver,this._trackNetworkRequests=!!e.trackNetworkRequests,this._minValue=e.minValue||null,this._requiredMainThreadQuietnessDurationInMilliseconds=e.requiredMainThreadQuietnessDurationInMilliseconds||5e3,this._requiredNetworkQuietnessDurationInMilliseconds=e.requiredNetworkQuietnessDurationInMilliseconds||5e3;var n=window.__tti&&window.__tti.e,a=window.__tti&&window.__tti.o;this._longTaskId=0,n?(s("Consuming the long task entries already recorded."),this._longTasks=n.map(function(e){return t._createLongTask(e)}),window.__tti.e=[]):this._longTasks=[],a&&a.disconnect(),this._networkRequests=[],this._incompleteJSInitiatedRequestStartTimes=new Map,this._timerId=void 0,this._timerActivationTime=-1/0,this._scheduleTimerTasks=!1,this._firstConsistentlyInteractiveResolver=null,this._performanceObserver=null,this._mutationObserver=null,this._registerListeners(this._trackNetworkRequests)}return e.prototype.getFirstConsistentlyInteractive=function(){var e=this;return new Promise(function(t,n){e._firstConsistentlyInteractiveResolver=t,"complete"===document.readyState?e.startSchedulingTimerTasks():window.addEventListener("load",function(){e.startSchedulingTimerTasks()})})},e.prototype.startSchedulingTimerTasks=function(){s("Enabling FirstConsistentlyInteractiveDetector"),this._scheduleTimerTasks=!0;var e=this._longTasks.length>0?this._longTasks[this._longTasks.length-1].end:0,t=d(this._incompleteRequestStarts(),this._networkRequests);this._rescheduleTimer(Math.max(this._trackNetworkRequests?t+this._requiredNetworkQuietnessDurationInMilliseconds:0,e))},e.prototype._rescheduleTimer=function(e){var t=this;this._scheduleTimerTasks?(s("Attempting to reschedule FirstConsistentlyInteractive "+"check to ".concat(e)),s("Previous timer activation time: ".concat(this._timerActivationTime)),this._timerActivationTime>e?s("Current activation time is greater than attempted reschedule time. No need to postpone."):(clearTimeout(this._timerId),this._timerId=setTimeout(function(){t._checkTTI()},Math.max(0,e-performance.now())),this._timerActivationTime=e,s("Rescheduled firstConsistentlyInteractive check at ".concat(e)))):s("startSchedulingTimerTasks must be called before calling rescheduleTimer")},e.prototype._disable=function(){s("Disabling FirstConsistentlyInteractiveDetector"),clearTimeout(this._timerId),this._scheduleTimerTasks=!1,this._unregisterListeners()},e.prototype._registerPerformanceObserver=function(e){var t=this;void 0===e&&(e=!0),this._performanceObserver=new PerformanceObserver(function(n){for(var a=0,i=n.getEntries();a<i.length;a++){var r=i[a];"resource"===r.entryType&&e&&t._networkRequestFinishedCallback(r),"longtask"===r.entryType&&t._longTaskFinishedCallback(r)}}),this._performanceObserver.observe({entryTypes:e?["longtask","resource"]:["longtask"]})},e.prototype._registerListeners=function(e){var t,n,a,s,c,d,l,u,f;void 0===e&&(e=!0),e&&(s=this._beforeJSInitiatedRequestCallback.bind(this),c=this._afterJSInitiatedRequestCallback.bind(this),d=XMLHttpRequest.prototype.send,l=i++,XMLHttpRequest.prototype.send=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return s(l.toString()),this.addEventListener("readystatechange",function(){4===e.readyState&&c(l.toString())}),d.apply(this,t)},t=this._beforeJSInitiatedRequestCallback.bind(this),n=this._afterJSInitiatedRequestCallback.bind(this),a=window.fetch,window.fetch=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new Promise(function(r,o){var s=i++;t(s.toString()),a.apply(void 0,e).then(function(e){n(s.toString()),r(e)},function(e){n(e),o(e)})})}),this._registerPerformanceObserver(e),this._useMutationObserver&&(this._mutationObserver=(u=this._mutationObserverCallback.bind(this),(f=new MutationObserver(function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t];("childList"===a.type&&o(a.addedNodes,r)||"attributes"===a.type&&r.includes(a.target.tagName.toLowerCase()))&&u(a)}})).observe(document,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["href","src"]}),f))},e.prototype._unregisterListeners=function(){this._performanceObserver&&this._performanceObserver.disconnect(),this._mutationObserver&&this._mutationObserver.disconnect()},e.prototype._beforeJSInitiatedRequestCallback=function(e){s("Starting JS initiated request. Request ID: ".concat(e)),this._incompleteJSInitiatedRequestStartTimes.set(e,performance.now()),s("Active XHRs: ".concat(this._incompleteJSInitiatedRequestStartTimes.size))},e.prototype._afterJSInitiatedRequestCallback=function(e){s("Completed JS initiated request with request ID: ".concat(e)),this._incompleteJSInitiatedRequestStartTimes.delete(e),s("Active XHRs: ".concat(this._incompleteJSInitiatedRequestStartTimes.size))},e.prototype._networkRequestFinishedCallback=function(e){s("Network request finished",e),this._networkRequests.push({start:e.fetchStart,end:e.responseEnd}),this._rescheduleTimer(d(this._incompleteRequestStarts(),this._networkRequests)+this._requiredNetworkQuietnessDurationInMilliseconds)},e.prototype._longTaskFinishedCallback=function(e){s("Long task finished",e);var t,n=this._createLongTask(e),a="longTaskEnd".concat(n.id);t=a,window.performance&&performance.mark&&performance.mark(t),n.endMarkName=a,this._longTasks.push(n),this._rescheduleTimer(n.end+this._requiredMainThreadQuietnessDurationInMilliseconds)},e.prototype._mutationObserverCallback=function(e){s("Potentially network resource fetching mutation detected",e),s("Pushing back FirstConsistentlyInteractive check by ".concat(this._requiredNetworkQuietnessDurationInMilliseconds," milliseconds.")),this._rescheduleTimer(performance.now()+this._requiredNetworkQuietnessDurationInMilliseconds)},e.prototype._getMinValue=function(){return this._minValue?this._minValue:performance.timing.domContentLoadedEventEnd?performance.timing.domContentLoadedEventEnd-performance.timing.navigationStart:null},e.prototype._createLongTask=function(e){var t=e.startTime+e.duration;return{attribution:e.attribution,name:e.name,start:Math.round(e.startTime),end:Math.round(t),id:this._longTaskId++}},e.prototype._incompleteRequestStarts=function(){return Object(a.__spreadArray)([],Array.from(this._incompleteJSInitiatedRequestStartTimes.values()),!0)},e.prototype._checkTTI=function(){s("Checking if First Consistently Interactive was reached...");var e=performance.timing.navigationStart,t=d(this._incompleteRequestStarts(),this._networkRequests),n=(window.chrome&&window.chrome.loadTimes?1e3*window.chrome.loadTimes().firstPaintTime-e:0)||performance.timing.domContentLoadedEventEnd-e,a=this._getMinValue(),i=performance.now();if(null===a)return s("No usable minimum value yet. Postponing check."),void this._rescheduleTimer(Math.max(this._trackNetworkRequests?t+this._requiredNetworkQuietnessDurationInMilliseconds:0,i+1e3));s("Parameter values:"),s("NavigationStart",e),s("lastKnownNetwork2Busy",t),s("Search Start",n),s("Min Value",a),s("Last busy",t),s("Current time",i),s("Long tasks",this._longTasks),s("Incomplete JS Request Start Times",this._incompleteRequestStarts()),s("Network requests",this._networkRequests);var r=function(e,t,n,a,i,r,o,s){if(r&&a-n<s)return null;var c=0===i.length?e:i[i.length-1].end;if(a-c<o)return null;if(c&&i.length>0){var d=i[i.length-1].endMarkName;d&&performance.measure("TTI",void 0,d)}return Math.max(c,t)}(n,a,t,i,this._longTasks,this._trackNetworkRequests,this._requiredMainThreadQuietnessDurationInMilliseconds,this._requiredNetworkQuietnessDurationInMilliseconds);r&&this._firstConsistentlyInteractiveResolver?(s("maybeFCI",r),this._firstConsistentlyInteractiveResolver({tti:r,longTasks:this._longTasks}),this._disable()):(s("Could not detect First Consistently Interactive. Retrying in 1 second."),this._rescheduleTimer(performance.now()+1e3))},e}()},1617:function(e,t,n){"use strict";function a(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i()&&console.log.apply(console,e)}function i(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableFCILogging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1}n.r(t),n.d(t,"getFirstCPUIdle",function(){return o});var r=function(){function e(e){this._longTaskId=0,this._checkFCIRunId=0,this._isDisposed=!1;var t=e.requiredMainThreadCPUIdleDurationInMilliseconds,n=e.measurementStartTime;this._measurementStartTime=n,this._requiredMainThreadCPUIdleDurationInMilliseconds=t,this._resultResolver={resolve:void 0,reject:void 0},this._fciPromise=void 0,this._longTasks=[],this._processLongTaskPreQueue(),this._registerLongTaskObserver()}return e.prototype.measureFCI=function(){var e=this;if(this._isDisposed)throw"FCIMeasurer is disposed.";return this._fciPromise||(this._fciPromise=new Promise(function(t,n){e._resultResolver.resolve=t,e._resultResolver.reject=n})),this._tryScheduleNextCheck(),this._fciPromise},e.prototype._tryScheduleNextCheck=function(){var e=this;this._checkFCIRunId&&clearTimeout(this._checkFCIRunId);var t=this._findEarlestPossibleCheckTime(),n=performance.now(),a=Math.max(0,t-n);this._checkFCIRunId=setTimeout(function(){e._checkFCI()},a)},e.prototype._findEarlestPossibleCheckTime=function(){var e=this._getLatestLongTask(),t=e&&e.end||-1/0;return Math.max(t+this._requiredMainThreadCPUIdleDurationInMilliseconds,this._measurementStartTime+this._requiredMainThreadCPUIdleDurationInMilliseconds,performance.now())},e.prototype._checkFCI=function(){var e,t=performance.now(),n=this._longTasks?this._longTasks.length:0;if(a("Running checkFCI:"),a("Measurement start time",this._measurementStartTime),a("Current time",t),a("Long tasks",this._longTasks),a("latestLongTaskEndTime",null===(e=this._longTasks[n-1])||void 0===e?void 0:e.end),!this._measurementStartTime||this._measurementStartTime<0)this._onFoundFCI(NaN);else if(0!==n){for(var i=this._longTasks[0],r=1;r<n;r++){var o=this._longTasks[r],s=Math.max(i.end,this._measurementStartTime);if(o.start>=this._measurementStartTime&&o.start-s>=this._requiredMainThreadCPUIdleDurationInMilliseconds)return void this._onFoundFCI(s,i.endMarkName);i=o}if(t-i.end>=this._requiredMainThreadCPUIdleDurationInMilliseconds){var c=i.end>this._measurementStartTime?i.endMarkName:void 0;this._onFoundFCI(Math.max(i.end,this._measurementStartTime),c)}}else t-this._measurementStartTime>=this._requiredMainThreadCPUIdleDurationInMilliseconds&&this._onFoundFCI(this._measurementStartTime)},e.prototype._onFoundFCI=function(e,t){t&&performance.measure("FCI",void 0,t),a("possibleFCI:",e),this._resultResolver.resolve&&this._resultResolver.resolve({fci:e,longTasks:this._longTasks}),this._dispose()},e.prototype._dispose=function(){clearTimeout(this._checkFCIRunId),this._longTaskObserver.disconnect(),this._isDisposed=!0},e.prototype._getLatestLongTask=function(){for(var e=void 0,t=0,n=this._longTasks;t<n.length;t++){var a=n[t];(!e||a.end>e.end)&&(e=a)}return e},e.prototype._processLongTaskPreQueue=function(){if(window.__fci){var e=window.__fci.o,t=window.__fci.e;if(e){for(var n=0,a=t;n<a.length;n++){var i=a[n];if("longtask"===i.entryType){var r=this._createLongTask(i);this._longTasks.push(r)}}e.disconnect()}}},e.prototype._registerLongTaskObserver=function(){var e=this;this._longTaskObserver=new PerformanceObserver(function(t){for(var n=0,a=t.getEntries();n<a.length;n++){var i=a[n];"longtask"===i.entryType&&e._longTaskFinishedCallback(i)}}),this._longTaskObserver.observe({entryTypes:["longtask"]})},e.prototype._createLongTask=function(e){var t=e.startTime+e.duration;return{attribution:e.attribution,name:e.name,start:Math.round(e.startTime),end:Math.round(t),id:this._longTaskId++}},e.prototype._longTaskFinishedCallback=function(e){a("Long task finished: ",e);var t,n=this._createLongTask(e),i="longTaskEnd".concat(n.id);t=i,window.performance&&performance.mark&&performance.mark(t),n.endMarkName=i,this._longTasks.push(n),this._tryScheduleNextCheck()},e}();function o(e){return"PerformanceLongTaskTiming"in window?new r(e).measureFCI():Promise.resolve(null)}},1702:function(e,t,n){"use strict";n.d(t,"s",function(){return b}),n.d(t,"U",function(){return g}),n.d(t,"F",function(){return v}),n.d(t,"T",function(){return y}),n.d(t,"e",function(){return a}),n.d(t,"R",function(){return S}),n.d(t,"B",function(){return D}),n.d(t,"N",function(){return I}),n.d(t,"P",function(){return C}),n.d(t,"O",function(){return O}),n.d(t,"C",function(){return w}),n.d(t,"A",function(){return E}),n.d(t,"w",function(){return A}),n.d(t,"E",function(){return L}),n.d(t,"L",function(){return k}),n.d(t,"b",function(){return M}),n.d(t,"h",function(){return P}),n.d(t,"d",function(){return T}),n.d(t,"c",function(){return U}),n.d(t,"v",function(){return F}),n.d(t,"r",function(){return R}),n.d(t,"y",function(){return N}),n.d(t,"f",function(){return B}),n.d(t,"I",function(){return j}),n.d(t,"_",function(){return V}),n.d(t,"S",function(){return z}),n.d(t,"M",function(){return G}),n.d(t,"u",function(){return K}),n.d(t,"m",function(){return W}),n.d(t,"g",function(){return q}),n.d(t,"p",function(){return Q}),n.d(t,"a",function(){return Y}),n.d(t,"i",function(){return J}),n.d(t,"k",function(){return X}),n.d(t,"l",function(){return Z}),n.d(t,"o",function(){return $}),n.d(t,"H",function(){return ee}),n.d(t,"x",function(){return te}),n.d(t,"D",function(){return ne}),n.d(t,"t",function(){return ae}),n.d(t,"n",function(){return ie});var a,i=n(0),r=n(2395),o=n(2396),s=n(2397),c=n(1043),d=n(1754),l=n(42),u=n(1700),f=n(1706),p=n(779),m=n(1774),_=n(1703),h=n(242),b=[u.ps,u.Yn,u.ys,u.Ps,u.bs,u.en,u.no],g=[u.Qo,u.zo,u.Jo,u.Xo,u.Yo,u.Ho,u.Wo],v=[u.Ro,u.Fo,u.jo,u.Po,u.Vo,u.Bo,u.No,u.To,u.qo,u.Ko,u.Go,u.Uo],y=[u.yn,u.Qt,u.Nn,u.K,u.jn,u.Dn,u.Sn,u.ne,u.uo,u.Ma,u.ka,u.et];function S(e){return x(e,26)}function D(e,t){return x(e,t=t||25)}function I(e,t){return x(e,t=t||20)}function x(e,t){if(!e)return"";var n=t,a=n/2;if(e.length<=n)return e;var i=e.slice(0,a),r=e.slice(e.length-a);return"".concat(i,"...").concat(r)}function C(e){return e.userRole===r.e.none&&e.defaultLinkKind===o.e.uninitialized}function O(e,t){switch(e){case"anonymous":return t?o.e.anonymousEdit:o.e.anonymousView;case"organization":return t?o.e.organizationEdit:o.e.organizationView;case"users":return o.e.flexible;default:return o.e.direct}}function w(e){switch(e){case"anonymous":return s.e.anyone;case"organization":return s.e.organization;case"users":return s.e.specificPeople;default:return s.e.existing}}function E(e){switch(e){case o.e.anonymousEdit:case o.e.anonymousView:return"anonymous";case o.e.organizationEdit:case o.e.organizationView:return"organization";case o.e.flexible:return"users";default:return"existingAccess"}}function A(e){switch(e){case s.e.anyone:return"anyone";case s.e.organization:return"organization";case s.e.specificPeople:case s.e.specificPeopleFlex:case s.e.customLabeledSpecificPeople:return"specificPeople";case s.e.existing:default:return"existingAccess"}}function L(e){switch(e){case s.e.anyone:return 0;case s.e.organization:return 1;case s.e.specificPeople:case s.e.specificPeopleFlex:case s.e.customLabeledSpecificPeople:return 2;case s.e.existing:default:return 3}}function k(e){switch(e){case 1:return"created";case 2:return"updated";default:return"uninitialized"}}function M(e,t,n){var a=t.sharingLinkKind,i=t.audience,r="https://res-1.cdn.office.net/files/fabric-cdn-prod_20211207.001/assets/icons/sharing",c=f.d(e)?"directrecipients.svg":"peopleinchat.svg";switch(a){case o.e.organizationView:case o.e.organizationEdit:return"".concat(r,"/companyonly.svg");case o.e.anonymousView:case o.e.anonymousEdit:return"".concat(r,"/anyone.svg");case o.e.flexible:return t.audience===s.e.customLabeledSpecificPeople?n&&n.iconUrl||"".concat(r,"/").concat(c):"".concat(r,"/specificpeople.svg");default:return i===s.e.customLabeledSpecificPeople?n&&n.iconUrl||"".concat(r,"/").concat(c):"".concat(r,"/existingaccess.svg?v2")}}function P(e){if(e.isCreateOnlyLink)return"FileRequest";switch(e.sharingLinkKind){case o.e.requestAccess:return"Mail";case o.e.organizationView:case o.e.organizationEdit:return"Work";case o.e.anonymousView:case o.e.anonymousEdit:return"Globe";case o.e.flexible:return e.audience===s.e.anyone?"Globe":e.audience===s.e.organization?"Work":"PeopleAdd";default:return"Link"}}function T(){return{palette:{themePrimary:"#3A96DD",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#004578",themeDarker:"#34365c",neutralLighterAlt:"#292827",neutralLighter:"#323130",neutralLight:"#3B3A39",neutralQuaternaryAlt:"#484644",neutralQuaternary:"#605E5C",neutralTertiaryAlt:"#484644",neutralTertiary:"#A19F9D",neutralSecondary:"#BEBBB8",neutralPrimaryAlt:"#E1DFDD",neutralPrimary:"#F3F2F1",neutralDark:"#FAF9F8",redDark:"#FF4343",black:"#FFFFFF",white:"#252423",primaryBackground:"#f9f8f7",primaryText:"#252423",bodyBackground:"#252423",bodyText:"#252423",disabledBackground:"#3B3A39",disabledText:"#c8c8c8"}}}function U(e,t,n,a){var i=f.d(e);switch(n&&n.audienceType||i&&"recipient"){case"channel":switch(t){case"edit":return u._i;case"review":return p.t[a]?u.hi:u.bi;default:return u.gi}case"team":switch(t){case"edit":return u.Ii;case"review":return p.t[a]?u.xi:u.Ci;default:return u.Oi}case"recipient":switch(t){case"edit":return u.Pr;case"review":return p.t[a]?u.Tr:u.Ur;default:return u.Fr}default:switch(t){case"edit":return u.vi;case"review":return p.t[a]?u.yi:u.Si;default:return u.Di}}}function F(e,t,n,a,i){var r=e.sharingLinkKind,c=e.audience;if(e.isCreateOnlyLink)return!e.allowsAnonymousAccess&&t?l.format(u.Yt,t):u.Jt;switch(r){case o.e.requestAccess:var d=e.invitees[0],f=d.primaryText||d.email||d.id;return l.format(u.qr,f);case o.e.organizationView:return l.format(u.Qe,t);case o.e.organizationEdit:return l.format(u.Ge,t);case o.e.anonymousView:return u.N;case o.e.anonymousEdit:return u.k;case o.e.direct:return c===s.e.customLabeledSpecificPeople?e.isReview?a&&a.entityName?l.format(u.Ze,a.entityName):U(n,"review",a,i):e.isEdit?a&&a.entityName?l.format(u.Xe,a.entityName):U(n,"edit",a):a&&a.entityName?l.format(u.$e,a.entityName):U(n,"view",a):u.Ot;case o.e.flexible:return c===s.e.existing?u.Ot:c===s.e.anyone?e.blockDownload?e.hasPassword?u.j:u.B:e.hasPassword?e.isReview?p.t[i]?u.U:u.F:e.isEdit?u.T:u.H:e.isReview?p.t[i]?u.P:u.R:e.isEdit?u.k:u.N:c===s.e.customLabeledSpecificPeople?e.isReview?a&&a.entityName?l.format(u.Ze,a.entityName):U(n,"review",a,i):e.isEdit?a&&a.entityName?l.format(u.Xe,a.entityName):U(n,"edit",a):a&&a.entityName?l.format(u.$e,a.entityName):U(n,"view",a):e.audience===s.e.organization?e.blockDownload?l.format(u.Ye,t):e.isReview?p.t[i]?l.format(u.We,t):l.format(u.qe,t):e.isEdit?l.format(u.Ge,t):l.format(u.Qe,t):e.blockDownload?u.as:e.isReview?p.t[i]?u._r:u.hr:e.isEdit?u.mr:u.br;default:return""}}function H(e){return{principalId:e.id,name:e.primaryText,image:e.imageUrl,isResolved:!0,principalName:e.loginName,userId:e.loginName,email:e.email,job:e.secondaryText,isExternal:e.isExternal,principalType:e.type}}function R(e){return{id:e.principalId,primaryText:e.name,imageUrl:e.image,loginName:e.userId,email:e.email,secondaryText:e.job,isExternal:e.isExternal,type:e.principalType}}function N(e){for(var t=[],n=e.principals,a=e.invitees,i=0,r=n;i<r.length;i++){var o=r[i];t.push(H(o))}for(var s=function(e){0===(!0===e.isExternal?t.filter(function(t){return t.email===e.email}):t.filter(function(t){return t.principalName===e.loginName})).length&&t.push(H(e))},c=0,d=a;c<d.length;c++)s(d[c]);return t}function B(e){if(!e)return 0;var t=0,n=e.length,a=0,i=!1;if(0===e.length)return 0;for(;a<n;){var r=null,o=e[a];" "===o?r=a+1<n&&" "===e[a+1]||i?"&#160;":" ":"\n"===o?(r="<br />",i=!0):('"'===o?r="&quot;&quot;&quot;":"&"===o?r="&amp;":"'"===o?r="&#39;":"<"===o?r="&lt;":">"===o?r="&gt;":"\r"===o&&(r=" "),i=!1),t+=null!==r?r.length:1,a++}return t}function j(e,t){var n,a;switch(e){case r.e.manageList:n="EditListPencil",a=u.ce;break;case r.e.edit:n="Edit",a=u.ce;break;case r.e.view:n="Uneditable2",a=u.ge;break;case r.e.review:n="Feedback",a=u.me;break;case r.e.owner:n="Signin",a=u.tn;break;case r.e.none:n="Delete",a=u._t}return{name:n,title:t?a.toLowerCase():a}}function V(e){var t=r.e.none,n=[r.e.none,r.e.submit,r.e.restrictedview,r.e.view,r.e.review,r.e.edit,r.e.manageList,r.e.owner],a=e.accessMap;return null==a||a.forEach(function(e){var a=z(e.rawPermission);n.indexOf(a)>n.indexOf(t)&&(t=a)}),t}function z(e){var t=r.e.none;if(e.roles){t=r.e.view;for(var n=0,a=e.roles;n<a.length;n++)"write"===a[n]&&(t=r.e.edit)}return e.link&&e.link.type&&("edit"===e.link.type?t=r.e.edit:"view"===e.link.type&&(t=r.e.view)),t}function G(e){return e===r.e.edit||Object(_.k)()&&e===r.e.manageList}function K(e,t){return Object(_.k)()&&f.n(e)&&(null==t?void 0:t.sharedObjectType)===m.e.list?r.e.manageList:r.e.edit}function W(e,t){var n=a.none,i=t;if(!e||e.getTime()===new Date(0).getTime())return n;var r=new Date;r.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());var o=Math.floor((e.getTime()-r.getTime())/864e5);return o<1?n=a.pastDate:o>730?n=a.overMax:o>i&&-1!==i&&(n=a.adminPolicy),n}function q(e,t){return e===s.e.anyone?t?o.e.anonymousEdit:o.e.anonymousView:e===s.e.organization?t?o.e.organizationEdit:o.e.organizationView:e===s.e.specificPeople||e===s.e.existing?o.e.direct:o.e.flexible}function Q(e,t){switch(e){case a.pastDate:return u.pi;case a.adminPolicy:return l.format(u.O,t);case a.overMax:return l.format(u.Bn,730);case a.adminRequired:return u.Jr;default:return""}}function Y(e){return e.canAddExternalPrincipal||e.canAddInternalPrincipal}function J(e){return!!(e&&e.organizationLinkAbilities&&e.organizationLinkAbilities.canManageReadLink)&&e.organizationLinkAbilities.canManageReadLink.enabled}function X(e,t,n){return f.d(e)||t===c.e.linkSettings&&f.u(e)&&n&&(!!n.entityName||!!n.audienceType)}function Z(e){var t=e;if(-1===t)return null;var n=new Date;return n.setDate(n.getDate()+t),n}function $(e,t,n,a){return Object(i.__awaiter)(this,void 0,void 0,function(){var r,o,s,c,d,l,u,p,m,b;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(r=!1,f.r(e))return[3,7];try{t.focus(),t.setSelectionRange(0,t.value.length),r=document.execCommand("copy")}catch(e){}if(!window.navigator||!window.navigator.clipboard)return[3,7];i.label=1;case 1:return i.trys.push([1,6,,7]),!Object(_.C)()&&"write"in window.navigator.clipboard&&a?(o=t.value,s="text/plain",c="text/html",d=new Blob([o],{type:s}),l=new Blob(["<a href=".concat(o,">").concat(h.e.encodeText(a),"</a>")],{type:c}),u=[new ClipboardItem((b={},b[s]=d,b[c]=l,b))],[4,window.navigator.clipboard.write(u)]):[3,3];case 2:return i.sent(),[3,5];case 3:return[4,window.navigator.clipboard.writeText(t.value)];case 4:i.sent(),i.label=5;case 5:return r=!0,[3,7];case 6:return i.sent(),[3,7];case 7:try{p=window.external,m=p.CopyToClipboard(n),r=m||void 0===m}catch(e){}return[2,r]}})})}function ee(e,t){return!Object(_.O)()&&e&&e.toLowerCase().indexOf("/_layouts/15/userphoto.aspx")>=0&&location.href.toLowerCase().indexOf("sharedialog.aspx")<0&&(f.s(t)||f.m(t))}function te(e){var t=e.sharingLinks,n=e.sharingPrincipals,a=t.filter(function(e){return e.isActive&&e.sharingLinkKind!==o.e.direct&&(!e.expiration||e.expiration.getTime()>Date.now())&&!(e.isAddressBarLink&&!0===e.isUnhealthy)}),i=!!a.length;if(!i&&n.length)for(var s=0,c=n;s<c.length;s++)if(c[s].role!==r.e.owner){i=!0;break}return{shared:i,activeLinks:a,sharingPrincipals:n}}function ne(e){var t;switch(e){case d.e.user:t="user";break;case d.e.none:t="none";break;default:t="group"}return t}!function(e){e[e.none=0]="none",e[e.pastDate=1]="pastDate",e[e.adminPolicy=2]="adminPolicy",e[e.overMax=3]="overMax",e[e.adminRequired=4]="adminRequired"}(a||(a={}));var ae=340,ie=480},1703:function(e,t,n){"use strict";n.d(t,"r",function(){return d}),n.d(t,"G",function(){return u}),n.d(t,"m",function(){return f}),n.d(t,"k",function(){return p}),n.d(t,"L",function(){return m}),n.d(t,"W",function(){return _}),n.d(t,"P",function(){return h}),n.d(t,"n",function(){return b}),n.d(t,"p",function(){return g}),n.d(t,"u",function(){return v}),n.d(t,"e",function(){return y}),n.d(t,"f",function(){return S}),n.d(t,"N",function(){return D}),n.d(t,"_",function(){return I}),n.d(t,"M",function(){return x}),n.d(t,"l",function(){return C}),n.d(t,"b",function(){return O}),n.d(t,"y",function(){return w}),n.d(t,"o",function(){return E}),n.d(t,"S",function(){return A}),n.d(t,"c",function(){return L}),n.d(t,"H",function(){return k}),n.d(t,"q",function(){return M}),n.d(t,"Q",function(){return P}),n.d(t,"d",function(){return T}),n.d(t,"I",function(){return U}),n.d(t,"x",function(){return F}),n.d(t,"s",function(){return H}),n.d(t,"v",function(){return R}),n.d(t,"B",function(){return N}),n.d(t,"E",function(){return B}),n.d(t,"A",function(){return j}),n.d(t,"O",function(){return V}),n.d(t,"w",function(){return z}),n.d(t,"K",function(){return G}),n.d(t,"C",function(){return K}),n.d(t,"U",function(){return W}),n.d(t,"h",function(){return q}),n.d(t,"z",function(){return Q}),n.d(t,"F",function(){return Y}),n.d(t,"g",function(){return J}),n.d(t,"T",function(){return X}),n.d(t,"j",function(){return Z}),n.d(t,"V",function(){return $}),n.d(t,"i",function(){return ee}),n.d(t,"R",function(){return te}),n.d(t,"D",function(){return ne}),n.d(t,"t",function(){return ae}),n.d(t,"a",function(){return ie});var a=n(13),i=n(338),r=n(415),o=window._spPageContextInfo,s=(o&&"21"===o.webTemplate&&o.listBaseTemplate,[]),c=!1;function d(e,t){s=e,c=t}function l(e){var t=s.filter(function(t){return t.flightStringId===e})[0];return t?t.flightEnabled:e}function u(){return!0}function f(){return i.n.isFeatureEnabled({ODB:1977})}function p(){return i.n.isFeatureEnabled({ODB:60345})}function m(){return i.n.isFeatureEnabled({ODC:l("ManageAccessRevampConsumer"),ODB:!1,OneDrive:c?l("ManageAccessRevampConsumer"):void 0})}function _(){return!a.t.isActivated("227ee00d-a46d-42cd-8beb-de7befc5cff7","4/27/2021","Deactivate require signin link clientid flag")}function h(){return!i.n.isFeatureEnabled({ODC:l("ODCHideNonPremiumLinkFeatures"),ODB:!1,OneDrive:c?l("ODCHideNonPremiumLinkFeatures"):void 0})}function b(){return a.t.isActivated("b011fecf-6da0-4c0e-8dd1-46fe2d478766","07/20/2021","Remove duplicated suggestions in PeoplePicker")}function g(){return i.n.isFeatureEnabled({OneDrive:!0})||!i.n.isFeatureEnabled({ECS:91527})}function v(){return!0}function y(){return a.t.isActivated("f1bcbfe5-3183-4488-b087-2c390f95473c","08/06/2021","Add close button to manage access in WAC")}function S(){return!a.t.isActivated("8da0a512-655d-47ba-9e0c-edf9846bb7de","08/13/2021","Uses Direct Link for Share Target")}function D(){return!a.t.isActivated("be78e09f-3a06-4c6b-8eee-f946ec0f6aea","08/13/2021","Refactored OnClick functions for Share Targets")}function I(){return a.t.isActivated("032EB02B-0045-4238-8909-4EFC9FDECC26","10/11/2021","hide facepile")||i.n.isFeatureEnabled({ECS:93635})}function x(){return!a.t.isActivated("c6c60aa6-0336-4ab1-9124-756af18c8c17","11/03/2021","new Error Page killswitch")}function C(){return!a.t.isActivated("8a705e30-e665-4b70-a48f-be3b5872cdb4","10/22/2021","copyLink shortcut experiment killswitch")&&!i.n.isFeatureEnabled({ECS:108074})}function O(){return!a.t.isActivated("44a2427d39f54a38b1e4b18a6b3be70b","06/19/2022","fix mode when IRM enabled killswitch")&&!i.n.isFeatureEnabled({ECS:1023341})}function w(){return!a.t.isActivated("72e53ec0-db7c-4a4a-a36e-2a10741af870","10/22/2021","hide role selector when existing access")}function E(){return!a.t.isActivated("c1169fd5-0aa4-4e11-b1ce-d182d4644b3a","04/20/2022","can office review in role selector killswitch")&&!i.n.isFeatureEnabled({ECS:1002892})&&i.n.isFeatureEnabled({ODB:60920})}function A(){return!i.n.isFeatureEnabled({ECS:117949})&&!a.t.isActivated("4e15a9ee-ffb1-4411-b812-4d8f6cb8b621","01/24/2022","hide share button in manageAccess if file is infected")}function L(){return!i.n.isFeatureEnabled({ECS:1016271})&&!a.t.isActivated("dfac4afa-7169-4dd0-a912-2385d3956e83","05/12/2022","change permission refactor")}function k(){return!i.n.isFeatureEnabled({ECS:1012849})||!a.t.isActivated("59ecb991-8301-454b-9576-d13c7380b34d","04/21/2022","fix requireSignIn property is not set when copyLink from LinkSettings")}function M(){return a.t.isActivated("4b80dfbd-dadd-43e7-83b7-8fb6cf2bb88c","09/23/2021","userPhotoBaseUrl")}function P(){return a.t.isActivated("F85E07B9-8012-4F0B-BF2B-46AE5F954119","09/28/2021","userPhotoBaseUrl1")||i.n.isFeatureEnabled({ECS:98570})}function T(){return a.t.isActivated("c95dbe16-0705-478f-959e-99f5177d18c0","10/01/2021","check if GSI is prefetched")}function U(){return!a.t.isActivated("FE17821F-BAE7-44D8-91C0-5145C4D97969","10/01/2021","Invite placeholder user")&&i.n.isFeatureEnabled({ODB:60596})}function F(){return a.t.isActivated("34f56314-e874-4fd6-ab55-d5989a76f8ae","10/12/2021","Check sharing abilities for read permissions")||i.n.isFeatureEnabled({ECS:100295})}function H(){return a.t.isActivated("fe858624-b4db-46dc-839d-136517b1f8b6","10/12/21","launch manage access in centered, wide dialog")}function R(){return a.t.isActivated("1dcce0fd-59bb-479e-8d91-2910b7a0c824","11/16/21","launch manage access in centered, wide dialog")}function N(){return!a.t.isActivated("dcfb2c5d-46bc-4a7f-8970-f5066f36bb16","10/12/2021","Share To Teams in web")}function B(){return!a.t.isActivated("9d5d3857-93f0-4635-87a2-8e36409df377","07/05/2022","Link Settings Improvement")&&!i.n.isFeatureEnabled({ECS:1028319})}function j(){return!a.t.isActivated("8511183b-9de9-4797-ada1-ac052cf3ecb1","2/23/2022","Manage Access V3 in ODB")}function V(){return a.t.isActivated("2B61136D-C6A8-432B-9B67-392506BF2DB4","12/07/2021","fix NGSC userphoto")||i.n.isFeatureEnabled({ECS:112341})}function z(){return a.t.isActivated("5108f6ec-83ee-43f0-b941-7183bcf0a99f","02/09/2022","get GSI response before rendering Share component")||i.n.isFeatureEnabled({ECS:1002677})}function G(){return!a.t.isActivated("209e41e5-d804-4aa1-9d59-5209d8d48f2c","02/03/2022","render wider dialog across all endpoints")&&!i.n.isFeatureEnabled({ECS:1000799})}function K(){return a.t.isActivated("7D579513-ED41-46CC-A73A-20870B56E146","02/04/2022","html format copy link")||i.n.isFeatureEnabled({ECS:1000922})}function W(){return!a.t.isActivated("e6dbe5d1-55f9-439b-a975-1931c6bf9c90","02/25/2021","People picker improvements")&&!i.n.isFeatureEnabled({ECS:1005398})}function q(){return i.n.isFeatureEnabled({ODC:l("FamilySharing"),ODB:!1,OneDrive:c?l("FamilySharing"):void 0})}function Q(){return a.t.isActivated("61C832C8-21D8-4A3C-AB3F-96B622EDF097","05/03/2022","sharing telemetry change")||i.n.isFeatureEnabled({ECS:1014685})}function Y(){return!a.t.isActivated("2f7d46e9-cb5e-4ab7-8239-0c53e0934af9","05/06/2022","refactorCopyLinkSection")&&!i.n.isFeatureEnabled({ECS:1015255})}function J(){return!a.t.isActivated("48bce1e2-c587-4cc2-956b-d0bccfeca219","05/23/2022","fixShareNotification")&&!i.n.isFeatureEnabled({ECS:1018011})}function X(){return a.t.isActivated("ed6b3f5f-31b8-41db-bc7e-f62efa6ac71b","05/06/2022","peoplepicker fix in link settings")||i.n.isFeatureEnabled({ECS:1015173})}function Z(){return a.t.isActivated("0865093c-8bb2-4412-bde8-5d4fdfb6cd0b","05/16/2022","share link details action btn fix ks")||r.e.isFeatureEnabled({ECS:1016798})}function $(){return a.t.isActivated("6f92e945-60ed-4655-8ae4-8ea1fd9355ba","05/18/2022","share update select tooltip to callout ks")||r.e.isFeatureEnabled({ODC:l("SharingTooltipCalloutKS"),ECS:1017301,OneDrive:c?l("SharingTooltipCalloutKS"):void 0})}function ee(){return a.t.isActivated("f7963b70-44d5-419e-9547-1d1da515f04f","5/25/2022","add loop error message")||r.e.isFeatureEnabled({ECS:1018382})}function te(){return a.t.isActivated("329dfa2c-94ea-4c31-8bbf-419322c8b944","07/06/2022","set isExternal from resolve result to be the same as search result")||r.e.isFeatureEnabled({ECS:1026142})}function ne(){return a.t.isActivated("cece5fd8-e7c6-4961-ac00-926d3ab16909","5/31/2022","invalidate GSI on unshareLink call and fetch GSI")||r.e.isFeatureEnabled({ECS:1019444})}function ae(){return a.t.isActivated("7be01111-82c1-461e-ab44-b116f3fe9d36","06/06/2022","Add feature to allow block download for folders and lists")||r.e.isFeatureEnabled({ECS:1020410})}function ie(){return a.t.isActivated("02544627-40b7-4d41-8a2c-5b0ddf5dc8c5","6/15/2022","fix wrong audience based on linkKind")||r.e.isFeatureEnabled({ECS:1021639})}},1706:function(e,t,n){"use strict";n.d(t,"s",function(){return i}),n.d(t,"o",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"d",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"r",function(){return l}),n.d(t,"_",function(){return u}),n.d(t,"h",function(){return f}),n.d(t,"e",function(){return p}),n.d(t,"p",function(){return m}),n.d(t,"a",function(){return _}),n.d(t,"l",function(){return h}),n.d(t,"f",function(){return b}),n.d(t,"c",function(){return g}),n.d(t,"u",function(){return v}),n.d(t,"b",function(){return y}),n.d(t,"m",function(){return S});var a=n(1557);function i(e){return m(e)||h(e)||_(e)||b(e)||g(e)||function(e){return e===a.e.officemobileIos||e===a.e.officemobileAndroid}(e)}function r(e){return e===a.e.odb||e===a.e.sharePoint||e===a.e.odc||e===a.e.consumerList}function o(e){return e===a.e.consumerList}function s(e){return e===a.e.outlookWeb||e===a.e.outlookWindows||e===a.e.outlookMac||e===a.e.outlookAndroid||e===a.e.outlookiOS}function c(e){return e===a.e.odIos||e===a.e.wordIos||e===a.e.excelIos||e===a.e.visioIos||e===a.e.onenoteIos||e===a.e.powerpointIos||e===a.e.teamsIos||e===a.e.officemobileIos||e===a.e.listsIos||e===a.e.streamIos||e===a.e.loopIos||e===a.e.outlookiOS}function d(e){return e===a.e.odAndroid||e===a.e.wordAndroid||e===a.e.excelAndroid||e===a.e.visioAndroid||e===a.e.onenoteAndroid||e===a.e.powerpointAndroid||e===a.e.teamsAndroid||e===a.e.officemobileAndroid||e===a.e.streamAndroid||e===a.e.outlookAndroid}function l(e){return c(e)||d(e)}function u(e){return r(e)||e===a.e.onenoteWeb||e===a.e.outlookWeb||e===a.e.officecom||e===a.e.teams||e===a.e.sample||e===a.e.outlookGroupsWeb||e===a.e.fluid||e===a.e.odcWac||e===a.e.wac||e===a.e.businesscentral||e===a.e.listPart||e===a.e.listsHome||e===a.e.shareDemo||l(e)}function f(e){return r(e)||e===a.e.officecom||e===a.e.wac||e===a.e.businesscentral}function p(e){return l(e)||v(e)}function m(e){return e===a.e.word||e===a.e.wordAndroid||e===a.e.wordIos}function _(e){return e===a.e.excel||e===a.e.excelAndroid||e===a.e.excelIos}function h(e){return e===a.e.powerpoint||e===a.e.powerpointAndroid||e===a.e.powerpointIos}function b(e){return e===a.e.visio||e===a.e.visioIos||e===a.e.visioAndroid}function g(e){return e===a.e.onenote||e===a.e.onenoteWeb||e===a.e.onenoteUWP||e===a.e.onenoteIos||e===a.e.onenoteAndroid}function v(e){return e===a.e.teams||e===a.e.teamsIos||e===a.e.teamsAndroid}function y(e){return e===a.e.odc}function S(e){return e===a.e.word||e===a.e.excel||e===a.e.powerpoint||e===a.e.ngsc||e===a.e.visio||e===a.e.windowsShare}},1707:function(e,t,n){"use strict";n.d(t,"t",function(){return x}),n.d(t,"o",function(){return C}),n.d(t,"i",function(){return O}),n.d(t,"s",function(){return w}),n.d(t,"c",function(){return A}),n.d(t,"a",function(){return L}),n.d(t,"r",function(){return k}),n.d(t,"d",function(){return M}),n.d(t,"n",function(){return P}),n.d(t,"e",function(){return T});var a,i,r,o,s,c,d,l,u,f,p=n(0),m=n(786),_=n(2131),h=n(205),b=n(42),g=n(415),v=n(565),y=n(295),S=n(13),D=void 0,I={ODB:1469,ODC:"ChromiumDateFix"};function x(e){var t;return"undefined"!=typeof Intl&&Intl.DateTimeFormat?function(n){return t||(t=new Intl.DateTimeFormat(P(h.e.language),e)),t.format(n)}:function(t){return t.toLocaleDateString(P(h.e.language),e)}}function C(e,t){return void 0===t&&(t=!1),v.n(e,P(h.e.language),t)}function O(e,t,n,a,i,r){void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===a&&(a=!1);var o,s=Date.now()-e.getTime(),c=((o=new Date).setHours(0,0,0,0),o),d=R(c,-1),l=R(c,-6),u=i||{},f=u.displayMinutesToOneHour,p=void 0===f||f,b=u.displayHoursToOneDay,g=void 0===b||b,S=u.displayHoursInDates,D=void 0===S||S,I=u.displayShortenedWeekday,x=void 0===I||I,C=P(r||h.e.language);if(p&&s<-5*y.n)return e.toLocaleDateString(C,B({month:"short",day:"numeric"},a));if(s<y.o)return n?_.n:_.t;if(p&&s<y.t)return N(s,_.i,y.n);if(y.l(c,e))return g?N(s,_.a,y.t):v.t("Today",n);if(e>=d)return t||!D?v.t("Yesterday",n):v.t("YesterdayAndTime",n).replace("{0}",e.toLocaleTimeString(C,B({hour:"numeric",minute:"2-digit"},a)));if(e>=l){var O=e.toLocaleDateString(C,B({weekday:"short"},a));return t?O:x||D?m.RelativeDateTime_DayAndTime.replace("{0}",O).replace("{1}",e.toLocaleTimeString(C,B({hour:"numeric",minute:"2-digit"},a))):e.toLocaleDateString(C,B({weekday:"long"},a))}return y.u(c,e)?C.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(C,B({month:"long",day:"numeric"},a)):e.toLocaleDateString(C,B({month:"short",day:"numeric"},a)):e.toLocaleDateString(C,B({month:"short",day:"numeric",year:"numeric"},a))}function w(e){return v.a(e,P(h.e.language))}function E(){var e=a(),t=U();if(window.Intl&&window.Intl.DateTimeFormat){var n={},i={hour:"2-digit",minute:"2-digit"};r=new Intl.DateTimeFormat(e,n),o=new Intl.DateTimeFormat(e,i),t&&(n.timeZone="UTC",i.timeZone="UTC"),s=new Intl.DateTimeFormat(e,n),c=new Intl.DateTimeFormat(e,i),d=r.format,l=o.format,u=s.format,f=c.format}else d=u=function(t){return t.toLocaleDateString(e)},l=f=function(t){return t.toLocaleTimeString(e)}}function A(e,t){if(!e)return"";d||E();var n=y.l(new Date,e);return(t?n?f:u:n?l:d)(e)}function L(e,t){return e?(d||E(),(t?u:d)(e).replace(/[:\/\\]/g,"-")):""}function k(e,t){d||E();var n=t?u(e):d(e),a=t?f(e):l(e);return Object(b.format)(_.e,n,a)}function M(e,t){return y.p(e,P(h.e.language),t)}function P(e){if(void 0===D)try{D=g.e.isFeatureEnabled(I)}catch(e){D=!1}return D&&function(e){if(void 0===H&&function(){H={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,a=F;n<a.length;n++){var i=a[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(H[i]=!0)}}catch(e){}}(),e)return e=e.toLowerCase(),H[e]}(e)?"en":e}function T(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function U(){if(void 0===i)try{var e=a();(new Date).toLocaleDateString(e,{timeZone:"UTC"}),i=!0}catch(e){i=!1}return i}a=function(){for(var e,t=0,n=S.t.isActivated("6f22587b-a676-47a0-b10c-3e037c3f7b14","03/11/2022","Use currentCultureName to display numbers and dates.")?[window.$Config&&window.$Config.mkt,h.e.language,navigator.language,"en"].filter(function(e){return!!e}):[window.$Config&&window.$Config.mkt,h.e.cultureLCID,h.e.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var i=n[t];try{(new Date).toLocaleDateString(i),e=i;break}catch(e){}}return e=P(e),a=function(){return e},e};var F=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","ha-latn-ng","hy-am","ig-ng","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","si-lk","sq-al","ur-pk","uz-latn-uz","yo-ng","zu-za","pa-arab-pk","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","ky","mk","mn","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku","be","rw","ti"],H=void 0;function R(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function N(e,t,n){var a=Math.round(e/n);return t.replace("{0}",String(a))}function B(e,t){return U()&&t&&e?Object(p.__assign)(Object(p.__assign)({},e),{timeZone:"UTC"}):e}},1709:function(e,t,n){"use strict";var a=n(779);n.d(t,"e",function(){return a.t}),n.d(t,"t",function(){return a.n}),n.d(t,"n",function(){return a.a}),n.d(t,"a",function(){return a.r}),n.d(t,"i",function(){return a.o}),n.d(t,"r",function(){return a.s})},1716:function(e,t,n){"use strict";n.d(t,"t",function(){return l}),n.d(t,"e",function(){return u});var a=n(0),i=n(1591),r=n(136),o=n(1),s={gapSpace:0},c={styles:{content:{fontSize:"0.75rem"}},maxWidth:"300px"},d=0;function l(e,t,n){var l=(n=n||{}).tooltipId?n.tooltipId:"od-Share-tooltip-".concat(d);d++;var u=n.targetElementId?Object(a.__assign)(Object(a.__assign)({},s),{target:"#".concat(n.targetElementId)}):s;return o.createElement(i.e,{id:l,content:t,directionalHint:void 0===n.position?r.e.topCenter:n.position,calloutProps:u,tooltipProps:c},e)}function u(e,t,n,a){return o.createElement("span",{tabIndex:-1,"aria-hidden":!!a,className:"od-Share-screenReaderOnly","aria-live":t,role:n},e||"")}},1717:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.default=0]="default",e[e.shareShimmer=1]="shareShimmer",e[e.modifyPermissions=2]="modifyPermissions",e[e.permissionsList=3]="permissionsList",e[e.linkSuccess=4]="linkSuccess",e[e.grantPermissions=5]="grantPermissions",e[e.policyDetails=6]="policyDetails",e[e.error=7]="error",e[e.linkSettings=8]="linkSettings",e[e.notify=9]="notify",e[e.addPeople=10]="addPeople",e[e.linksFromTemplateList=12]="linksFromTemplateList",e[e.atMention=13]="atMention",e[e.spinner=14]="spinner",e[e.copyLinkShortcut=15]="copyLinkShortcut",e[e.permissionsPivot=16]="permissionsPivot",e[e.shareToTeams=17]="shareToTeams"}(a||(a={}))},1720:function(e,t,n){"use strict";n.d(t,"e",function(){return l}),n.d(t,"t",function(){return u}),n.d(t,"r",function(){return f}),n.d(t,"i",function(){return p}),n.d(t,"a",function(){return m}),n.d(t,"n",function(){return _});var a,i,r,o,s,c=n(660),d=n(1703);function l(e){a=Object(c.t)(90076,e),r=Object(c.t)(90022,e),o=Object(c.t)(90128,e),s=Object(c.t)(90127,e),i=Object(c.t)(90069,e)}function u(){try{if(sessionStorage.getItem("linkSettingsImprovementExperiment"))return parseInt(sessionStorage.getItem("linkSettingsImprovementExperiment"))}catch(e){}return i&&d.E()?(i.logExposure(),i.variantToDisplay):0}function f(){return a&&d.G()?(a.logExposure(),a.variantToDisplay):0}function p(){return r&&d.B()?(r.logExposure(),r.variantToDisplay):0}function m(){return d.U()&&o?(o.logExposure(),o.variantToDisplay):0}function _(){return s&&d.A()?(s.logExposure(),s.variantToDisplay):0}},1726:function(e,t,n){"use strict";function a(e){return{clientId:e.clientId,scenarioId:e.scenarioId,correlationId:e.correlationId,hostOptions:e.hostOptions}}n.d(t,"e",function(){return a})},1734:function(e,t,n){"use strict";n.d(t,"t",function(){return u}),n.d(t,"n",function(){return f}),n.d(t,"m",function(){return p}),n.d(t,"_",function(){return m}),n.d(t,"i",function(){return _}),n.d(t,"e",function(){return h}),n.d(t,"d",function(){return b}),n.d(t,"c",function(){return g}),n.d(t,"l",function(){return y}),n.d(t,"h",function(){return S}),n.d(t,"f",function(){return D}),n.d(t,"p",function(){return I}),n.d(t,"u",function(){return x}),n.d(t,"s",function(){return C}),n.d(t,"o",function(){return O}),n.d(t,"a",function(){return w}),n.d(t,"r",function(){return E}),n(0);var a=n(1557),i=n(1043),r=n(2397),o=n(120),s=n(48),c=n(1702),d=(n(59),n(1703)),l=!1;function u(){window.parent.postMessage(JSON.stringify({name:"share_copyLinkClicked"}),"*")}function f(){try{window.external.Dismiss()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_dismiss"}),"*")}}function p(e,t){try{window.external.ShareCompleted(e)}catch(a){var n={name:"share_completed",shareType:e,scope:t};window.parent.postMessage(JSON.stringify(n),"*")}}function m(e,t,n){var a=t?t.length:0;try{window.external.SendLinkViaTeams(e.url)}catch(t){var i={name:"share_teamsClicked",sharingLink:e.url};window.parent.postMessage(JSON.stringify(i),"*")}try{window.external.SendLinkViaTeamsWithContext(e.url,t,a,n)}catch(i){var r={name:"share_teamsClickedWithContext",sharingLink:e.url,recipients:t,numRecipients:a,body:n};window.parent.postMessage(JSON.stringify(r),"*")}}function _(e){try{window.external.GrantAccessCompleted(e)}catch(n){var t={name:"share_grantAccessCompleted",successful:e};window.parent.postMessage(JSON.stringify(t),"*")}}function h(e,t){void 0===t&&(t="");try{window.external.AddPeopleCompleted(e,t)}catch(a){var n={name:"share_addPeopleCompleted",successful:e,completionMessage:t};window.parent.postMessage(JSON.stringify(n),"*")}}function b(e,t,n,r,c,d){l?function(e,t,n,r,c,d){var l=a.e[t]||"unknown";new o.e({name:"ShareV3.".concat(i.e[n],".AfterPageLoad"),startTimeOverride:e||void 0}).end({resultType:c?s.e.Failure:s.e.Success,extraData:{clientId:l,scenario:r,isError:!!c,correlationId:d,error:c}})}(e,t,n,r,c.isStubFile?"file uploading":c.errorMessage||"unknown error",d):(v(e,t,n,r,c.errorMessage||"unknown error",d),l=!0);try{window.external.PageError(c.error,c.errorCategory,c.errorMessage,c.debugErrorMessage)}catch(e){var u={name:"share_error",error:c.error,errorCategory:c.errorCategory,errorMessage:c.errorMessage,debugErrorMessage:c.debugErrorMessage};window.parent.postMessage(JSON.stringify(u),"*")}}function g(){window.parent.postMessage(JSON.stringify({name:"share_outlookClicked"}),"*")}function v(e,t,n,r,c,d){if(e){var l=a.e[t]||"unknown";new o.e({name:"ShareV3.".concat(i.e[n],".PageLoaded"),startTimeOverride:e}).end({resultType:c?s.e.Failure:s.e.Success,extraData:{clientId:l,scenario:r,isError:!!c,correlationId:d,error:c}})}}function y(e,t,n,a,i){if(l){v(e,t,n,a,void 0,i),r=new o.e({name:"Sharing.post_share_ready_instant_load"});try{c={name:"share_instantLoadReady"},window.parent.postMessage(JSON.stringify(c),"*"),r.end({resultType:s.e.Success})}catch(e){r.end({resultType:s.e.Failure,resultCode:"post_share_ready_instant_load_failure"})}}else{v(e,t,n,a,void 0,i);try{window.external.PageFinishedLoading(),new o.e({name:"Sharing.post_webview_share_ready"}).end({resultType:s.e.Success})}catch(e){var r=new o.e({name:"Sharing.post_iframe_share_ready"});try{var c={name:"share_ready"};window.parent.postMessage(JSON.stringify(c),"*"),r.end({resultType:s.e.Success})}catch(e){r.end({resultType:s.e.Failure,resultCode:"post_share_ready_failure"})}}l=!0}}function S(){try{window.external.UIReady()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_uiReady"}),"*")}}function D(){window.parent.postMessage(JSON.stringify({name:"share_readyForRecipients"}),"*")}function I(){window.parent.postMessage(JSON.stringify({name:"share_sendClicked"}),"*")}function x(){try{window.external.PeoplePickerFocused()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_peoplePickerFocused"}),"*")}}function C(e,t,n,a){var i,o=Object(c.b)(a,e,n),s=Object(c.v)(e,t,a,n),l=Object(d.z)()?Object(c.A)(e.sharingLinkKind):Object(c.w)(e.audience),u=Object(c.L)(e.status),f=e.audience===r.e.existing?"00000000-0000-0000-0000-000000000000":e.shareId,p=!1;try{window.external.LinkSettingsCompleted(f,e.url,o,s,l),p=!0}catch(e){}var m={id:f,expirationDateTime:null===(i=e.expiration)||void 0===i?void 0:i.toISOString(),hasPassword:!!e.hasPassword,link:{type:e.isReview?"review":e.isEdit?"edit":"view",blocksDownload:!!e.blockDownload,preventsDownload:!!e.blockDownload,createOnly:!!e.isCreateOnlyLink,iconUrl:o,localizedDescription:s,webUrl:e.url,scope:l,customLabeledAudience:e.audience===r.e.customLabeledSpecificPeople,status:u,createdDateTime:e.created}};try{window.external.LinkSettingsCompletedV2(JSON.stringify(m)),p=!0}catch(e){}if(!p){var _={name:"share_linkSettingsCompleted",type:e.isReview?"review":e.isEdit?"edit":"view",shareId:f,linkUrl:e.url,iconUrl:o,linkDescription:s,scope:l,blocksDownload:!!e.blockDownload,customLabeledAudience:e.audience===r.e.customLabeledSpecificPeople};window.parent.postMessage(JSON.stringify(_),"*"),window.parent.postMessage(JSON.stringify({name:"share_linkSettingsCompletedV2",permissions:m}),"*")}}function O(){var e=!1;try{e=window.external.IsDarkMode()}catch(e){}return e}function w(){var e=void 0;try{e=window.parent.GetShareDialogTheme()}catch(e){}return e}function E(){window.parent.postMessage(JSON.stringify({name:"share_manageAccessClicked"}),"*")}},1735:function(e,t,n){"use strict";n.d(t,"r",function(){return f}),n.d(t,"i",function(){return p}),n.d(t,"e",function(){return m}),n.d(t,"t",function(){return _}),n.d(t,"n",function(){return h}),n.d(t,"a",function(){return b}),n.d(t,"o",function(){return g});var a=n(2397),i=n(2396),r=n(1828),o=n(42),s=n(1),c=n(1590),d=n(1700),l=n(1754),u=n(1703);function f(e){var t,n;return!("UNVALIDATED_EMAIL_ADDRESS"!==(null===(n=null===(t=null==e?void 0:e.rawPersonData)||void 0===t?void 0:t.EntityData)||void 0===n?void 0:n.PrincipalType))}function p(e){var t,n;return!(!(null==e?void 0:e.isExternal)||"GUEST_USER"!==(null===(n=null===(t=null==e?void 0:e.rawPersonData)||void 0===t?void 0:t.EntityData)||void 0===n?void 0:n.PrincipalType))}function m(e){return e&&0!==e.length?e.filter(function(e){return e.entityType===r.e.externalUser}).length:0}function _(e){return e&&0!==e.length?e.filter(function(e){return e.entityType===r.e.linkedinUser}).length:0}function h(e){var t,n=e.filter(function(e){return e.entityType===r.e.externalUser}),a=n.length,i=n.map(function(e){return e.name});if(2===a){var o=(t=i.join(", ")).lastIndexOf(",");return"".concat(t.substring(0,o)," ").concat(d.L," ").concat(t.substring(o+1)," ").concat(d.za)}return a>2?(o=(t=i.join(", ")).lastIndexOf(","),"".concat(t.substring(0,o+1)," ").concat(d.L," ").concat(t.substring(o+1)," ").concat(d.za)):1===a?"".concat(i[0]," ").concat(d.Ga):""}function b(e,t){var n=e.filter(function(e){return e.entityType===r.e.group}).length,a="";return 1===n?a=d.Ha:n>1&&(a=o.format(d.$n,n)),t>=1e3?a+=" ".concat(d.ln):t>=25&&(a+=" ".concat(o.format(d.dn,t))),a}function g(e){var t,n,f,m=e.selectedItems,_=e.sharingLinkKind,h=e.canAddExternalPrincipal,b=e.sharingInformation,g=e.viewPolicyTipCallback,v=e.permissionsMap,y=s.createElement("div",null,s.createElement("span",{role:"alert","aria-live":"assertive"},d.gr," "),s.createElement(c.e,{onClick:g},d.Mr)),S=b.item.hasDlpPolicy||b.sharingAbilities&&b.sharingAbilities.directSharingAbilities&&7===b.sharingAbilities.directSharingAbilities.canAddExternalPrincipal.disabledReason,D=!1,I=!1,x=e.audience;if(b.sharingAbilities&&e.audience&&m&&m.length)switch(x){case a.e.specificPeople:case a.e.specificPeopleFlex:b.sharingAbilities.peopleSharingLinkAbilities&&b.sharingAbilities.peopleSharingLinkAbilities.canAddNewExternalPrincipals&&(D=43===b.sharingAbilities.peopleSharingLinkAbilities.canAddNewExternalPrincipals.disabledReason,I=12===b.sharingAbilities.peopleSharingLinkAbilities.canAddNewExternalPrincipals.disabledReason);break;case a.e.anyone:b.sharingAbilities.anyoneLinkAbilities&&b.sharingAbilities.anyoneLinkAbilities.canAddNewExternalPrincipals&&(D=43===b.sharingAbilities.anyoneLinkAbilities.canAddNewExternalPrincipals.disabledReason,I=12===b.sharingAbilities.anyoneLinkAbilities.canAddNewExternalPrincipals.disabledReason);break;case a.e.organization:b.sharingAbilities.organizationLinkAbilities&&b.sharingAbilities.organizationLinkAbilities.canAddNewExternalPrincipals&&(D=43===b.sharingAbilities.organizationLinkAbilities.canAddNewExternalPrincipals.disabledReason,I=12===b.sharingAbilities.organizationLinkAbilities.canAddNewExternalPrincipals.disabledReason)}for(var C=0,O=m;C<O.length;C++){var w=O[C];if(!w.isResolved)return S&&!h?y:!Object(u.i)()&&D&&w.isExternal?s.createElement("span",{role:"alert","aria-live":"assertive"},d.Hn):w.rawData?(t=w.rawData,n=b.customizedExternalSharingServiceUrl,void 0,0===(f=t.EntityData&&t.EntityData.BlockingSharingPolicy||0)?s.createElement("span",{role:"alert","aria-live":"assertive"},t.Description):f>=401&&f<=404?n?s.createElement("div",{role:"alert","aria-live":"assertive"},o.formatToArray(d.Bt,s.createElement("a",{href:n,target:"_blank"},d.ra))):s.createElement("span",{role:"alert","aria-live":"assertive"},d.Nt):f>=200&&f<=209||f>=301&&f<=305?n?s.createElement("div",{role:"alert","aria-live":"assertive"},o.formatToArray(d.Vt,s.createElement("a",{href:n,target:"_blank"},d.ra))):s.createElement("span",{role:"alert","aria-live":"assertive"},d.jt):f>=600&&f<=603?n?s.createElement("div",{role:"alert","aria-live":"assertive"},o.formatToArray(d.Ao,s.createElement("a",{href:n,target:"_blank"},d.ra))):s.createElement("span",{role:"alert","aria-live":"assertive"},d.Eo):void 0):s.createElement("span",{role:"alert","aria-live":"assertive"},d.ia);if(w.isExternal&&S&&!h)return y;if(w.isExternal&&!h&&!p(w)||w.isExternal&&I)return s.createElement("span",{role:"alert","aria-live":"assertive"},d.Ai);if(w.isExternal&&w.principalType===l.e.distributionList&&w.entityType===r.e.group)return s.createElement("span",{role:"alert","aria-live":"assertive"},d.Ei);var E=_===i.e.organizationEdit||_===i.e.organizationView;if(w.isExternal&&E)return s.createElement("span",{role:"alert","aria-live":"assertive"},d.wi)}if(v&&_===i.e.direct){var A=0;for(var L in v)1===v[L]&&A++;var k="";1===A?k=d._n:A>1&&(k=d.hn);var M=e.onShareHintClick?s.createElement("a",{className:"od-Share-PeoplePicker-error-changeTypeLink",onClick:e.onShareHintClick,href:"javascript:void(0)"},d.xe):void 0;if(k)return s.createElement("div",null,s.createElement("span",{role:"alert","aria-live":"assertive"},k),M)}return b.peoplePickerError?s.createElement("span",{role:"alert","aria-live":"assertive"},b.peoplePickerError):null}},1736:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(e){this._cachedRect={width:0,height:0,top:0,left:0,bottom:0,right:0},this._resizeCallback=e,this._callbackDelayMilliseconds=20}return e.prototype.checkSizeChangeForRef=function(e){e&&e.current&&this.checkSizeChange(e.current)},e.prototype.checkSizeChange=function(e){var t=this;if(e&&this._resizeCallback){var n=e.getBoundingClientRect();this._cachedRect.width===n.width&&this._cachedRect.height===n.height&&this._cachedRect.top===n.top&&this._cachedRect.right===n.right&&this._cachedRect.left===n.left&&this._cachedRect.bottom===n.bottom||(this._callbackDelayMilliseconds?setTimeout(function(){t._resizeCallback()},this._callbackDelayMilliseconds):this._resizeCallback()),this._cachedRect=n}},e}()},1743:function(e,t,n){"use strict";n.d(t,"e",function(){return g});var a=n(0),i=(n(2056),n(1556)),r=n(1676),o=n(1043),s=n(1717),c=n(1),d=n(1699),l=n(42),u=n(1706),f=n(1702),p=n(1700),m=n(136),_=n(1716),h=n(1703),b=n(1720),g=function(e){function t(t,n){var a=e.call(this,t)||this;return a._closeButtonRef=Object(c.createRef)(),a._dismissComponent=function(e){e.stopPropagation(),e.preventDefault(),a._onDismiss()},a.state={showContextualMenu:!1,target:null},a._onDismiss=n.onDismiss,a._platformDetection=n.platformDetection,a._store=n.sharingStore,a._onDismissMoreContextualMenu=a._onDismissMoreContextualMenu.bind(a),a._onManageExistingAccessClick=a._onManageExistingAccessClick.bind(a),a._onMoreClick=a._onMoreClick.bind(a),a._linkSettingsImprovement=Object(b.t)(),a}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=this.props.mode!==o.e.manageAccess||h.e()?"od-ShareHeader-buttons-right":"od-ShareHeader-buttons-right-wac",a=this._platformDetection.isIE?"od-ShareHeader-linkSettings IE":"od-ShareHeader-linkSettings";if(this.props.fullScreenIframeMode&&(n="od-ShareHeader-buttons-right-fullscreen"),t.mode===o.e.linkSettings||t.mode===o.e.manageAccess&&!h.e())return c.createElement("div",null,c.createElement("h3",{className:a},this._getViewName()),!this.props.doNotrenderHeaderButtons&&c.createElement("div",{className:n},this._renderCloseButton()));var i=t.viewState===s.e.linkSuccess||t.viewState===s.e.notify,r=(u.r(this.props.clientId)||this._platformDetection.isMobile,i?"":" od-ShareHeader-backgroundColor"),d=this.props.hasBackButton?" od-ShareHeader-withBackButton":"",l=this.props.title||(null===(e=this.props.hostOptions)||void 0===e?void 0:e.customHeaderString)||this._getViewName(),f="";(t.viewState==s.e.default||h.l()&&t.viewState==s.e.copyLinkShortcut||h.M()&&t.viewState==s.e.error||this._linkSettingsImprovement&&t.viewState==s.e.modifyPermissions)&&(f=" new");var p="od-ShareHeader"+r+d+f,m=this.props.titleIsSubLevel?c.createElement("h2",{className:"od-ShareHeader-viewName od-ShareHeader-subheading",id:"od-shareHeader-viewTitle"},l):c.createElement("h1",{className:"od-ShareHeader-viewName",id:"od-shareHeader-viewTitle"},l),_=i?"":c.createElement("div",{className:p},c.createElement("div",{className:"od-ShareHeader-title"},m,this._renderItemName()));return this.props.fullScreenIframeMode?c.createElement("div",{className:"od-ShareHeader-flexBox"+f},_,!this.props.doNotrenderHeaderButtons&&this._renderRightHeaderButtons(!1,i,t.viewState)):c.createElement("div",null,_,!this.props.doNotrenderHeaderButtons&&this._renderRightHeaderButtons(!1,i,t.viewState),!this.props.doNotrenderHeaderButtons&&this._renderContextualMenu())},t.prototype._onInfoButtonClicked=function(){this._store.getEngagementHelper().linkSettingsLearnMoreClicked(this.props.engagementExtraData),window.open("https://go.microsoft.com/fwlink/?linkid=846149")},t.prototype._renderInfoButton=function(){if(3!=this._linkSettingsImprovement||this.props.viewState!=s.e.modifyPermissions)return null;var e=c.createElement(i.e,{className:"od-ShareHeader-button od-ShareHeader-button-fabric","aria-label":"".concat(p.In,": ").concat(p.er,". ").concat(p.Na),iconProps:{iconName:"Info"},onClick:this._onInfoButtonClicked});return this._platformDetection.isMobile||(e=_.t(e,p.In,{position:m.e.bottomRightEdge})),e},t.prototype._renderMoreButton=function(){if(!(this.props.viewState!==s.e.default&&this.props.viewState!==s.e.addPeople||this.props.hideShareDialogOverflowButton||this._store.isBundleShare())){var e={items:[{key:"manageaccess",text:p.Rn,ariaLabel:p.Rn,onClick:this._onManageExistingAccessClick}],styles:{list:{selectors:{".ms-ContextualMenu-itemText":{fontSize:"0.875rem"},".ms-ContextualMenu-link":{height:"2.25rem",lineHeight:"2.25rem"}}}}},t=c.createElement(i.e,{className:"od-ShareHeader-button od-ShareHeader-button-fabric",ariaLabel:p.Zn,menuIconProps:{iconName:"More",className:"od-ShareHeader-moreOptionsIcon"},menuProps:e});return this._platformDetection.isMobile?t:_.t(t,p.Zn,{position:m.e.bottomRightEdge})}},t.prototype._renderCloseButton=function(){var e,t,n,a=null!==(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.showCloseButton)&&void 0!==n?n:u._(this.props.clientId);if(this._onDismiss&&a){var r=c.createElement(i.e,{componentRef:this._closeButtonRef,className:"od-ShareHeader-button od-ShareHeader-button-fabric","aria-label":p.Ee,onClick:this._dismissComponent,iconProps:{iconName:"Cancel",className:"od-ShareHeader-closeButtonIcon"}});return this._platformDetection.isMobile?r:_.t(r,p.Ee,{position:m.e.bottomRightEdge})}},t.prototype._renderRightHeaderButtons=function(e,t,n){var a="od-ShareHeader-buttons-right od-ShareHeader-buttons-fabric";return this.props.fullScreenIframeMode&&(a="od-ShareHeader-buttons-right-fullscreen"),e&&!t&&n===s.e.default?c.createElement("div",{className:a},this._renderMoreButton()):e&&(t||n!==s.e.default)?"":c.createElement("div",{className:a},this._renderInfoButton(),this._renderMoreButton(),this._renderCloseButton())},t.prototype._renderItemName=function(){var e=this.props,t=e.item;if(t){var n=t.childCount>1?" (".concat(l.format(p.$t,t.childCount),")"):"";return c.createElement("p",{className:"od-ShareHeader-itemName","aria-label":t.name},!e.hideItemName&&f.R("".concat(t.name," ").concat(n)))}},t.prototype._renderContextualMenu=function(){var e=[];if(e.push({key:"editable",name:p.Rn,onClick:this._onManageExistingAccessClick}),this.state.showContextualMenu)return c.createElement(r.e,{ariaLabel:p.Zn,className:"od-ShareHeader-moreContextualMenu",items:e,onDismiss:this._onDismissMoreContextualMenu,target:this.state.target,isBeakVisible:!0,styles:{subComponentStyles:{menuItem:{itemClassName:"od-ShareHeader-moreContextualMenu-item"},callout:{}}}})},t.prototype._onMoreClick=function(e){this.setState({showContextualMenu:!this.state.showContextualMenu,target:e.nativeEvent.target})},t.prototype._onDismissMoreContextualMenu=function(){this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{showContextualMenu:!1}))},t.prototype._onManageExistingAccessClick=function(){this.props.onManageExistingAccessClick&&this.props.onManageExistingAccessClick()},t.prototype._getViewName=function(){switch(this.props.viewState){case s.e.default:return p.ho;case s.e.modifyPermissions:return 3==this._linkSettingsImprovement?p.Wn:p.Kn;case s.e.linksFromTemplateList:return p.Qn;case s.e.permissionsList:return p.Rn;case s.e.policyDetails:return p.rr;case s.e.grantPermissions:return p.sn;case s.e.addPeople:return p.y;default:return p.ho}},t.prototype.focusCloseButton=function(){this._closeButtonRef.current&&(this._closeButtonRef.current.focus(),this.props.closeButtonOnFocus&&this.props.closeButtonOnFocus())},t.contextTypes={onDismiss:d.func,platformDetection:d.object.isRequired,sharingStore:d.object.isRequired},t}(c.Component)},1748:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return S});var a,i=n(2017),r=n(332);!function(e){e[e.cover=0]="cover",e[e.center=1]="center",e[e.fit=2]="fit",e[e.fitExpand=3]="fitExpand",e[e.fitExpandHeight=4]="fitExpandHeight",e[e.fitExpandWidth=5]="fitExpandWidth",e[e.fitWidth=6]="fitWidth",e[e.fitHeight=7]="fitHeight",e[e.top=8]="top"}(a||(a={}));var o=function(e,t){this.name=e,this.getTransform=t};function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new o(e.map(function(e){return e.name}).join("-"),function(t,n){for(var a=i.e.IDENTITY,r=0,o=e;r<o.length;r++){var s=o[r],c={width:t.width*a.scale,height:t.height*a.scale};a=s.getTransform(c,n).multiply(a)}return a})}var c=new o(a[a.center],function(e,t){var n=new r.e((t.width-e.width)/2,(t.height-e.height)/2);return new i.e(n)}),d=new o(a[a.top],function(e,t){var n=new r.e((t.width-e.width)/2,0);return new i.e(n)}),l=new o(a[a.fitWidth],function(e,t){var n=t.width/e.width;return new i.e(r.e.ORIGIN,Math.min(n,1))}),u=new o(a[a.fitHeight],function(e,t){var n=t.height/e.height;return new i.e(r.e.ORIGIN,Math.min(n,1))}),f=new o(a[a.fit],function(e,t){return(e.width/e.height>t.width/t.height?l:u).getTransform(e,t)}),p=new o(a[a.fitExpandWidth],function(e,t){var n=t.width/e.width;return new i.e(r.e.ORIGIN,n)}),m=new o(a[a.fitExpandHeight],function(e,t){var n=t.height/e.height;return new i.e(r.e.ORIGIN,n)}),_=new o(a[a.fitExpand],function(e,t){return(e.width/e.height>t.width/t.height?p:m).getTransform(e,t)}),h=new o(a[a.cover],function(e,t){return(e.width/e.height>t.width/t.height?u:l).getTransform(e,t)}),b=s(f,c),g=s(_,c),v=s(h,c);function y(e){var t,n;if("string"==typeof e)t=a[e];else{if(function(e){return"object"==typeof e}(e))return e;t=e}switch(t){case a.top:n=d;break;case a.fitHeight:n=u;break;case a.fitWidth:n=l;break;case a.fit:n=b;break;case a.fitExpand:n=g;break;case a.center:n=c;break;default:n=v}return n}function S(e){var t;return t=e instanceof Array?e:[e],s.apply(void 0,t.map(y))}},1751:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return i}),function(e){e[e.none=0]="none",e[e.right=1]="right",e[e.flip=2]="flip",e[e.left=3]="left"}(a||(a={}));var i=a},1757:function(e,t,n){"use strict";var a=n(59),i=n(203),r=function(){function e(e){this.concurrency=e||1,this._running=0,this._queue=[],this._promiseComplete=this._promiseComplete.bind(this)}return e.prototype.enqueue=function(e){var t;if(this._running<this.concurrency)this._running++,(t=e()).then(this._promiseComplete,this._promiseComplete);else{var n={callback:e,signal:null,canceled:!1,result:null};n.signal=new i.e(function(){n.canceled=!0,a.n.is(n.result)&&n.result.cancel()}),this._queue.push(n),t=n.signal.getPromise()}return a.n.resolve(t)},e.prototype._promiseComplete=function(){var e=this;if(this._running--,this._running<this.concurrency&&this._queue.length){for(var t=this._queue.shift();t&&t.canceled;)t=this._queue.length?this._queue.shift():null;t&&(this._running++,t.result=t.callback(),t.result.then(function(n){t.signal.complete(n),e._promiseComplete()},function(n){t.signal.error(n),e._promiseComplete()}))}},e}();t.e=r},1813:function(e,t,n){"use strict";var a=n(59),i=n(203),r=[],o=function(){function e(e,t,n){this.complete=!1,this.pending=!1,this.eventName="cookieToss",this._lastAttempt=0,this.domainRegex=e,this.iframeSrc=t,this.complete=n}return e.initializeAuthenticators=function(t,n){if(n)if(window.$Config.aadClientId&&"live.com"===window.$Config.domain);else{for(var a=n.s,i=n.r,o=0;a&&o<a.length;o++)r.push(new e(t[o],a[o],!i[o]));n.c=function(e){r[e].onAuthComplete()},e.authenticate("https://livefilestore.com/"),e.authenticate("https://1drv.com/")}},e.authenticate=function(e){for(var t,n=0;n<r.length;n++){var i=r[n];if(i.requiresAuth(e)){t=i.authenticate(e);break}}for(var o=[t||a.n.wrap(!0)],s=0,c=this._cookieCheckers;s<c.length;s++){var d=c[s];d.isApplicable(e)&&o.push(d.check(e))}return a.n.all(o).then(function(e){return e.reduce(function(e,t){return e&&t})})},e.registerCookieChecker=function(e){this._cookieCheckers.push(e)},e.prototype.requiresAuth=function(e){return this.domainRegex.test(e)},e.prototype.authenticate=function(e){var t=(new Date).getTime();if(t-this._lastAttempt>6e5&&(this._authPromise=null,this._lastAttempt=t),!this._authPromise){this._authPromise=new i.e;var n=document.createElement("IFRAME");n.src=this.iframeSrc,n.style.display="none",document.body.appendChild(n)}return this._authPromise.getPromise()},e.prototype.onAuthComplete=function(){this._authPromise.complete(!0)},e._cookieCheckers=[],e}();t.e=o},1827:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(20);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ActivityIndicator{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);z-index:2;text-align:center}.od-ActivityIndicator .ms-Spinner{display:inline-block;width:1.75rem}.od-ActivityIndicator span{font-size:1rem}\n"}]);var r=n(1),o=n(1686),s=n(414),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){return r.createElement("div",{className:"od-ActivityIndicator","aria-hidden":this.props.ariaHidden,"aria-live":"assertive"},r.createElement("div",null,r.createElement(o.e,{type:s.t.large,styles:{circle:{width:"1.75rem",height:"1.75rem",borderWidth:"0.09375rem"},label:{fontSize:"0.75rem"}}})),r.createElement("span",{role:"alert"},this.props.message))},t}(r.Component)},1845:function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"e",function(){return _});var a,i,r=n(0),o=n(89),s=n(1557),c=n(1043),d=n(2669),l=n(2397),u=n(2396),f=n(1735),p=n(1717),m="ShareV3";!function(e){e.Opening="Opening",e.Opened="Opened",e.Completed="Completed"}(a||(a={})),function(e){e.MainLinkSettingsHint="MainLinkSettingsHint",e.CopyLinkSettingsHint="CopyLinkSettingsHint",e.RoleSelector="RoleSelector",e.Other="Unknown"}(i||(i={}));var _=function(){function e(e,t){this._manager=e,this._extraData=t}return e.prototype.setEngagementExtraData=function(e){this._extraData=Object(r.__assign)(Object(r.__assign)({},this._extraData),e)},e.prototype.linkSettingsOpened=function(e,t){this.log("LinkSettings.Opened",Object(r.__assign)(Object(r.__assign)({},e),{linkSettingsOpenSource:t||i.Other}))},e.prototype.linkSettingsApplyClicked=function(e){this.log("LinkSettings.ApplyClicked",e)},e.prototype.linkSettingsCancelClicked=function(e){this.log("LinkSettings.CancelClicked",e)},e.prototype.linkSettingsLearnMoreClicked=function(e){this.log("LinkSettings.LearnMoreClicked",e)},e.prototype.linkSettingsOnAllowEditingClicked=function(e){this.log("LinkSettings.AllowEditingClicked",e)},e.prototype.linkTrackLinkClicked=function(e){this.log("LinkSettings.TrackLinkClicked",e)},e.prototype.linkSettingsLinkTypeChanged=function(e){this.log("LinkSettings.LinkTypeChanged",e)},e.prototype.manageAccessOpened=function(e){this.log("ManageAccess.Opened",e)},e.prototype.manageAccessAddressBarLinkTypeClicked=function(e){this.log("ManageAccess.AddressBarLinkTypeClicked",e)},e.prototype.manageAccessFacePileClicked=function(e){this.log("ManageAccess.FacePileClicked",e)},e.prototype.manageAccessRemoveDirectAccess=function(e){this.log("ManageAccess.RemoveDirectAccess",e)},e.prototype.manageAccessLinkCopyButtonClicked=function(e){this.log("ManageAccess.LinkCopyClicked",e)},e.prototype.manageAccessLinkDetailsClicked=function(e){this.log("ManageAccess.LinkDetailsClicked",e)},e.prototype.manageAccessLinkInviteesToggled=function(e,t){this.log("ManageAccess.LinkInviteesToggled",Object(r.__assign)(Object(r.__assign)({},t),{isExpanded:e}))},e.prototype.manageAccessAdvancedLinkClicked=function(e){this.log("ManageAccess.AdvancedLinkClicked",e)},e.prototype.manageAccessLinkSectionShareClicked=function(e){this.log("ManageAccess.LinkSectionShareClicked",e)},e.prototype.manageAccessGrantAccessClicked=function(e){this.log("ManageAccess.DiretAccessSectionGrantAccessClicked",e)},e.prototype.manageAccessV3Opened=function(e){this.log("ManageAccessV3.Opened",e)},e.prototype.manageAccessV3NavClicked=function(e,t){this.log("ManageAccessV3.NavigationClicked",Object(r.__assign)(Object(r.__assign)({},t),{manageAccessSection:e}))},e.prototype.manageAccessV3ShareClicked=function(e,t){this.log("ManageAccessV3.ShareClicked",Object(r.__assign)(Object(r.__assign)({},t),{shareLocation:e}))},e.prototype.manageAccessV3PrincipalDetailsClicked=function(e,t){this.log("ManageAccessV3.PrincipalDetailsClicked",Object(r.__assign)(Object(r.__assign)({},t),{principalType:e}))},e.prototype.manageAccessV3PrincipalRemoveDirectAccess=function(e,t){this.log("ManageAccessV3.PrincipalRemoveDirectAccess",Object(r.__assign)(Object(r.__assign)({},t),{principalType:e}))},e.prototype.manageAccessV3CancelPermissionUpdate=function(e){this.log("ManageAccessV3.CancelPermissionUpdate",e)},e.prototype.shareToTeamsTeachingBubbleShown=function(e){this.log("ShareToTeamsTeachingBubble.Shown",e)},e.prototype.shareCompleted=function(e){this.log("Completed",e)},e.prototype.sendACopyClicked=function(e){this.log("SendACopy.Clicked",e)},e.prototype.sendACopyOfficeClicked=function(e){this.log("SendACopy.OfficeClicked",e)},e.prototype.sendACopyPdfClicked=function(e){this.log("SendACopy.PdfClicked",e)},e.prototype.whoElseHasAccessClicked=function(e){this.log("WhoElseHasAccess.Clicked",e)},e.prototype.externalSharingCslError=function(e){this.log("externalSharingCslError",e)},e.prototype.copyLinkInterruptOpened=function(e){this.log("copyLinkInterruptOpened",e)},e.prototype.copyLinkInterruptEditLinkChosen=function(e){this.log("copyLinkInterruptEditLinkChosen",e)},e.prototype.copyLinkInterruptExistingLinkChosen=function(e){this.log("copyLinkInterruptExistingLinkChosen",e)},e.prototype.copyLinkInterruptCancelled=function(e){this.log("copyLinkInterruptCancelled",e)},e.prototype.shareErrorFileIsUploading=function(e){this.log("shareError.FileUploading",e)},e.prototype.webShareToTeamsTargetClicked=function(e){this.log("ShareToTeams.TeamsTargetClicked",e)},e.prototype.onLinkParticipantOpenDelete=function(e){this.log("ShareLinkParticipants.OpenParticipantDeletionDialog",e)},e.prototype.onLinkParticipantDelete=function(e){this.log("ShareLinkParticipants.ParticipantDeleted",e)},e.prototype.peoplePickerLinkedinSuggestions=function(e,t){this.log("PeoplePicker.Suggestions",Object(r.__assign)(Object(r.__assign)({},e),{linkedinSuggestionsCount:f.t(t)}))},e.prototype.onShareLinkDelete=function(e){this.log("ShareLink.Delete",e)},e.prototype.logShareLinkGeneration=function(e,t){this.log("ShareV3.odspShareLink",Object(r.__assign)(Object(r.__assign)({},t),{allowsAnonymousAccess:e.allowsAnonymousAccess,audience:e.audience,blockDownload:e.blockDownload,createdViaCopyLinkCommand:e.createdViaCopyLinkCommand,hasDescription:!!e.description,hasExpiration:!!e.expiration,hasPassword:e.hasPassword,numOfInvitees:e.invitees?e.invitees.length:0,isActive:e.isActive,isAddressBarLink:e.isAddressBarLink,isCreateOnlyLink:e.isCreateOnlyLink,isEdit:e.isEdit,isManageList:e.isManageList,isReview:e.isReview,isUnhealthy:e.isUnhealthy,shareId:e.shareId,sharingLinkStatus:e.status,trackLinkUsers:e.trackLinkUsers}))},e.prototype.logEvent=function(e,t){this.log(a[e],t)},e.prototype.log=function(e,t){var n=Object(r.__assign)(Object(r.__assign)({},this._extraData),t),a=location.href.toLowerCase().indexOf("sharedialog.aspx")>=0,i=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},n),{clientId:s.e[n.clientId],scenarioId:n.scenarioId,mode:c.e[n.mode],shareType:d.e[n.shareType],audience:l.e[n.audience],shareTargets:this._getFriendlyShareTargets(n.shareTargets),sharingLinkKind:u.e[n.sharingLinkKind],isShareDialogASPXHosted:a}),void 0===n.shareViewState?{}:{shareViewState:p.e[n.shareViewState]}),f={name:0===e.indexOf(m)?e:"".concat(m,".").concat(e),webTemplateId:n.webTemplateId?n.webTemplateId.toString():void 0,docId:n.itemUniqueId,extraData:i};(this._manager?o.e.withManager(this._manager):o.e).logData(f)},e.prototype._getFriendlyShareTargets=function(e){var t=[];if(e)for(var n=0,a=e;n<a.length;n++){var i=a[n];t.push(d.e[i])}return t},e}()},1894:function(e,t,n){"use strict";var a=function(){function e(t){var n;if(this._raw=t,t){t=(t=t.replace(/\u200e|\u200f/g,"")).trim();for(var a,i,r=new RegExp(e.EmailRegexPattern,"gi"),o=e.EmailMatchTypes.None,s=e.EmailMatchTypes.None;null!==(i=r.exec(t));){var c=i[0],d=c.charAt(0),l=c.charAt(c.length-1);if((s="<"===d&&">"===l?e.EmailMatchTypes.Bracketed:'"'===d&&'"'===l?e.EmailMatchTypes.Quoted:e.EmailMatchTypes.Bare)>o&&(a=i,o=s,s===e.EmailMatchTypes.Bracketed))break}var u=t;if(a){n=a[0];var f=a.index,p=f+n.length,m=f>0?t.substr(0,f).trim():"",_=p<t.length?t.substr(p):"";"'"===(n=e.StripBracketsAndQuotesRegex.exec(n)[1]).charAt(0)&&_&&"'"===_.charAt(0)&&(n=n.slice(1),_=_.slice(1).trim()),u=""===m?_:m,this._email=n.trim()}(u=u.replace(/^\s*"\s*/,"").trim()).length>1&&"/"!==u.charAt(u.length-2)&&(u=u.replace(/\s*"$/,"")),""!==(u=u.replace(/\//g,""))&&u!==n&&(this._name=u)}}return e.isValidEmailSyntax=function(t,n){return!!t&&!!(n?e.ValidEmailRegex:e.EmailRegex).exec(t.trim())},e.parse=function(t){if(!t)return[];for(var n=e._splitAddresses(t),a=[],i=0,r=n.length;i<r;i++)a.push(new e(n[i]));return a},e.endsWithDelimiter=function(t){if(t){var n=t.split(e.DelimiterRegex);return!n[n.length-1].trim()}return!1},e._splitAddresses=function(t){for(var n=t.split(e.DelimiterRegex),a=n.length-1;a>=0;a--)n[a]=n[a].trim(),0===n[a].length&&n.splice(a,1);return n},e.prototype.getEmail=function(){return this._email},e.prototype.getName=function(){return this._name},e.prototype.getRaw=function(){return this._raw},e.EmailRegexPattern="(?:[<\"]\\s*)?[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?\\.)+[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?(?:\\s*[>\"])?",e.EmailRegex=new RegExp(e.EmailRegexPattern,"i"),e.ValidEmailRegexPattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)",e.ValidEmailRegex=new RegExp(e.ValidEmailRegexPattern,"i"),e.StripBracketsAndQuotesRegex=/^[<"]?([^<>"]*)[>"]?$/,e.DelimiterRegex=/[,;](?=(?:[^"]*"[^"]*")*(?![^"]*"))/,e.EmailMatchTypes={None:0,Quoted:1,Bare:2,Bracketed:3},e}();t.e=a},1914:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(253),i=Object(a.e)({eventName:"ListViewStartRender,",shortEventName:"ListViewStartRender",samplingFeature:{ODB:!0,ODC:"ListViewRenderLogging",Fallback:!1}},{})},1925:function(e,t,n){"use strict";var a,i;n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.Error=2]="Error"}(a||(a={})),function(e){e[e.UnshareLink=0]="UnshareLink",e[e.ShareLink=1]="ShareLink",e[e.FetchSharingInformation=2]="FetchSharingInformation"}(i||(i={}))},1960:function(e,t,n){"use strict";function a(e){return!!e.properties.CheckedOutUserId}function i(e,t){var n=Number(t);return!isNaN(n)&&Number(e.properties.CheckedOutUserId)===n}function r(e,t){return a(e)&&!i(e,t)}n.d(t,"e",function(){return a}),n.d(t,"n",function(){return i}),n.d(t,"t",function(){return r})},2009:function(e,t,n){"use strict";n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var a=n(157),i={word:["doc","docm","docx","docb","dot","dotm","dotx"],excel:["xls","xlsb","xlsm","xlsx","xlt","xltm","xltx"],powerpoint:["ppt","pptm","pptx","sldx","sldm","pot","potm","potx","pps","ppsm","ppsx"],onenote:["one"],visio:["vsd","vsdm","vsdx","vdw","vss","vssm","vssx","vst","vstm","vstx"],fluid:["fluid"],pdf:["pdf"],document:["epub","gdoc","odt","rtf","wri","pages"],presentation:["odp","gslides","key"],spreadsheet:["ods","gsheet","numbers"],txt:["dif","diff","readme","out","plist","properties","text","txt"],archive:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z","zip"],photo:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"],audio:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","ogg","oga","ra","rm","wav","wma","wv"],video:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4"," mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"],vector:["ai","dgn","gdraw","pd","emf","eps","fig","indd","indt","ps","svg","svgz","wmf","oxps","xps","xd","sketch"],model:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layout","max","off","ply","skp","stp","stl","t","thl","x"],csv:["csv"],xml:["xaml","xml","xsl"],html:["htm","html","mht"],code:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","Hcp","h","h++","haml","handlebars","hbs","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","sh","shtml","sml","svn-base","sql","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"],email:["eml","msg","ost","pst"],application:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"],font:["ttf","otf","woff"],sysfile:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","kdc","ldt","lrprev","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xll"]},r=void 0;function o(e){return e?null!==e.itemType&&void 0!==e.itemType&&e.itemType!==a.t.File?a.t[e.itemType].toLowerCase():s(e.extension):"none"}function s(e){return e?(r||(r={},Object.keys(i).map(function(e){i[e].forEach(function(t){r[t]=e})})),r[e.toLowerCase()]||"other"):"none"}},2017:function(e,t,n){"use strict";var a=n(332),i=n(666),r=function(){function e(e,t){void 0===e&&(e=new a.e),void 0===t&&(t=1),this.translate=e,this.scale=t}return e.areEqual=function(e,t,n){return void 0===n&&(n=1e-6),a.e.areEqual(e.translate,t.translate,n)&&Math.abs(Math.log(e.scale/t.scale))<n},e.zoom=function(t,n,a){return new e(t.subtract(n).scale(a-1),a)},e.centerWithinBounds=function(t,n,r){return new e(new i.e(a.e.ORIGIN,t).getCenter().subtract(a.e.getCenter([n,r])))},e.prototype.apply=function(e){return e.scale(this.scale).add(this.translate)},e.prototype.multiply=function(t){return new e(this.translate.add(t.translate.scale(this.scale)),this.scale*t.scale)},e.prototype.invert=function(){return new e(this.translate.scale(-1/this.scale),1/this.scale)},e.prototype.toString=function(){return"[Transform (".concat(this.translate.x,", ").concat(this.translate.y,") ").concat(this.scale,"]")},e.IDENTITY=new e,e}();t.e=r},2054:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n(489);function i(e,t){var n;e.extend({rateLimit:{timeout:1,method:"notifyWhenChangesStop"}});var i=e.subscribe(function(a){t.cancelAnimationFrame(n),n=t.requestAnimationFrame(function(){n=t.requestAnimationFrame(function(){n=void 0,e()})})},null,"beforeChange");return e=Object(a.e)(e,function(){i.dispose()})}function r(e,t){return e.equalityComparer=t,e}},2056:function(e,t,n){"use strict";var a=n(20);Object(a.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareHeader{-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;padding:16px 16px 12px}.od-ShareHeader.new{padding:0}[dir='ltr'] .od-ShareHeader.od-ShareHeader-withBackButton{padding-left:48px}[dir='rtl'] .od-ShareHeader.od-ShareHeader-withBackButton{padding-right:48px}.od-ShareHeader-linkSettings{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;padding:0;margin-bottom:5px;font-size:1.125rem;font-weight:700}[dir='ltr'] .od-ShareHeader-linkSettings{margin-left:20px}[dir='rtl'] .od-ShareHeader-linkSettings{margin-right:20px}.od-ShareHeader-linkSettings.IE{margin-top:0px}.teams .od-ShareHeader-linkSettings{font-weight:700;margin-top:32px}.od-ShareHeader-backgroundColor{background-color:transparent}.teams .od-ShareHeader-backgroundColor{background-color:transparent}.od-ShareHeader-moreContextualMenu .is-open{border:none;width:auto}.od-ShareHeader-buttons-left{padding-top:16px;position:absolute;top:0}[dir='ltr'] .od-ShareHeader-buttons-left{padding-left:8px}[dir='rtl'] .od-ShareHeader-buttons-left{padding-right:8px}[dir='ltr'] .od-ShareHeader-buttons-left{left:0}[dir='rtl'] .od-ShareHeader-buttons-left{right:0}.od-ShareHeader-buttons-left.od-ShareHeader-buttons-fabric{padding-top:8px}.od-ShareHeader-buttons-right{padding-top:16px;position:absolute;top:0}[dir='ltr'] .od-ShareHeader-buttons-right{padding-right:8px}[dir='rtl'] .od-ShareHeader-buttons-right{padding-left:8px}[dir='ltr'] .od-ShareHeader-buttons-right{right:0}[dir='rtl'] .od-ShareHeader-buttons-right{left:0}.od-ShareHeader-buttons-right.od-ShareHeader-buttons-fabric{padding-top:8px}.od-ShareHeader-buttons-right-fullscreen{padding-top:16px;top:0}[dir='ltr'] .od-ShareHeader-buttons-right-fullscreen{padding-right:8px}[dir='rtl'] .od-ShareHeader-buttons-right-fullscreen{padding-left:8px}[dir='ltr'] .od-ShareHeader-buttons-right-fullscreen{right:0}[dir='rtl'] .od-ShareHeader-buttons-right-fullscreen{left:0}.od-ShareHeader-buttons-right-fullscreen.od-ShareHeader-buttons-fabric{padding-top:8px}.od-ShareHeader-buttons-right-fullscreen.new{padding:0}.od-ShareHeader-buttons-right-wac{padding-top:8px;position:absolute;top:0}[dir='ltr'] .od-ShareHeader-buttons-right-wac{padding-right:8px}[dir='rtl'] .od-ShareHeader-buttons-right-wac{padding-left:8px}[dir='ltr'] .od-ShareHeader-buttons-right-wac{right:0}[dir='rtl'] .od-ShareHeader-buttons-right-wac{left:0}.od-ShareHeader-moreOptionsIcon{font-size:1rem}.od-ShareHeader-closeButtonIcon{font-size:1rem}.od-ShareHeader-button{z-index:10}.od-ShareHeader-button:not(.od-ShareHeader-button-fabric){outline:transparent;position:relative;background:none;border:none;padding:0px;width:1.875rem;cursor:pointer}.od-ShareHeader-button:not(.od-ShareHeader-button-fabric)::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareHeader-button:not(.od-ShareHeader-button-fabric):focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareHeader-button.od-ShareHeader-button-fabric{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:1rem;width:1.875rem;height:1.875rem}.od-ShareHeader-button:focus,.od-ShareHeader-button:hover{outline:1px solid black}.od-ShareHeader-title{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.od-ShareHeader-viewName{font-size:1.25rem;font-weight:600;font:-apple-system-title1;margin:0px 2rem 4px 0px}[dir='rtl'] .od-ShareHeader-viewName{margin:0px 0px 4px 2rem}.od-ShareHeader-itemName{font-size:.75rem;font-weight:400;text-align:initial;width:100%;font:-apple-system-caption1;margin:0px}@media (forced-colors: active) and (prefers-color-scheme: dark){.od-ShareHeader-closeButtonIcon:hover,.od-ShareHeader-closeButtonIcon:focus{color:white}}@media (forced-colors: active) and (prefers-color-scheme: light){.od-ShareHeader-closeButtonIcon:hover,.od-ShareHeader-closeButtonIcon:focus{color:black}}.od-ShareHeader-flexBox{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline;margin-bottom:10px;width:100%}.od-ShareHeader-flexBox.new{margin:0}@media screen and (-ms-high-contrast: active){.od-Share .od-ShareHeader-button{outline:1px solid "},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-Share .od-ShareHeader-button:focus,.od-Share .od-ShareHeader-button:hover{background-color:highlight}.od-Share .od-ShareHeader-button:focus .od-ShareHeader-closeButtonIcon,.od-Share .od-ShareHeader-button:hover .od-ShareHeader-closeButtonIcon{forced-color-adjust:none;background-color:highlight;color:highlighttext}}@media screen and (-ms-high-contrast: active){.od-Share .od-ShareHeader-button .od-ShareHeader-closeButtonIcon:hover,.od-Share .od-ShareHeader-button .od-ShareHeader-closeButtonIcon:focus{forced-color-adjust:none;background-color:highlight;color:highlighttext}}\n"}])},2132:function(e,t,n){"use strict";var a=n(0),i=n(59),r=n(221),o=n(415),s={ownerCannotShareWithSelf:!0,maximumRecipientsExceeded:!0,invalidAclEmailSpecified:!0,duplicateMembersInRequest:!0,secureSharingInvalidRequest:!0},c=function(){function e(e,t){this._dataRequestor=t.dataRequestor}return e.getSharesPathFromItemUrl=function(e){var t=btoa(unescape(encodeURIComponent(e)));return"/shares/u!".concat(t.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-"),"/driveItem")},e.prototype.createBundle=function(e,t){var n=JSON.stringify({children:e.map(function(e){return{id:e}}),bundle:{},name:t});return n=n.slice(0,-1)+',"@microsoft.graph.conflictBehavior": "rename"}',this._dataRequestor.send({path:"/drive/bundles",apiName:"bundles",requestType:"POST",useAuthorizationHeaders:!0,postData:n,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})},e.prototype.getFamily=function(){var e={};return o.e.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(e.prefer="family.group-enabled-only"),this._dataRequestor.send({path:"/household/me/family",apiName:"family",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:e,expectedErrorCodes:Object(a.__assign)(Object(a.__assign)({},s),{404:!0})}).then(function(e){return e}).catch(function(e){})},e.prototype.getFamilyMembers=function(){var e={};return o.e.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(e.prefer="family.group-enabled-only"),this._dataRequestor.send({path:"/household/me/family/members",apiName:"familyMembers",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:e,expectedErrorCodes:Object(a.__assign)(Object(a.__assign)({},s),{404:!0})}).then(function(e){return e}).catch(function(e){})},e.prototype.isUserPremium=function(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return!!e.quota.storagePlanInformation&&!e.quota.storagePlanInformation.upgradeAvailable})},e.prototype.getDriveInfo=function(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})},e.prototype.createLink=function(e){var t=this,n=e.itemIds,a=e.type,i=e.scope,r=e.preventDownload,o=e.password,s=e.expiration,c=e.bundleName;return 1===n.length?this.createLinkSingleItem({itemUrl:this.getDrivesPathFromItemId(n[0]),type:a,scope:i,preventDownload:r,password:o,expiration:s}):this.createBundle(n,c).then(function(e){return t.createLinkSingleItem({itemUrl:t.getDrivesPathFromItemId(e.id),type:a,scope:i,preventDownload:r,password:o,expiration:s})})},e.prototype.createLinkFromItemUrl=function(t){var n=t.itemUrl,a=t.type,i=t.scope,r=t.preventDownload,o=t.password,s=t.expiration;return this.createLinkSingleItem({itemUrl:e.getSharesPathFromItemUrl(n),type:a,scope:i,preventDownload:r,password:o,expiration:s})},e.prototype.getCurrentUserId=function(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.id})},e.prototype.getDriveOwner=function(e){var t="/drives/"+e;return this._dataRequestor.send({path:t,apiName:"/drives/",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})},e.prototype.getCurrentUser=function(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s})},e.prototype.getItemInfo=function(e){var t="".concat(this.getDrivesPathFromItemId(e));return this._dataRequestor.send({path:t,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})},e.prototype.getItemInfoFromItemUrl=function(t){var n="".concat(e.getSharesPathFromItemUrl(t));return this._dataRequestor.send({path:n,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})},e.prototype.getPermissions=function(e){var t="".concat(this.getDrivesPathFromItemId(e),"/permissions");return this._dataRequestor.send({path:t,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value})},e.prototype.getPermissionsFromItemUrl=function(t){var n="".concat(e.getSharesPathFromItemUrl(t),"/permissions");return this._dataRequestor.send({path:n,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value})},e.prototype.invite=function(e){var t=this,n=e.itemIds,a=e.recipients,i=e.message,r=e.requireSignIn,o=e.sendInvitation,s=e.roles,c=e.password,d=e.expiration,l=e.bundleName;return 1===n.length?this.inviteSingleItem(this.getDrivesPathFromItemId(n[0]),a,i,r,o,s,c,d):this.createBundle(n,l).then(function(e){return t.inviteSingleItem(t.getDrivesPathFromItemId(e.id),a,i,r,o,s,c,d)})},e.prototype.inviteFromItemUrl=function(t){var n=t.itemUrl,a=t.recipients,i=t.message,r=t.requireSignIn,o=t.sendInvitation,s=t.roles,c=t.password,d=t.expiration;return this.inviteSingleItem(e.getSharesPathFromItemUrl(n),a,i,r,o,s,c,d)},e.prototype.getDefaultLink=function(t,n,a){return n.length>0?this.inviteSingleItem(e.getSharesPathFromItemUrl(t),n,"",!0,!1,[],"",void 0,{prefer:"getDefaultLink,ReturnSpecificErrorCode"},a):this.createLinkSingleItem({itemUrl:e.getSharesPathFromItemUrl(t),useMultiPart:a}).then(function(e){return i.n.wrap([e])})},e.prototype.getDefaultLinkByUniqueId=function(e,t,n){return t.length>0?this.inviteSingleItem(this.getPathFromUniqueId(e),t,"",!0,!1,[],"",void 0,{prefer:"getDefaultLink,ReturnSpecificErrorCode"},n):this.createLinkSingleItem({itemUrl:this.getPathFromUniqueId(e),useMultiPart:n}).then(function(e){return i.n.wrap([e])})},e.prototype.updatePermissions=function(e,t,n){var a="".concat(this.getDrivesPathFromItemId(e),"/permissions/").concat(t),o={roles:[n]};return this._dataRequestor.send({path:a,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(o),getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value}).catch(function(e){var t=e.message||"Error updating permission",n=e.code||Object(r.i)(e)||"genericPermissionUpdateFailure",a={error:e.error,name:e.name,errorCode:n,debugErrorMessage:JSON.stringify(e),errorMessage:t,rawError:JSON.stringify(e)};return i.n.reject(a)})},e.prototype.updatePermissionsFromItemUrl=function(t,n,a){var i="".concat(e.getSharesPathFromItemUrl(t),"/permissions/").concat(n),r={roles:[a]};return this._dataRequestor.send({path:i,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(r),getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value})},e.prototype.unshareLink=function(e,t){var n="".concat(this.getDrivesPathFromItemId(e),"/permissions/").concat(t);return this._dataRequestor.send({path:n,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(){return!0})},e.prototype.unshareLinkFromItemUrl=function(t,n){var a="".concat(e.getSharesPathFromItemUrl(t),"/permissions/").concat(n);return this._dataRequestor.send({path:a,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(){return!0})},e.prototype.createLinkSingleItem=function(e){var t=e.type,n=e.itemUrl,a=e.scope,i=e.preventDownload,r=e.password,o=e.useMultiPart,c=e.expiration,d="".concat(n,"/createLink"),l=t&&a?{type:t,scope:a,preventDownload:i}:void 0;return(r||""===r)&&(l.password=r),c&&(l.expirationDateTime=c),this._dataRequestor.send({path:d,apiName:"createLink",requestType:"POST",useMultiPart:o,useAuthorizationHeaders:!0,postData:JSON.stringify(l||{}),getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})},e.prototype.getPathFromUniqueId=function(e){return"/sites/root/items/".concat(e,"/driveItem")},e.prototype.getDrivesPathFromItemId=function(e){var t=e.split("!");return t.length>1?"/drives/".concat(t[0],"/items/").concat(e):"/drive/items/".concat(e)},e.prototype.inviteSingleItem=function(e,t,n,a,i,r,o,c,d,l){var u="".concat(e,"/invite"),f={recipients:t,message:n,requireSignIn:a,sendInvitation:i,roles:r};return o&&(f.password=o),c&&(f.expirationDateTime=c),this._dataRequestor.send({path:u,apiName:"invite",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(f),useMultiPart:l,headers:d,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value})},e}();t.e=c},2144:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Family=0]="Family",e[e.FamilyMember=1]="FamilyMember"}(a||(a={}))},2161:function(e,t,n){"use strict";function a(e){return e?function(e){if(!e)return{};try{var t=atob(e.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(t)}catch(e){return{}}}(decodeURIComponent(e).split(".")[1]):{}}function i(e){return!!e&&"hashedprooftoken"===e.ver}function r(e){if(e){var t=e.azp||e.appid;if(t)return t;var n=e.nameid;return n&&"true"!==e.isuser&&n.split("@")[0]||void 0}}function o(e,t){void 0===t&&(t=Date.now());var n=t/1e3;if(!e)return!1;var a=e.exp,i=e.nbf;return("number"!=typeof i||n>=i)&&("number"!=typeof a||n<a)}n.d(t,"a",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"n",function(){return o})},2184:function(e,t,n){"use strict";n.d(t,"e",function(){return C});var a=n(0),i=n(1043),r=n(20);Object(r.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-AtMention{max-height:550px;min-height:150px;overflow-y:auto;position:relative;min-width:320px}.od-AtMention ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-AtMention li{-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;padding-bottom:8px}[dir='ltr'] .od-AtMention li{padding-right:4px}[dir='rtl'] .od-AtMention li{padding-left:4px}.od-AtMention.od-AtMention--isSharing{position:relative}.od-AtMention.od-AtMention--isSharing:after{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";bottom:0;content:'';left:0;opacity:0.8;position:absolute;right:0;top:0}.od-AtMention .od-AtMention-container{display:inline-block;padding:16px 16px 0px 16px;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:"},{theme:"menuBackground",defaultValue:"#ffffff"},{rawString:";width:100%}.od-AtMention .od-AtMention-recipients{margin-bottom:16px;max-height:200px;overflow-y:auto}.od-AtMention .od-AtMention-recipients li>.od-AtMention-recipient{font:-apple-system-headline}.od-AtMention .od-AtMention-recipients--error{margin-top:16px}.od-AtMention .od-AtMention-recipients--error li>.od-AtMention-recipient--error{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";border-style:solid;border-width:thin}.od-AtMention .od-AtMention-recipients--error li>.od-AtMention-recipient--error .ms-Persona-primaryText{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";font:-apple-system-body}.od-AtMention .od-AtMention-recipient{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-radius:16px;font:-apple-system-body}.od-AtMention div.od-AtMention-message{margin-bottom:16px;font:-apple-system-body;font-size:.875rem}.od-AtMention .od-AtMention-button{margin-bottom:16px;font:-apple-system-headline}.od-AtMention .od-AtMention-button-rounded{margin-bottom:16px;font:-apple-system-headline;height:2.75rem;border-radius:8px}.od-AtMention .od-AtMention-spinnerHolder{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;height:150px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.od-AtMention .od-Share-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}@media screen and (-ms-high-contrast: active){.od-AtMention .od-AtMention-button:hover{color:window;background-color:highlight;border-color:highlight}.od-AtMention .od-AtMention-button:focus,.od-AtMention .od-AtMention-button:active{color:window;background-color:highlight;border-color:highlight;outline:transparent;position:relative}.od-AtMention .od-AtMention-button:focus::-moz-focus-inner,.od-AtMention .od-AtMention-button:active::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-AtMention .od-AtMention-button:focus:focus:after,.ms-Fabric--isFocusVisible .od-AtMention .od-AtMention-button:active:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}}\n"}]);var o=n(1827),s=n(1743),c=n(2214),d=n(1865),l=n(1741),u=n(2325),f=n(1834),p=n(1726),m=n(1717),_=n(1686),h=n(414),b=n(1700),g=n(1706),v=n(1),y=n(1699),S=n(1734),D=n(1716),I=n(1736),x={root:{height:"unset",minHeight:"2rem",padding:"0 1rem"},label:{fontSize:"0.875rem"}},C=function(e){function t(t,n){var a=e.call(this,t)||this;a._topLevelDivRef=v.createRef(),a._onShareClicked=function(){a.setState({isSharing:!0},function(){a._store.getEngagementHelper().shareCompleted({clientId:a.props.clientId,scenarioId:a.props.scenarioId,mode:i.e.atMention}),a._store.grantAccess(a.props.recipients,a.props.canGrantEditPermissions)})},a._onOkayClicked=function(){a._notifyGrantAccessCompleted(!1),a._sharingClientMessenger?a._sharingClientMessenger.sendDismiss():a._dismiss()},a._dismiss=n.onDismiss,a._resize=n.resize,a._store=n.sharingStore,a._platformDetection=n.platformDetection,a._shareClickTime=n.shareClickTime,a._sharingClientMessenger=n.sharingClientMessenger;var r=0===t.recipients.length;return r||a._notifyReady(),a.state={canShare:a._canShare(t.recipients),isLoading:r,isSharing:!1},a._resizeTracker=new I.e(n.resize),a}return Object(a.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=0===e.recipients.length;this.state.isLoading&&!t&&this._notifyReady(),this.setState({canShare:this._canShare(e.recipients),isLoading:t})},t.prototype.componentDidUpdate=function(){this._resizeIfNeeded()},t.prototype.componentDidMount=function(){var e=this;this._notifyReadyForRecipients(),this._store.addListener(function(){var t=e._store.getGrantAccessResult();null!==t&&(e._notifyGrantAccessCompleted(t),e.props.onComplete&&e.props.onComplete(!!t),e._sharingClientMessenger?e._sharingClientMessenger.sendDismiss():e._dismiss())}),this._resizeIfNeeded()},t.prototype.render=function(){var e,t=this.state,n=t.canShare,r=t.isLoading,o=t.isSharing;return e=r?this._renderLoadingSpinner():n?this._renderHappyPath():this._renderSadPath(),v.createElement("div",{ref:this._topLevelDivRef,className:"od-AtMention ".concat(o?"od-AtMention--isSharing":"")},!r&&v.createElement(s.e,Object(a.__assign)({},Object(p.e)(this.props),{mode:i.e.atMention,viewState:m.e.grantPermissions})),e,this._renderSharingActivityIndicator(),D.e(this._getScreenReaderAlertMessage(),"assertive","alert"))},t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.prototype._renderLoadingSpinner=function(){return v.createElement("div",{className:"od-AtMention-spinnerHolder"},v.createElement(_.e,{className:"od-AtMention-spinner",label:b.Le,type:h.t.large,styles:{circle:{width:"1.75rem",height:"1.75rem",borderWidth:"0.09375rem"},label:{fontSize:"0.75rem"}}}))},t.prototype._renderSharingActivityIndicator=function(){if(this.state.isSharing)return v.createElement(o.e,{message:b.on})},t.prototype._renderHappyPath=function(){var e=this._platformDetection.isIOS?"od-AtMention-button-rounded":"od-AtMention-button",t=this._getHappyMessage();return v.createElement("div",{className:"od-AtMention-container"},this._renderRecipients(!1),v.createElement("div",{className:"od-AtMention-message"},t),v.createElement(f.e,{autoFocus:!0,className:e,onClick:this._onShareClicked,"aria-label":b._o,styles:x},b._o))},t.prototype._renderSadPath=function(){var e=this._platformDetection.isIOS?"od-AtMention-button-rounded":"od-AtMention-button";return v.createElement("div",{className:"od-AtMention-container"},v.createElement(c.e,{messageBarType:d.e.warning,styles:{icon:{fontSize:"1rem",minWidth:"1rem",minHeight:"1rem"},text:{fontSize:"0.75rem",lineHeight:"1rem"},innerText:{lineHeight:"1rem"}}},this._getSadMessage()),this._renderRecipients(!0),v.createElement(f.e,{autoFocus:!0,className:e,onClick:this._onOkayClicked,"aria-label":b._o,styles:x},b.Fa))},t.prototype._renderRecipients=function(e){var t=this,n=this.props.recipients.map(function(e){var n=t._isRecipientInvalid(e),i={imageUrl:e.image,primaryText:e.name,size:l.n.extraSmall,coinProps:{styles:{coin:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"},image:{width:"2.5rem !important",height:"2.5rem !important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"}}},styles:{root:{height:"2.5rem"},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"},details:{paddingLeft:t._platformDetection.isIE?"24px":"8px"}}};return v.createElement("li",null,v.createElement(u.e,Object(a.__assign)({},i,{className:"od-AtMention-recipient ".concat(n?"od-AtMention-recipient--error":"")})))});return v.createElement("ul",{className:"od-AtMention-recipients ".concat(e?"od-AtMention-recipients--error":""),"aria-label":b.cn},n)},t.prototype._getScreenReaderAlertMessage=function(){return this.state.isSharing?b.on:b.sn},t.prototype._canShare=function(e){var t=this,n=this.props.sharingInformation;return!!n.canManagePermissions&&!!n.canAddInternalPrincipal&&e.every(function(e){return!t._isRecipientInvalid(e)})},t.prototype._isRecipientInvalid=function(e){return!e.isResolved||e.isExternal&&!e.providerName},t.prototype._notifyReady=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():S.l(this._shareClickTime,this.props.clientId,i.e.atMention,this.props.scenarioId,this.props.correlationId)},t.prototype._notifyReadyForRecipients=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendShareReadyForRecipients():S.f()},t.prototype._notifyGrantAccessCompleted=function(e){this._sharingClientMessenger?this._sharingClientMessenger.sendGrantAccessCompleted(e):S.i(e)},t.prototype._getHappyMessage=function(){return this._store.isConsumer()?b.Q:this._store.isListItem()?b.q:g.c(this.props.clientId)?b.Y:b.W},t.prototype._getSadMessage=function(){if(this._store.isConsumer())return b.$;var e=this.props.sharingInformation,t=g.c(this.props.clientId)?b.X:b.J;return e.canManagePermissions&&e.canAddInternalPrincipal?b.Z:t},t.contextTypes={onDismiss:y.func.isRequired,resize:y.func.isRequired,sharingStore:y.object.isRequired,platformDetection:y.object.isRequired,shareClickTime:y.number,sharingClientMessenger:y.object},t}(v.Component)},2308:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i});var a={edit:0,move:1,comment:2,commentResponse:3,mention:4,version:5,restore:6,restoreVersion:7,pointInTimeRestore:8,rename:9,delete:10,create:11,share:12,copy:13,addShortcutToOneDrive:14,removeShortcutFromOneDrive:15,unknown:16};function i(e){return function(t){return t.type===a.comment?e.Comment(t):t.type===a.commentResponse?e.CommentResponse(t):t.type===a.create?e.Create(t):t.type===a.delete?e.Delete(t):t.type===a.edit?e.Edit(t):t.type===a.mention?e.Mention(t):t.type===a.move?e.Move(t):t.type===a.pointInTimeRestore?e.PointInTimeRestore(t):t.type===a.rename?e.Rename(t):t.type===a.restore?e.Restore(t):t.type===a.restoreVersion?e.RestoreVersion(t):t.type===a.share?e.Share(t):t.type===a.version?e.Version(t):t.type===a.copy?e.Copy(t):t.type===a.addShortcutToOneDrive?e.AddShortcutToOneDrive(t):t.type===a.removeShortcutFromOneDrive?e.RemoveShortcutFromOneDrive(t):e.Unknown(t)}}},2560:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o});var a=n(508),i=new a.n("Click",a.a.event),r=new a.n("KeyPress",a.a.event),o=new a.n("Drop",a.a.event)},2669:function(e,t,n){"use strict";var a;!function(e){e[e.share=0]="share",e[e.copy=1]="copy",e[e.outlook=2]="outlook",e[e.nonOutlook=3]="nonOutlook",e[e.moreApps=4]="moreApps",e[e.mobileShareToTeams=5]="mobileShareToTeams",e[e.webShareToTeams=6]="webShareToTeams"}(a||(a={})),t.e=a},2749:function(e,t,n){"use strict";var a=n(2308);function i(e){return void 0!==e.action}function r(e){return void 0!==e.activityDateTime}function o(e){var t=g(e).comment;return void 0!==t&&!t.isReply}function s(e){var t=g(e).comment;return void 0!==t&&t.isReply}function c(e){return void 0!==g(e).mention}function d(e){return void 0!==g(e).version}function l(e){return void 0!==g(e).pointInTimeRestore}function u(e){return void 0!==g(e).restoreVersion}function f(e){return void 0!==g(e).move}function p(e){return void 0!==g(e).rename}function m(e){return void 0!==g(e).delete}function _(e){return void 0!==g(e).share}function h(e){var t=g(e).addToOneDrive;return void 0!==t&&!t.removedDateTime}function b(e){var t=g(e).addToOneDrive;return void 0!==t&&!!t.removedDateTime}function g(e){return i(e)?e.action:e}function v(e){return e.driveItem||e.listItem}var y=n(74),S=!n(13).t.isActivated("DC1B3A2B-2469-49B2-9230-7F6CD01BD84C","12/30/2020","Enable deeplinking for comment activities"),D=function(){function e(){}return e.prototype.processResponse=function(e){var t=this,n=e.item,a=e.response;return{isPlaceholder:!1,activities:a.value.map(function(e){if(r(e))if(o(e)||s(e)){var a=g(e).comment;(a.contentId||a.navigationId)&&(e.docDetails={contentId:a.contentId,navigationId:a.navigationId})}else if(c(e)){var i=g(e).mention;(i.contentId||i.navigationId)&&(e.docDetails={contentId:i.contentId,navigationId:i.navigationId})}return t._processActivityResponse(n,e)}),nextRequestToken:this._getNextRequestToken(a),success:!0}},e.prototype.processActivitiesByIntervalResponse=function(e){var t=this;return{activitiesByInterval:e.value.map(function(e){return t._processActivitySummaryResponse(e)}),success:!0}},e.prototype._processActivitySummaryResponse=function(e){return{totalCount:(void 0!==e.create?e.create.actionCount:0)+(void 0!==e.delete?e.delete.actionCount:0)+(void 0!==e.edit?e.edit.actionCount:0)+(void 0!==e.move?e.move.actionCount:0)+(void 0!==e.rename?e.rename.actionCount:0)+(void 0!==e.restore?e.restore.actionCount:0)+(void 0!==e.copy?e.copy.actionCount:0),startDateTime:new Date(e.startDateTime),endDateTime:new Date(e.endDateTime)}},e.prototype._getNextRequestToken=function(e){if(e.value&&!(e.value.length<1)){var t=e["@odata.nextLink"],n=t&&t.match(/skiptoken=([^&]+)/i);return n?n[1]:void 0}},e.prototype._processActivityResponse=function(e,t){var n=this._getItem(e,t),a=this._getParentItem(t),i=this._getAction(e,n,a,t);if(r(t)){var o=t.actor&&t.actor.user,s=o&&{displayName:o.displayName,id:o.id,email:o.email,self:o.self};return{id:t.id,type:this._getActivityType(t),actors:s?[s]:[],item:n,parentItem:a,time:new Date(t.activityDateTime),action:i}}var c=t.actor&&t.actor.user,d=c&&{displayName:c.displayName,email:c.email,self:c.self,userPrincipalName:c.userPrincipalName};return{id:t.id,type:this._getActivityType(t),actors:[d],item:n,parentItem:a,time:t.times.recordedTime?new Date(t.times.recordedTime):new Date(t.times.recordedDateTime),friendlyDisplayTime:t["@sharePoint.localizedRelativeTime"],action:i}},e.prototype._getActivityType=function(e){return(t={Comment:function(){return a.e.comment},CommentResponse:function(){return a.e.commentResponse},Create:function(){return a.e.create},Delete:function(){return a.e.delete},Edit:function(){return a.e.edit},Mention:function(){return a.e.mention},Move:function(){return a.e.move},Rename:function(){return a.e.rename},Restore:function(){return a.e.restore},RestoreVersion:function(){return a.e.restoreVersion},PointInTimeRestore:function(){return a.e.pointInTimeRestore},Share:function(){return a.e.share},Version:function(){return a.e.version},Copy:function(){return a.e.copy},AddShortcutToOneDrive:function(){return a.e.addShortcutToOneDrive},RemoveShortcutFromOneDrive:function(){return a.e.removeShortcutFromOneDrive}},function(e){return c(e)?t.Mention(e):o(e)?t.Comment(e):s(e)?t.CommentResponse(e):function(e){return void 0!==g(e).create}(e)?t.Create(e):m(e)?t.Delete(e):function(e){return void 0!==g(e).edit}(e)?t.Edit(e):f(e)?t.Move(e):p(e)?t.Rename(e):function(e){return void 0!==g(e).restore}(e)?t.Restore(e):u(e)?t.RestoreVersion(e):_(e)?t.Share(e):d(e)?t.Version(e):function(e){return void 0!==g(e).copy}(e)?t.Copy(e):l(e)?t.PointInTimeRestore(e):h(e)?t.AddShortcutToOneDrive(e):b(e)?t.RemoveShortcutFromOneDrive(e):void 0})(e);var t},e.prototype._getItem=function(e,t){var n,a,o=v(t);if(f(t)){if(i(t)){var s=g(t).move;if(s&&s.to)return{name:this._getFileNameFromPath(s.to),isRoot:this._isRootItem(s.to),graphItemUrl:void 0,relativePath:void 0,absolutePath:s.to}}}else if(m(t)&&i(t)){var c=g(t).delete;if(c&&c.name){var d=(a=(n=o&&o.parentReference)&&this._getRelativePathFromVroomPath(n.path))&&o&&a+"/"+o.name+"/"+c.name;return{name:c.name,isRoot:this._isRootItem(c.name),graphItemUrl:void 0,relativePath:d,absolutePath:void 0,isFolder:"Folder"===c.objectType}}}return o?(t.docDetails&&(o.webUrl=this._getNavLink(o,t.docDetails)),d=(a=(n=o&&(o.parentReference||o.remoteItem&&o.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(n.path))&&a+"/"+o.name,m(t)?{name:o.name,isRoot:this._isRootItem(o.name),graphItemUrl:void 0,relativePath:d,absolutePath:void 0}:{name:o.name,isRoot:this._isRootItem(o.name),graphItemUrl:n&&"/drives/".concat(n.driveId,"/items/").concat(o.id),relativePath:d,absolutePath:void 0,driveItem:o,navigationId:this._getNavigationId(t)}):r(t)?void 0:e},e.prototype._getParentItem=function(e){var t=v(e);if(f(e)){var n=g(e).move;if(n&&n.to){var a=this._getDirNameFromPath(n.to),r=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference);return{name:this._getFileNameFromPath(a),isRoot:this._isRootItem(a),graphItemUrl:r&&"/drives/".concat(r.driveId,"/items/").concat(r.id),relativePath:void 0,absolutePath:this._getDirNameFromPath(a),isFolder:!0,driveItem:r&&{id:r.id}}}}else if(m(e)&&t){if(i(e)){var o=(c=(r=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(r.path))&&c+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:r&&"/drives/".concat(r.driveId,"/items/").concat(t.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t}}if(r=t&&t.parentReference){o=this._getRelativePathFromVroomPath(r.path);var s=r.name?r.name:o&&this._getFileNameFromPath(o);if(void 0===o||void 0===s||void 0===r.id)return;return{name:s,isRoot:this._isRootItem(s),graphItemUrl:"/drives/".concat(r.driveId,"/items/").concat(r.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:r.id}}}}else{if(u(e)&&t)return o=(c=(r=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(r.path))&&c+"/"+name,{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:r&&"/drives/".concat(r.driveId,"/items/").concat(t.id),relativePath:o,absolutePath:void 0,isFolder:!1,driveItem:t};var c;if(l(e)&&t)return o=(c=(r=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(r.path))&&c+"/"+name,{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:r&&"/drives/".concat(r.driveId,"/items/").concat(t.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t};if(t&&(r=t.parentReference&&t.parentReference)){o=this._getRelativePathFromVroomPath(r.path);var d=r.name?r.name:o&&this._getFileNameFromPath(o);return{name:d,isRoot:this._isRootItem(d),graphItemUrl:"/drives/".concat(r.driveId,"/items/").concat(r.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:r.id}}}}},e.prototype._getNavLink=function(e,t){var n=e.webUrl,a=n&&new y.t(n),i=t.navigationId;return a&&i&&a.setQueryParameter("nav",i),a.toString()||n},e.prototype._getNavId=function(e){return e&&e.navigationId},e.prototype._getNavigationId=function(e){var t,n,a;if(null==e?void 0:e.docDetails)return this._getNavId(e.docDetails);if(S&&o(e)){var i=g(e);return(null===(t=null==i?void 0:i.comment)||void 0===t?void 0:t.navigationId)?null===(n=null==i?void 0:i.comment)||void 0===n?void 0:n.navigationId:null===(a=null==i?void 0:i.comment)||void 0===a?void 0:a.commentId}},e.prototype._getAction=function(e,t,n,a){var i,l={};if(d(a)&&(l.version={newVersion:g(a).version.newVersion}),f(a)){var u=g(a).move;if(r(a)){var m=void 0,v=void 0;u.from&&(m=this._getDirNameFromPath(u.from)),u.to&&(v=this._getDirNameFromPath(u.to)),l.move={from:{name:this._getFileNameFromPath(m),isRoot:this._isRootItem(m),graphItemUrl:void 0,absolutePath:m},to:{name:this._getFileNameFromPath(v),isRoot:this._isRootItem(v),graphItemUrl:void 0,absolutePath:v}}}else if(u.From){var y=this._getDirNameFromPath(u.From);l.move={from:{name:this._getFileNameFromPath(y),isRoot:this._isRootItem(y),graphItemUrl:void 0,absolutePath:y},to:void 0}}else if(u.to){var S=this._getDirNameFromPath(u.to);l.move={from:void 0,to:{name:this._getFileNameFromPath(S),isRoot:this._isRootItem(S),graphItemUrl:void 0,absolutePath:S}}}}if(p(a)){var D=g(a).rename;l.rename={newItem:{name:D.newName,isRoot:this._isRootItem(D.newName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0},oldItem:{name:D.oldName,isRoot:this._isRootItem(D.oldName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0}}}if(s(a)&&(i=g(a).comment).isReply&&(l.commentResponse={commentAuthor:i.parentAuthor&&i.parentAuthor.user}),o(a)&&((i=g(a).comment).isReply||(l.comment={commentId:i.commentId})),c(a)){var I=g(a).mention;l.mention={mentionees:I.mentionees&&I.mentionees.map(function(e){return e.user})||[],commentId:r(a)?I.navigationId:void 0}}if(_(a)){var x=g(a).share;l.share={recipients:x.recipients&&x.recipients.map(function(e){return e.user})||[]}}if(h(a)&&(l.addShortcutToOneDrive={}),b(a)){var C=g(a).addToOneDrive;l.removeShortcutFromOneDrive={mountPointName:C.mountPointName}}return l},e.prototype._getRelativePathFromVroomPath=function(e){if(e)return e.split(":",2)[1]},e.prototype._getDirNameFromPath=function(e){return e&&e.substring(0,e.lastIndexOf("/"))},e.prototype._getFileNameFromPath=function(e){return e&&e.substring(e.lastIndexOf("/")+1)},e.prototype._isRootItem=function(e){return e&&"/LiveFolders"===e},e}();t.e=D},2771:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(253),i=Object(a.e)({eventName:"ListViewRendered,",shortEventName:"ListViewRendered",samplingFeature:{ODB:!0,ODC:"ListViewRenderLogging",Fallback:!1}},{})},2906:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(3145),i=(a.T,a.l,a.F,a.H,a.U,a.i,a.p,a.L,a.C,a.M,a.P,a.k,a.v,a.E,a.y,a.g,a.I,a._,a.x,a.D,a.S,a.h,a.A,a.w,a.O,a.b,[a.r,a.a,a.c,a.e,a.d,a.s,a.o,a.t,a.m,a.f,a.u,a.n])},2918:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(74),i=n(250);function r(e,t){return null!==e&&(e===i.e.Word||e===i.e.PowerPoint||e===i.e.Excel||e===i.e.Prague||e===i.e.Bohemia||e===i.e.Visio||e===i.e.OneNote&&t)}function o(e,t,n,i,o){if(r(n,o)){var s=new a.t(e);return s.setQueryParameter("docliburl",encodeURI(t)),s.setQueryParameter("doctype",n.toString()),s.setQueryParameter("action","editnew"),s.setQueryParameter("odsp","1"),i&&s.setQueryParameter("folderGuid",i),s.toString()}throw new Error("document type is not valid, doc.aspx createNew only support type: 1 - Word, 2 - Excel, 3 - PowerPoint, 4 - OneNote, 8 - Visio, 9-Bohemia, 10 - Prague for the time being.")}},2958:function(e,t,n){"use strict";var a=n(0),i=n(2397),r=n(1557),o=n(2396),s=n(2395),c=n(1754),d=n(221),l=n(120),u=n(48),f=n(1700),p=n(1866),m=n(42),_=n(1845),h=n(415),b=n(1828),g=n(1894),v=n(1706),y=n(2144),S=n(1707),D=n(1703),I=n(1925),x=n(1459),C=n(2009),O=n(1084),w=function(){return null},E=function(){function e(e,t){var n=this;if(this._listeners=null,this.addPeople=w,this.getCompanyName=w,this.getOutlookAvailability=w,this.fetchSuiteNavInformation=w,this.navigateToOwa=w,this.fetchGroupsMemberCount=w,this.getGroupsMemberCount=w,this.fetchPolicyTipInformation=w,this.getPolicyTipInformation=w,this.updatePolicy=w,this.checkPermissions=w,this.getPermissionsMap=w,this.isValidatingDefaultRecipients=function(){return n._isValidatingDefaultRecipients},this.getAddPeopleResult=w,this.hasAccessRequestBeenCreated=w,this.fetchMemberCount=w,this.getMembersCounts=w,this.getInvitationId=w,!e.itemId&&!e.itemUrl&&!e.multiShareIds)throw new Error("An itemId, itemUrl, or multiShareIds must be passed to the Sharing store");this._listeners=new Array,this._shareLink=null,this._grantAccessResult=null,this._itemUrl=e.itemUrl,this._multiShareIds=e.multiShareIds,this._itemId=this._multiShareIds?this._multiShareIds[0]:e.itemId,this._itemName=this._multiShareIds&&this._multiShareIds.length>1?m.format(f.Oo,this._multiShareIds.length):e.itemName,this._sharingService=e.sharingService,this._sharingInformation=null,this._isPremium=null,this._isPremiumPromise=e.isPremiumPromise,this._isBundleShare=this._multiShareIds&&this._multiShareIds.length>1,this._sharingContextInformation=e.sharingContextInformation,this._isUserMinor=e.isUserMinor,this._engagementLoggingChanges=!0,this._engagementLoggingChanges?this._engagementHelper=new _.e(e.telemetryManager,{clientId:this._clientId}):this._engagementHelper=new _.e(e.telemetryManager),this._navId=e.navId,this._family=null,this._familyMembers=[],this._clientId=e.clientId,this._isEdit=null===e.isEdit||void 0===e.isEdit||e.isEdit,this._audience=null!==e.audience&&void 0!==e.audience?e.audience:i.e.anyone,this._isBundleShare&&(this._bundleName=m.format(f.wo,S.a(new Date))),h.e.isFeatureEnabled({ODC:"AtMentionODCKillSwitch"})||(t?this._tryResolveDefaultRecipients(e.defaultRecipients,t.peoplePickerProvider):this._tryResolveDefaultRecipients(e.defaultRecipients,void 0)),this._sharingContextInformation&&this._sharingContextInformation.consumerFlightContexts&&D.r(this._sharingContextInformation.consumerFlightContexts,this._clientId===r.e.odc)}return e.prototype.isConsumer=function(){return!0},e.prototype.isConsumerLists=function(){return!1},e.prototype.isListItem=function(){return!1},e.prototype.getEngagementHelper=function(){return this._engagementHelper},e.prototype._emitChange=function(e){this._listeners.forEach(function(t){return t(e)})},e.prototype.addListener=function(e){this._listeners.push(e),this._emitChange()},e.prototype.shouldInterruptCopyLink=function(e){var t=this;return this._isPremium&&!this.isBundleShare()?this._sharingInformation.hasPermissionsInformation?new Promise(function(n,a){n(t._doesMatchingLinkExist(e))}):new Promise(function(n,a){t._sharingService.getPermissions(t._itemId).then(function(a){t._permissions=a;var i=t._parsePermissions(a),r=i.principals,o=i.sharingLinks;t._sharingInformation.sharingPrincipals=r,t._sharingInformation.sharingLinks=o,n(t._doesMatchingLinkExist(e))})}):new Promise(function(e,t){e(!1)})},e.prototype._doesMatchingLinkExist=function(e){var t=this._sharingInformation.sharingLinks,n=!1;return t.forEach(function(t){t.isEdit!==e||t.application||(n=t.hasPassword)}),n},e.prototype.getInitialLinkSettings=function(e){var t,n=i.e.anyone,a=!0,r=null;if(null==e)t=o.e.anonymousEdit;else if(null!==e.isEdit&&void 0!==e.isEdit&&(a=e.isEdit),null!==e.expiration&&void 0!==e.expiration&&(r=e.expiration),e.audience===i.e.specificPeople)t=o.e.direct,n=i.e.specificPeople;else{if(null!==e.audience&&void 0!==e.audience&&e.audience!==i.e.anyone)throw new Error("ODC does not support other SharingAudience settings.");t=a?o.e.anonymousEdit:o.e.anonymousView,n=i.e.anyone}var c=!1;return D.H()&&(c=e.audience===i.e.specificPeople),{allowEditing:!0,audience:n,expiration:r,isEdit:a,sharingRole:a?s.e.edit:s.e.view,sharingLinkKind:t,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",requireSignIn:c}},e.prototype.getSharingInformation=function(){return this._sharingInformation},e.prototype.shouldDisableGraphForPeopleSearch=function(){return!1},e.prototype.fetchSharingInformation=function(e){var t,n,c,p=this,m=this._itemId?this._sharingService.getItemInfo(this._itemId):this._sharingService.getItemInfoFromItemUrl(this._itemUrl);t=this._sharingService.getDriveInfo(),n=D.p()?this._sharingService.getCurrentUser():Promise.resolve(void 0),c=Promise.resolve(void 0),D.u()||(c=this._isPremiumPromise||Promise.resolve(!1));var _=D.h()&&v.b(this._clientId),h=_?this._sharingService.getFamily():Promise.resolve(),b=_?this._sharingService.getFamilyMembers():Promise.resolve(),g=new l.e({name:"SharingInformationPreReqs",extraData:{clientId:r.e[this._clientId]}});Promise.all([this._toTuple(m),this._toTuple(h),this._toTuple(b),this._toTuple(t),this._toTuple(n),this._toTuple(c)]).then(function(t){var n,r,c=t[0],l=t[1],m=t[2],h=t[3],b=t[4],v=t[5];if(p._isError(c)||p._isError(h)||p._isError(b)||p._isError(v)){if(p._isError(c)){var y=c.error;p._sharingInformation=Object(a.__assign)(Object(a.__assign)({},p._sharingInformation),{error:Object(d.i)(y),errorCategory:5,debugErrorMessage:JSON.stringify(c),errorMessage:y.message||f.an});var S="Canceled"===y.message&&y._handled,I=S?y.message:p._sharingInformation.error;return g.end({resultType:S?u.e.ExpectedFailure:u.e.Failure,resultCode:"Item Error: ".concat(I),extraData:{error:y}}),void p._emitChange()}if(p._isError(b))return y=b.error,p._sharingInformation=Object(a.__assign)(Object(a.__assign)({},p._sharingInformation),{error:Object(d.i)(y),errorCategory:6,debugErrorMessage:JSON.stringify(b),errorMessage:y.message||f.an}),g.end({resultType:u.e.Failure,resultCode:"Me Error: ".concat(p._sharingInformation.error),extraData:{error:y}}),void p._emitChange();if(p._isError(v))return y=v.error,p._sharingInformation=Object(a.__assign)(Object(a.__assign)({},p._sharingInformation),{error:Object(d.i)(y),errorCategory:7,debugErrorMessage:JSON.stringify(v),errorMessage:y.message||f.an}),g.end({resultType:u.e.Failure,resultCode:"Drive Error: ".concat(p._sharingInformation.error),extraData:{error:y}}),void p._emitChange();if(p._isError(h))return y=h.error,p._sharingInformation=Object(a.__assign)(Object(a.__assign)({},p._sharingInformation),{error:Object(d.i)(y),errorCategory:7,debugErrorMessage:JSON.stringify(h),errorMessage:y.message||f.an}),g.end({resultType:u.e.Failure,resultCode:"Drive Error: ".concat(p._sharingInformation.error),extraData:{error:y}}),void p._emitChange()}else{g.end({resultType:u.e.Success});var C=c.value,O=null==h?void 0:h.value;D.p()&&"string"!=typeof b.value?b.value.id:b.value,p._currentUserId=O.id,p._engagementLoggingChanges&&p._engagementHelper.setEngagementExtraData({userId:p._currentUserId}),p._itemId=C.id,p._isPremium=!(null===(r=null===(n=O.quota)||void 0===n?void 0:n.storagePlanInformation)||void 0===r?void 0:r.upgradeAvailable);var w,E=p._getOwnerPrincipal(C);if(D.u()||(p._isPremium=v.value),w=e?p._sharingService.getPermissions(p._itemId):Promise.resolve([]),_&&!p._isError(l)&&!p._isError(m)&&l.value){var A=p._parseFamilyInfo(l.value.id,m.value.value),L=A.family,k=A.familyMembers;p._family=L,p._familyMembers=k}var M=o.e.anonymousEdit,P=i.e.anyone;p._audience===i.e.specificPeople?(M=o.e.direct,P=i.e.specificPeople):p._isEdit||(M=o.e.anonymousView),Promise.all([p._toTuple(w),p._toTuple(E)]).then(function(t){var n,i,r,o,c,l,u,m=t[0],_=t[1];if(p._isError(m)||p._isError(_)){if(p._isError(m)){var h=m.error;p._sharingInformation=Object(a.__assign)(Object(a.__assign)({},p._sharingInformation),{error:Object(d.i)(h),errorCategory:4,debugErrorMessage:JSON.stringify(h),errorMessage:h.message||f.an}),p._emitChange()}else if(p._isError(_)){var b=_.error;p._sharingInformation=Object(a.__assign)(Object(a.__assign)({},p._sharingInformation),{error:Object(d.i)(b),errorCategory:4,debugErrorMessage:JSON.stringify(b),errorMessage:b.message||f.an}),p._emitChange()}}else{var g=m.value,v=_.value,y=(null===(n=p._sharingContextInformation)||void 0===n?void 0:n.itemExtension)||Object(x.t)(C.name,!0);p._permissions=g;var S=p._parsePermissions(g),D=S.principals,I=S.sharingLinks,O=S.hasInheritedPermissions,w=S.hasBundlePermissions;D=[v].concat(D),p._sharingInformation={anonymousLinkExpirationRestrictionDays:-1,blockPeoplePickerAndSharing:!1,canAddExternalPrincipal:!0,canAddInternalPrincipal:!0,canManagePermissions:!0,canRequestAccessForGrantAccess:!0,defaultShareLinkToExistingAccess:!1,defaultShareLinkScope:void 0,defaultSharingLink:{allowsAnonymousAccess:!0,audience:P,expiration:null,isActive:!0,isEdit:p._isEdit,principals:[],shareId:null,sharingLinkKind:M,sharingScope:void 0,url:null,createdViaCopyLinkCommand:null,invitees:[],isReview:!1,updatePassword:!1,password:null,hasPassword:!1,blockDownload:!1,passwordLastModifiedBy:null},hasInheritedLinks:O,hasBundleLinks:w,isShared:!0,item:{name:p._itemName,hasDlpPolicy:!1,childCount:0,appmap:null===(i=p._sharingContextInformation)||void 0===i?void 0:i.itemAppmap,extension:y,itemType:null===(r=p._sharingContextInformation)||void 0===r?void 0:r.itemType,parentName:null===(o=C.parentReference)||void 0===o?void 0:o.name,parentPath:null===(c=C.parentReference)||void 0===c?void 0:c.path},fileExtension:y,sharingLinks:I,sharingPrincipals:D,peoplePickerSettings:{},userDisplayName:"",error:null,errorCategory:null,errorMessage:null,debugErrorMessage:null,requiresAccessApproval:!1,userRole:v&&(null==v?void 0:v.id)===p._currentUserId?s.e.owner:null,defaultShareLinkPermission:p._isEdit?2:1,defaultLinkKind:null,sharingAbilities:(l={enabled:!0,disabledReason:null},u={canGetEditLink:l,canGetReviewLink:l,canGetReadLink:l,canHaveExternalUsers:l,canManageEditLink:l,canManageReviewLink:l,canManageReadLink:l,canManageManageListLink:l,canGetManageListLink:l,linkExpiration:{defaultExpirationInDays:-1,enabled:!0,disabledReason:null},canRequestAccessForGrantAccess:l,canAddInternalPrincipal:l,canAddExternalPrincipal:l,supportsReviewPermission:l,supportsRestrictedView:l,canAddNewExternalPrincipals:l},{anonymousLinkAbilities:u,anyoneLinkAbilities:u,organizationLinkAbilities:u,peopleSharingLinkAbilities:u,directSharingAbilities:u}),directLink:null,hasPermissionsInformation:p._sharingInformation&&p._sharingInformation.hasPermissionsInformation||e,isGraphAvailable:!0,sharingLinkTemplates:null,webTemplateId:void 0,itemUniqueId:p._itemId,peoplePickerError:void 0,webUrl:void 0},p._emitChange()}})}})},e.prototype.shareLink=function(e){var t=e.settings,n=e.recipients,a=e.emailMessage;n&&0!==n.length?this._shareViaInvite(t,n,a):(null==t?void 0:t.updatePassword)?this._createSharingLink(t):this._createSharingLink(t,{useOldPassword:!0})},e.prototype._parseFamilyInfo=function(e,t){var n=t.map(function(e){return{userId:e.id,name:e.firstName+" "+e.lastName,email:e.userPrincipalName,isResolved:!0,familySharingTargetType:y.e.FamilyMember}}),a=t[0].firstName;return t.forEach(function(e,t){0!==t&&(a+=", ".concat(e.firstName))}),{family:{userId:e,name:f.qt,email:a,isExternal:!1,isResolved:!0,entityType:b.e.group,familySharingTargetType:y.e.Family,detailedGroupInfo:b.n.family},familyMembers:n}},e.prototype._getOwnerPrincipal=function(e){var t,n=this;if(D.L()){var i={id:"",isExternal:!1,loginName:"",primaryText:"",secondaryText:"",role:s.e.owner,type:c.e.user,imageUrl:"",email:""};if(e.shared&&e.shared.owner&&e.shared.owner.user)return i.id=e.shared.owner.user.id,i.primaryText=e.shared.owner.user.displayName,new Promise(function(e,t){return e(i)});if(e.parentReference&&e.createdBy&&e.createdBy.user&&e.parentReference.driveId===e.createdBy.user.id)return i.id=e.createdBy.user.id,i.primaryText=e.createdBy.user.displayName,new Promise(function(e,t){return e(i)});if(e.parentReference){var o=new l.e({name:"SharingStore_GetDriveOwner",extraData:{clientId:r.e[this._clientId],driveIdLength:null===(t=e.parentReference.driveId)||void 0===t?void 0:t.length}});return this._sharingService.getDriveOwner(e.parentReference.driveId).then(function(e){var t=e.owner.user;return o.end({resultType:u.e.Success}),i.id=t.id,i.primaryText=t.displayName,new Promise(function(e,t){return e(i)})},function(e){return n._sharingInformation=Object(a.__assign)(Object(a.__assign)({},n._sharingInformation),{error:Object(d.i)(e),errorCategory:7,debugErrorMessage:JSON.stringify(e),errorMessage:e.message||f.an}),o.end({resultType:u.e.Failure,resultCode:"Drives Error: ".concat(n._sharingInformation.error),extraData:{error:e}}),n._emitChange(),new Promise(function(e,t){return e(i)})})}return new Promise(function(e,t){return e(i)})}var p,m=void 0;e.shared&&e.shared.owner&&e.shared.owner.user&&(m=e.shared.owner.user.id,p=e.shared.owner.user.displayName);var _={id:m||"",isExternal:!1,loginName:"",primaryText:p||"",secondaryText:"",role:s.e.owner,type:c.e.user,imageUrl:"",email:""};return new Promise(function(e,t){return e(_)})},e.prototype._parsePermissions=function(e){for(var t,n=[],a=[],r=!1,d=!1,l=[],u=function(e){if(D.L()){if(e.inheritedFrom&&(void 0!==e.inheritedFrom.path?r=!0:d=!0),e.grantedTo&&(e.grantedTo.user&&e.grantedTo.user.id&&"requestAccess"!==(null===(t=e.link)||void 0===t?void 0:t.type)||e.grantedTo.group&&e.grantedTo.group.id)){var u=void 0;if(e.grantedTo.user)if(-1===l.indexOf(e.grantedTo.user.id)){var f=e.invitation&&e.invitation.email||e.grantedTo.user.displayName,p=new Map,m={id:e.id,rawPermission:e,role:"write"===e.roles[0]?s.e.edit:s.e.view};p.set(e.id,m),u={id:e.grantedTo.user.id,isExternal:!1,loginName:f,primaryText:e.grantedTo.user.displayName||f,secondaryText:e.grantedTo.user.displayName?f:"",role:"write"===e.roles[0]?s.e.edit:s.e.view,type:c.e.user,imageUrl:"",email:f,accessMap:p}}else{var _=a.filter(function(t){return t.id===e.grantedTo.user.id})[0];f=e.invitation&&e.invitation.email||e.grantedTo.user.displayName,_.secondaryText=_.secondaryText||(e.grantedTo.user.displayName?f:""),_.email=_.email||f,m={id:e.id,rawPermission:e,role:"write"===e.roles[0]?s.e.edit:s.e.view},_.accessMap.set(e.id,m)}else e.grantedTo.group&&-1===l.indexOf(e.grantedTo.group.id)&&(f=e.invitation&&e.invitation.email||e.grantedTo.group.displayName,p=new Map,m={id:e.id,rawPermission:e,role:"write"===e.roles[0]?s.e.edit:s.e.view},p.set(e.id,m),u={id:e.grantedTo.group.id,isExternal:!1,loginName:f,primaryText:e.grantedTo.group.displayName||f,secondaryText:"",role:"write"===e.roles[0]?s.e.edit:s.e.view,type:c.e.all,imageUrl:"",email:f,accessMap:p});u&&(a.push(u),l.push(u.id))}else if(e.grantedToIdentities){for(var h=[],b=function(t){var n=void 0;if(t.user.displayName){if(-1===l.indexOf(t.user.id)){var i=new Map,r={id:e.id,rawPermission:e,role:"write"===e.roles[0]?s.e.edit:s.e.view};i.set(e.id,r),n={id:t.user.id,isExternal:!1,loginName:void 0,primaryText:t.user.displayName,secondaryText:"",role:"write"===e.roles[0]?s.e.edit:s.e.view,type:c.e.user,imageUrl:"",email:void 0,accessMap:i},a.push(n),l.push(n.id)}else n=a.filter(function(e){return e.id===t.user.id})[0],r={id:e.id,rawPermission:e,role:"write"===e.roles[0]?s.e.edit:s.e.view},n.accessMap.set(e.id,r);h.push(n)}},g=0,v=e.grantedToIdentities;g<v.length;g++)b(v[g]);var y={allowsAnonymousAccess:!0,audience:i.e.anyone,expiration:e.expirationDateTime,isActive:!0,isEdit:"edit"===e.link.type,principals:h,shareId:e.shareId,sharingLinkKind:"edit"===e.link.type?o.e.anonymousEdit:o.e.anonymousView,sharingScope:void 0,url:e.link.webUrl,createdViaCopyLinkCommand:!e.grantedTo,invitees:[],updatePassword:!1,password:"",hasPassword:e.hasPassword,blockDownload:!1,application:e.link.application,inheritedLinkInfo:e.inheritedFrom,origPermission:e,isPartialRedeem:!0};n.push(y)}else if(e.link){var S=o.e.uninitialized,I="edit"===e.link.type,x=[];switch(h=[],e.link.type){case"edit":S=o.e.anonymousEdit;break;case"requestAccess":S=o.e.requestAccess,I="write"===e.roles[0],x=[{id:e.grantedTo.user.id,isExternal:!0,loginName:void 0,primaryText:e.grantedTo.user.id,secondaryText:void 0,type:c.e.user,imageUrl:""}];break;default:S=o.e.anonymousView}y={allowsAnonymousAccess:!0,audience:i.e.anyone,expiration:e.expirationDateTime,isActive:!0,isEdit:I,principals:h,shareId:e.shareId,sharingLinkKind:S,sharingScope:void 0,url:e.link.webUrl,createdViaCopyLinkCommand:!e.grantedTo,invitees:x,updatePassword:!1,password:"",hasPassword:e.hasPassword,blockDownload:!1,application:e.link.application,inheritedLinkInfo:e.inheritedFrom,origPermission:e,isPartialRedeem:!1},n.push(y)}}else if(e.grantedTo&&e.grantedTo.user&&e.grantedTo.user.id){if(-1===l.indexOf(e.grantedTo.user.id)){f=e.invitation&&e.invitation.email||e.grantedTo.user.displayName;var C={id:e.grantedTo.user.id,isExternal:!1,loginName:f,primaryText:e.grantedTo.user.displayName||f,secondaryText:"",role:"write"===e.roles[0]?s.e.edit:s.e.view,type:c.e.user,imageUrl:"",email:f};a.push(C),l.push(C.id)}}else e.link&&(y={allowsAnonymousAccess:!0,audience:i.e.anyone,expiration:e.expirationDateTime,isActive:!0,isEdit:"edit"===e.link.type,principals:[],shareId:e.shareId,sharingLinkKind:"edit"===e.link.type?o.e.anonymousEdit:o.e.anonymousView,sharingScope:void 0,url:e.link.webUrl,createdViaCopyLinkCommand:!e.grantedTo,invitees:[],updatePassword:!1,password:"",hasPassword:e.hasPassword,blockDownload:!1,application:e.link.application,isPartialRedeem:!1},n.push(y))},f=0,p=e;f<p.length;f++)u(p[f]);return{principals:a,sharingLinks:n,hasInheritedPermissions:r,hasBundlePermissions:d}},e.prototype._shareViaInvite=function(e,t,n){var r,s=this,c=t.map(function(e){var t={};return g.e.isValidEmailSyntax(e.email,!1)?t.email=e.email:t.objectId=e.userId,e.entityType&&e.entityType===b.e.group&&(t.permissionIdentityTypeInput="Group"),t}),l=e.isEdit?"write":"read",u=e.password,p=e.expiration;if(this._itemId||this.isBundleShare()){var m={itemIds:this.isBundleShare()?this._multiShareIds:[this._itemId],recipients:c,message:n,requireSignIn:!!e.requireSignIn,sendInvitation:!1!==e.sendInvitation,roles:[l],password:u,expiration:p,bundleName:this._bundleName};Object(O.e)()&&window.sessionStorage.setItem("ShareLink_Payload",JSON.stringify(m)),r=this._sharingService.invite(m)}else m={itemUrl:this._itemUrl,recipients:c,message:n,requireSignIn:!!e.requireSignIn,sendInvitation:!1!==e.sendInvitation,roles:[l],password:u,expiration:p},Object(O.e)()&&window.sessionStorage.setItem("ShareLink_Payload",JSON.stringify(m)),r=this._sharingService.inviteFromItemUrl(m);r.then(function(t){var n,a,r=t[0];if(r.link.type&&(n="edit"===r.link.type?o.e.anonymousEdit:o.e.anonymousView,a="edit"===r.link.type),r.roles&&1===r.roles.length){var c=r.roles[0];n="write"===c?o.e.anonymousEdit:o.e.anonymousView,a="write"===c}s._shareLink={allowsAnonymousAccess:!0,audience:e.requireSignIn?i.e.specificPeople:i.e.anyone,expiration:r.expirationDateTime,isActive:!0,isEdit:a,principals:[],shareId:"",sharingLinkKind:n,sharingScope:void 0,url:r.link.webUrl,createdViaCopyLinkCommand:!0,invitees:[],updatePassword:!1,password:"",hasPassword:r.hasPassword,blockDownload:r.preventDownload,passwordLastModifiedBy:null},Object(O.e)()&&window.sessionStorage.setItem("ShareLink_Response",JSON.stringify(s._shareLink)),s._grantAccessResult=!0,s._emitChange({type:I.t.ShareLink})},function(e){var t=Object(d.i)(e);["ownerCannotShareWithSelf","maximumRecipientsExceeded","invalidAclEmailSpecified","duplicateMembersInRequest","secureSharingInvalidRequest"].indexOf(t)>-1?s._sharingInformation.peoplePickerError=e.response&&e.response.error&&(e.response.error.localizedMessage||e.response.error.message):(s._sharingInformation=Object(a.__assign)(Object(a.__assign)({},s._sharingInformation),{error:t,errorCategory:8,errorMessage:e.response&&e.response.error&&(e.response.error.localizedMessage||e.response.error.message)||f.an}),e.response&&e.response.error&&e.response.error.fixItUrl&&(s._sharingInformation.fixItUrl=e.response.error.fixItUrl)),s._grantAccessResult=!1,s._emitChange()})},e.prototype._createSharingLink=function(e,t){var n,r=this,s=e.isEdit?"edit":"view",c="anonymous",l=e.preventDownload,u=t&&t.useOldPassword?null:e.password,p=e.expiration;if(this._itemId||this.isBundleShare()){var m={itemIds:this.isBundleShare()?this._multiShareIds:[this._itemId],type:s,scope:c,preventDownload:l,password:u,expiration:p,bundleName:this._bundleName};Object(O.e)()&&window.sessionStorage.setItem("ShareLink_Payload",JSON.stringify(m)),n=this._sharingService.createLink(m)}else m={itemUrl:this._itemUrl,type:s,scope:c,preventDownload:l,password:u,expiration:p},Object(O.e)()&&window.sessionStorage.setItem("ShareLink_Payload",JSON.stringify(m)),n=this._sharingService.createLinkFromItemUrl(m);n.then(function(e){var t="edit"===e.link.type?o.e.anonymousEdit:o.e.anonymousView;r._shareLink={allowsAnonymousAccess:!0,audience:i.e.anyone,expiration:e.expirationDateTime,isActive:!0,isEdit:"edit"===e.link.type,principals:[],shareId:"",sharingLinkKind:t,sharingScope:void 0,url:e.link.webUrl,createdViaCopyLinkCommand:!0,invitees:[],updatePassword:!1,password:"",hasPassword:e.hasPassword,blockDownload:e.preventDownload,passwordLastModifiedBy:null},Object(O.e)()&&window.sessionStorage.setItem("ShareLink_Response",JSON.stringify(r._shareLink)),r._grantAccessResult=!0,r._emitChange({type:I.t.ShareLink})},function(e){r._sharingInformation=Object(a.__assign)(Object(a.__assign)({},r._sharingInformation),{error:Object(d.i)(e),errorCategory:9,errorMessage:e.message||f.an}),r._grantAccessResult=!1,r._emitChange()})},e.prototype.getCurrentUserId=function(){return this._currentUserId},e.prototype.unshareLink=function(e,t){for(var n,a=this,i=0,r=this._permissions;i<r.length;i++){var o=r[i];o.shareId===t&&(n=o)}var s=n.inheritedFrom?n.inheritedFrom.id:this._itemId;(s?this._sharingService.unshareLink(s,n.id):this._sharingService.unshareLinkFromItemUrl(this._itemUrl,n.id)).then(function(){a.fetchSharingInformation(!0)})},e.prototype.getSharingLinkCreated=function(){return this._shareLink},e.prototype.updatePermissions=function(e,t){for(var n=this,a=[],i=0,r=this._permissions;i<r.length;i++){var c=r[i];c.grantedTo&&c.grantedTo.user&&c.grantedTo.user.id===e.id&&a.push(c)}for(var d=0,l=a;d<l.length;d++){var u=l[d],f=u.inheritedFrom?u.inheritedFrom.id:this._itemId;switch(t){case s.e.none:this.unshareLink(o.e.anonymousEdit,u.shareId);break;case s.e.edit:(f?this._sharingService.updatePermissions(f,u.id,"write"):this._sharingService.updatePermissionsFromItemUrl(this._itemUrl,u.id,"write")).then(function(e){n.fetchSharingInformation(!0)});break;default:(f?this._sharingService.updatePermissions(f,u.id,"read"):this._sharingService.updatePermissionsFromItemUrl(this._itemUrl,u.id,"read")).then(function(e){n.fetchSharingInformation(!0)})}}},e.prototype.updatePermissionById=function(e,t){var n=this._permissions.filter(function(t){return t.id===e})[0];if(!n)return c={error:i="No permission found for given id",name:"invalidItem",errorCode:3,errorCategory:4,debugErrorMessage:i,errorMessage:i},console.log(JSON.stringify(c)),Promise.reject(c);var a=n.inheritedFrom?n.inheritedFrom.id:this._itemId;try{switch(t){case s.e.none:this.unshareLink(o.e.anonymousEdit,n.shareId);break;case s.e.edit:return this._sharingService.updatePermissions(a,n.id,"write");default:return this._sharingService.updatePermissions(a,n.id,"read")}}catch(e){var i="Error updating permission",r=Object(d.i)(e)||"genericPermissionUpdateFailure",c={error:e.message||i,name:r,errorCode:r,errorCategory:4,debugErrorMessage:JSON.stringify(e),errorMessage:e.message||i,rawError:JSON.stringify(e)};return console.log(JSON.stringify(c)),Promise.reject(c)}},e.prototype.getDefaultRecipients=function(){return this._defaultRecipients},e.prototype.consumeDefaultRecipients=function(){this._defaultRecipients={isConsumed:!0,recipients:this._defaultRecipients.recipients}},e.prototype.grantAccess=function(e,t){void 0===t&&(t=!0),this.shareLink({recipients:e,settings:{allowEditing:!0,isEdit:t,audience:i.e.anyone,specificPeople:null,expiration:null,password:null,sharingLinkKind:o.e.direct,updatePassword:!1,sendInvitation:!1}})},e.prototype.getGrantAccessResult=function(){return this._grantAccessResult},e.prototype.isPeopleSharingLinksEnabled=function(){return!1},e.prototype.showManageAccess=function(){return!1},e.prototype.isPasswordModificationAllowed=function(){return!0},e.prototype.isExpirationDateModificationAllowed=function(){return!0},e.prototype.isPremiumExperienceAllowed=function(){return this._isPremium},e.prototype.disablePremiumUpsell=function(){return this._isUserMinor},e.prototype.isPreventDownloadAllowed=function(){return!1},e.prototype.setAddressBarLinkCapability=function(e){},e.prototype.isReportProblemSupported=function(){return!1},e.prototype.isBundleShare=function(){return this._isBundleShare},e.prototype.getNavId=function(){return this._navId},e.prototype.getSupportedAudienceOptions=function(){return[i.e.anyone,i.e.specificPeople]},e.prototype.isSpecificPeopleExpirationAllowed=function(){return!0},e.prototype.showAudienceLearnMore=function(){return!1},e.prototype.resetPeoplePickerError=function(){this._sharingInformation.peoplePickerError&&(this._sharingInformation.peoplePickerError=void 0,this._emitChange())},e.prototype._tryResolveDefaultRecipients=function(e,t){var n=this;if(e&&0!==e.length)if(this._defaultRecipients=void 0,this._isValidatingDefaultRecipients=!0,t)try{for(var a=[],i=[],r=0,o=e;r<o.length;r++){var s=o[r];i.push(t.resolve(s,{}).then(function(e){a.push(e)}))}Promise.all(i).then(function(){n._setDefaultRecipients(a)},function(){n._setUnresolvedDefaultRecipients(e)})}catch(t){this._setUnresolvedDefaultRecipients(e)}else this._setUnresolvedDefaultRecipients(e);else this._isValidatingDefaultRecipients=!1},e.prototype._setDefaultRecipients=function(e){e.map(function(e){e.name=e.name||e.email}),this._defaultRecipients={isConsumed:!1,recipients:e},this._isValidatingDefaultRecipients=!1,this._emitChange()},e.prototype._setUnresolvedDefaultRecipients=function(e){this._setDefaultRecipients(e.map(function(e){return{userId:e,name:e,email:e,isResolved:g.e.isValidEmailSyntax(e,!1)}}))},e.prototype.showEmailsInSuggestions=function(){return!0},e.prototype.getFamily=function(){return this._family},e.prototype.getFamilyMembers=function(){return this._familyMembers},e.prototype.getItemInformationForLogging=function(){var e=this.getSharingInformation();return{itemType:Object(C.t)(e.item),extension:e.item.extension}},e.prototype.getSharingClickTime=function(){return NaN},e.prototype.getLinksCount=function(){return this.getSharingInformation().sharingLinks.length},e.prototype.parsePrincipals=function(){for(var e=[],t=[],n=0,a=this.getSharingInformation().sharingPrincipals;n<a.length;n++){var i=a[n];i.type===c.e.user?e.push(i):i.type===c.e.all&&t.push(i)}return{users:e,groups:t}},e.prototype.getPermissionsViewSettings=function(){return{groupPivotHeader:p.C,manageGroupLink:"https://go.microsoft.com/fwlink/?linkid=2198883",itemStopSharingSupported:!1,supportedGroupTypes:[c.e.all]}},e.prototype.getUserIdFromItemId=function(e,t){if(t&&t.length>0&&t[0],e){var n=e.split("!");if(n.length>0)return n[0]}},e.prototype._toTuple=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t={},[4,e];case 1:return[2,(t.value=n.sent(),t)];case 2:return[2,{error:n.sent()}];case 3:return[2]}})})},e.prototype._isError=function(e){return!!e.error},e}();t.e=E},3162:function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"t",function(){return c});var a=["ai","pdf"],i=["doc","docx","odt","rtf","ods","xls","xlsm","xlsx","odp","ppt","pptx","pps","ppsx","tiff","tif","epub","htm","html","eml","msg","md","markdown"],r=["dwg","dxf"];function o(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}function s(e,t){return o(i,e)||!!t&&o(r,e)}function c(e){return o(a,e)}},3508:function(e,t,n){"use strict";var a;!function(e){e.fromHexString=function(e,t){var n=t?{High:2147483647,Low:2147483647}:{High:0,Low:0},a=e&&e.match(/^(0x)?([0-9a-f]*)$/i);if(a){var i=void 0,r=void 0;(e=(e=a[2]||"0").slice(-16)).length<=8?(i=0,r=parseInt(e,16)):(i=parseInt(e.slice(0,-8),16),r=parseInt(e.slice(-8),16)),isNaN(i)||isNaN(r)||(n.High=i,n.Low=r)}return n},e.or=function(e){return(e||[]).reduce(function(e,t){return{High:e.High|t.High,Low:e.Low|t.Low}},{High:0,Low:0})},e.and=function(e){return e&&e.length?e.reduce(function(e,t){return{High:e.High&t.High,Low:e.Low&t.Low}}):{High:0,Low:0}}}(a||(a={})),t.e=a},3509:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(2161);function i(e,t){if(void 0===t&&(t=0),!e.expiry){var n=function(e){return Object(a.a)(e)}(e.authToken);e.expiry=n&&function(e){try{return new Date(parseInt(e+"000",10))}catch(e){}}(n.exp)}return(e.expiry?e.expiry.getTime():0)-Date.now()<t}},3510:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s});var a=["htm","html","svg"],i=["eml","msg","md","mdown","markdown"];function r(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}function o(e){return r(i,e)}function s(e){return r(a,e)}},3532:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(0),i=n(59),r=function(){function e(e,t){this._dataRequestor=t.vroomDataRequestor}return e.prototype.checkUserAccess=function(e,t){var n="".concat(e,"/checkAccess"),r={value:Object(a.__spreadArray)([],t,!0)};return this._dataRequestor.send({apiName:"checkAccess",path:n,requestType:"POST",useAuthorizationHeaders:!0,getErrorAsMessage:!0,postData:JSON.stringify(r)}).then(function(e){return i.n.resolve(e.value)},function(e){return i.n.reject(e)})},e}()},3932:function(e,t,n){"use strict";function a(e){return new Date(e/1e4-621355968e5)}n.d(t,"e",function(){return a})}}]);