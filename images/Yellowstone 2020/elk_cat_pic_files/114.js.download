(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[114],{1761:function(e,t,n){"use strict";n.d(t,"t",function(){return m});var a='\x3c!--ko if:areCSS3TransitionsSupported--\x3e<div class="ProgressSpinnerFlat" role="progressbar"><div aria-hidden="true">•</div><div aria-hidden="true">•</div><div aria-hidden="true">•</div><div aria-hidden="true">•</div><div aria-hidden="true">•</div></div>\x3c!--/ko--\x3e\x3c!--ko if:!areCSS3TransitionsSupported--\x3e<img data-bind="attr:{src:loadingUrl,alt:loadingString}">\x3c!--/ko--\x3e',i=n(20);Object(i.n)([{rawString:".ProgressSpinnerFlat{position:relative;box-sizing:border-box;padding:2px 0;overflow:hidden;height:6px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:15px}.ProgressSpinnerFlat>div{position:relative;line-height:0;cursor:default;animation:progress 3.4s infinite cubic-bezier(0,.75,1,.25)}[dir=ltr] .ProgressSpinnerFlat>div{left:-50px}[dir=rtl] .ProgressSpinnerFlat>div{right:-50px}[dir=rtl] .ProgressSpinnerFlat>div{animation:progressRtl 3.4s infinite cubic-bezier(0,.75,1,.25)}.ProgressSpinnerFlat>div:nth-child(1){animation-delay:.1s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(1){margin-left:40px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(1){margin-right:40px}.ProgressSpinnerFlat>div:nth-child(2){animation-delay:.2s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(2){margin-left:30px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(2){margin-right:30px}.ProgressSpinnerFlat>div:nth-child(3){animation-delay:.3s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(3){margin-left:20px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(3){margin-right:20px}.ProgressSpinnerFlat>div:nth-child(4){animation-delay:.4s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(4){margin-left:10px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(4){margin-right:10px}.ProgressSpinnerFlat>div:nth-child(5){animation-delay:.5s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(5){margin-left:0}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(5){margin-right:0}@keyframes progress{from{left:-50px}25%{left:-50px}to{left:100%}}@keyframes progressRtl{from{right:-50px}25%{right:-50px}to{right:100%}}"}]);var r=n(0),o=n(175),s=n(62),c=n(1862),d=n(204),l=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.platformDetection,r=void 0===i?a.resources.consume(d.e):i;return a.areCSS3TransitionsSupported=r.areCSS3TransitionsSupported,a.loadingUrl=window.require.toUrl("odsp-media/images/loading/loadingdots.gif"),a.loadingString=c.e,a}return Object(r.__extends)(t,e),t.resources=Object(r.__assign)(Object(r.__assign)({},o.t.dependencies),{platformDetection:d.e,settingsDataSource:s.ce}),t}(o.t),u=n(379),f=n(156),p=Object(u.e)({tagName:"ms-progressSpinnerFlat",template:a,viewModel:l,synchronous:!0}),m=Object(f.t)({automationName:"ms-progressSpinnerFlat",name:"ProgressSpinnerFlat",template:a,viewModelType:l});t.e=p},2096:function(e,t,n){"use strict";var a=n(0),i=n(175),r=n(59),o=function(e){function t(t){var n=e.call(this,t)||this,a=t.action;return n.action=a,n}return Object(a.__extends)(t,e),t.prototype.endWith=function(e){var t=this;e.done(function(){return t.action.complete()},function(e){return t.action.fail(e)})},t.prototype.continueWith=function(e){var t=this;return e.then(null,function(e){return t.action.fail(e),r.n.wrapError(e)})},t}(i.t);t.e=o},3756:function(e,t,n){!function(){"use strict";var n={};function a(e){return u(">"+p("B",e.length),e)}function i(e){return u(">"+p("H",e.length),e)}function r(e){return u(">"+p("L",e.length),e)}function o(e,t,n){var o,s,c,d,l="",f="";if("Byte"==t)(o=e.length)<=4?f=a(e)+p("\0",4-o):(f=u(">L",[n]),l=a(e));else if("Short"==t)(o=e.length)<=2?f=i(e)+p("\0\0",2-o):(f=u(">L",[n]),l=i(e));else if("Long"==t)(o=e.length)<=1?f=r(e):(f=u(">L",[n]),l=r(e));else if("Ascii"==t)(o=(s=e+"\0").length)>4?(f=u(">L",[n]),l=s):f=s+p("\0",4-o);else if("Rational"==t){if("number"==typeof e[0])o=1,c=e[0],d=e[1],s=u(">L",[c])+u(">L",[d]);else{o=e.length,s="";for(var m=0;m<o;m++)c=e[m][0],d=e[m][1],s+=u(">L",[c])+u(">L",[d])}f=u(">L",[n]),l=s}else if("SRational"==t){if("number"==typeof e[0])o=1,c=e[0],d=e[1],s=u(">l",[c])+u(">l",[d]);else for(o=e.length,s="",m=0;m<o;m++)c=e[m][0],d=e[m][1],s+=u(">l",[c])+u(">l",[d]);f=u(">L",[n]),l=s}else"Undefined"==t&&((o=e.length)>4?(f=u(">L",[n]),l=e):f=e+p("\0",4-o));return[u(">L",[o]),f,l]}function s(e,t,n){var a,i=Object.keys(e).length,r=u(">H",[i]);a=["0th","1st"].indexOf(t)>-1?2+12*i+4:2+12*i;var s="",c="";for(var d in e)if("string"==typeof d&&(d=parseInt(d)),!("0th"==t&&[34665,34853].indexOf(d)>-1||"Exif"==t&&40965==d||"1st"==t&&[513,514].indexOf(d)>-1)){var l=e[d],f=u(">H",[d]),p=h[t][d].type,m=u(">H",[_[p]]);"number"==typeof l&&(l=[l]);var b=o(l,p,8+a+n+c.length);s+=f+m+b[0]+b[1],c+=b[2]}return[r+s,c]}function c(e){var t;if("ÿØ"==e.slice(0,2))t=function(e){for(var t,n=0;n<e.length;n++)if("ÿá"==(t=e[n]).slice(0,2)&&"Exif\0\0"==t.slice(4,10))return t;return null}(m(e)),this.tiftag=t?t.slice(10):null;else if(["II","MM"].indexOf(e.slice(0,2))>-1)this.tiftag=e;else{if("Exif"!=e.slice(0,4))throw new Error("Given file is neither JPEG nor TIFF.");this.tiftag=e.slice(6)}}if(n.version="1.0.4",n.remove=function(e){var t=!1;if("ÿØ"==e.slice(0,2));else{if("data:image/jpeg;base64,"!=e.slice(0,23)&&"data:image/jpg;base64,"!=e.slice(0,22))throw new Error("Given data is not jpeg.");e=l(e.split(",")[1]),t=!0}var n=m(e).filter(function(e){return!("ÿá"==e.slice(0,2)&&"Exif\0\0"==e.slice(4,10))}).join("");return t&&(n="data:image/jpeg;base64,"+d(n)),n},n.insert=function(e,t){var n=!1;if("Exif\0\0"!=e.slice(0,6))throw new Error("Given data is not exif.");if("ÿØ"==t.slice(0,2));else{if("data:image/jpeg;base64,"!=t.slice(0,23)&&"data:image/jpg;base64,"!=t.slice(0,22))throw new Error("Given data is not jpeg.");t=l(t.split(",")[1]),n=!0}var a="ÿá"+u(">H",[e.length+2])+e,i=function(e,t){var n=!1,a=[];return e.forEach(function(i,r){"ÿá"==i.slice(0,2)&&"Exif\0\0"==i.slice(4,10)&&(n?a.unshift(r):(e[r]=t,n=!0))}),a.forEach(function(t){e.splice(t,1)}),!n&&t&&(e=[e[0],t].concat(e.slice(1))),e.join("")}(m(t),a);return n&&(i="data:image/jpeg;base64,"+d(i)),i},n.load=function(e){var t;if("string"!=typeof e)throw new Error("'load' gots invalid type argument.");if("ÿØ"==e.slice(0,2))t=e;else if("data:image/jpeg;base64,"==e.slice(0,23)||"data:image/jpg;base64,"==e.slice(0,22))t=l(e.split(",")[1]);else{if("Exif"!=e.slice(0,4))throw new Error("'load' gots invalid file data.");t=e.slice(6)}var n={"0th":{},Exif:{},GPS:{},Interop:{},"1st":{},thumbnail:null},a=new c(t);if(null===a.tiftag)return n;"II"==a.tiftag.slice(0,2)?a.endian_mark="<":a.endian_mark=">";var i=f(a.endian_mark+"L",a.tiftag.slice(4,8))[0];n["0th"]=a.get_ifd(i,"0th");var r=n["0th"].first_ifd_pointer;if(delete n["0th"].first_ifd_pointer,34665 in n["0th"]&&(i=n["0th"][34665],n.Exif=a.get_ifd(i,"Exif")),34853 in n["0th"]&&(i=n["0th"][34853],n.GPS=a.get_ifd(i,"GPS")),40965 in n.Exif&&(i=n.Exif[40965],n.Interop=a.get_ifd(i,"Interop")),"\0\0\0\0"!=r&&(i=f(a.endian_mark+"L",r)[0],n["1st"]=a.get_ifd(i,"1st"),513 in n["1st"]&&514 in n["1st"])){var o=n["1st"][513]+n["1st"][514],s=a.tiftag.slice(n["1st"][513],o);n.thumbnail=s}return n},n.dump=function(e){var t,a,i,r,o,c,d=(t=e,JSON.parse(JSON.stringify(t))),l=!1,f=!1,p=!1,h=!1;a="0th"in d?d["0th"]:{},"Exif"in d&&Object.keys(d.Exif).length||"Interop"in d&&Object.keys(d.Interop).length?(a[34665]=1,l=!0,i=d.Exif,"Interop"in d&&Object.keys(d.Interop).length?(i[40965]=1,p=!0,r=d.Interop):Object.keys(i).indexOf(n.ExifIFD.InteroperabilityTag.toString())>-1&&delete i[40965]):Object.keys(a).indexOf(n.ImageIFD.ExifTag.toString())>-1&&delete a[34665],"GPS"in d&&Object.keys(d.GPS).length?(a[n.ImageIFD.GPSTag]=1,f=!0,o=d.GPS):Object.keys(a).indexOf(n.ImageIFD.GPSTag.toString())>-1&&delete a[n.ImageIFD.GPSTag],"1st"in d&&"thumbnail"in d&&null!=d.thumbnail&&(h=!0,d["1st"][513]=1,d["1st"][514]=1,c=d["1st"]);var b,g,v,y=s(a,"0th",0),S=y[0].length+12*l+12*f+4+y[1].length,D="",I=0,x="",C=0,O="",w=0,E="";if(l&&(I=(b=s(i,"Exif",S))[0].length+12*p+b[1].length),f&&(C=(x=s(o,"GPS",S+I).join("")).length),p&&(w=(O=s(r,"Interop",S+I+C).join("")).length),h&&(g=s(c,"1st",S+I+C+w),(v=function(e){for(var t=m(e);"ÿà"<=t[1].slice(0,2)&&t[1].slice(0,2)<="ÿï";)t=[t[0]].concat(t.slice(2));return t.join("")}(d.thumbnail)).length>64e3))throw new Error("Given thumbnail is too large. max 64kB");var A="",L="",k="",M="\0\0\0\0";if(l){var P=u(">L",[T=8+S]);A=u(">H",[34665])+u(">H",[_.Long])+u(">L",[1])+P}if(f&&(P=u(">L",[T=8+S+I]),L=u(">H",[34853])+u(">H",[_.Long])+u(">L",[1])+P),p&&(P=u(">L",[T=8+S+I+C]),k=u(">H",[40965])+u(">H",[_.Long])+u(">L",[1])+P),h){var T;M=u(">L",[T=8+S+I+C+w]);var U="\0\0\0\0"+u(">L",[T+g[0].length+24+4+g[1].length]),F="\0\0\0\0"+u(">L",[v.length]);E=g[0]+U+F+"\0\0\0\0"+g[1]+v}var H=y[0]+A+L+M+y[1];return l&&(D=b[0]+k+b[1]),"Exif\0\0MM\0*\0\0\0\b"+H+D+x+O+E},c.prototype={get_ifd:function(e,t){var n,a={},i=f(this.endian_mark+"H",this.tiftag.slice(e,e+2))[0],r=e+2;n=["0th","1st"].indexOf(t)>-1?"Image":t;for(var o=0;o<i;o++){e=r+12*o;var s=f(this.endian_mark+"H",this.tiftag.slice(e,e+2))[0],c=[f(this.endian_mark+"H",this.tiftag.slice(e+2,e+4))[0],f(this.endian_mark+"L",this.tiftag.slice(e+4,e+8))[0],this.tiftag.slice(e+8,e+12)];s in h[n]&&(a[s]=this.convert_value(c))}return"0th"==t&&(e=r+12*i,a.first_ifd_pointer=this.tiftag.slice(e,e+4)),a},convert_value:function(e){var t,n=null,a=e[0],i=e[1],r=e[2];if(1==a)i>4?(t=f(this.endian_mark+"L",r)[0],n=f(this.endian_mark+p("B",i),this.tiftag.slice(t,t+i))):n=f(this.endian_mark+p("B",i),r.slice(0,i));else if(2==a)i>4?(t=f(this.endian_mark+"L",r)[0],n=this.tiftag.slice(t,t+i-1)):n=r.slice(0,i-1);else if(3==a)i>2?(t=f(this.endian_mark+"L",r)[0],n=f(this.endian_mark+p("H",i),this.tiftag.slice(t,t+2*i))):n=f(this.endian_mark+p("H",i),r.slice(0,2*i));else if(4==a)i>1?(t=f(this.endian_mark+"L",r)[0],n=f(this.endian_mark+p("L",i),this.tiftag.slice(t,t+4*i))):n=f(this.endian_mark+p("L",i),r);else if(5==a)if(t=f(this.endian_mark+"L",r)[0],i>1){n=[];for(var o=0;o<i;o++)n.push([f(this.endian_mark+"L",this.tiftag.slice(t+8*o,t+4+8*o))[0],f(this.endian_mark+"L",this.tiftag.slice(t+4+8*o,t+8+8*o))[0]])}else n=[f(this.endian_mark+"L",this.tiftag.slice(t,t+4))[0],f(this.endian_mark+"L",this.tiftag.slice(t+4,t+8))[0]];else if(7==a)i>4?(t=f(this.endian_mark+"L",r)[0],n=this.tiftag.slice(t,t+i)):n=r.slice(0,i);else if(9==a)i>1?(t=f(this.endian_mark+"L",r)[0],n=f(this.endian_mark+p("l",i),this.tiftag.slice(t,t+4*i))):n=f(this.endian_mark+p("l",i),r);else{if(10!=a)throw new Error("Exif might be wrong. Got incorrect value type to decode. type:"+a);if(t=f(this.endian_mark+"L",r)[0],i>1)for(n=[],o=0;o<i;o++)n.push([f(this.endian_mark+"l",this.tiftag.slice(t+8*o,t+4+8*o))[0],f(this.endian_mark+"l",this.tiftag.slice(t+4+8*o,t+8+8*o))[0]]);else n=[f(this.endian_mark+"l",this.tiftag.slice(t,t+4))[0],f(this.endian_mark+"l",this.tiftag.slice(t+4,t+8))[0]]}return n instanceof Array&&1==n.length?n[0]:n}},"undefined"!=typeof window&&"function"==typeof window.btoa)var d=window.btoa;if(void 0===d&&(d=function(e){for(var t,n,a,i,r,o,s,c="",d=0,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";d<e.length;)i=(t=e.charCodeAt(d++))>>2,r=(3&t)<<4|(n=e.charCodeAt(d++))>>4,o=(15&n)<<2|(a=e.charCodeAt(d++))>>6,s=63&a,isNaN(n)?o=s=64:isNaN(a)&&(s=64),c=c+l.charAt(i)+l.charAt(r)+l.charAt(o)+l.charAt(s);return c}),"undefined"!=typeof window&&"function"==typeof window.atob)var l=window.atob;function u(e,t){if(!(t instanceof Array))throw new Error("'pack' error. Got invalid type argument.");if(e.length-1!=t.length)throw new Error("'pack' error. "+(e.length-1)+" marks, "+t.length+" elements.");var n;if("<"==e[0])n=!0;else{if(">"!=e[0])throw new Error("");n=!1}for(var a="",i=1,r=null,o=null,s=null;o=e[i];){if("b"==o.toLowerCase()){if(r=t[i-1],"b"==o&&r<0&&(r+=256),r>255||r<0)throw new Error("'pack' error.");s=String.fromCharCode(r)}else if("H"==o){if((r=t[i-1])>65535||r<0)throw new Error("'pack' error.");s=String.fromCharCode(Math.floor(r%65536/256))+String.fromCharCode(r%256),n&&(s=s.split("").reverse().join(""))}else{if("l"!=o.toLowerCase())throw new Error("'pack' error.");if(r=t[i-1],"l"==o&&r<0&&(r+=4294967296),r>4294967295||r<0)throw new Error("'pack' error.");s=String.fromCharCode(Math.floor(r/16777216))+String.fromCharCode(Math.floor(r%16777216/65536))+String.fromCharCode(Math.floor(r%65536/256))+String.fromCharCode(r%256),n&&(s=s.split("").reverse().join(""))}a+=s,i+=1}return a}function f(e,t){if("string"!=typeof t)throw new Error("'unpack' error. Got invalid type argument.");for(var n,a=0,i=1;i<e.length;i++)if("b"==e[i].toLowerCase())a+=1;else if("h"==e[i].toLowerCase())a+=2;else{if("l"!=e[i].toLowerCase())throw new Error("'unpack' error. Got invalid mark.");a+=4}if(a!=t.length)throw new Error("'unpack' error. Mismatch between symbol and string length. "+a+":"+t.length);if("<"==e[0])n=!0;else{if(">"!=e[0])throw new Error("'unpack' error.");n=!1}for(var r=[],o=0,s=1,c=null,d=null,l=null,u="";d=e[s];){if("b"==d.toLowerCase())l=1,c=(u=t.slice(o,o+l)).charCodeAt(0),"b"==d&&c>=128&&(c-=256);else if("H"==d)l=2,u=t.slice(o,o+l),n&&(u=u.split("").reverse().join("")),c=256*u.charCodeAt(0)+u.charCodeAt(1);else{if("l"!=d.toLowerCase())throw new Error("'unpack' error. "+d);l=4,u=t.slice(o,o+l),n&&(u=u.split("").reverse().join("")),c=16777216*u.charCodeAt(0)+65536*u.charCodeAt(1)+256*u.charCodeAt(2)+u.charCodeAt(3),"l"==d&&c>=2147483648&&(c-=4294967296)}r.push(c),o+=l,s+=1}return r}function p(e,t){for(var n="",a=0;a<t;a++)n+=e;return n}function m(e){if("ÿØ"!=e.slice(0,2))throw new Error("Given data isn't JPEG.");for(var t=2,n=["ÿØ"];;){if("ÿÚ"==e.slice(t,t+2)){n.push(e.slice(t));break}var a=t+f(">H",e.slice(t+2,t+4))[0]+2;if(n.push(e.slice(t,a)),(t=a)>=e.length)throw new Error("Wrong JPEG data.")}return n}void 0===l&&(l=function(e){var t,n,a,i,r,o,s="",c=0,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)t=d.indexOf(e.charAt(c++))<<2|(i=d.indexOf(e.charAt(c++)))>>4,n=(15&i)<<4|(r=d.indexOf(e.charAt(c++)))>>2,a=(3&r)<<6|(o=d.indexOf(e.charAt(c++))),s+=String.fromCharCode(t),64!=r&&(s+=String.fromCharCode(n)),64!=o&&(s+=String.fromCharCode(a));return s});var _={Byte:1,Ascii:2,Short:3,Long:4,Rational:5,Undefined:7,SLong:9,SRational:10},h={Image:{11:{name:"ProcessingSoftware",type:"Ascii"},254:{name:"NewSubfileType",type:"Long"},255:{name:"SubfileType",type:"Short"},256:{name:"ImageWidth",type:"Long"},257:{name:"ImageLength",type:"Long"},258:{name:"BitsPerSample",type:"Short"},259:{name:"Compression",type:"Short"},262:{name:"PhotometricInterpretation",type:"Short"},263:{name:"Threshholding",type:"Short"},264:{name:"CellWidth",type:"Short"},265:{name:"CellLength",type:"Short"},266:{name:"FillOrder",type:"Short"},269:{name:"DocumentName",type:"Ascii"},270:{name:"ImageDescription",type:"Ascii"},271:{name:"Make",type:"Ascii"},272:{name:"Model",type:"Ascii"},273:{name:"StripOffsets",type:"Long"},274:{name:"Orientation",type:"Short"},277:{name:"SamplesPerPixel",type:"Short"},278:{name:"RowsPerStrip",type:"Long"},279:{name:"StripByteCounts",type:"Long"},282:{name:"XResolution",type:"Rational"},283:{name:"YResolution",type:"Rational"},284:{name:"PlanarConfiguration",type:"Short"},290:{name:"GrayResponseUnit",type:"Short"},291:{name:"GrayResponseCurve",type:"Short"},292:{name:"T4Options",type:"Long"},293:{name:"T6Options",type:"Long"},296:{name:"ResolutionUnit",type:"Short"},301:{name:"TransferFunction",type:"Short"},305:{name:"Software",type:"Ascii"},306:{name:"DateTime",type:"Ascii"},315:{name:"Artist",type:"Ascii"},316:{name:"HostComputer",type:"Ascii"},317:{name:"Predictor",type:"Short"},318:{name:"WhitePoint",type:"Rational"},319:{name:"PrimaryChromaticities",type:"Rational"},320:{name:"ColorMap",type:"Short"},321:{name:"HalftoneHints",type:"Short"},322:{name:"TileWidth",type:"Short"},323:{name:"TileLength",type:"Short"},324:{name:"TileOffsets",type:"Short"},325:{name:"TileByteCounts",type:"Short"},330:{name:"SubIFDs",type:"Long"},332:{name:"InkSet",type:"Short"},333:{name:"InkNames",type:"Ascii"},334:{name:"NumberOfInks",type:"Short"},336:{name:"DotRange",type:"Byte"},337:{name:"TargetPrinter",type:"Ascii"},338:{name:"ExtraSamples",type:"Short"},339:{name:"SampleFormat",type:"Short"},340:{name:"SMinSampleValue",type:"Short"},341:{name:"SMaxSampleValue",type:"Short"},342:{name:"TransferRange",type:"Short"},343:{name:"ClipPath",type:"Byte"},344:{name:"XClipPathUnits",type:"Long"},345:{name:"YClipPathUnits",type:"Long"},346:{name:"Indexed",type:"Short"},347:{name:"JPEGTables",type:"Undefined"},351:{name:"OPIProxy",type:"Short"},512:{name:"JPEGProc",type:"Long"},513:{name:"JPEGInterchangeFormat",type:"Long"},514:{name:"JPEGInterchangeFormatLength",type:"Long"},515:{name:"JPEGRestartInterval",type:"Short"},517:{name:"JPEGLosslessPredictors",type:"Short"},518:{name:"JPEGPointTransforms",type:"Short"},519:{name:"JPEGQTables",type:"Long"},520:{name:"JPEGDCTables",type:"Long"},521:{name:"JPEGACTables",type:"Long"},529:{name:"YCbCrCoefficients",type:"Rational"},530:{name:"YCbCrSubSampling",type:"Short"},531:{name:"YCbCrPositioning",type:"Short"},532:{name:"ReferenceBlackWhite",type:"Rational"},700:{name:"XMLPacket",type:"Byte"},18246:{name:"Rating",type:"Short"},18249:{name:"RatingPercent",type:"Short"},32781:{name:"ImageID",type:"Ascii"},33421:{name:"CFARepeatPatternDim",type:"Short"},33422:{name:"CFAPattern",type:"Byte"},33423:{name:"BatteryLevel",type:"Rational"},33432:{name:"Copyright",type:"Ascii"},33434:{name:"ExposureTime",type:"Rational"},34377:{name:"ImageResources",type:"Byte"},34665:{name:"ExifTag",type:"Long"},34675:{name:"InterColorProfile",type:"Undefined"},34853:{name:"GPSTag",type:"Long"},34857:{name:"Interlace",type:"Short"},34858:{name:"TimeZoneOffset",type:"Long"},34859:{name:"SelfTimerMode",type:"Short"},37387:{name:"FlashEnergy",type:"Rational"},37388:{name:"SpatialFrequencyResponse",type:"Undefined"},37389:{name:"Noise",type:"Undefined"},37390:{name:"FocalPlaneXResolution",type:"Rational"},37391:{name:"FocalPlaneYResolution",type:"Rational"},37392:{name:"FocalPlaneResolutionUnit",type:"Short"},37393:{name:"ImageNumber",type:"Long"},37394:{name:"SecurityClassification",type:"Ascii"},37395:{name:"ImageHistory",type:"Ascii"},37397:{name:"ExposureIndex",type:"Rational"},37398:{name:"TIFFEPStandardID",type:"Byte"},37399:{name:"SensingMethod",type:"Short"},40091:{name:"XPTitle",type:"Byte"},40092:{name:"XPComment",type:"Byte"},40093:{name:"XPAuthor",type:"Byte"},40094:{name:"XPKeywords",type:"Byte"},40095:{name:"XPSubject",type:"Byte"},50341:{name:"PrintImageMatching",type:"Undefined"},50706:{name:"DNGVersion",type:"Byte"},50707:{name:"DNGBackwardVersion",type:"Byte"},50708:{name:"UniqueCameraModel",type:"Ascii"},50709:{name:"LocalizedCameraModel",type:"Byte"},50710:{name:"CFAPlaneColor",type:"Byte"},50711:{name:"CFALayout",type:"Short"},50712:{name:"LinearizationTable",type:"Short"},50713:{name:"BlackLevelRepeatDim",type:"Short"},50714:{name:"BlackLevel",type:"Rational"},50715:{name:"BlackLevelDeltaH",type:"SRational"},50716:{name:"BlackLevelDeltaV",type:"SRational"},50717:{name:"WhiteLevel",type:"Short"},50718:{name:"DefaultScale",type:"Rational"},50719:{name:"DefaultCropOrigin",type:"Short"},50720:{name:"DefaultCropSize",type:"Short"},50721:{name:"ColorMatrix1",type:"SRational"},50722:{name:"ColorMatrix2",type:"SRational"},50723:{name:"CameraCalibration1",type:"SRational"},50724:{name:"CameraCalibration2",type:"SRational"},50725:{name:"ReductionMatrix1",type:"SRational"},50726:{name:"ReductionMatrix2",type:"SRational"},50727:{name:"AnalogBalance",type:"Rational"},50728:{name:"AsShotNeutral",type:"Short"},50729:{name:"AsShotWhiteXY",type:"Rational"},50730:{name:"BaselineExposure",type:"SRational"},50731:{name:"BaselineNoise",type:"Rational"},50732:{name:"BaselineSharpness",type:"Rational"},50733:{name:"BayerGreenSplit",type:"Long"},50734:{name:"LinearResponseLimit",type:"Rational"},50735:{name:"CameraSerialNumber",type:"Ascii"},50736:{name:"LensInfo",type:"Rational"},50737:{name:"ChromaBlurRadius",type:"Rational"},50738:{name:"AntiAliasStrength",type:"Rational"},50739:{name:"ShadowScale",type:"SRational"},50740:{name:"DNGPrivateData",type:"Byte"},50741:{name:"MakerNoteSafety",type:"Short"},50778:{name:"CalibrationIlluminant1",type:"Short"},50779:{name:"CalibrationIlluminant2",type:"Short"},50780:{name:"BestQualityScale",type:"Rational"},50781:{name:"RawDataUniqueID",type:"Byte"},50827:{name:"OriginalRawFileName",type:"Byte"},50828:{name:"OriginalRawFileData",type:"Undefined"},50829:{name:"ActiveArea",type:"Short"},50830:{name:"MaskedAreas",type:"Short"},50831:{name:"AsShotICCProfile",type:"Undefined"},50832:{name:"AsShotPreProfileMatrix",type:"SRational"},50833:{name:"CurrentICCProfile",type:"Undefined"},50834:{name:"CurrentPreProfileMatrix",type:"SRational"},50879:{name:"ColorimetricReference",type:"Short"},50931:{name:"CameraCalibrationSignature",type:"Byte"},50932:{name:"ProfileCalibrationSignature",type:"Byte"},50934:{name:"AsShotProfileName",type:"Byte"},50935:{name:"NoiseReductionApplied",type:"Rational"},50936:{name:"ProfileName",type:"Byte"},50937:{name:"ProfileHueSatMapDims",type:"Long"},50938:{name:"ProfileHueSatMapData1",type:"Float"},50939:{name:"ProfileHueSatMapData2",type:"Float"},50940:{name:"ProfileToneCurve",type:"Float"},50941:{name:"ProfileEmbedPolicy",type:"Long"},50942:{name:"ProfileCopyright",type:"Byte"},50964:{name:"ForwardMatrix1",type:"SRational"},50965:{name:"ForwardMatrix2",type:"SRational"},50966:{name:"PreviewApplicationName",type:"Byte"},50967:{name:"PreviewApplicationVersion",type:"Byte"},50968:{name:"PreviewSettingsName",type:"Byte"},50969:{name:"PreviewSettingsDigest",type:"Byte"},50970:{name:"PreviewColorSpace",type:"Long"},50971:{name:"PreviewDateTime",type:"Ascii"},50972:{name:"RawImageDigest",type:"Undefined"},50973:{name:"OriginalRawFileDigest",type:"Undefined"},50974:{name:"SubTileBlockSize",type:"Long"},50975:{name:"RowInterleaveFactor",type:"Long"},50981:{name:"ProfileLookTableDims",type:"Long"},50982:{name:"ProfileLookTableData",type:"Float"},51008:{name:"OpcodeList1",type:"Undefined"},51009:{name:"OpcodeList2",type:"Undefined"},51022:{name:"OpcodeList3",type:"Undefined"}},Exif:{33434:{name:"ExposureTime",type:"Rational"},33437:{name:"FNumber",type:"Rational"},34850:{name:"ExposureProgram",type:"Short"},34852:{name:"SpectralSensitivity",type:"Ascii"},34855:{name:"ISOSpeedRatings",type:"Short"},34856:{name:"OECF",type:"Undefined"},34864:{name:"SensitivityType",type:"Short"},34865:{name:"StandardOutputSensitivity",type:"Long"},34866:{name:"RecommendedExposureIndex",type:"Long"},34867:{name:"ISOSpeed",type:"Long"},34868:{name:"ISOSpeedLatitudeyyy",type:"Long"},34869:{name:"ISOSpeedLatitudezzz",type:"Long"},36864:{name:"ExifVersion",type:"Undefined"},36867:{name:"DateTimeOriginal",type:"Ascii"},36868:{name:"DateTimeDigitized",type:"Ascii"},37121:{name:"ComponentsConfiguration",type:"Undefined"},37122:{name:"CompressedBitsPerPixel",type:"Rational"},37377:{name:"ShutterSpeedValue",type:"SRational"},37378:{name:"ApertureValue",type:"Rational"},37379:{name:"BrightnessValue",type:"SRational"},37380:{name:"ExposureBiasValue",type:"SRational"},37381:{name:"MaxApertureValue",type:"Rational"},37382:{name:"SubjectDistance",type:"Rational"},37383:{name:"MeteringMode",type:"Short"},37384:{name:"LightSource",type:"Short"},37385:{name:"Flash",type:"Short"},37386:{name:"FocalLength",type:"Rational"},37396:{name:"SubjectArea",type:"Short"},37500:{name:"MakerNote",type:"Undefined"},37510:{name:"UserComment",type:"Ascii"},37520:{name:"SubSecTime",type:"Ascii"},37521:{name:"SubSecTimeOriginal",type:"Ascii"},37522:{name:"SubSecTimeDigitized",type:"Ascii"},40960:{name:"FlashpixVersion",type:"Undefined"},40961:{name:"ColorSpace",type:"Short"},40962:{name:"PixelXDimension",type:"Long"},40963:{name:"PixelYDimension",type:"Long"},40964:{name:"RelatedSoundFile",type:"Ascii"},40965:{name:"InteroperabilityTag",type:"Long"},41483:{name:"FlashEnergy",type:"Rational"},41484:{name:"SpatialFrequencyResponse",type:"Undefined"},41486:{name:"FocalPlaneXResolution",type:"Rational"},41487:{name:"FocalPlaneYResolution",type:"Rational"},41488:{name:"FocalPlaneResolutionUnit",type:"Short"},41492:{name:"SubjectLocation",type:"Short"},41493:{name:"ExposureIndex",type:"Rational"},41495:{name:"SensingMethod",type:"Short"},41728:{name:"FileSource",type:"Undefined"},41729:{name:"SceneType",type:"Undefined"},41730:{name:"CFAPattern",type:"Undefined"},41985:{name:"CustomRendered",type:"Short"},41986:{name:"ExposureMode",type:"Short"},41987:{name:"WhiteBalance",type:"Short"},41988:{name:"DigitalZoomRatio",type:"Rational"},41989:{name:"FocalLengthIn35mmFilm",type:"Short"},41990:{name:"SceneCaptureType",type:"Short"},41991:{name:"GainControl",type:"Short"},41992:{name:"Contrast",type:"Short"},41993:{name:"Saturation",type:"Short"},41994:{name:"Sharpness",type:"Short"},41995:{name:"DeviceSettingDescription",type:"Undefined"},41996:{name:"SubjectDistanceRange",type:"Short"},42016:{name:"ImageUniqueID",type:"Ascii"},42032:{name:"CameraOwnerName",type:"Ascii"},42033:{name:"BodySerialNumber",type:"Ascii"},42034:{name:"LensSpecification",type:"Rational"},42035:{name:"LensMake",type:"Ascii"},42036:{name:"LensModel",type:"Ascii"},42037:{name:"LensSerialNumber",type:"Ascii"},42240:{name:"Gamma",type:"Rational"}},GPS:{0:{name:"GPSVersionID",type:"Byte"},1:{name:"GPSLatitudeRef",type:"Ascii"},2:{name:"GPSLatitude",type:"Rational"},3:{name:"GPSLongitudeRef",type:"Ascii"},4:{name:"GPSLongitude",type:"Rational"},5:{name:"GPSAltitudeRef",type:"Byte"},6:{name:"GPSAltitude",type:"Rational"},7:{name:"GPSTimeStamp",type:"Rational"},8:{name:"GPSSatellites",type:"Ascii"},9:{name:"GPSStatus",type:"Ascii"},10:{name:"GPSMeasureMode",type:"Ascii"},11:{name:"GPSDOP",type:"Rational"},12:{name:"GPSSpeedRef",type:"Ascii"},13:{name:"GPSSpeed",type:"Rational"},14:{name:"GPSTrackRef",type:"Ascii"},15:{name:"GPSTrack",type:"Rational"},16:{name:"GPSImgDirectionRef",type:"Ascii"},17:{name:"GPSImgDirection",type:"Rational"},18:{name:"GPSMapDatum",type:"Ascii"},19:{name:"GPSDestLatitudeRef",type:"Ascii"},20:{name:"GPSDestLatitude",type:"Rational"},21:{name:"GPSDestLongitudeRef",type:"Ascii"},22:{name:"GPSDestLongitude",type:"Rational"},23:{name:"GPSDestBearingRef",type:"Ascii"},24:{name:"GPSDestBearing",type:"Rational"},25:{name:"GPSDestDistanceRef",type:"Ascii"},26:{name:"GPSDestDistance",type:"Rational"},27:{name:"GPSProcessingMethod",type:"Undefined"},28:{name:"GPSAreaInformation",type:"Undefined"},29:{name:"GPSDateStamp",type:"Ascii"},30:{name:"GPSDifferential",type:"Short"},31:{name:"GPSHPositioningError",type:"Rational"}},Interop:{1:{name:"InteroperabilityIndex",type:"Ascii"}}};h["0th"]=h.Image,h["1st"]=h.Image,n.TAGS=h,n.ImageIFD={ProcessingSoftware:11,NewSubfileType:254,SubfileType:255,ImageWidth:256,ImageLength:257,BitsPerSample:258,Compression:259,PhotometricInterpretation:262,Threshholding:263,CellWidth:264,CellLength:265,FillOrder:266,DocumentName:269,ImageDescription:270,Make:271,Model:272,StripOffsets:273,Orientation:274,SamplesPerPixel:277,RowsPerStrip:278,StripByteCounts:279,XResolution:282,YResolution:283,PlanarConfiguration:284,GrayResponseUnit:290,GrayResponseCurve:291,T4Options:292,T6Options:293,ResolutionUnit:296,TransferFunction:301,Software:305,DateTime:306,Artist:315,HostComputer:316,Predictor:317,WhitePoint:318,PrimaryChromaticities:319,ColorMap:320,HalftoneHints:321,TileWidth:322,TileLength:323,TileOffsets:324,TileByteCounts:325,SubIFDs:330,InkSet:332,InkNames:333,NumberOfInks:334,DotRange:336,TargetPrinter:337,ExtraSamples:338,SampleFormat:339,SMinSampleValue:340,SMaxSampleValue:341,TransferRange:342,ClipPath:343,XClipPathUnits:344,YClipPathUnits:345,Indexed:346,JPEGTables:347,OPIProxy:351,JPEGProc:512,JPEGInterchangeFormat:513,JPEGInterchangeFormatLength:514,JPEGRestartInterval:515,JPEGLosslessPredictors:517,JPEGPointTransforms:518,JPEGQTables:519,JPEGDCTables:520,JPEGACTables:521,YCbCrCoefficients:529,YCbCrSubSampling:530,YCbCrPositioning:531,ReferenceBlackWhite:532,XMLPacket:700,Rating:18246,RatingPercent:18249,ImageID:32781,CFARepeatPatternDim:33421,CFAPattern:33422,BatteryLevel:33423,Copyright:33432,ExposureTime:33434,ImageResources:34377,ExifTag:34665,InterColorProfile:34675,GPSTag:34853,Interlace:34857,TimeZoneOffset:34858,SelfTimerMode:34859,FlashEnergy:37387,SpatialFrequencyResponse:37388,Noise:37389,FocalPlaneXResolution:37390,FocalPlaneYResolution:37391,FocalPlaneResolutionUnit:37392,ImageNumber:37393,SecurityClassification:37394,ImageHistory:37395,ExposureIndex:37397,TIFFEPStandardID:37398,SensingMethod:37399,XPTitle:40091,XPComment:40092,XPAuthor:40093,XPKeywords:40094,XPSubject:40095,PrintImageMatching:50341,DNGVersion:50706,DNGBackwardVersion:50707,UniqueCameraModel:50708,LocalizedCameraModel:50709,CFAPlaneColor:50710,CFALayout:50711,LinearizationTable:50712,BlackLevelRepeatDim:50713,BlackLevel:50714,BlackLevelDeltaH:50715,BlackLevelDeltaV:50716,WhiteLevel:50717,DefaultScale:50718,DefaultCropOrigin:50719,DefaultCropSize:50720,ColorMatrix1:50721,ColorMatrix2:50722,CameraCalibration1:50723,CameraCalibration2:50724,ReductionMatrix1:50725,ReductionMatrix2:50726,AnalogBalance:50727,AsShotNeutral:50728,AsShotWhiteXY:50729,BaselineExposure:50730,BaselineNoise:50731,BaselineSharpness:50732,BayerGreenSplit:50733,LinearResponseLimit:50734,CameraSerialNumber:50735,LensInfo:50736,ChromaBlurRadius:50737,AntiAliasStrength:50738,ShadowScale:50739,DNGPrivateData:50740,MakerNoteSafety:50741,CalibrationIlluminant1:50778,CalibrationIlluminant2:50779,BestQualityScale:50780,RawDataUniqueID:50781,OriginalRawFileName:50827,OriginalRawFileData:50828,ActiveArea:50829,MaskedAreas:50830,AsShotICCProfile:50831,AsShotPreProfileMatrix:50832,CurrentICCProfile:50833,CurrentPreProfileMatrix:50834,ColorimetricReference:50879,CameraCalibrationSignature:50931,ProfileCalibrationSignature:50932,AsShotProfileName:50934,NoiseReductionApplied:50935,ProfileName:50936,ProfileHueSatMapDims:50937,ProfileHueSatMapData1:50938,ProfileHueSatMapData2:50939,ProfileToneCurve:50940,ProfileEmbedPolicy:50941,ProfileCopyright:50942,ForwardMatrix1:50964,ForwardMatrix2:50965,PreviewApplicationName:50966,PreviewApplicationVersion:50967,PreviewSettingsName:50968,PreviewSettingsDigest:50969,PreviewColorSpace:50970,PreviewDateTime:50971,RawImageDigest:50972,OriginalRawFileDigest:50973,SubTileBlockSize:50974,RowInterleaveFactor:50975,ProfileLookTableDims:50981,ProfileLookTableData:50982,OpcodeList1:51008,OpcodeList2:51009,OpcodeList3:51022,NoiseProfile:51041},n.ExifIFD={ExposureTime:33434,FNumber:33437,ExposureProgram:34850,SpectralSensitivity:34852,ISOSpeedRatings:34855,OECF:34856,SensitivityType:34864,StandardOutputSensitivity:34865,RecommendedExposureIndex:34866,ISOSpeed:34867,ISOSpeedLatitudeyyy:34868,ISOSpeedLatitudezzz:34869,ExifVersion:36864,DateTimeOriginal:36867,DateTimeDigitized:36868,ComponentsConfiguration:37121,CompressedBitsPerPixel:37122,ShutterSpeedValue:37377,ApertureValue:37378,BrightnessValue:37379,ExposureBiasValue:37380,MaxApertureValue:37381,SubjectDistance:37382,MeteringMode:37383,LightSource:37384,Flash:37385,FocalLength:37386,SubjectArea:37396,MakerNote:37500,UserComment:37510,SubSecTime:37520,SubSecTimeOriginal:37521,SubSecTimeDigitized:37522,FlashpixVersion:40960,ColorSpace:40961,PixelXDimension:40962,PixelYDimension:40963,RelatedSoundFile:40964,InteroperabilityTag:40965,FlashEnergy:41483,SpatialFrequencyResponse:41484,FocalPlaneXResolution:41486,FocalPlaneYResolution:41487,FocalPlaneResolutionUnit:41488,SubjectLocation:41492,ExposureIndex:41493,SensingMethod:41495,FileSource:41728,SceneType:41729,CFAPattern:41730,CustomRendered:41985,ExposureMode:41986,WhiteBalance:41987,DigitalZoomRatio:41988,FocalLengthIn35mmFilm:41989,SceneCaptureType:41990,GainControl:41991,Contrast:41992,Saturation:41993,Sharpness:41994,DeviceSettingDescription:41995,SubjectDistanceRange:41996,ImageUniqueID:42016,CameraOwnerName:42032,BodySerialNumber:42033,LensSpecification:42034,LensMake:42035,LensModel:42036,LensSerialNumber:42037,Gamma:42240},n.GPSIFD={GPSVersionID:0,GPSLatitudeRef:1,GPSLatitude:2,GPSLongitudeRef:3,GPSLongitude:4,GPSAltitudeRef:5,GPSAltitude:6,GPSTimeStamp:7,GPSSatellites:8,GPSStatus:9,GPSMeasureMode:10,GPSDOP:11,GPSSpeedRef:12,GPSSpeed:13,GPSTrackRef:14,GPSTrack:15,GPSImgDirectionRef:16,GPSImgDirection:17,GPSMapDatum:18,GPSDestLatitudeRef:19,GPSDestLatitude:20,GPSDestLongitudeRef:21,GPSDestLongitude:22,GPSDestBearingRef:23,GPSDestBearing:24,GPSDestDistanceRef:25,GPSDestDistance:26,GPSProcessingMethod:27,GPSAreaInformation:28,GPSDateStamp:29,GPSDifferential:30,GPSHPositioningError:31},n.InteropIFD={InteroperabilityIndex:1},n.GPSHelper={degToDmsRational:function(e){var t=Math.abs(e),n=t%1*60,a=n%1*60;return[[Math.floor(t),1],[Math.floor(n),1],[Math.round(100*a),100]]},dmsRationalToDeg:function(e,t){var n="S"===t||"W"===t?-1:1;return(e[0][0]/e[0][1]+e[1][0]/e[1][1]/60+e[2][0]/e[2][1]/3600)*n}},e.exports&&(t=e.exports=n),t.piexif=n}()},3836:function(e,t,n){"use strict";n.r(t);var a=n(379),i=n(0),r=n(2096),o=n(89),s=n(20);Object(s.n)([{rawString:".od-ImageFileEditor{position:absolute;top:0;bottom:0;left:0;right:0;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;background-color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-ImageFileEditor-belowNav{position:absolute;top:0;bottom:0;left:0;right:0}.od-ImageFileEditor-loadingDiv{display:block;position:absolute;top:0;width:100%;z-index:298}.od-ImageFileEditor-loadingBar{opacity:1}.od-ImageFileEditor-belowHeader{position:absolute;top:0;bottom:0;left:0;right:0}.od-ImageFileEditor-content{position:absolute;top:0;bottom:0;width:100%}.md .od-ImageFileEditor .od-ImageFileEditor-belowNav .od-ImageFileEditor-belowHeader,.sm .od-ImageFileEditor .od-ImageFileEditor-belowNav .od-ImageFileEditor-belowHeader{bottom:0}"}]);var c=n(175),d=n(1761),l=n(23),u=n(156),f=n(1052),p=n(59),m=n(553),_=n(62),h=n(8),b=n(112),g=new h.t({name:"SaveOperator.key",loader:new b.t(function(){return n.e(279).then(n.bind(null,3240)).then(function(e){return e.typeResourceKey})})}),v=n(1082),y=n(2454),S=n(1871),D=n(48),I=n(1769),x=n(3756),C=n.n(x),O=n(3165),w=n(1704),E=n(204),A=n(1775),L=n(308),k=n(327),M=n(99),P=n(1061),T=n(449),U=n(127),F=n(2913),H=n(221),R=n(1054),N=n(42),B=50331648,j="Exif",V=function(e){function t(t){var a=e.call(this,t)||this;a.addBindingHandlers({control:u.n,react:m.t,keyboard:f.e}),a.keyboardOptions=[{mappings:{Esc:a.onEsc}},{target:document,mappings:{},allowButtonEvents:!0}],a._thumbnailProvider=a.resources.consume(M.L.optional),a._platformDetection=a.resources.consume(E.e),a._itemContentsProvider=a.resources.consume(y.e),a._itemStore=a.resources.consume(R.e),a.loadingComponent=d.e.tagName,a.isRetrievingData=a.createObservable(!0),a._item=t.item;var i=(a._item.graph||{}).driveType;a._isODC=!("personal"!==i),a._onDismiss=t.onDismiss,a._actionMap=a.resources.consume(l.e),a.saveAction=new(a.managed(a._actionMap.SaveAction)),a.showImageEditorControl=a.observables.create(!1),a._currentItemSet=a.resources.consume(l.o),a._itemParentHelper=a.resources.consume(I.e),a._itemProvider=a.resources.consume(w.resourceKey),a._urlDataSource=a.resources.consume(_.Se),a._engagement=a.resources.consume(k.e),a._instrumentationProvider=a.resources.consume(M.d),a._operationProvider=a.resources.consume(P.resourceKey),a._imageEditorDataSource=a.resources.consume(F.e),a._desktopInkToolbarPosition="Left",a.imageEditorControl={componentPath:"../../controls/imageEditorControl/ImageEditorControl",getModule:function(){return p.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e(150)]).then(n.bind(null,4115)))},props:a.observables.pureCompute(a._computeImageEditorControlProps)};var r=a._item;return a._imageEditorDataSource.isWebFormat(r)?a._editWebFormatImage(r):a._editNonWebFormatImage(r),a}return Object(i.__extends)(t,e),t.prototype.onEsc=function(e,t){return this._onDismiss(),t.stopPropagation(),t.preventDefault(),!0},t.prototype._editWebFormatImage=function(e){var t=this;this.trackPromise(this._getContent(e).then(function(n){t._processBlob(e,n)},function(e){p.n.isCanceled(e)}))},t.prototype._editNonWebFormatImage=function(e){var t=this;this.trackPromise(this._getThumbnails(e).then(function(n){var a=n?t._thumbnailProvider.getThumbnailForSize(n,e.photo.width,e.photo.height).url:t._getBackupThumbnailUrl(e);fetch(a).then(function(e){return e.blob()}).then(function(n){t._processBlob(e,n)})}))},t.prototype._processBlob=function(e,t){this._imageUrl=this.createComputed(function(){return URL.createObjectURL(t)}),this.showImageEditorControl(!0),this.isRetrievingData(!1),this._processExif(e,t)},t.prototype._processExif=function(e,t){var n=this;if(this._isExifSupported(e)){var a=new FileReader;a.onloadend=function(){if(a.result)try{var t=n._resetOrientation(C.a.load(a.result.toString()));t=n._addDateTakenToExif(t,e),n._extractedExifString=C.a.dump(t)}catch(e){n._logWarningTelemetry(n._getErrorData(e))}},a.readAsDataURL(t)}},t.prototype._computeImageEditorControlProps=function(){var e=this,t=this._item;return{canSaveCopy:this._imageEditorDataSource.canSaveAsCopy({item:t}),canSaveOriginal:this._imageEditorDataSource.canSaveAsOriginal({item:t}),engagementCurrentPage:this._instrumentationProvider&&this._instrumentationProvider.currentPageName()+"-Edit"||"NA",imageUrl:this._imageUrl(),platformDetection:this._platformDetection,onClose:function(){e._onClose()},desktopInkToolbarPosition:this._desktopInkToolbarPosition,executeSave:function(t,n){var a=t.toDataURL(e._getSaveFileTypeByExtension(e._item));a?(e.isRetrievingData(!0),n?e._executeSaveAs(a):e._executeSave(a)):e._logErrorTelemetry({errorCode:"SaveFailed",errorMessage:"executeSave unable to get blob from canvas"})}}},t.prototype._getParentItem=function(e){var t=this,n=this.observables.peekUnwrap(this._itemParentHelper.getParent(e));return!n&&e.parentKey?this._itemProvider.getItem({parentKey:e.parentKey,ignoreChildren:!0}).then(function(e){return n=e.item()},function(a){return(n=t.observables.peekUnwrap(t._itemParentHelper.getParent(e)))||void t._logErrorTelemetry({errorCode:a.name,errorMessage:a instanceof H.e?a.code:""})}):p.n.resolve(n)},t.prototype._getBoundaryString=function(){return L.e.generate()},t.prototype._getImageData=function(e,t){return this._isExifSupported(t)&&(e=this._addExif(e)),e.split(",")[1]},t.prototype._convertImageDataToBytes=function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),a=0;a<e.length;a++)n[a]=e.charCodeAt(a);return n},t.prototype._getUploadAPIData=function(e,t){var n=this._getImageData(e,t),a=atob(n),i=this._convertImageDataToBytes(a),r=new Blob([i],{type:this._getSaveFileTypeByExtension(t)});return r.name=this._getFileName(t),r},t.prototype._getVroomRequestData=function(e,t,n,a){var i={name:this._getFileName(e),"@content.sourceUrl":"cid:content"},r=e.dateTakenTime||e.dateCreatedTime;r&&(i.photo={alternateTakenDateTime:r.toISOString(),orientation:1}),a&&(i["@name.conflictBehavior"]="rename",i.file={});var o=JSON.stringify(i),s=this._getImageData(t,e),c="\r\n",d="\r\n--"+n+"\r\nContent-ID: <metadata>\r\nContent-Type: application/json"+c+c+o+"\r\n--"+n+"\r\nContent-ID: <content>\r\nContent-Type: "+this._getSaveFileTypeByExtension(e)+c+c+atob(s)+"\r\n--"+n+"--";return this._convertImageDataToBytes(d)},t.prototype._saveWithVroom=function(e,t,n,a,i,r){var o=new Blob([a],{type:this._getSaveFileTypeByExtension(t)}),s="PATCH",c="/drive/items/".concat(t.id),d={Prefer:"synchronousmetadata"};if(d["Content-Type"]='multipart/related; boundary="'+i+'"',d.Scenario="Photos_Edit_HVC",r){s="POST";var l=this._urlDataSource.getKeyParams(n.key).id;c="/drive/items/".concat(l,"/children")}var u=e.getAccessToken(t,{useDirectEndpoint:!0});return this.resources.consume(A.e).send({path:c,apiName:"UpdateItemContentAndMetadata",headers:d,requestType:s,useAuthorizationHeaders:!0,postData:o,accessToken:u})},t.prototype._executeSave=function(e){var t=this,n=this._item,a=this._getBoundaryString();return this._getParentItem(n).then(function(i){if(i){var r=t._getVroomRequestData(n,e,a,!1);r.length<=B&&t._isODC?t._saveSmallData(n,i,r,a):t._saveLargeData(n,i,e)}else t._logErrorTelemetry({errorCode:"SaveFailed",errorMessage:"save missing parentItem"})}),p.n.resolve({resultType:D.e.ExpectedFailure})},t.prototype._saveSmallData=function(e,t,n,a){var i=this,r=this._operationProvider.register({name:e.name||e.displayName||"",type:T.e.saveItem,payloads:{uploadItems:{parent:t,name:e.name||e.displayName||""}}});r.progress.maximum(1),r.progress.current(0),this.resources.consumeAsync(_.y).then(function(o){i._saveWithVroom(o,e,t,n,a,!1).then(function(){i.resources.consume(O.e)(e),i._itemProvider.invalidateItem(e.key),i._invalidateCurrentItemSet(),i._itemProvider.getItem({parentKey:e.key,requestAllChildren:!0,skipCache:!0}).then(function(){r.state(U.e.completed),i._onClose()})},function(e){i._logErrorTelemetry({errorCode:e.name,errorMessage:e instanceof H.e?e.code:""}),r.state(U.e.failed),i._onClose()})})},t.prototype._saveLargeData=function(e,t,n){var a=this,i=this._getUploadAPIData(n,e);this._itemContentsProvider.getItemContent(e).memoryContent({text:"",mimeType:this._getSaveFileTypeByExtension(e),isSafeText:!0}),p.n.resolve(this.resources.consumeAsync(g)).then(function(n){var r=new n({files:[i],parentItem:t,wasDragAndDropped:!1,type:v.e.Html5file,item:e,itemSet:a._currentItemSet&&a._currentItemSet.peek(),skipInvalidation:!0,isTemplate:!0,ignoreCurrentItem:!0,onItemUploaded:function(e){a.resources.consume(O.e)(e),a._itemProvider.getItem({parentKey:e.key,requestAllChildren:!0,skipCache:!0})}});return r.start(),a._onClose(),r.wait()}).done(function(){return{resultType:D.e.Success}},function(){return{resultType:D.e.Failure}})},t.prototype._executeSaveAs=function(e){var t=this,n=this._item,a=this._getBoundaryString();return this._getParentItem(n).then(function(i){if(i){var r=t._getVroomRequestData(n,e,a,!0);r.length<=B&&t._isODC?t._saveAsSmallData(n,i,r,a):t._saveAsLargeData(n,i,e)}else t._logErrorTelemetry({errorCode:"SaveFailed",errorMessage:"save missing parentItem"})}),p.n.wrap({resultType:D.e.ExpectedFailure})},t.prototype._saveAsSmallData=function(e,t,n,a){var i=this,r=this._operationProvider.register({name:e.name||e.displayName||"",type:T.e.uploadItems,payloads:{uploadItems:{parent:t,name:e.name||e.displayName||""}}});r.progress.maximum(1),r.progress.current(0),this.resources.consumeAsync(_.y).then(function(o){i._saveWithVroom(o,e,t,n,a,!0).then(function(n){var a;if(i.resources.consume(O.e)(e),n&&n.id&&n.parentReference&&n.parentReference.driveId){var o=i._urlDataSource.getKey(((a={}).id=n.id,a.cid=n.parentReference.driveId.toUpperCase(),a)),s=n.name||n.file&&n.file.name||"";r.name=s,r.payloads({uploadItems:{parent:t,name:s}}),i._itemStore.invalidateAllPhotos(),i._invalidateCurrentItemSet(),i._itemProvider.invalidateItem(t.key),i._itemProvider.getItem({parentKey:o,requestAllChildren:!0,skipCache:!0}).then(function(e){var t=i.resources.consume(l.e);new(i.managed(t.OpenAction))({urlType:"focus",item:e.item,itemSet:i.observables.create(e),openRelation:2,ignoreHistory:!0,preserveAction:!0,openLocal:!0}).execute(null).then(function(){r.state(U.e.completed),i._onClose()})})}},function(e){i._logErrorTelemetry({errorCode:e.name,errorMessage:e instanceof H.e?e.code:""}),r.state(U.e.failed),i._onClose()})})},t.prototype._saveAsLargeData=function(e,t,n){var a=this,i=this._getUploadAPIData(n,e);p.n.resolve(this.resources.consumeAsync(S.e)).then(function(e){var n=new e({files:[i],parentItem:t,wasDragAndDropped:!1,type:v.e.Html5file,behavior:2,itemSet:a._currentItemSet&&a._currentItemSet.peek(),skipInvalidation:!0,isTemplate:!0,ignoreCurrentItem:!0,onItemUploaded:function(e){a.resources.consume(O.e)(e);var t=a.resources.consume(l.e);new(a.managed(t.OpenAction))({urlType:"focus",item:a.observables.wrap(e),openRelation:2,ignoreHistory:!0,preserveAction:!0,openLocal:!0}).execute(null).done()}});return n.start(),a._onClose(),n.wait()}).done(function(){return{resultType:D.e.Success}},function(){return{resultType:D.e.Failure}})},t.prototype._getSaveFileTypeByExtension=function(e){return".png"===e.extension?"image/png":"image/jpeg"},t.prototype._getFileName=function(e){var t=e.name;return e.extension&&e.name&&e.name.endsWith(e.extension)&&(t=e.name.substring(0,e.name.lastIndexOf(e.extension)),e.extension.toLowerCase().endsWith("png"))?e.name+(e.extension||""):t+".jpg"},t.prototype._onClose=function(){this.isRetrievingData(!1),this._onDismiss()},t.prototype._getThumbnails=function(e){if(!this._thumbnailProvider)return p.n.resolve(void 0);var t=[];return e.photo&&t.push(e.photo),t.push({height:10,width:10}),this._thumbnailProvider.getThumbnails(e.graph,t)},t.prototype._getBackupThumbnailUrl=function(e){var t=(e.orientedThumbnail||e).thumbnail;return t&&t.url&&N.format(t.url,t.width,t.height)||""},t.prototype._getContent=function(e){return this.trackPromise(p.n.resolve(this.resources.consumeAsync(_.c)).then(function(t){return t.getItemContents(e)})).then(function(e){return e})},t.prototype._resetOrientation=function(e){var t=C.a.ImageIFD.Orientation;return e["0th"]&&e["0th"][t]&&(e["0th"][t]=1),e},t.prototype._addExif=function(e){if(this._extractedExifString)try{e=C.a.insert(this._extractedExifString,e)}catch(e){this._logWarningTelemetry(this._getErrorData(e))}return e},t.prototype._getErrorData=function(e){return{errorCode:e&&e.code||e&&e.error&&e.error.code||"",errorMessage:e&&e.message?e.message.value?e.message.value:e.message:""}},t.prototype._logWarningTelemetry=function(e){this._logTelemetry("EditControlWarning",e)},t.prototype._logErrorTelemetry=function(e){this._logTelemetry("EditControlError",e)},t.prototype._logTelemetry=function(e,t){this._engagement.logData({isIntentional:!1,name:e,extraData:{code:t.errorCode,message:t.errorMessage},currentPage:this._instrumentationProvider&&this._instrumentationProvider.currentPageName()+"-Edit"||"NA"})},t.prototype._isExifSupported=function(e){var t,n=null===(t=e.extension)||void 0===t?void 0:t.toLowerCase();return!n||".png"!==n},t.prototype._addDateTakenToExif=function(e,t){var n=C.a.ImageIFD.DateTime,a=C.a.ExifIFD.DateTimeOriginal,i=C.a.ExifIFD.DateTimeDigitized,r=this._getExifData(e,n,"0th")||this._getExifData(e,a,j)||this._getExifData(e,i,j),o=t.dateTakenTime||t.dateCreatedTime;return!r&&o&&(r=this._convertUTCDateToExif(o)),r&&(e=this._addExifData(e,r,n,"0th"),e=this._addExifData(e,r,a,j),e=this._addExifData(e,r,i,j)),e},t.prototype._addExifData=function(e,t,n,a){return e[a]?e[a][n]||(e[a][n]=t):(e[a]={},e[a][n]=t),e},t.prototype._getExifData=function(e,t,n){if(e&&e[n]&&e[n][t])return e[n][t]},t.prototype._convertUTCDateToExif=function(e){function t(e,t){return t>e.toString().length?(Array(t).join("0")+e).slice(-t):e.toString()}var n=e.getUTCFullYear(),a=t(e.getUTCMonth()+1,2),i=t(e.getUTCDate(),2),r=t(e.getUTCHours(),2),o=t(e.getUTCMinutes(),2),s=t(e.getUTCSeconds(),2);return"".concat(n,":").concat(a,":").concat(i," ").concat(r,":").concat(o,":").concat(s)},t.prototype._invalidateCurrentItemSet=function(){return p.n.resolve(this.resources.consumeAsync(_.M)).then(function(e){e.invalidateCurrentItemSet()})},t}(c.t),z=a.e({tagName:"ms-image-file-editor",template:'<div class="od-ImageFileEditor" tabindex="-1" data-bind="keyboard:keyboardOptions">\x3c!--ko if:isRetrievingData--\x3e<div class="od-ImageFileEditor-loadingDiv"><span class="od-ImageFileEditor-loadingBar" data-bind="component:{name:loadingComponent}"></span></div>\x3c!--/ko--\x3e<div class="od-ImageFileEditor-belowHeader">\x3c!--ko if:showImageEditorControl--\x3e<div class="od-ImageFileEditor-content" data-bind="react:imageEditorControl"></div>\x3c!--/ko--\x3e</div></div>',viewModel:V,synchronous:!0}),G=n(1725),K=n(568),W=n(2196),q=function(e){function t(t){var n=e.call(this,t)||this,a=n.resources.consume(M.d.optional);o.e.logData({name:"ImageEditButton.Click",isIntentional:!0,currentPage:a&&a.currentPageName()||"NA"});var i=n.resources.consume(M.A.optional),r=n.resources.consume(W.e.optional);return i&&r&&(r.hideCampaign(),i.clearCurrentBubble(),i.markBubbleAsDismissed(K.PHOTO_EDIT)),n.overlaySpecification=n.observables.create({name:G.e.tagName,params:{}}),n.imageFileEditorSpecification=n.observables.create({name:z.tagName,params:{item:t.item,onDismiss:function(){n.action.complete()}}}),n}return Object(i.__extends)(t,e),t}(r.e),Q=a.e({tagName:"open-in-image-editor",template:"\x3c!--ko component:overlaySpecification--\x3e\x3c!--ko component:imageFileEditorSpecification--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e",viewModel:q,synchronous:!0});t.default=Q}}]);