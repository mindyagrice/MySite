(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[407],{2196:function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a=n(0),i=n(11),r=n(55),o=n(112),s=n(106),c=n(63),d=n(81),l=n(99),u=n(459),f=n(311),p=n(281),m="CoachmarkTearDropSeen",_={campaignGuid:"00000000-0000-0000-0000-000000000000",endDate:new Date(1970,1,1),flag:i.Off,isCoachmark:!0},h=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;a._dataStore=new s.e("CoachmarkProvider",c.e.session),a._currentCampaign=a.createObservable(_),a._isVisible=a.createObservable(!1),a._navigation=n.navigation,a._firstRunExperienceStatus=n.firstRunExperienceStatus,a._currentTeachingBubble=a.createObservable({campaign:a._currentCampaign,isVisible:a._isVisible}),a._navigation.viewParams.resetAllBubbles&&a._dataStore.remove(m);var i=a.resources.consume(p.e);return a._teachingBubbleProviderPromise=i.waitForPLT().then(function(){return a.resources.consume(l.A)}),a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._isVisible},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentCampaign",{get:function(){return this._currentCampaign},enumerable:!1,configurable:!0}),t.prototype.hideCampaign=function(){this._isVisible(!1),this._currentCampaign(_)},t.prototype.setCampaign=function(e){var t=this;if(!e)return this._currentCampaign(_),void this._isVisible(!1);if(this._firstRunExperienceStatus.get()!==f.e.visible){var n="".concat(e.name).concat(m);this._dataStore.getValue(m)||this._teachingBubbleProviderPromise.then(function(a){a&&a.shouldBubbleBeAdded(e,!1).then(function(a){a&&(t._currentCampaign(e),t._isVisible(!0),t._dataStore.setValue(n,!0))})})}},t.prototype.getCurrentTeachingBubble=function(){return this._currentTeachingBubble},t.dependencies=Object(a.__assign)(Object(a.__assign)({},r.n.dependencies),{navigation:d.e,firstRunExperienceStatus:u.e}),t}(r.n),b=Object(o.r)("CoachmarkProvider",h)},3995:function(e,t,n){"use strict";n.r(t),n.d(t,"OpenInImageEditorHandler",function(){return x});var a=n(0),i=n(204),r=n(2382),o=n(55),s=n(59),c=n(62),d=n(773),l=n(1819),u=n(36),f=n(119),p=n(2913),m=n(2133),_=n(11),h=n(140),b=n(568),g=n(2196),v=n(91),y={jpg:"image/jpg",jpeg:"image/jpeg"},S={png:"image/png"},D={heic:"image/heic",heif:"image/heif"},I={bmp:"image/bmp",emf:"image/emf",gif:"image/gif",tiff:"image/tiff",tif:"image/tif",webp:"image/webp",wmf:"image/wmf"},x=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._itemSelectionHelper=new(n.child(d.e))({allowMultiSelect:!1,canFallback:!0}),n._isOneDriveWinApp=Object(f.e)(),n._urlDataSource=n.resources.consume(c.Se),n._itemCommandHelper=n.resources.consume(l.t),n._platformDetection=n.resources.consume(i.e),n._identityDataSource=n.resources.consume(c.I),n._coachmarkProvider=n.resources.consume(g.e.optional),n._imageEditorDataSource=n.resources.consume(p.e.optional),n.state=n.createPureComputed(n._computeState),n}return Object(a.__extends)(t,e),t.prototype.getParams=function(){return this._itemSelectionHelper.resolveFirst().then(function(e){return{item:e}})},t.prototype._computeState=function(){return{isAvailable:this._isAvailable()}},t.prototype._isAvailable=function(){if(!this._imageEditorDataSource)return!1;var e=this._itemSelectionHelper.firstItem();if(!e)return!1;if(e.video&&e.video.burstPhotoType)return!1;var t=this._itemCommandHelper.isCommandSupported(e,m.c),n=this._isSupportedFileType(e),a=this._itemSelectionHelper.currentItem(),i=this._urlDataSource.getKeyParams(a.key),r=this._urlDataSource.getQueryType(i),o=this._shouldEnableImageEditor()&&t&&n&&(!this._platformDetection.isIE||Object(_.isFeatureEnabled)(_.EnableEditUtilityControlIE))&&(!this._platformDetection.isSafari||Object(_.isFeatureEnabled)(_.EnableEditUtilityControlSafari))&&(!this._platformDetection.isMobile||Object(_.isFeatureEnabled)(_.EnableEditUtilityControlMobile))&&!!e&&0===e.sharingRole&&r!==u.e.SharedWithMe&&!this._isOneDriveWinApp&&!this._urlDataSource.isRecycleBin(r)&&4!==e.itemStatus&&3!==e.itemStatus&&this._imageEditorDataSource.canSave({item:e});return o&&Object(_.isFeatureEnabled)(_.EnableEditControlTeachingBubble)&&!Object(_.isFeatureEnabled)(_.MentionTeachingUIAA)&&!Object(_.isFeatureEnabled)(_.EnableExpirationSectionForTMR)&&this._coachmarkProvider.setCampaign(b.PHOTO_EDIT),o},t.prototype._shouldEnableImageEditor=function(){if(Object(_.isFeatureEnabled)(_.EnableEditUtilityControl))return!0;if(Object(_.isFeatureEnabled)(_.EnableEditControlExperimentAA)){if(this._identityDataSource){var e=this._identityDataSource.getIdentity();e&&h.t.init({userLoginName:e.email})}var t={name:"EnableEditControlExperiment",startDate:"2/09/2021",version:h.e.v2};return new h.t(t,_.EnableEditControlExperimentAB).isOn()}return!1},t.prototype._isSupportedFileType=function(e){if(!function(e){return Object(_.isFeatureEnabled)(_.EnableEditAllImageFormats)&&w.forEach(function(e){O.push(e),O.push(e.toUpperCase())}),Object(_.isFeatureEnabled)(_.EnableEditPNG)&&(O.push(".png"),O.push(".PNG")),Object(_.isFeatureEnabled)(_.EnableEditHEIC)&&(O.push(".heic"),O.push(".heif"),O.push(".HEIC"),O.push(".HEIF")),O.some(function(t){return e.toLowerCase()===t})}(e.extension||""))return!1;if(e&&e.extension&&(e.type===v.e.File||e.type===v.e.Media)){var t=e.extension;if(t=((t&&"."===t[0]?t.substring(1):t)||"").toLowerCase(),y.hasOwnProperty(t))return!0;if(Object(_.isFeatureEnabled)(_.EnableEditPNG)&&S.hasOwnProperty(t))return!0;if(Object(_.isFeatureEnabled)(_.EnableEditHEIC)&&D.hasOwnProperty(t))return!0;if(Object(_.isFeatureEnabled)(_.EnableEditAllImageFormats)&&I.hasOwnProperty(t))return!0}return!1},t}(o.n),C=Object(r.e)({name:"OpenInImageEditor",source:{moduleDefinition:{path:"./OpenInImageEditorExecutor",getModule:function(){return s.n.resolve(n.e(114).then(n.bind(null,3836)))}}},handlerType:x}),O=[".jpg",".jpeg",".JPG",".JPEG"],w=[".bmp",".emf",".gif",".tiff",".tif",".webp",".wmf"];t.default=C}}]);