(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[309],{1616:function(e,t,n){"use strict";n.r(t),n.d(t,"FloodgateDataSource",function(){return K}),n.d(t,"resourceKey",function(){return W});var a={};n.r(a),n.d(a,"NPSCampaignProd",function(){return b}),n.d(a,"NPSCampaignDogfood",function(){return g}),n.d(a,"NPSCampaignForceNomination",function(){return v}),n.d(a,"NPSCampaignDebugForSPO",function(){return y}),n.d(a,"NPSCampaignForSPO",function(){return S}),n.d(a,"NPSCampaignForLists",function(){return I}),n.d(a,"NPSCampaignForListsDebug",function(){return x}),n.d(a,"NPSSuiteSurvey",function(){return C}),n.d(a,"AllPhotosFPSSurvey",function(){return O}),n.d(a,"ODBMoveFPSSurvey",function(){return w}),n.d(a,"ODBCopyFPSSurvey",function(){return E}),n.d(a,"ODCMoveFPSSurvey",function(){return A}),n.d(a,"CreateListFromTemplateFPS",function(){return L}),n.d(a,"ODCCopyFPSSurvey",function(){return k}),n.d(a,"NlqsSurveyForBigLangs",function(){return M}),n.d(a,"NlqsSurveyForMediumLangs",function(){return P}),n.d(a,"NlqsSurveyForSmallLangs",function(){return T});var i=n(0),r=n(20);Object(r.n)([{rawString:"#obf-TPromptContainer:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}#obf-ToastContainer{background-color:"},{theme:"menuBackground",defaultValue:"#ffffff"},{rawString:";border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}#obf-ToastContainer #obf-TFormComment{background-color:"},{theme:"menuBackground",defaultValue:"#ffffff"},{rawString:"}#obf-ToastContainer #obf-TFormTitle,#obf-ToastContainer #obf-TPromptTitle{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}#obf-ToastContainer .obf-ChoiceGroup input[type=radio]:checked+label>.obf-ChoiceGroupIcon>span{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}#obf-ToastContainer .obf-ChoiceGroup input[type=radio]:checked+label>.obf-ChoiceGroupIcon{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}#obf-ToastContainer #obf-TFormRating,#obf-ToastContainer #obf-TPromptText,#obf-ToastContainer #obf-ToastCancel svg path{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";fill:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}#obf-ToastContainer .obf-Link{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}#obf-ToastContainer .obf-TextInput{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}#obf-ToastContainer .obf-TextInput::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}#obf-ToastContainer .obf-Link:focus,#obf-ToastContainer .obf-SubmitButton:focus{outline-color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}#obf-ToastContainer .obf-ChoiceGroup input:focus+label{outline-color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}#obf-ToastContainer .obf-SubmitButton[disabled],#obf-ToastContainer .obf-SubmitButton[disabled]:active,#obf-ToastContainer .obf-SubmitButton[disabled]:focus,#obf-ToastContainer .obf-SubmitButton[disabled]:hover{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:";color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}"}]);var o=n(120),s=n(48),c=n(327),d=n(99),l=n(204),u=n(1266),f=n(1712),p=n(3504),m=n(2257),_={Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MeaningfulNpsAction",Count:1,IsAggregate:!0},{Type:0,Activity:"NewNpsSession",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:p.h,Question:p.g,YesLabel:p.V,NoLabel:p.N},Rating:{Question:p.F,RatingValuesAscending:[p.B,"2","3","4",p.j]},Question:{Question:p.r}}},h={Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SPListAction",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:p.h,Question:p.g,YesLabel:p.V,NoLabel:p.N},Rating:{Question:p.R,RatingValuesAscending:[p.B,"2","3","4",p.j]},Question:{Question:p.o}}},b={CampaignId:"520978bb-a341-4304-8733-25b60ca048a5",StartTimeUtc:"2018-11-29T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:3,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:_},g={CampaignId:"520978bb-a341-4304-8733-25b60ca048a5",StartTimeUtc:"2018-11-29T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:432e3}},SurveyTemplate:_},v={CampaignId:"520978bb-a341-4304-8733-25b60ca048a5",StartTimeUtc:"2018-11-29T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:432e3}},SurveyTemplate:_},y={CampaignId:"a546f732-aac7-49d2-9da5-9a55220505a0",StartTimeUtc:"2019-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:h},S={CampaignId:"a546f732-aac7-49d2-9da5-9a55220505a0",StartTimeUtc:"2019-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:6,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:h},D={Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:m.e,Count:2,IsAggregate:!0}]},Content:{Prompt:{Title:p.b,Question:p.g,YesLabel:p.V,NoLabel:p.N},Rating:{Question:p.H,RatingValuesAscending:[p.B,"2","3","4",p.j]},Question:{Question:p.s}}},I={CampaignId:"d443d624-9997-4028-98d0-a990cd23631f",StartTimeUtc:"2020-09-17T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:6,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:D},x={CampaignId:"d443d624-9997-4028-98d0-a990cd23631f",StartTimeUtc:"2020-09-17T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:D},C={CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",StartTimeUtc:"2019-03-21T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:3,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MeaningfulNpsAction",Count:1,IsAggregate:!0},{Type:0,Activity:"NewNpsSession",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:p.h,Question:p.g,YesLabel:p.V,NoLabel:p.N},Rating:{Question:p.y,RatingValuesAscending:[p.B,"2","3","4",p.j]},Question:{Question:p.v}}}},O={CampaignId:"f603ed6a-6f11-4e88-8f4d-7050fda6a676",StartTimeUtc:"2019-10-10T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:20,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"EnteredAllPhotosView",Count:2,IsAggregate:!0}]},Content:{Prompt:{Title:p.e,Question:p.g,YesLabel:p.V,NoLabel:p.N},Rating:{Question:p.t,RatingValuesAscending:[p.n,"2","3","4",p.a]},Question:{Question:p.i}}}},w={CampaignId:"e9808919-b9be-44a7-85fa-2a11dbf35d41",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODBMoveActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:p.I,Question:p.x,YesLabel:p.V,NoLabel:p.N},Rating:{Question:p.D,RatingValuesAscending:[p.n,"2","3","4",p.a]},Question:{Question:p.S}}}},E={CampaignId:"bf829135-ea3a-43e7-8592-6d62259a0a92",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODBCopyActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:p.l,Question:p.u,YesLabel:p.V,NoLabel:p.N},Rating:{Question:p.d,RatingValuesAscending:[p.n,"2","3","4",p.a]},Question:{Question:p.c}}}},A={CampaignId:"54eeb279-6ab7-4f26-880c-0643d3d60e53",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODCMoveActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:p.I,Question:p.x,YesLabel:p.V,NoLabel:p.N},Rating:{Question:p.D,RatingValuesAscending:[p.n,"2","3","4",p.a]},Question:{Question:p.S}}}},L={CampaignId:"20e51938-5a9e-4760-b14f-cd6491d1864e",StartTimeUtc:"2021-08-06T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1},CooldownPeriod:{Type:0,IntervalSeconds:1}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CreateListFromTemplate",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:p._,Question:p.g,YesLabel:p.V,NoLabel:p.N},Rating:{Question:p.f,RatingValuesAscending:[p.p,"2","3","4",p.m]},Question:{Question:p.o}}}},k={CampaignId:"ffd1b867-3ee8-4ca9-a04c-2467930dfc54",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODCCopyActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:p.l,Question:p.u,YesLabel:p.V,NoLabel:p.N},Rating:{Question:p.d,RatingValuesAscending:[p.n,"2","3","4",p.a]},Question:{Question:p.c}}}},M={CampaignId:"a0be9dbb-0be9-429c-a632-c8de3a4d08b8",StartTimeUtc:"2021-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,Scope:{Languages:[{Type:0,Value:"de"},{Type:0,Value:"en-GB"},{Type:0,Value:"es-MX"},{Type:0,Value:"fr"},{Type:0,Value:"ja"},{Type:0,Value:"nl"},{Type:0,Value:"pt-BR"},{Type:0,Value:"zh-CN"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:3,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageTime",Count:300,IsAggregate:!0},{Type:0,Activity:"AppResume",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:p.w,Question:p.O,YesLabel:p.E,NoLabel:p.C},Rating:{Question:p.L,RatingValuesAscending:[p.k,p.M,p.P,p.T,p.U]},Question:{Question:p.A}}}},P={CampaignId:"a0be9dbb-0be9-429c-a632-c8de3a4d08b8",StartTimeUtc:"2021-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,Scope:{Languages:[{Type:0,Value:"ar"},{Type:0,Value:"es"},{Type:0,Value:"fil-PH"},{Type:0,Value:"id"},{Type:0,Value:"it"},{Type:0,Value:"ko"},{Type:0,Value:"ms"},{Type:0,Value:"pl"},{Type:0,Value:"pt-PT"},{Type:0,Value:"ru"},{Type:0,Value:"sv"},{Type:0,Value:"th"},{Type:0,Value:"tr"},{Type:0,Value:"vi"},{Type:0,Value:"zh-TW"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageTime",Count:300,IsAggregate:!0},{Type:0,Activity:"AppResume",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:p.w,Question:p.O,YesLabel:p.E,NoLabel:p.C},Rating:{Question:p.L,RatingValuesAscending:[p.k,p.M,p.P,p.T,p.U]},Question:{Question:p.A}}}},T={CampaignId:"a0be9dbb-0be9-429c-a632-c8de3a4d08b8",StartTimeUtc:"2021-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,Scope:{Languages:[{Type:0,Value:"af"},{Type:0,Value:"az-Latn-AZ"},{Type:0,Value:"be"},{Type:0,Value:"bg"},{Type:0,Value:"bn-BD"},{Type:0,Value:"bs-Latn-BA"},{Type:0,Value:"cs"},{Type:0,Value:"da"},{Type:0,Value:"el"},{Type:0,Value:"et"},{Type:0,Value:"fa-IR"},{Type:0,Value:"fi"},{Type:0,Value:"fr-CA"},{Type:0,Value:"he"},{Type:0,Value:"hi"},{Type:0,Value:"hr"},{Type:0,Value:"hu"},{Type:0,Value:"ka"},{Type:0,Value:"kk"},{Type:0,Value:"km-KH"},{Type:0,Value:"lb-LU"},{Type:0,Value:"lv"},{Type:0,Value:"mt-MT"},{Type:0,Value:"nb-NO"},{Type:0,Value:"ne-NP"},{Type:0,Value:"nn-NO"},{Type:0,Value:"pa-Arab-PK"},{Type:0,Value:"quz-PE"},{Type:0,Value:"ro"},{Type:0,Value:"si-LK"},{Type:0,Value:"sk"},{Type:0,Value:"sl"},{Type:0,Value:"sq"},{Type:0,Value:"sw"},{Type:0,Value:"uk"},{Type:0,Value:"uz-Latn-UZ"},{Type:0,Value:"yo-NG"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageTime",Count:300,IsAggregate:!0},{Type:0,Activity:"AppResume",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:p.w,Question:p.O,YesLabel:p.E,NoLabel:p.C},Rating:{Question:p.L,RatingValuesAscending:[p.k,p.M,p.P,p.T,p.U]},Question:{Question:p.A}}}},U=n(1140),F=n(7),H=n(205),R=n(112),N=n(219),B=n(308),j=n(2189),V=n(113),z=n(13),G=n(96),K=function(){function e(e,t){void 0===e&&(e={});var n=this;if(this._eventGroup=new G.t(this),this._engagement=t.engagement,this._userInfoProvider=t.userInfoProvider,this._platformDetection=t.platformDetection,this._sessionId=B.e.generate(),this._appId=t.appId,this._pageContext=t.pageContext,this._isItemsScopeEnabledInAllPhotosPivotResource=t.isItemsScopeEnabledInAllPhotosPivotResource,this._onSurveyActivated=function(e){var t=e.survey.surveyInfo.data.backEndIdentifier,a=n._pageContext&&n._pageContext.isSPO;n._userInfoProvider.getSurveyStatusUserFact(t,a,!0).then(function(i){if(i.activated){for(var r=!1,o=0,s=n._campaignDefinitions;o<s.length;o++){var c=s[o];if(c.CampaignId===t){var d=1e3*c.NominationScheme.CooldownPeriod.IntervalSeconds;r=(new Date).getTime()>i.dateLastModified.getTime()+d}}if(!r)return void n._engagement.logData({name:"Floodgate.SurveyBlockedByUserFact",extraData:{id:t},isIntentional:!0})}n._ratingComponent=e.survey&&e.survey.getRatingComponent&&e.survey.getRatingComponent(),e.launch();var l={activated:!0,dateLastModified:new Date};!z.t.isActivated("069E3BF0-5DF9-4305-A165-C4280E18F2DE","10/26/20","Skip setSurveyStatus SPO")&&a?n._engagement.logData({name:"Floodgate.SurveyShown",extraData:{id:t},isIntentional:!0}):n._userInfoProvider.setSurveyStatusUserFact(t,l).then(function(e){n._engagement.logData({name:"Floodgate.SurveyShown",extraData:{id:t,userFactUpdated:e},isIntentional:!0})})})},this._onSurveyDismissed=function(e,t){var a=new o.e({name:"Floodgate.SurveyCompleted"});if(t){var i=n._getEngine();if(i){var r=i.launchedSurveys,c=-1;for(var d in r)r[d].surveyInfo.data.backEndIdentifier===e&&(c=r[d].rating.selectedIndex+1);a.end({extraMetrics:{surveyResponse:c,sessionId:n._sessionId},resultType:s.e.Success}),n._engagement.logData({name:"Floodgate.SurveySubmitted",extraData:{id:e,response:c,sessionId:n._sessionId},isIntentional:!0})}if(n._pageContext&&n._pageContext.isSPO&&n._ratingComponent&&n._ratingComponent.getSelectedRating){var l=n._ratingComponent.getSelectedRating();-1!==l.indexOf("5")?n._engagement.logData({name:"SharePointNPSPromoter",extraData:{rating:l}}):-1===l.indexOf("1")&&-1===l.indexOf("2")&&-1===l.indexOf("3")||n._engagement.logData({name:"SharePointNPSDetractor",extraData:{rating:l}})}}else a.end({resultCode:"SurveyClosed",resultType:s.e.ExpectedFailure}),n._engagement.logData({name:"Floodgate.SurveyClosed",isIntentional:!0})},this._campaignDefinitions=[],e.customCampaignDefinitions)this._campaignDefinitions=e.customCampaignDefinitions;else{this._campaignDefinitions=[];var a=this._getActiveOneDriveNpsCampaign();a&&this._campaignDefinitions.push(a),this._pageContext&&this._pageContext.isSPO&&(this._pageContext.farmName&&this._pageContext.farmName.indexOf("MSIT_SPDF")>-1?(this._campaignDefinitions.push(y),this._campaignDefinitions.push(x)):(this._campaignDefinitions.push(S),this._campaignDefinitions.push(I)),Object(F.Dr)(F.K)&&this._campaignDefinitions.push(L)),Object(F.Dr)(F.c)&&this._campaignDefinitions.push(O),Object(F.Dr)(F.vt)&&(this._campaignDefinitions.push(w),this._campaignDefinitions.push(E),this._campaignDefinitions.push(A),this._campaignDefinitions.push(k)),Object(F.Dr)(F.vn)&&(this._campaignDefinitions.push(M),this._campaignDefinitions.push(P),this._campaignDefinitions.push(T)),this._userInfoProvider.getIsPremium(!1).then(function(e){n._isPremium=e,e&&Object(F.Dr)(F.In)&&n._campaignDefinitions.push(C)})}}return e.prototype.dispose=function(){this._eventGroup.dispose()},e.prototype.recordUserAction=function(e,t){var n=this;this.waitForFloodgateInit().then(function(){var t=n._getEngine();t&&t.getActivityListener().logActivity(e)})},e.prototype.waitForFloodgateInit=function(){return this._initPromise||(this._initPromise=this._initFloodgate()),this._initPromise},e.prototype.processViewParams=function(e){e[m.t]&&this._resetAllSurveyStatuses();var t=e[m.n];t&&this._resetSurveyStatusByCampaignId(t);var n=e.origin;"createList"===n?this.recordUserAction(m.e):Object(F.Dr)(F.K)&&"createListFromTemplate"===n&&this.recordUserAction("CreateListFromTemplate")},e.prototype._initFloodgate=function(){var e=this;return n.e(1).then(n.t.bind(null,4009,7)).then(function(){var t=new o.e({name:"Floodgate.Initialized"});if(!window.OfficeBrowserFeedback||!window.OfficeBrowserFeedback.floodgate)return t.end({resultCode:"FloodgateNotLoaded",resultType:s.e.ExpectedFailure,extraData:{error:"Floodgate SDK not loaded."}}),e._engagement.logData({name:"Floodgate.SdkNotLoaded",extraData:{error:"Floodgate SDK not loaded."}}),Promise.resolve();try{localStorage.setItem("test","test"),localStorage.removeItem("test")}catch(n){return t.end({resultCode:"LocalStorageDisabled",resultType:s.e.ExpectedFailure,extraData:{error:"Local storage not enabled."}}),e._engagement.logData({name:"Floodgate.LocalStorageNotEnabled",extraData:{error:"Local storage not enabled."}}),Promise.resolve()}window.OfficeBrowserFeedback.initOptions={appId:e._appId,stylesUrl:window.require.toUrl("@ms-ofb/officebrowserfeedback/styles/officebrowserfeedback.css"),intlUrl:window.require.toUrl("@ms-ofb/officebrowserfeedback/intl")+"/",environment:e._computeCurrentEnvironment(),sessionId:e._sessionId,locale:H.e.language,primaryColour:j.n.themePrimary,secondaryColour:j.n.themeSecondary,build:e._computeBuildVersion()};var n={newAllPhotosExperience:e._isItemsScopeEnabledInAllPhotosPivotResource,isPremium:e._isPremium},a=Object(U.t)();a&&(n=Object(i.__assign)(Object(i.__assign)({},n),{lastActionBeforeNPSSurvey:Object(U.e)(a.actionName),extension:a.extension,objectType:a.objectType,currentPage:a.currentPage})),window.OfficeBrowserFeedback.initOptions.applicationGroup={appData:JSON.stringify(n)};var r=window.FilesConfig&&window.FilesConfig.df;return e._pageContext&&e._pageContext.isSPO&&(r=e._pageContext.farmName.indexOf("MSIT_SPDF")>-1),window.OfficeBrowserFeedback.initOptions.telemetryGroup={audienceGroup:r?"Dogfood":"Production",officeUILang:e._computeLanguage(),loggableUserId:e._getUserId()},e._pageContext&&e._pageContext.isSPO&&e._pageContext.aadTenantId?window.OfficeBrowserFeedback.initOptions.telemetryGroup.tenantId=e._pageContext.aadTenantId:window.OfficeBrowserFeedback.initOptions.telemetryGroup.tenantId="00000000-0000-0000-0000-000000000000",e._pageContext&&e._pageContext.isSPO&&void 0!==e._pageContext.listBaseType&&(Object(V.a)(e._pageContext.listBaseType)?window.OfficeBrowserFeedback.initOptions.telemetryGroup.featureArea="Libraries":window.OfficeBrowserFeedback.initOptions.telemetryGroup.featureArea="List"),e._platformDetection&&(window.OfficeBrowserFeedback.initOptions.telemetryGroup.platform=e._platformDetection.osName,window.OfficeBrowserFeedback.initOptions.webGroup={browser:e._platformDetection.browserName}),window.OfficeBrowserFeedback.initOptions.telemetryGroup.channel="CC",window.OfficeBrowserFeedback.floodgate.initOptions={campaignDefinitions:e._campaignDefinitions,onDismiss:e._onSurveyDismissed,onSurveyActivatedCallback:{onSurveyActivated:e._onSurveyActivated}},window.OfficeBrowserFeedback.floodgate.initialize().then(function(){return window.OfficeBrowserFeedback.floodgate.start().then(function(){var n=e._getEngine();if(!n)throw"Floodgate engine initialization failed silently.";var a=n.getActivityListener();a.logActivityStartTime("AppUsageTime"),a.logActivity("AppResume"),e._setupEventListeners(),t.end({resultType:s.e.Success}),e._engagement.logData({name:"Floodgate.Initialized"})})}).catch(function(n){t.end({resultCode:"FloodgateInitializationFailure",resultType:s.e.Failure}),e._engagement.logData({name:"Floodgate.FailedToInitialize",extraData:{error:n}})})})},e.prototype._getActiveOneDriveNpsCampaign=function(){return Object(F.Dr)(F.Sn)?v:Object(F.Dr)(F.yn)?g:b},e.prototype._getEngine=function(){if(window.OfficeBrowserFeedback&&window.OfficeBrowserFeedback.floodgate)return window.OfficeBrowserFeedback.floodgate.getEngine()},e.prototype._computeCurrentEnvironment=function(){return 0},e.prototype._computeBuildVersion=function(){var e=z.t.isActivated("92557910-4C5C-4204-8F39-A11BF1AD085E","10/26/20","STS regex"),t=window._spModuleLink&&window._spModuleLink.buildNumber||window.Flight&&window.Flight.version;if(t){var n=e?t.match(/\d{4}-\d{2}-\d{2}(-sts)?_\d{8}\.\d{3}/):t.match(/\d{4}-\d{2}-\d{2}_\d{8}\.\d{3}/);if(n)return n[0].replace(/-/g,"").replace("_",".")}},e.prototype._computeLanguage=function(){if(this._pageContext){if(this._pageContext.currentCultureLCID)return this._pageContext.currentCultureLCID;if(this._pageContext.currentLanguage)return this._pageContext.currentLanguage}else if($Config&&$Config.langPref)return $Config.langPref},e.prototype._getUserId=function(){if(!z.t.isActivated("FAB40378-F3AE-4D14-88B8-E7EE827CCA3B","03/15/2022","Return userId"))return this._pageContext&&this._pageContext.aadUserId?this._pageContext.aadUserId:$Config&&$Config.hcid?$Config.hcid:B.e.Empty},e.prototype._setupEventListeners=function(){var e=this,t=this._getEngine();this._eventGroup.on(window,"blur",function(){t&&(t.getActivityListener().logActivityStopTime("AppUsageTime"),window.OfficeBrowserFeedback.floodgate.stop())}),this._eventGroup.on(window,"unload",function(){t&&(t.getActivityListener().logActivityStopTime("AppUsageTime"),window.OfficeBrowserFeedback.floodgate.stop())}),this._eventGroup.on(window,"focus",function(){window.OfficeBrowserFeedback&&window.OfficeBrowserFeedback.floodgate&&window.OfficeBrowserFeedback.floodgate.start().then(function(){var e=window.OfficeBrowserFeedback.floodgate.getEngine().getActivityListener();e.logActivityStartTime("AppUsageTime"),e.logActivity("AppResume")}).catch(function(t){e._engagement.logData({name:"Floodgate.FailedToReinitialize",extraData:{error:t}})})})},e.prototype._resetSurveyStatusByCampaignId=function(e){this._userInfoProvider.setSurveyStatusUserFact(e,{activated:!1,dateLastModified:new Date}).then(function(t){t&&console.log("UserFact successfully reset: "+e)})},e.prototype._resetAllSurveyStatuses=function(){var e=new Set;for(var t in a){var n=a[t];e.has(n.CampaignId)||(e.add(n.CampaignId),this._resetSurveyStatusByCampaignId(n.CampaignId))}},e.dependencies={engagement:c.e,userInfoProvider:d.M,platformDetection:l.e,appId:u.e,pageContext:N.s.optional,isItemsScopeEnabledInAllPhotosPivotResource:f.n},e}(),W=Object(R.r)("FloodgateDataSource",K)},1712:function(e,t,n){"use strict";n.d(t,"u",function(){return s}),n.d(t,"r",function(){return c}),n.d(t,"o",function(){return d}),n.d(t,"s",function(){return l}),n.d(t,"n",function(){return u}),n.d(t,"c",function(){return f}),n.d(t,"l",function(){return p}),n.d(t,"d",function(){return m}),n.d(t,"t",function(){return _}),n.d(t,"i",function(){return h}),n.d(t,"a",function(){return b}),n.d(t,"e",function(){return g}),n.d(t,"f",function(){return v}),n.d(t,"m",function(){return y}),n.d(t,"p",function(){return S});var a=n(8),i=n(1794),r=n(7),o=n(204),s=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabled"),factory:{dependencies:{},create:function(e){return{instance:r.xr?Object(r.Dr)(r.Ri)||Object(r.Dr)(r.Wi):Object(r.Dr)(r.Qi)}}}}),c=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInFilesPivot"),factory:{dependencies:{},create:function(){return{instance:r.xr?Object(r.Dr)(r.Ri):Object(r.Dr)(r.Qi)}}}}),d=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInRecentPivot"),factory:{dependencies:{},create:function(){return{instance:Object(r.Dr)(r.Xe)}}}}),l=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSharedPivot"),factory:{dependencies:{},create:function(){return{instance:Object(r.Dr)(r.ji)}}}}),u=(new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInCrossSitePivots"),factory:{dependencies:{},create:function(){return{instance:!!r.xr&&Object(r.Dr)(r.Wi)}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPhotosPivot"),factory:{dependencies:{platformDetection:o.e},create:function(e){return{instance:Object(r.Dr)(r.Li)&&(!e.platformDetection.isIE||Object(r.Dr)(r.ki))&&(!e.platformDetection.isSafari||Object(r.Dr)(r.Ti))&&(!e.platformDetection.isMobile||Object(r.Dr)(r.Pi))}}}})),f=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSingleAlbumView"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.Dr)(r.zi)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),p=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSingleTagView"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.Dr)(r.Ki)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),m=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSinglePlace"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.Dr)(r.Gi)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),_=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPhotosFilePicker"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.Dr)(r.Mi)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),h=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllTagsPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.Dr)(r.Ui)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),b=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPlacesPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.Dr)(r.Ni)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),g=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllAlbumsPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.Dr)(r.Ai)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),v=new a.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInAllPhotosPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(i.t)()&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),y=new a.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInSingleTagView"),factory:{dependencies:{isItemsScopeEnabledInSingleTagView:p},create:function(e){return{instance:Object(r.Dr)(r.gr)&&e.isItemsScopeEnabledInSingleTagView}}}}),S=new a.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInSinglePlaceView"),factory:{dependencies:{isItemsScopeEnabledInSinglePlaceView:m},create:function(e){return{instance:Object(r.Dr)(r.br)&&e.isItemsScopeEnabledInSinglePlaceView}}}})},1794:function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"t",function(){return l});var a=n(143),i=n(1797),r=n(1798),o=n(11),s=n(16),c=n(81);function d(){return function(e){var t=e(Object(a.e)(function(e){return e.demandItemFacet(s.o,s.i)})),n=null==t?void 0:t.consume(c.e);return(null==n?void 0:n.viewParams)||{}}}function l(){return function(e){var t=e(Object(a.e)(function(e){return e.demandItemFacet(r.e,i.e)}));return Object(o.isFeatureEnabled)(o.UseVroomInItemsScopeAllPhotos)||Boolean(t&&t.isUseVroomInItemsScopeAllPhotosOtdExpOn())}}},1797:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(31).e)("photosExperimentHelperKeyFacet",{}).serialize({})},1798:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("photosExperimentHelper")},2189:function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"t",function(){return d});var a=n(0),i={themeName:"Office",themeDescription:"Default theme",themePrimary:"#0078d4",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#005a9e",themeDarker:"#004578",neutralLighterAlt:"#f8f8f8",neutralLighter:"#f4f4f4",neutralLight:"#eaeaea",neutralQuaternaryAlt:"#dadada",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c8c8",neutralTertiary:"#a6a6a6",neutralSecondaryAlt:"#767676",neutralSecondary:"#666666",neutralPrimary:"#333",neutralPrimaryAlt:"#3c3c3c",neutralDark:"#212121",black:"#000000",white:"#fff",primaryBackground:"#fff",primaryText:"#333"},r={themeName:"Dark Mode",themeDescription:"(Dark) A dark theme based on the default.",themePrimary:"#2899f5",themeLighterAlt:"#0c2031",themeLighter:"#043862",themeLight:"#092C47",themeTertiary:"#185f00",themeSecondary:"#004C87",themeDarkAlt:"#3AA0F3",themeDark:"#6CB8F6",themeDarker:"#82c7ff",neutralLighterAlt:"#282828",neutralLighter:"#201f1e",neutralLight:"#252423",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondary:"#a19f9d",neutralPrimaryAlt:"#c8c6c4",neutralPrimary:"#f3f2f1",neutralDark:"#FAF9F8",black:"#ffffff",white:"#1b1a19",primaryBackground:"#1f1f1f",primaryText:"#f3f2f1",bodyBackground:"#1f1f1f",bodyText:"#ffffff",disabledBackground:"#1d1d1d",disabledText:"#797775"},o={themeName:"ODB Dark Mode",themeDescription:"ODB dark mode",themePrimary:"#2899f5",themeLighterAlt:"#092c47",themeLighter:"#043862",themeLight:"#004c87",themeTertiary:"#0078D4",themeSecondary:"#0078d4",themeDarkAlt:"#3aa0f3",themeDarker:"#82c7ff",themeDark:"#6cb8f6",neutralLighterAlt:"#201f1e",neutralLighter:"#252423",neutralLight:"#292827",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondaryAlt:"#979693",neutralSecondary:"#a19f9d",neutralPrimary:"#f3f2f1",neutralPrimaryAlt:"#c8c6c4",neutralDark:"#faf9f8",black:"#ffffff",white:"#1b1a19",redDark:"#F1707B",primaryBackground:"#1b1a19",primaryText:"#f3f2f1",whiteTranslucent40:"rgba(0,0,0,.5)",freOverlayColor:"rgba(0,0,0,.5)",shareSuccessIcon:"#92C353",wordColor:"#296FE6",powerpointColor:"#CA5010",excelColor:"#10893C",excelPrimaryColor:"#10893C",excelShade10Color:"#0F7937",excelShade20Color:"#0A5325",powerpointPrimaryColor:"#CA5010",powerpointShade10Color:"#B1470E",powerpointShade20Color:"#79310A",wordPrimaryColor:"#296FE6",wordShade10Color:"#2461CA",wordShade20Color:"#19428A",wordIconColor:"#598FEC",powerpointIconColor:"#D67540",excelIconColor:"#37A660",visoIconColor:"#598FEC",oneNoteIconColor:"#D0AFE2",oneUpPaneBackground:"rgba(27, 26, 25, .75)"},s={bodyBackground:o.primaryBackground,bodyStandoutBackground:o.neutralLight,buttonText:o.black,buttonTextPressed:o.neutralDark,buttonTextHovered:o.neutralPrimary,bodySubtext:o.neutralSecondary,disabledBackground:o.neutralQuaternaryAlt,errorText:o.redDark,inputBackgroundChecked:o.themePrimary,menuBackground:o.neutralLighter,menuItemBackgroundHovered:o.neutralQuaternaryAlt,menuItemBackgroundPressed:o.neutralQuaternary,menuDivider:o.neutralTertiaryAlt,menuIcon:o.themeDarkAlt,menuHeader:o.black,menuItemText:o.neutralPrimary,menuItemTextHovered:o.neutralDark,messageText:o.neutralPrimary,primaryButtonBackground:o.themeTertiary,primaryButtonBackgroundHovered:o.themeLight,primaryButtonBackgroundPressed:o.themeLighter,primaryButtonText:o.black,primaryButtonTextHovered:o.black,primaryButtonTextPressed:o.black,variantBorder:o.neutralQuaternary,infoBackground:o.neutralQuaternaryAlt,infoIcon:o.neutralPrimaryAlt,errorIcon:o.redDark,warningIcon:o.neutralPrimaryAlt,blockingIcon:"#442726",severeWarningIcon:"#FCE100",successIcon:"#92C353",errorBackground:"#442726",blockingBackground:"#442726",warningBackground:"#433519",severeWarningBackground:"#4F2A0F",successBackground:"#393D1B"},c=Object(a.__assign)(Object(a.__assign)({},o),{white:"#252423",neutralLighterAlt:"#292827",neutralLighter:"#323130",neutralLight:"#3B3A39",neutralQuaternaryAlt:"#484644",themePrimary:"#3AA0F3",themeDarkAlt:"#6CB8F6",themeDark:"#82C7FF"}),d=(Object(a.__assign)(Object(a.__assign)({},s),{bodyStandoutBackground:c.neutralLight,disabledBackground:c.neutralQuaternaryAlt,inputBackgroundChecked:c.themePrimary,menuBackground:c.neutralLighter,menuItemBackgroundHovered:c.neutralQuaternaryAlt,menuIcon:c.themeDarkAlt}),{palette:o,semanticColors:s,isInverted:!0})},2257:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r});var a="ListsAction",i="resetAllSurveyStatuses",r="resetSurveyStatusById"}}]);