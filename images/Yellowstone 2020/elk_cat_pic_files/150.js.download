/*! For license information please see 150.js.LICENSE.txt */
(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[150],{1771:function(e,t,n){"use strict";function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,a(e,t)}n.r(t),n.d(t,"Provider",function(){return u}),n.d(t,"connectAdvanced",function(){return v}),n.d(t,"ReactReduxContext",function(){return d}),n.d(t,"connect",function(){return K});var r=n(1),o=n.n(r),s=n(1699),c=n.n(s),d=o.a.createContext(null),l=function(e){function t(t){var n;n=e.call(this,t)||this;var a=t.store;return n.state={storeState:a.getState(),store:a},n}i(t,e);var n=t.prototype;return n.componentDidMount=function(){this._isMounted=!0,this.subscribe()},n.componentWillUnmount=function(){this.unsubscribe&&this.unsubscribe(),this._isMounted=!1},n.componentDidUpdate=function(e){this.props.store!==e.store&&(this.unsubscribe&&this.unsubscribe(),this.subscribe())},n.subscribe=function(){var e=this,t=this.props.store;this.unsubscribe=t.subscribe(function(){var n=t.getState();e._isMounted&&e.setState(function(e){return e.storeState===n?null:{storeState:n}})});var n=t.getState();n!==this.state.storeState&&this.setState({storeState:n})},n.render=function(){var e=this.props.context||d;return o.a.createElement(e.Provider,{value:this.state},this.props.children)},t}(r.Component);l.propTypes={store:c.a.shape({subscribe:c.a.func.isRequired,dispatch:c.a.func.isRequired,getState:c.a.func.isRequired}),context:c.a.object,children:c.a.any};var u=l;function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(){return p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},p.apply(this,arguments)}function m(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}var _=n(1320),h=n.n(_),b=n(47),g=n.n(b);function v(e,t){void 0===t&&(t={});var n=t,a=n.getDisplayName,s=void 0===a?function(e){return"ConnectAdvanced("+e+")"}:a,c=n.methodName,l=void 0===c?"connectAdvanced":c,u=n.renderCountProp,_=void 0===u?void 0:u,b=n.shouldHandleStateChanges,v=void 0===b||b,y=n.storeKey,S=void 0===y?"store":y,D=n.withRef,I=void 0!==D&&D,x=n.forwardRef,C=void 0!==x&&x,O=n.context,w=void 0===O?d:O,E=m(n,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"]);g()(void 0===_,"renderCountProp is removed. render counting is built into the latest React dev tools profiling extension"),g()(!I,"withRef is removed. To access the wrapped instance, use a ref on the connected component");var A="To use a custom Redux store for specific components,  create a custom React context with React.createContext(), and pass the context object to React-Redux's Provider and specific components like:  <Provider context={MyContext}><ConnectedComponent context={MyContext} /></Provider>. You may also pass a {context : MyContext} option to connect";g()("store"===S,"storeKey has been removed and does not do anything. "+A);var L=w;return function(t){var n=t.displayName||t.name||"Component",a=s(n),c=p({},E,{getDisplayName:s,methodName:l,renderCountProp:_,shouldHandleStateChanges:v,storeKey:S,displayName:a,wrappedComponentName:n,WrappedComponent:t}),d=E.pure,u=r.Component,m=t;d&&(u=r.PureComponent);var b=function(t){function n(n){var a,i,r,s,l,u,_,h,b;return a=t.call(this,n)||this,g()(C?!n.wrapperProps[S]:!n[S],"Passing redux store in props has been removed and does not do anything. "+A),a.selectDerivedProps=function(t,n,a){if(d&&i===n&&r===t)return s;a!==l&&(l=a,u=e(a.dispatch,c)),i=n,r=t;var o=u(t,n);return s===o?s:s=o},a.selectChildElement=function(e,t){return e===_&&t===h||(_=e,h=t,b=o.a.createElement(m,p({},e,{ref:t}))),b},a.renderWrappedComponent=a.renderWrappedComponent.bind(f(f(a))),a}i(n,t);var r=n.prototype;return r.renderWrappedComponent=function(e){g()(e,'Could not find "store" in the context of "'+a+'". Either wrap the root component in a <Provider>, or pass a custom React context provider to <Provider> and the corresponding React context consumer to '+a+" in connect options.");var t,n=e.storeState,i=e.store,r=this.props;C&&(r=this.props.wrapperProps,t=this.props.forwardedRef);var o=this.selectDerivedProps(n,r,i);return this.selectChildElement(o,t)},r.render=function(){var e=this.props.context||L;return o.a.createElement(e.Consumer,null,this.renderWrappedComponent)},n}(u);if(b.WrappedComponent=t,b.displayName=a,C){var y=o.a.forwardRef(function(e,t){return o.a.createElement(b,{wrapperProps:e,forwardedRef:t})});return y.displayName=a,y.WrappedComponent=t,h()(y,t)}return h()(b,t)}}n(1481);var y=Object.prototype.hasOwnProperty;function S(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function D(e,t){if(S(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(var i=0;i<n.length;i++)if(!y.call(t,n[i])||!S(e[n[i]],t[n[i]]))return!1;return!0}n(1021);var I=function(){return Math.random().toString(36).substring(7).split("").join(".")};function x(e,t){return function(){return t(e.apply(this,arguments))}}function C(e){return function(t,n){var a=e(t,n);function i(){return a}return i.dependsOnOwnProps=!1,i}}function O(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function w(e,t){return function(t,n){n.displayName;var a=function(e,t){return a.dependsOnOwnProps?a.mapToProps(e,t):a.mapToProps(e)};return a.dependsOnOwnProps=!0,a.mapToProps=function(t,n){a.mapToProps=e,a.dependsOnOwnProps=O(e);var i=a(t,n);return"function"==typeof i&&(a.mapToProps=i,a.dependsOnOwnProps=O(i),i=a(t,n)),i},a}}function E(e,t,n){return p({},n,e,t)}I(),I();var A=[function(e){return"function"==typeof e?function(e){return function(t,n){n.displayName;var a,i=n.pure,r=n.areMergedPropsEqual,o=!1;return function(t,n,s){var c=e(t,n,s);return o?i&&r(c,a)||(a=c):(o=!0,a=c),a}}}(e):void 0},function(e){return e?void 0:function(){return E}}];function L(e,t,n,a){return function(i,r){return n(e(i,r),t(a,r),r)}}function k(e,t,n,a,i){var r,o,s,c,d,l=i.areStatesEqual,u=i.areOwnPropsEqual,f=i.areStatePropsEqual,p=!1;return function(i,m){return p?function(i,p){var m,_,h=!u(p,o),b=!l(i,r);return r=i,o=p,h&&b?(s=e(r,o),t.dependsOnOwnProps&&(c=t(a,o)),d=n(s,c,o)):h?(e.dependsOnOwnProps&&(s=e(r,o)),t.dependsOnOwnProps&&(c=t(a,o)),d=n(s,c,o)):b?(m=e(r,o),_=!f(m,s),s=m,_&&(d=n(s,c,o)),d):d}(i,m):(s=e(r=i,o=m),c=t(a,o),d=n(s,c,o),p=!0,d)}}function M(e,t,n){for(var a=t.length-1;a>=0;a--){var i=t[a](e);if(i)return i}return function(t,a){throw new Error("Invalid value of type "+typeof e+" for "+n+" argument when connecting component "+a.wrappedComponentName+".")}}function P(e,t){return e===t}var T,U,F,H,R,N,B,j,V,z,G,K=(U=(T={}).connectHOC,F=void 0===U?v:U,R=void 0===(H=T.mapStateToPropsFactories)?[function(e){return"function"==typeof e?w(e):void 0},function(e){return e?void 0:C(function(){return{}})}]:H,B=void 0===(N=T.mapDispatchToPropsFactories)?[function(e){return"function"==typeof e?w(e):void 0},function(e){return e?void 0:C(function(e){return{dispatch:e}})},function(e){return e&&"object"==typeof e?C(function(t){return function(e,t){if("function"==typeof e)return x(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var n=Object.keys(e),a={},i=0;i<n.length;i++){var r=n[i],o=e[r];"function"==typeof o&&(a[r]=x(o,t))}return a}(e,t)}):void 0}]:N,V=void 0===(j=T.mergePropsFactories)?A:j,G=void 0===(z=T.selectorFactory)?function(e,t){var n=t.initMapStateToProps,a=t.initMapDispatchToProps,i=t.initMergeProps,r=m(t,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),o=n(e,r),s=a(e,r),c=i(e,r);return(r.pure?k:L)(o,s,c,e,r)}:z,function(e,t,n,a){void 0===a&&(a={});var i=a,r=i.pure,o=void 0===r||r,s=i.areStatesEqual,c=void 0===s?P:s,d=i.areOwnPropsEqual,l=void 0===d?D:d,u=i.areStatePropsEqual,f=void 0===u?D:u,_=i.areMergedPropsEqual,h=void 0===_?D:_,b=m(i,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),g=M(e,R,"mapStateToProps"),v=M(t,B,"mapDispatchToProps"),y=M(n,V,"mergeProps");return F(G,p({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:g,initMapDispatchToProps:v,initMergeProps:y,pure:o,areStatesEqual:c,areOwnPropsEqual:l,areStatePropsEqual:f,areMergedPropsEqual:h},b))})},1901:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(1513),i=n(3),r=n(1),o=n(95),s=n(952),c=Object(s.e)({cacheSize:100}),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.as,n=void 0===t?"label":t,a=e.children,s=e.className,d=e.disabled,l=e.styles,u=e.required,f=e.theme,p=c(l,{className:s,disabled:d,required:u,theme:f});return r.createElement(n,Object(i.e)({},Object(o.s)(this.props,o.r),{className:p.root}),a)},t}(r.Component),l=n(33),u=Object(a.e)(d,function(e){var t,n=e.theme,a=e.className,r=e.disabled,o=e.required,s=n.semanticColors,c=l.i.semibold,d=s.bodyText,u=s.disabledBodyText,f=s.errorText;return{root:["ms-Label",n.fonts.medium,{fontWeight:c,color:d,boxSizing:"border-box",boxShadow:"none",margin:0,display:"block",padding:"5px 0",wordWrap:"break-word",overflowWrap:"break-word"},r&&{color:u,selectors:(t={},t[l.r]=Object(i.e)({color:"GrayText"},Object(l.x)()),t)},o&&{selectors:{"::after":{content:"' *'",color:f,paddingRight:12}}},a]}},void 0,{scope:"Label"})},2049:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=n(1537).e},2057:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(3),i=n(1),r=n(953),o=n(1381),s=n(95),c=function(e){function t(t){var n=e.call(this,t)||this;return Object(r.e)(n),Object(o.e)("PivotItem",t,{linkText:"headerText"}),n}return Object(a.a)(t,e),t.prototype.render=function(){return i.createElement("div",Object(a.e)({},Object(s.s)(this.props,s.r)),this.props.children)},t}(i.Component)},2117:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(248);function i(e,t,n,i,r){return i===a.e||"number"!=typeof i?"#"+r:"rgba("+e+", "+t+", "+n+", "+i/a.e+")"}},2231:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(248),i=n(1562),r=n(1137),o=n(2117);function s(e){var t=e.a,n=void 0===t?a.e:t,s=e.b,c=e.g,d=e.r,l=Object(i.e)(d,c,s),u=l.h,f=l.s,p=l.v,m=Object(r.e)(d,c,s);return{a:n,b:s,g:c,h:u,hex:m,r:d,s:f,str:Object(o.e)(d,c,s,n,m),v:p,t:a.e-n}}},2265:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(1),i=n(585);function r(e,t){var n=a.useRef(t);return n.current||(n.current=Object(i.e)(e)),n.current}},2373:function(e,t,n){"use strict";n.d(t,"e",function(){return w});var a,i,r=n(1513),o=n(3),s=n(1),c=n(952),d=n(953),l=n(585),u=n(95),f=n(49),p=n(502),m=n(97),_=n(2049),h=n(1663),b=n(326),g=n(2057);!function(e){e[e.links=0]="links",e[e.tabs=1]="tabs"}(a||(a={})),function(e){e[e.normal=0]="normal",e[e.large=1]="large"}(i||(i={}));var v=n(551),y=Object(c.e)(),S=function(e){function t(t){var n=e.call(this,t)||this;n._focusZone=s.createRef(),n._renderPivotLink=function(e,t,a){var i,r=t.itemKey,c=t.headerButtonProps,d=e.keyToTabIdMapping[r],l=t.onRenderItemLink,u=a===r;i=l?l(t,n._renderLinkContent):n._renderLinkContent(t);var f=t.headerText||"";return f+=t.itemCount?" ("+t.itemCount+")":"",f+=t.itemIcon?" xx":"",s.createElement(_.e,Object(o.e)({},c,{id:d,key:r,className:u?n._classNames.linkIsSelected:n._classNames.link,onClick:n._onLinkClick.bind(n,r),onKeyDown:n._onKeyDown.bind(n,r),"aria-label":t.ariaLabel,role:"tab","aria-selected":u,name:t.headerText,keytipProps:t.keytipProps,"data-content":f}),i)},n._renderLinkContent=function(e){var t=e.itemCount,a=e.itemIcon,i=e.headerText,r=n._classNames;return s.createElement("span",{className:r.linkContent},void 0!==a&&s.createElement("span",{className:r.icon},s.createElement(v.e,{iconName:a})),void 0!==i&&s.createElement("span",{className:r.text}," ",e.headerText),void 0!==t&&s.createElement("span",{className:r.count}," (",t,")"))},Object(d.e)(n),n._pivotId=Object(l.e)("Pivot");var a,i=n._getPivotLinks(t).links,r=t.defaultSelectedKey,c=void 0===r?t.initialSelectedKey:r,u=t.defaultSelectedIndex,f=void 0===u?t.initialSelectedIndex:u;return c?a=c:"number"==typeof f?a=i[f].itemKey:i.length&&(a=i[0].itemKey),n.state={selectedKey:a},n}return Object(o.a)(t,e),t.prototype.focus=function(){this._focusZone.current&&this._focusZone.current.focus()},t.prototype.render=function(){var e=this,t=this.props.focusZoneProps,n=this._getPivotLinks(this.props),a=this._getSelectedKey(n),i=Object(u.s)(this.props,u.r);return this._classNames=this._getClassNames(this.props),s.createElement("div",Object(o.e)({role:"toolbar"},i),this._renderPivotLinks(n,a,t),a&&n.links.map(function(t){return(!0===t.alwaysRender||a===t.itemKey)&&e._renderPivotItem(n,t.itemKey,a===t.itemKey)}))},t.prototype._getSelectedKey=function(e){var t=this.props.selectedKey;if(this._isKeyValid(e,t)||null===t)return t;var n=this.state.selectedKey;return this._isKeyValid(e,n)?n:e.links.length?e.links[0].itemKey:void 0},t.prototype._renderPivotLinks=function(e,t,n){var a,i=this,r=e.links.map(function(n){return i._renderPivotLink(e,n,t)});return s.createElement(h.e,Object(o.e)({role:"tablist",componentRef:this._focusZone,direction:b.e.horizontal},n,{className:Object(f.e)(this._classNames.root,null===(a=n)||void 0===a?void 0:a.className)}),r)},t.prototype._renderPivotItem=function(e,t,n){if(this.props.headersOnly||!t)return null;var a=e.keyToIndexMapping[t],i=e.keyToTabIdMapping[t];return s.createElement("div",{role:"tabpanel",hidden:!n,key:t,"aria-hidden":!n,"aria-labelledby":i,className:this._classNames.itemContainer},s.Children.toArray(this.props.children)[a])},t.prototype._getPivotLinks=function(e){var t=this,n={links:[],keyToIndexMapping:{},keyToTabIdMapping:{}};return s.Children.map(s.Children.toArray(e.children),function(e,a){if(D(e)){var i=e,r=i.props,s=r.linkText,c=Object(o.r)(r,["linkText"]),d=i.props.itemKey||a.toString();n.links.push(Object(o.e)(Object(o.e)({headerText:s},c),{itemKey:d})),n.keyToIndexMapping[d]=a,n.keyToTabIdMapping[d]=t._getTabId(d,a)}else Object(p.e)("The children of a Pivot component must be of type PivotItem to be rendered.")}),n},t.prototype._getTabId=function(e,t){return this.props.getTabId?this.props.getTabId(e,t):this._pivotId+"-Tab"+t},t.prototype._isKeyValid=function(e,t){return null!=t&&void 0!==e.keyToIndexMapping[t]},t.prototype._onLinkClick=function(e,t){t.preventDefault(),this._updateSelectedItem(e,t)},t.prototype._onKeyDown=function(e,t){t.which===m.e.enter&&(t.preventDefault(),this._updateSelectedItem(e))},t.prototype._updateSelectedItem=function(e,t){this.setState({selectedKey:e});var n=this._getPivotLinks(this.props);if(this.props.onLinkClick&&n.keyToIndexMapping[e]>=0){var a=n.keyToIndexMapping[e],i=s.Children.toArray(this.props.children)[a];D(i)&&this.props.onLinkClick(i,t)}},t.prototype._getClassNames=function(e){var t=e.theme,n=e.linkSize===i.large,r=e.linkFormat===a.tabs;return y(e.styles,{theme:t,rootIsLarge:n,rootIsTabs:r})},t}(s.Component);function D(e){return!!e&&"object"==typeof e&&!!e.type&&e.type.name===g.e.name}var I=n(33),x=n(530),C={count:"ms-Pivot-count",icon:"ms-Pivot-icon",linkIsSelected:"is-selected",link:"ms-Pivot-link",linkContent:"ms-Pivot-linkContent",root:"ms-Pivot",rootIsLarge:"ms-Pivot--large",rootIsTabs:"ms-Pivot--tabs",text:"ms-Pivot-text"},O=function(e){var t,n,a=e.rootIsLarge,i=e.rootIsTabs,r=e.theme,o=r.semanticColors,s=r.fonts;return[s.medium,{color:o.actionLink,display:"inline-block",lineHeight:44,height:44,marginRight:8,padding:"0 8px",textAlign:"center",position:"relative",backgroundColor:"transparent",border:0,borderRadius:0,selectors:(t={":before":{backgroundColor:"transparent",bottom:0,content:'""',height:2,left:8,position:"absolute",right:8,transition:"left "+I.n.durationValue2+" "+I.n.easeFunction2+",\n                      right "+I.n.durationValue2+" "+I.n.easeFunction2},":after":{color:"transparent",content:"attr(data-content)",display:"block",fontWeight:I.i.bold,height:1,overflow:"hidden",visibility:"hidden"},":hover":{backgroundColor:o.buttonBackgroundHovered,color:o.buttonTextHovered,cursor:"pointer"},":active":{backgroundColor:o.buttonBackgroundPressed,color:o.buttonTextHovered},":focus":{outline:"none"}},t["."+x.e+" &:focus"]={outline:"1px solid "+o.focusBorder},t["."+x.e+" &:focus:after"]={content:"attr(data-content)",position:"relative",border:0},t)},a&&{fontSize:s.large.fontSize},i&&[{marginRight:0,height:44,lineHeight:44,backgroundColor:o.buttonBackground,padding:"0 10px",verticalAlign:"top",selectors:(n={":focus":{outlineOffset:"-1px"}},n["."+x.e+" &:focus::before"]={height:"auto",background:"transparent",transition:"none"},n)}]]},w=Object(r.e)(S,function(e){var t,n,a,i=e.className,r=e.rootIsLarge,s=e.rootIsTabs,c=e.theme,d=c.semanticColors,l=c.fonts,u=Object(I.I)(C,c);return{root:[u.root,l.medium,I.H,{position:"relative",color:d.link,whiteSpace:"nowrap"},r&&u.rootIsLarge,s&&u.rootIsTabs,i],itemContainer:{selectors:{"&[hidden]":{display:"none"}}},link:Object(o.o)([u.link],O(e),[s&&{selectors:{"&:hover, &:focus":{color:d.buttonTextCheckedHovered},"&:active, &:hover":{color:d.primaryButtonText,backgroundColor:d.primaryButtonBackground}}}]),linkIsSelected:Object(o.o)([u.link,u.linkIsSelected],O(e),[{fontWeight:I.i.semibold,selectors:(t={":before":{backgroundColor:d.inputBackgroundChecked,selectors:(n={},n[I.r]={backgroundColor:"Highlight"},n)},":hover::before":{left:0,right:0}},t[I.r]={color:"Highlight"},t)},s&&{backgroundColor:d.primaryButtonBackground,color:d.primaryButtonText,fontWeight:I.i.regular,selectors:(a={":before":{backgroundColor:"transparent",transition:"none",position:"absolute",top:0,left:0,right:0,bottom:0,content:'""',height:0},":hover":{backgroundColor:d.primaryButtonBackgroundHovered,color:d.primaryButtonText},"&:active":{backgroundColor:d.primaryButtonBackgroundPressed,color:d.primaryButtonText}},a[I.r]=Object(o.e)({fontWeight:I.i.semibold,color:"HighlightText",background:"Highlight"},Object(I.x)()),a)}]),linkContent:[u.linkContent,{flex:"0 1 100%",selectors:{"& > * ":{marginLeft:4},"& > *:first-child":{marginLeft:0}}}],text:[u.text,{display:"inline-block",verticalAlign:"top"}],count:[u.count,{display:"inline-block",verticalAlign:"top"}],icon:u.icon}},void 0,{scope:"Pivot"})},2567:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(3),i=n(1564),r=n(2231);function o(e){var t=Object(i.e)(e);if(t)return Object(a.e)(Object(a.e)({},Object(r.e)(t)),{str:e})}},2860:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=n(1).createContext(void 0)},3051:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(1),i=n(1373),r=n(537),o=n(2860),s=function(){var e=Object(a.useContext)(o.e),t=Object(i.e)(["theme"]).theme;return e||t||Object(r.e)({})}},3370:function(e,t,n){var a;!function(i,r,o,s){"use strict";var c,d=["","webkit","Moz","MS","ms","o"],l=r.createElement("div"),u=Math.round,f=Math.abs,p=Date.now;function m(e,t,n){return setTimeout(S(e,n),t)}function _(e,t,n){return!!Array.isArray(e)&&(h(e,n[t],n),!0)}function h(e,t,n){var a;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==s)for(a=0;a<e.length;)t.call(n,e[a],a,e),a++;else for(a in e)e.hasOwnProperty(a)&&t.call(n,e[a],a,e)}function b(e,t,n){var a="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",r=i.console&&(i.console.warn||i.console.log);return r&&r.call(i.console,a,n),e.apply(this,arguments)}}c="function"!=typeof Object.assign?function(e){if(e===s||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var a=arguments[n];if(a!==s&&null!==a)for(var i in a)a.hasOwnProperty(i)&&(t[i]=a[i])}return t}:Object.assign;var g=b(function(e,t,n){for(var a=Object.keys(t),i=0;i<a.length;)(!n||n&&e[a[i]]===s)&&(e[a[i]]=t[a[i]]),i++;return e},"extend","Use `assign`."),v=b(function(e,t){return g(e,t,!0)},"merge","Use `assign`.");function y(e,t,n){var a,i=t.prototype;(a=e.prototype=Object.create(i)).constructor=e,a._super=i,n&&c(a,n)}function S(e,t){return function(){return e.apply(t,arguments)}}function D(e,t){return"function"==typeof e?e.apply(t&&t[0]||s,t):e}function I(e,t){return e===s?t:e}function x(e,t,n){h(E(t),function(t){e.addEventListener(t,n,!1)})}function C(e,t,n){h(E(t),function(t){e.removeEventListener(t,n,!1)})}function O(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function w(e,t){return e.indexOf(t)>-1}function E(e){return e.trim().split(/\s+/g)}function A(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var a=0;a<e.length;){if(n&&e[a][n]==t||!n&&e[a]===t)return a;a++}return-1}function L(e){return Array.prototype.slice.call(e,0)}function k(e,t,n){for(var a=[],i=[],r=0;r<e.length;){var o=t?e[r][t]:e[r];A(i,o)<0&&a.push(e[r]),i[r]=o,r++}return n&&(a=t?a.sort(function(e,n){return e[t]>n[t]}):a.sort()),a}function M(e,t){for(var n,a,i=t[0].toUpperCase()+t.slice(1),r=0;r<d.length;){if((a=(n=d[r])?n+i:t)in e)return a;r++}return s}var P=1;function T(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||i}var U="ontouchstart"in i,F=M(i,"PointerEvent")!==s,H=U&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),R="touch",N="mouse",B=["x","y"],j=["clientX","clientY"];function V(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){D(e.options.enable,[e])&&n.handler(t)},this.init()}function z(e,t,n){var a=n.pointers.length,i=n.changedPointers.length,r=1&t&&a-i==0,o=12&t&&a-i==0;n.isFirst=!!r,n.isFinal=!!o,r&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,a=t.pointers,i=a.length;n.firstInput||(n.firstInput=G(t)),i>1&&!n.firstMultiple?n.firstMultiple=G(t):1===i&&(n.firstMultiple=!1);var r=n.firstInput,o=n.firstMultiple,c=o?o.center:r.center,d=t.center=K(a);t.timeStamp=p(),t.deltaTime=t.timeStamp-r.timeStamp,t.angle=Y(c,d),t.distance=Q(c,d),function(e,t){var n=t.center,a=e.offsetDelta||{},i=e.prevDelta||{},r=e.prevInput||{};1!==t.eventType&&4!==r.eventType||(i=e.prevDelta={x:r.deltaX||0,y:r.deltaY||0},a=e.offsetDelta={x:n.x,y:n.y}),t.deltaX=i.x+(n.x-a.x),t.deltaY=i.y+(n.y-a.y)}(n,t),t.offsetDirection=q(t.deltaX,t.deltaY);var l,u,m=W(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=m.x,t.overallVelocityY=m.y,t.overallVelocity=f(m.x)>f(m.y)?m.x:m.y,t.scale=o?(l=o.pointers,Q((u=a)[0],u[1],j)/Q(l[0],l[1],j)):1,t.rotation=o?function(e,t){return Y(t[1],t[0],j)+Y(e[1],e[0],j)}(o.pointers,a):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,a,i,r,o=e.lastInterval||t,c=t.timeStamp-o.timeStamp;if(8!=t.eventType&&(c>25||o.velocity===s)){var d=t.deltaX-o.deltaX,l=t.deltaY-o.deltaY,u=W(c,d,l);a=u.x,i=u.y,n=f(u.x)>f(u.y)?u.x:u.y,r=q(d,l),e.lastInterval=t}else n=o.velocity,a=o.velocityX,i=o.velocityY,r=o.direction;t.velocity=n,t.velocityX=a,t.velocityY=i,t.direction=r}(n,t);var _=e.element;O(t.srcEvent.target,_)&&(_=t.srcEvent.target),t.target=_}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function G(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:u(e.pointers[n].clientX),clientY:u(e.pointers[n].clientY)},n++;return{timeStamp:p(),pointers:t,center:K(t),deltaX:e.deltaX,deltaY:e.deltaY}}function K(e){var t=e.length;if(1===t)return{x:u(e[0].clientX),y:u(e[0].clientY)};for(var n=0,a=0,i=0;i<t;)n+=e[i].clientX,a+=e[i].clientY,i++;return{x:u(n/t),y:u(a/t)}}function W(e,t,n){return{x:t/e||0,y:n/e||0}}function q(e,t){return e===t?1:f(e)>=f(t)?e<0?2:4:t<0?8:16}function Q(e,t,n){n||(n=B);var a=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return Math.sqrt(a*a+i*i)}function Y(e,t,n){n||(n=B);var a=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return 180*Math.atan2(i,a)/Math.PI}V.prototype={handler:function(){},init:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(T(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(T(this.element),this.evWin,this.domHandler)}};var J={mousedown:1,mousemove:2,mouseup:4},X="mousedown",Z="mousemove mouseup";function $(){this.evEl=X,this.evWin=Z,this.pressed=!1,V.apply(this,arguments)}y($,V,{handler:function(e){var t=J[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:N,srcEvent:e}))}});var ee={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},te={2:R,3:"pen",4:N,5:"kinect"},ne="pointerdown",ae="pointermove pointerup pointercancel";function ie(){this.evEl=ne,this.evWin=ae,V.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(ne="MSPointerDown",ae="MSPointerMove MSPointerUp MSPointerCancel"),y(ie,V,{handler:function(e){var t=this.store,n=!1,a=e.type.toLowerCase().replace("ms",""),i=ee[a],r=te[e.pointerType]||e.pointerType,o=r==R,s=A(t,e.pointerId,"pointerId");1&i&&(0===e.button||o)?s<0&&(t.push(e),s=t.length-1):12&i&&(n=!0),s<0||(t[s]=e,this.callback(this.manager,i,{pointers:t,changedPointers:[e],pointerType:r,srcEvent:e}),n&&t.splice(s,1))}});var re={touchstart:1,touchmove:2,touchend:4,touchcancel:8},oe="touchstart",se="touchstart touchmove touchend touchcancel";function ce(){this.evTarget=oe,this.evWin=se,this.started=!1,V.apply(this,arguments)}function de(e,t){var n=L(e.touches),a=L(e.changedTouches);return 12&t&&(n=k(n.concat(a),"identifier",!0)),[n,a]}y(ce,V,{handler:function(e){var t=re[e.type];if(1===t&&(this.started=!0),this.started){var n=de.call(this,e,t);12&t&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:R,srcEvent:e})}}});var le={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ue="touchstart touchmove touchend touchcancel";function fe(){this.evTarget=ue,this.targetIds={},V.apply(this,arguments)}function pe(e,t){var n=L(e.touches),a=this.targetIds;if(3&t&&1===n.length)return a[n[0].identifier]=!0,[n,n];var i,r,o=L(e.changedTouches),s=[],c=this.target;if(r=n.filter(function(e){return O(e.target,c)}),1===t)for(i=0;i<r.length;)a[r[i].identifier]=!0,i++;for(i=0;i<o.length;)a[o[i].identifier]&&s.push(o[i]),12&t&&delete a[o[i].identifier],i++;return s.length?[k(r.concat(s),"identifier",!0),s]:void 0}function me(){V.apply(this,arguments);var e=S(this.handler,this);this.touch=new fe(this.manager,e),this.mouse=new $(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function _e(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,he.call(this,t)):12&e&&he.call(this,t)}function he(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var a=this.lastTouches;setTimeout(function(){var e=a.indexOf(n);e>-1&&a.splice(e,1)},2500)}}function be(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,a=0;a<this.lastTouches.length;a++){var i=this.lastTouches[a],r=Math.abs(t-i.x),o=Math.abs(n-i.y);if(r<=25&&o<=25)return!0}return!1}y(fe,V,{handler:function(e){var t=le[e.type],n=pe.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:R,srcEvent:e})}}),y(me,V,{handler:function(e,t,n){var a=n.pointerType==R,i=n.pointerType==N;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(a)_e.call(this,t,n);else if(i&&be.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ge=M(l.style,"touchAction"),ve=ge!==s,ye="compute",Se="auto",De="manipulation",Ie="none",xe="pan-x",Ce="pan-y",Oe=function(){if(!ve)return!1;var e={},t=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){e[n]=!t||i.CSS.supports("touch-action",n)}),e}();function we(e,t){this.manager=e,this.set(t)}we.prototype={set:function(e){e==ye&&(e=this.compute()),ve&&this.manager.element.style&&Oe[e]&&(this.manager.element.style[ge]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return h(this.manager.recognizers,function(t){D(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(e){if(w(e,Ie))return Ie;var t=w(e,xe),n=w(e,Ce);return t&&n?Ie:t||n?t?xe:Ce:w(e,De)?De:Se}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var a=this.actions,i=w(a,Ie)&&!Oe.none,r=w(a,Ce)&&!Oe["pan-y"],o=w(a,xe)&&!Oe["pan-x"];if(i){var s=1===e.pointers.length,c=e.distance<2,d=e.deltaTime<250;if(s&&c&&d)return}if(!o||!r)return i||r&&6&n||o&&24&n?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Ee=32;function Ae(e){this.options=c({},this.defaults,e||{}),this.id=P++,this.manager=null,this.options.enable=I(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Le(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function ke(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function Me(e,t){var n=t.manager;return n?n.get(e):e}function Pe(){Ae.apply(this,arguments)}function Te(){Pe.apply(this,arguments),this.pX=null,this.pY=null}function Ue(){Pe.apply(this,arguments)}function Fe(){Ae.apply(this,arguments),this._timer=null,this._input=null}function He(){Pe.apply(this,arguments)}function Re(){Pe.apply(this,arguments)}function Ne(){Ae.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Be(e,t){return(t=t||{}).recognizers=I(t.recognizers,Be.defaults.preset),new je(e,t)}function je(e,t){this.options=c({},Be.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new(this.options.inputClass||(F?ie:H?fe:U?me:$))(this,z),this.touchAction=new we(this,this.options.touchAction),Ve(this,!0),h(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function Ve(e,t){var n,a=e.element;a.style&&(h(e.options.cssProps,function(i,r){n=M(a.style,r),t?(e.oldCssProps[n]=a.style[n],a.style[n]=i):a.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={}))}Ae.prototype={defaults:{},set:function(e){return c(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(_(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Me(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return _(e,"dropRecognizeWith",this)||(e=Me(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(_(e,"requireFailure",this))return this;var t=this.requireFail;return-1===A(t,e=Me(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(_(e,"dropRequireFailure",this))return this;e=Me(e,this);var t=A(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function a(n){t.manager.emit(n,e)}n<8&&a(t.options.event+Le(n)),a(t.options.event),e.additionalEvent&&a(e.additionalEvent),n>=8&&a(t.options.event+Le(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Ee},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=c({},e);if(!D(this.options.enable,[this,t]))return this.reset(),void(this.state=Ee);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},y(Pe,Ae,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,a=6&t,i=this.attrTest(e);return a&&(8&n||!i)?16|t:a||i?4&n?8|t:2&t?4|t:2:Ee}}),y(Te,Pe,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(Ce),24&e&&t.push(xe),t},directionTest:function(e){var t=this.options,n=!0,a=e.distance,i=e.direction,r=e.deltaX,o=e.deltaY;return i&t.direction||(6&t.direction?(i=0===r?1:r<0?2:4,n=r!=this.pX,a=Math.abs(e.deltaX)):(i=0===o?1:o<0?8:16,n=o!=this.pY,a=Math.abs(e.deltaY))),e.direction=i,n&&a>t.threshold&&i&t.direction},attrTest:function(e){return Pe.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=ke(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),y(Ue,Pe,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ie]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),y(Fe,Ae,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Se]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,a=e.distance<t.threshold,i=e.deltaTime>t.time;if(this._input=e,!a||!n||12&e.eventType&&!i)this.reset();else if(1&e.eventType)this.reset(),this._timer=m(function(){this.state=8,this.tryEmit()},t.time,this);else if(4&e.eventType)return 8;return Ee},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),y(He,Pe,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ie]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),y(Re,Pe,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Te.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return 30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:24&n&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&f(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=ke(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),y(Ne,Ae,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[De]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,a=e.distance<t.threshold,i=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(a&&i&&n){if(4!=e.eventType)return this.failTimeout();var r=!this.pTime||e.timeStamp-this.pTime<t.interval,o=!this.pCenter||Q(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,o&&r?this.count+=1:this.count=1,this._input=e,0==this.count%t.taps)return this.hasRequireFailures()?(this._timer=m(function(){this.state=8,this.tryEmit()},t.interval,this),2):8}return Ee},failTimeout:function(){return this._timer=m(function(){this.state=Ee},this.options.interval,this),Ee},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Be.VERSION="2.0.7",Be.defaults={domEvents:!1,touchAction:ye,enable:!0,inputTarget:null,inputClass:null,preset:[[He,{enable:!1}],[Ue,{enable:!1},["rotate"]],[Re,{direction:6}],[Te,{direction:6},["swipe"]],[Ne],[Ne,{event:"doubletap",taps:2},["tap"]],[Fe]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},je.prototype={set:function(e){return c(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var a=this.recognizers,i=t.curRecognizer;(!i||i&&8&i.state)&&(i=t.curRecognizer=null);for(var r=0;r<a.length;)n=a[r],2===t.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(e),!i&&14&n.state&&(i=t.curRecognizer=n),r++}},get:function(e){if(e instanceof Ae)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(_(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(_(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=A(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==s&&t!==s){var n=this.handlers;return h(E(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this}},off:function(e,t){if(e!==s){var n=this.handlers;return h(E(e),function(e){t?n[e]&&n[e].splice(A(n[e],t),1):delete n[e]}),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=r.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var a=0;a<n.length;)n[a](t),a++}},destroy:function(){this.element&&Ve(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},c(Be,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Ee,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:je,Input:V,TouchAction:we,TouchInput:fe,MouseInput:$,PointerEventInput:ie,TouchMouseInput:me,SingleTouchInput:ce,Recognizer:Ae,AttrRecognizer:Pe,Tap:Ne,Pan:Te,Swipe:Re,Pinch:Ue,Rotate:He,Press:Fe,on:x,off:C,each:h,merge:v,extend:g,assign:c,inherit:y,bindFn:S,prefixed:M}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=Be,(a=function(){return Be}.call(t,n,t,e))===s||(e.exports=a)}(window,document)},3411:function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a=n(1513),i=n(3),r=n(1),o=n(416),s=n(1050),c=n(97),d=n(233),l=n(953),u=n(1383),f=n(585),p=n(49),m=n(1523),_=n(952),h=n(95),b=n(1901),g=Object(_.e)(),v="SliderBase",y=function(e){function t(t){var n=e.call(this,t)||this;n._disposables=[],n._sliderLine=r.createRef(),n._thumb=r.createRef(),n._lowerValueThumb=r.createRef(),n._onKeyDownTimer=-1,n._isAdjustingLowerValue=!1,n._getAriaValueText=function(e){var t=n.props.ariaValueText;if(void 0!==e)return t?t(e):e.toString()},n._calculateCurrentSteps=function(e){if(n._sliderLine.current){var t,a=n.props,i=(a.max-a.min)/a.step,r=n._sliderLine.current.getBoundingClientRect(),s=(n.props.vertical?r.height:r.width)/i;if(n.props.vertical){var c=n._getPosition(e,n.props.vertical);t=(r.bottom-c)/s}else{var d=n._getPosition(e,n.props.vertical);t=(Object(o.e)(n.props.theme)?r.right-d:d-r.left)/s}return t}},n._onMouseDownOrTouchStart=function(e){var t=n.props,a=t.ranged,i=t.min,r=t.step;if(a){var o=i+r*n._calculateCurrentSteps(e);o<=n.state.lowerValue||o-n.state.lowerValue<=n.state.value-o?n._isAdjustingLowerValue=!0:n._isAdjustingLowerValue=!1}"mousedown"===e.type?n._disposables.push(Object(s.e)(window,"mousemove",n._onMouseMoveOrTouchMove,!0),Object(s.e)(window,"mouseup",n._onMouseUpOrTouchEnd,!0)):"touchstart"===e.type&&n._disposables.push(Object(s.e)(window,"touchmove",n._onMouseMoveOrTouchMove,!0),Object(s.e)(window,"touchend",n._onMouseUpOrTouchEnd,!0)),n._onMouseMoveOrTouchMove(e,!0)},n._onMouseMoveOrTouchMove=function(e,t){if(n._sliderLine.current){var a,i,r=n.props,o=r.max,s=r.min,c=r.step,d=(o-s)/c,l=n._calculateCurrentSteps(e);l>Math.floor(d)?i=a=o:l<0?i=a=s:(i=s+c*l,a=s+c*Math.round(l)),n._updateValue(a,i),t||(e.preventDefault(),e.stopPropagation())}},n._onMouseUpOrTouchEnd=function(e){n.setState({renderedValue:void 0,renderedLowerValue:void 0}),n.props.onChanged&&n.props.onChanged(e,n.state.value),n._disposeListeners()},n._disposeListeners=function(){n._disposables.forEach(function(e){return e()}),n._disposables=[]},n._onKeyDown=function(e){var t;t=n._isAdjustingLowerValue?n.props.lowerValue||n.state.lowerValue:n.props.value||n.state.value;var a=n.props,i=a.max,r=a.min,s=a.step,d=0;switch(e.which){case Object(o.t)(c.e.left,n.props.theme):case c.e.down:d=-s,n._clearOnKeyDownTimer(),n._setOnKeyDownTimer(e);break;case Object(o.t)(c.e.right,n.props.theme):case c.e.up:d=s,n._clearOnKeyDownTimer(),n._setOnKeyDownTimer(e);break;case c.e.home:t=r,n._clearOnKeyDownTimer(),n._setOnKeyDownTimer(e);break;case c.e.end:t=i,n._clearOnKeyDownTimer(),n._setOnKeyDownTimer(e);break;default:return}var l=Math.min(i,Math.max(r,t+d));n._updateValue(l,l),e.preventDefault(),e.stopPropagation(),n.setState({renderedValue:void 0,renderedLowerValue:void 0})},n._onThumbFocus=function(e){n._isAdjustingLowerValue=e.target===n._lowerValueThumb.current},n._clearOnKeyDownTimer=function(){n._async.clearTimeout(n._onKeyDownTimer)},n._setOnKeyDownTimer=function(e){n._onKeyDownTimer=n._async.setTimeout(function(){n.props.onChanged&&n.props.onChanged(e,n.state.value)},1e3)},n._async=new d.e(n),Object(l.e)(n),Object(u.e)(v,n.props,{value:"defaultValue"}),t.ranged&&Object(u.e)(v,n.props,{lowerValue:"defaultLowerValue"}),n._id=Object(f.e)("Slider");var a=void 0!==t.value?t.value:void 0!==t.defaultValue?t.defaultValue:t.min,i=void 0!==t.lowerValue?t.lowerValue:void 0!==t.defaultLowerValue?t.defaultLowerValue:t.min;return n.state={value:a,lowerValue:i,renderedValue:void 0,renderedLowerValue:void 0},n}return Object(i.a)(t,e),t.prototype.componentWillUnmount=function(){this._async.dispose(),this._disposeListeners()},t.prototype.render=function(){var e,t,n,a=this.props,o=a.ariaLabel,s=a.className,c=a.disabled,d=a.label,l=a.max,u=a.min,f=a.showValue,_=a.buttonProps,v=a.vertical,y=a.styles,S=a.theme,D=a.originFromZero,I=a.ranged,x=this.value,C=this.renderedValue,O=this.renderedLowerValue,w=this._getPercent(C),E=this._getPercent(O),A=D?0:u,L=this._getPercent(A),k=I?w-E:Math.abs(L-w),M=Math.min(100-w,100-L),P=I?E:Math.min(w,L),T=v?"height":"width",U=c?{}:{onMouseDown:this._onMouseDownOrTouchStart},F=c?{}:{onTouchStart:this._onMouseDownOrTouchStart},H=c?{}:{onKeyDown:this._onKeyDown},R=c?{}:{onFocus:this._onThumbFocus},N=g(y,{className:s,ranged:I,disabled:c,vertical:v,showTransitions:C===x||I&&O===this.lowerValue,showValue:f,theme:S}),B=_?Object(h.s)(_,h.r):void 0,j={"aria-disabled":c,role:"slider",tabIndex:c?void 0:0,"data-is-focusable":!c},V=Object(i.e)(Object(i.e)(Object(i.e)(Object(i.e)(Object(i.e)({id:this._id,className:Object(p.e)(N.slideBox,_.className)},U),F),H),B),!I&&Object(i.e)(Object(i.e)({},j),{"aria-valuemin":u,"aria-valuemax":l,"aria-valuenow":x,"aria-valuetext":this._getAriaValueText(x),"aria-label":o||d})),z=I?Object(i.e)(Object(i.e)(Object(i.e)({},j),R),{id:"max-"+this._id,"aria-valuemin":this.lowerValue,"aria-valuemax":l,"aria-valuenow":x,"aria-valuetext":this._getAriaValueText(x),"aria-label":"max "+(o||d)}):void 0,G=I?Object(i.e)(Object(i.e)(Object(i.e)({},j),R),{id:"min-"+this._id,"aria-valuemin":u,"aria-valuemax":x,"aria-valuenow":this.lowerValue,"aria-valuetext":this._getAriaValueText(this.lowerValue),"aria-label":"min "+(o||d)}):void 0;return r.createElement("div",{className:N.root},d&&r.createElement(b.e,Object(i.e)({className:N.titleLabel},o?{}:{htmlFor:this._id},{disabled:c}),d),r.createElement("div",{className:N.container},I&&f&&r.createElement(b.e,{className:N.valueLabel,disabled:c},this._getValueLabel(v?this.value:this.lowerValue)),r.createElement("div",Object(i.e)({},V),r.createElement("div",{ref:this._sliderLine,className:N.line},D&&r.createElement("span",{className:Object(p.e)(N.zeroTick),style:this._getStyleUsingOffsetPercent(v,L)}),I&&r.createElement("span",Object(i.e)({ref:this._lowerValueThumb,className:N.thumb,style:this._getStyleUsingOffsetPercent(v,E)},G)),r.createElement("span",Object(i.e)({ref:this._thumb,className:N.thumb,style:this._getStyleUsingOffsetPercent(v,w)},z)),(I||D)&&r.createElement("span",{className:Object(p.e)(N.lineContainer,N.inactiveSection),style:(e={},e[T]=P+"%",e)}),r.createElement("span",{className:Object(p.e)(N.lineContainer,N.activeSection),style:(t={},t[T]=k+"%",t)}),r.createElement("span",{className:Object(p.e)(N.lineContainer,N.inactiveSection),style:(n={},n[T]=M+"%",n)}))),f&&r.createElement(b.e,{className:N.valueLabel,disabled:c},this._getValueLabel(I&&v?this.lowerValue:this.value))),r.createElement(m.e,null))},t.prototype.focus=function(){this._thumb.current&&this._thumb.current.focus()},Object.defineProperty(t.prototype,"range",{get:function(){if(this.props.ranged)return[this.lowerValue,this.value]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){var e=this.props.value,t=void 0===e?this.state.value:e;return void 0===this.props.min||void 0===this.props.max||void 0===t?void 0:Math.max(this.props.min,Math.min(this.props.max,t))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderedValue",{get:function(){var e=this.state.renderedValue;return void 0===e?this.value:e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lowerValue",{get:function(){var e=this.props,t=e.lowerValue,n=void 0===t?this.state.lowerValue:t;return e.ranged&&void 0!==this.props.min&&void 0!==this.props.max&&void 0!==n?Math.max(this.props.min,Math.min(this.props.max,n)):void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderedLowerValue",{get:function(){var e=this.state.renderedLowerValue;return void 0===e?this.lowerValue:e},enumerable:!0,configurable:!0}),t.prototype._getPercent=function(e){var t=this.props,n=t.min,a=t.max;return a===n?0:(e-n)/(a-n)*100},t.prototype._getValueLabel=function(e){var t=this.props.valueFormat;return t?t(e):e},t.prototype._getStyleUsingOffsetPercent=function(e,t){var n;return(n={})[e?"bottom":Object(o.e)(this.props.theme)?"right":"left"]=t+"%",n},t.prototype._getPosition=function(e,t){var n;switch(e.type){case"mousedown":case"mousemove":n=t?e.clientY:e.clientX;break;case"touchstart":case"touchmove":n=t?e.touches[0].clientY:e.touches[0].clientX}return n},t.prototype._setValueState=function(e,t){var n,a=this,i=this._isAdjustingLowerValue,r=e!==(i?this.state.lowerValue:this.state.value);this.setState(((n={})[i?"lowerValue":"value"]=e,n[i?"renderedLowerValue":"renderedValue"]=t,n),function(){var e=a.state,t=e.lowerValue,n=e.value;r&&a.props.onChange&&a.props.onChange(i?t:n,a.props.ranged?[t,n]:void 0)})},t.prototype._updateValue=function(e,t){var n=this.props,a=n.step,i=n.snapToStep,r=n.ranged,o=n.originFromZero,s=0;if(isFinite(a))for(;Math.round(a*Math.pow(10,s))/Math.pow(10,s)!==a;)s++;var c=parseFloat(e.toFixed(s));i&&(t=c);var d=this._isAdjustingLowerValue&&(o?c<=0:c<=this.renderedValue),l=!this._isAdjustingLowerValue&&(o?c>=0:c>=this.renderedLowerValue);(!r||d||l)&&this._setValueState(c,t)},t.defaultProps={step:1,min:0,max:10,showValue:!0,disabled:!1,vertical:!1,buttonProps:{},originFromZero:!1},t}(r.Component),S=n(33),D={root:"ms-Slider",enabled:"ms-Slider-enabled",disabled:"ms-Slider-disabled",row:"ms-Slider-row",column:"ms-Slider-column",container:"ms-Slider-container",slideBox:"ms-Slider-slideBox",line:"ms-Slider-line",thumb:"ms-Slider-thumb",activeSection:"ms-Slider-active",inactiveSection:"ms-Slider-inactive",valueLabel:"ms-Slider-value",showValue:"ms-Slider-showValue",showTransitions:"ms-Slider-showTransitions",zeroTick:"ms-Slider-zeroTick"},I=Object(a.e)(y,function(e){var t,n,a,r,s,c,d,l,u,f,p,m,_,h=e.className,b=e.titleLabelClassName,g=e.theme,v=e.vertical,y=e.disabled,I=e.showTransitions,x=e.showValue,C=e.ranged,O=g.semanticColors,w=Object(S.I)(D,g),E=O.inputBackgroundCheckedHovered,A=O.inputBackgroundChecked,L=O.inputPlaceholderBackgroundChecked,k=O.smallInputBorder,M=O.disabledBorder,P=O.disabledText,T=O.disabledBackground,U=O.inputBackground,F=O.smallInputBorder,H=O.disabledBorder,R=!y&&{backgroundColor:E,selectors:(t={},t[S.r]={backgroundColor:"Highlight"},t)},N=!y&&{backgroundColor:L,selectors:(n={},n[S.r]={borderColor:"Highlight"},n)},B=!y&&{backgroundColor:A,selectors:(a={},a[S.r]={backgroundColor:"Highlight"},a)},j=!y&&{border:"2px solid "+E,selectors:(r={},r[S.r]={borderColor:"Highlight"},r)},V=!e.disabled&&{backgroundColor:O.inputPlaceholderBackgroundChecked,selectors:(s={},s[S.r]={backgroundColor:"Highlight"},s)};return{root:Object(i.o)([w.root,g.fonts.medium,{userSelect:"none"},v&&{marginRight:8}],[y?void 0:w.enabled],[y?w.disabled:void 0],[v?void 0:w.row],[v?w.column:void 0],[h]),titleLabel:[{padding:0},b],container:[w.container,{display:"flex",flexWrap:"nowrap",alignItems:"center"},v&&{flexDirection:"column",height:"100%",textAlign:"center",margin:"8px 0"}],slideBox:Object(i.o)([w.slideBox,!C&&Object(S.D)(g),{background:"transparent",border:"none",flexGrow:1,lineHeight:28,display:"flex",alignItems:"center",selectors:(c={},c[":active ."+w.activeSection]=R,c[":hover ."+w.activeSection]=B,c[":active ."+w.inactiveSection]=N,c[":hover ."+w.inactiveSection]=N,c[":active ."+w.thumb]=j,c[":hover ."+w.thumb]=j,c[":active ."+w.zeroTick]=V,c[":hover ."+w.zeroTick]=V,c[S.r]={forcedColorAdjust:"none"},c)},v?{height:"100%",width:28,padding:"8px 0"}:{height:28,width:"auto",padding:"0 8px"}],[x?w.showValue:void 0],[I?w.showTransitions:void 0]),thumb:[w.thumb,C&&Object(S.D)(g,{inset:-4}),{borderWidth:2,borderStyle:"solid",borderColor:F,borderRadius:10,boxSizing:"border-box",background:U,display:"block",width:16,height:16,position:"absolute"},v?{left:-6,margin:"0 auto",transform:"translateY(8px)"}:{top:-6,transform:Object(o.e)(g)?"translateX(50%)":"translateX(-50%)"},I&&{transition:"left "+S.n.durationValue3+" "+S.n.easeFunction1},y&&{borderColor:H,selectors:(d={},d[S.r]={borderColor:"GrayText"},d)}],line:[w.line,{display:"flex",position:"relative"},v?{height:"100%",width:4,margin:"0 auto",flexDirection:"column-reverse"}:{width:"100%"}],lineContainer:[{borderRadius:4,boxSizing:"border-box"},v?{width:4,height:"100%"}:{height:4,width:"100%"}],activeSection:[w.activeSection,{background:k,selectors:(l={},l[S.r]={backgroundColor:"WindowText"},l)},I&&{transition:"width "+S.n.durationValue3+" "+S.n.easeFunction1},y&&{background:P,selectors:(u={},u[S.r]={backgroundColor:"GrayText",borderColor:"GrayText"},u)}],inactiveSection:[w.inactiveSection,{background:M,selectors:(f={},f[S.r]={border:"1px solid WindowText"},f)},I&&{transition:"width "+S.n.durationValue3+" "+S.n.easeFunction1},y&&{background:T,selectors:(p={},p[S.r]={borderColor:"GrayText"},p)}],zeroTick:[w.zeroTick,{position:"absolute",background:O.disabledBorder,selectors:(m={},m[S.r]={backgroundColor:"WindowText"},m)},e.disabled&&{background:O.disabledBackground,selectors:(_={},_[S.r]={backgroundColor:"GrayText"},_)},e.vertical?{width:"16px",height:"1px",transform:Object(o.e)(g)?"translateX(6px)":"translateX(-6px)"}:{width:"1px",height:"16px",transform:"translateY(-6px)"}],valueLabel:[w.valueLabel,{flexShrink:1,width:30,lineHeight:"1"},v?{margin:"0 auto",whiteSpace:"nowrap",width:40}:{margin:"0 8px",whiteSpace:"nowrap",width:40}]}},void 0,{scope:"Slider"})},3748:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(3),i=n(1),r=n(49),o=function(e){void 0===e&&(e={});var t=Object(a.o)(e.deepMerge||[],["style"]),n=function(e){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];for(var s=0,c=a;s<c.length;s++){var d=c[s];if(d)for(var l=0,u=Object.keys(d);l<u.length;l++){var f=u[l],p=d[f],m=typeof p;void 0!==p&&(p&&"object"===m?Array.isArray(p)?e[f]=p:(e[f]=e[f]||{},"object"!=typeof e[f]||i.isValidElement(p)||p&&"object"==typeof p&&p.hasOwnProperty("current")||-1===t.indexOf(f)?e[f]=p:n(e[f],p)):"className"===f?p&&(e[f]=Object(r.e)(e[f],p)):e[f]=p)}}return e};return n}},3749:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(3),i=n(1);function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=i.useCallback(function(t){n.current=t;for(var a=0,i=e;a<i.length;a++){var r=i[a];"function"==typeof r?r(t):r&&(r.current=t)}},Object(a.o)(e));return n}},3803:function(e,t,n){"use strict";n.r(t),t.default=n.p+"images/penCursorFallback_7b354f455c946fdc473f6f85e17e1a97.cur"},3804:function(e,t,n){"use strict";n.r(t),t.default=n.p+"images/eraserCursorFallback_dadc9876594b85a5ee3b073d5020d399.cur"},3857:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(1),i=n(1518),r=n(1029),o=function(){return null},s=function(e,t){var n={root:e.as||"div"},s={root:"string"==typeof e.as?Object(i.e)(e.as,e):Object(r.t)(e,["as"])};if(t)for(var c=0,d=t;c<d.length;c++){var l=d[c],u=e[l]||{},f=u.as,p=void 0===f?"span":f,m=u.children,_="string"==typeof p,h=_&&void 0===u.children;n[l]=h?o:p,"function"==typeof m?(s[l]={children:m(n[l],Object(r.t)(u,["as","children"]))},n[l]=a.Fragment):n[l]!==o&&(s[l]=_?Object(i.e)(p,u):Object(r.t)(u,["as"]))}return{slots:n,slotProps:s}}},3858:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(1),i={document:"document"},r=a.createContext({registerStyles:function(e,t){var n=t.styleCache,a=t.target;if(e&&!(e.length<1)){Array.isArray(e)||(e=[e]);var r=[],o=a||i,s=n.get(o);s||(s=new Map,n.set(o,s));for(var c=0,d=e;c<d.length;c++){var l=d[c];s.has(l)||(r.push(l),s.set(l,!0))}r.length&&t.renderStyles(r,t)}},renderStyles:function(e,t){var n=t.target;if(e.length&&n){var a=n.createElement("style");a.textContent=e.join(""),n.head.appendChild(a)}},target:"object"==typeof window?window.document:void 0,styleCache:new WeakMap}),o=function(e){var t=a.useContext(r);t.registerStyles(e,t)}},4115:function(e,t,n){"use strict";n.r(t);var a,i,r=n(0),o=n(1),s=n.n(o),c=n(49),d=n(1515),l=n(1373),u=n(537),f=o.createContext(void 0),p=function(){var e=Object(o.useContext)(f),t=Object(l.e)(["theme"]).theme;return e||t||Object(u.e)({})},m=n(237),_=n(1375),h=n(1377),b=n(1496),g=0,v={reset:function(){m.e.getInstance().onReset(function(){return g++})},getId:function(){return g},renderStyles:function(e,t){return Object(_.e)(Array.isArray(e)?e:[e],t)},renderFontFace:function(e,t){return Object(h.e)(e)},renderKeyframes:function(e){return Object(b.e)(e)}},y=o.createContext(v),S=function(e,t,n){void 0===n&&(n={});var a=!1;if(e)for(var i=0,r=Object.keys(e);i<r.length;i++){var o=r[i];if(!a){if(0===o.indexOf("--"))return e;a=!0}var s=t?t+("default"===o?"":"-"+o):"--"+o,c=e[o];c&&"object"==typeof c?S(c,s,n):n[s]=c}return n},D=(a=function(e){var t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b=e.tokens;return{root:S(b),body:[{color:null===(a=null===(n=null===(t=b)||void 0===t?void 0:t.color)||void 0===n?void 0:n.body)||void 0===a?void 0:a.contentColor,background:null===(o=null===(r=null===(i=b)||void 0===i?void 0:i.color)||void 0===r?void 0:r.body)||void 0===o?void 0:o.background,fontFamily:null===(c=null===(s=b)||void 0===s?void 0:s.body)||void 0===c?void 0:c.fontFamily,fontWeight:null===(l=null===(d=b)||void 0===d?void 0:d.body)||void 0===l?void 0:l.fontWeight,fontSize:null===(f=null===(u=b)||void 0===u?void 0:u.body)||void 0===f?void 0:f.fontSize,MozOsxFontSmoothing:null===(m=null===(p=b)||void 0===p?void 0:p.body)||void 0===m?void 0:m.mozOsxFontSmoothing,WebkitFontSmoothing:null===(h=null===(_=b)||void 0===_?void 0:_.body)||void 0===h?void 0:h.webkitFontSmoothing}]}},i=new Map,function(e){void 0===e&&(e={});var t=e.theme,n=e.renderer,r=Object(d.n)(),s=p(),c=o.useContext(y);t=t||s||{};var l=[(n=n||c).getId(),r,t],u=function(e,t){for(var n=0,a=t;n<a.length;n++){var i=a[n];if(!(e=e.get(i)))return}return e}(i,l);if(!u){var f=a(t);u=n.renderStyles(f,{targetWindow:r,rtl:!!t.rtl}),function(e,t,n){for(var a=0;a<t.length-1;a++){var i=t[a],r=e.get(i);r||(r=new Map,e.set(i,r)),e=r}e.set(t[t.length-1],n)}(i,l,u)}return u}),I=n(3),x=n(3857),C=n(534),O=function(e){var t=Object(x.e)(e),n=t.slots,a=t.slotProps,i=e.theme,r=e.customizerContext;return o.createElement(f.Provider,{value:i},o.createElement(y.Provider,{value:e.renderer},o.createElement(C.e.Provider,{value:r},o.createElement(n.root,Object(I.e)({},a.root)))))},w=n(3748),E=n(1378),A=n(585),L=n(1447),k=new Map,M=n(3749),P=Object(w.e)(),T=n(3858),U=n(1523),F=o.forwardRef(function(e,t){var n=function(e,t,n){var a,i,r,s,c=Object(M.e)(t,o.useRef(null)),d=P({ref:c,as:"div"},n,e);return i=(a=d).theme,r=p(),s=a.theme=o.useMemo(function(){var e,t=Object(E.e)(r,i);return t.tokens=function(e,t){var n=e.fonts,a=e.palette,i=e.semanticColors;return Object(L.e)({color:{body:{background:i.bodyBackground,contentColor:i.bodyText},brand:{background:i.primaryButtonBackground,borderColor:i.primaryButtonBorder,contentColor:i.primaryButtonText,iconColor:a.white,dividerColor:a.white,secondaryContentColor:a.white,hovered:{background:i.primaryButtonBackgroundHovered,contentColor:i.primaryButtonTextHovered,secondaryContentColor:a.white,borderColor:"var(--color-brand-borderColor)"},pressed:{background:i.primaryButtonBackgroundPressed,contentColor:i.primaryButtonTextPressed,secondaryContentColor:i.primaryButtonTextPressed,borderColor:"var(--color-brand-borderColor)",iconColor:"var(--color-brand-iconColor)"},focused:{background:"var(--color-brand-background)",borderColor:"var(--color-brand-borderColor)",contentColor:"var(--color-brand-contentColor)",iconColor:"var(--color-brand-iconColor)",secondaryContentColor:"var(--color-brand-focused-contentColor)"},disabled:{background:i.primaryButtonBackgroundDisabled,contentColor:i.buttonTextDisabled,dividerColor:a.neutralTertiaryAlt,secondaryContentColor:"var(--color-brand-disabled-contentColor)",borderColor:"var(--color-brand-disabled-background)",iconColor:"var(--color-brand-disabled-contentColor)"},checked:{background:i.primaryButtonBackgroundPressed,contentColor:i.primaryButtonTextPressed,iconColor:i.primaryButtonTextPressed},checkedHovered:{background:i.primaryButtonBackgroundPressed,contentColor:i.primaryButtonTextPressed,iconColor:i.primaryButtonTextPressed}}},body:{fontFamily:n.medium.fontFamily,fontWeight:n.medium.fontWeight,fontSize:n.medium.fontSize,mozOsxFontSmoothing:n.medium.MozOsxFontSmoothing,webkitFontSmoothing:n.medium.WebkitFontSmoothing},text:{variant:{caption:{fontSize:"12px",fontWeight:"400",lineHeight:"14px"},body:{fontSize:"14px",fontWeight:"400",lineHeight:"20px"},subHeadline:{fontSize:"16px",fontWeight:"600",lineHeight:"22px"},headline:{fontSize:"20px",fontWeight:"600",lineHeight:"28px"},title3:{fontSize:"24px",fontWeight:"600",lineHeight:"32px"},title2:{fontSize:"28px",fontWeight:"600",lineHeight:"36px"},title1:{fontSize:"32px",fontWeight:"600",lineHeight:"40px"},largeTitle:{fontSize:"40px",fontWeight:"600",lineHeight:"52px"},display:{fontSize:"68px",fontWeight:"600",lineHeight:"92px"}}}},t)}(t,null===(e=i)||void 0===e?void 0:e.tokens),t.id=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],a=0,i=e;a<i.length;a++){var r=i[a];if(r){var o=r.id||k.get(r);o||(o=Object(A.e)(""),k.set(r,o)),n.push(o)}}return n.join("-")}(r,i),t},[r,i]),a.customizerContext=o.useMemo(function(){return{customizations:{inCustomizerContext:!0,settings:{theme:s},scopedSettings:s.components||{}}}},[s]),a.theme.rtl!==r.rtl&&(a.dir=a.theme.rtl?"rtl":"ltr"),{state:d,render:O}}(e,t,{renderer:v,applyTo:"element"}),a=n.render,i=n.state;return Object(T.e)(i.theme.stylesheets),function(e){var t=D(e),n=e.className,a=e.applyTo;!function(e,t){var n,a="body"===e.applyTo,i=null===(n=Object(d.t)())||void 0===n?void 0:n.body;o.useEffect(function(){if(a&&i){for(var e=0,n=t;e<n.length;e++){var r=n[e];r&&i.classList.add(r)}return function(){if(a&&i)for(var e=0,n=t;e<n.length;e++){var r=n[e];r&&i.classList.remove(r)}}}},[a,i,t])}(e,[t.root,t.body]),e.className=Object(c.e)(n,t.root,"element"===a&&t.body)}(i),Object(U.t)(i.ref),a(i)});F.displayName="ThemeProvider";var H,R=n(1771),N=function(){function e(){this._count=0,this._min=Number.MAX_VALUE,this._totalTime=0}return Object.defineProperty(e.prototype,"frameCount",{get:function(){return this._count},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minimumFps",{get:function(){return this._min},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"averageFps",{get:function(){return 1e3*this._count/this._totalTime},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this._count=0,this._min=Number.MAX_VALUE,this._totalTime=0},e.prototype.reportFrame=function(e){this._count++;var t=1e3/e;this._min=Math.min(this.minimumFps,t),this._totalTime+=e},e}();function B(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(e){return(+e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+e/4).toString(16)})}!function(e){e.Editor="Editor",e.MainImage="MainImage",e.Thumbnail="Thumbnail"}(H||(H={}));var j=function(e,t){var n;return function(){for(var a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];return new Promise(function(i){n&&window.clearTimeout(n),n=window.setTimeout(function(){return i(e.apply(void 0,a))},t)})}};function V(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n+0}function z(e){return-Math.round(-e)}var G=function(){return G=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},G.apply(this,arguments)},K=function(e){var t=B();return{updateSessionId:function(){t=B()},logEditorActivityEvent:function(n){return e(W(t,n))},logCropEvent:j(function(n){return e(q(t,n))},1e3),logRotateEvent:j(function(n){return e(Q(t,G(G({},n),{angle:V(n.angle,8)})))},1e3),logEditResetEvent:function(n){return e(Y(t,n))},logZoomEvent:j(function(n){return e(J(t,n))},1e3),logAspectRatioEvent:function(n){return e(X(t,n))},logFlipEvent:function(n){return e(Z(t,n))},logAdjustmentEvent:j(function(n){return e($(t,n))},1e3),logCancelEvent:function(n){return e(ee(t,n))},logPageLoadTimeEvent:function(n){return e(te(t,n))},logSessionStatistics:function(n){return e(ne(t,n))},logErrorEvent:function(n){return e(ae(t,n))},logWarningEvent:function(n){return e(ie(t,n))},logSaveEvent:function(n){return e(re(t,n))},logFailedToGetEditedImageEvent:function(){return e(oe(t))},logRecenterEvent:function(){return e(se(t))},logMarkupSummaryEvent:function(n){return e(ce(t,n))},logMaxTextureSizeEvent:function(n){return e(de(t,n))},logMarkupToolSelectEvent:j(function(n){return e(le(t,n))},500),logInkBrushUpdateEvent:j(function(n){return e(ue(t,n))},1e3),logEditorActivityChangePrepareTimeEvent:function(n){return e(fe(t,n))},logClearAllInkStrokesEvent:function(n){return e(pe(t,n))},logAutoEnhanceRequestedEvent:function(n){return e(me(t,n))}}},W=function(e,t){return G({name:"EditorActivityChange",isIntentional:!0,sessionId:e},t)},q=function(e,t){return G({name:"Crop",isIntentional:!0,sessionId:e},t)},Q=function(e,t){return G({name:"Rotate",isIntentional:!0,sessionId:e},t)},Y=function(e,t){return G({name:"EditReset",isIntentional:!0,sessionId:e},t)},J=function(e,t){return G({name:"Zoom",isIntentional:!0,sessionId:e},t)},X=function(e,t){return G({name:"AspectRatio",isIntentional:!0,sessionId:e},t)},Z=function(e,t){return G({name:"Flip",isIntentional:!0,sessionId:e},t)},$=function(e,t){return G({name:"Adjustment",isIntentional:!0,sessionId:e},t)},ee=function(e,t){return G({name:"Cancel",isIntentional:!0,sessionId:e},t)},te=function(e,t){return G({name:"PageLoadTime",isIntentional:!1,sessionId:e},t)},ne=function(e,t){return G({name:"SessionStatistics",isIntentional:!1,sessionId:e},t)},ae=function(e,t){return G({name:"Error",isIntentional:!1,sessionId:e},t)},ie=function(e,t){return G({name:"Warning",isIntentional:!1,sessionId:e},t)},re=function(e,t){return G({name:"Save",isIntentional:!0,sessionId:e},t)},oe=function(e){return{name:"GetEditedImageFailure",isIntentional:!1,sessionId:e}},se=function(e){return{sessionId:e,name:"Recenter",isIntentional:!0}},ce=function(e,t){return G({name:"MarkupSummary",isIntentional:!0,sessionId:e},t)},de=function(e,t){return G({name:"MaxTextureSize",isIntentional:!1,sessionId:e},t)},le=function(e,t){return G({name:"MarkupToolSelect",isIntentional:!0,sessionId:e},t)},ue=function(e,t){return G({name:"InkBrushUpdate",isIntentional:!0,sessionId:e},t)},fe=function(e,t){return G({name:"EditorActivityChangePrepareTime",isIntentional:!0,sessionId:e},t)},pe=function(e,t){return G({name:"ClearAllInkStrokes",isIntentional:!0,sessionId:e},t)},me=function(e,t){return G({name:"AutoEnhanceRequested",isIntentional:!0,sessionId:e},t)},_e=Object(o.createContext)(K(function(e){}));function he(e){var t=performance.getEntriesByName(e);return t.length>0&&e?performance.now()-t[t.length-1].startTime:-1}var be=s.a.memo(function(e){var t=e.imageSize,n=e.children,a=Object(o.useContext)(_e),i=a.logPageLoadTimeEvent,r=a.logSessionStatistics,c=a.updateSessionId,d=Object(o.useRef)(t),l=Object(o.useMemo)(function(){return new N},[]);return Object(o.useEffect)(function(){var e=window.performance.now(),t=0,n=function(){var a=window.performance.now();l.reportFrame(a-e),e=a,t=window.requestAnimationFrame(n)};return t=window.requestAnimationFrame(n),function(){window.cancelAnimationFrame(t)}},[l]),Object(o.useEffect)(function(){return function(){d.current!==t&&(r({minFrameRate:l.minimumFps,avgFrameRate:l.averageFps,imageSize:{width:t.x,height:t.y}}),l.reset(),c(),d.current=t)}},[r,c,l,t]),Object(o.useLayoutEffect)(function(){var e=window.requestAnimationFrame(function(){setTimeout(function(){i({pageLoadTimeMs:he(H.Editor),component:H.Editor})})});return function(){window.cancelAnimationFrame(e)}},[i]),s.a.createElement(s.a.Fragment,null,n)}),ge=Object(R.connect)(function(e){return{imageSize:e.transformTools.image.originalPixelSize}},{})(be),ve=Object(o.createContext)(function(e){}),ye=s.a.memo(function(e){var t=e.onError,n=e.children;return s.a.createElement(ve.Provider,{value:t},n)});function Se(){return Object(o.useContext)(ve)}var De=function(){return De=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},De.apply(this,arguments)};function Ie(e,t,n){return function(e,t){var n=De(De({},t),{numberingSystem:"latn"});return new Intl.NumberFormat(e,n)}(t,n).format(e+0)}function xe(e){return Ie(1.1,e).substring(1,2)}function Ce(e){return"."===e}function Oe(e,t,n){return Ie(e,t,function(e){return{style:"percent",minimumFractionDigits:e,maximumFractionDigits:e}}(n))}var we,Ee,Ae=function(e){var t=e.strings,n=e.locales;return{strings:t,localizeNumber:function(e){return Ie(e,n)},localizeNumberDecimalSeparatorOnly:function(e,t){return function(e,t,n){var a=xe(t),i=void 0===n?e.toString():V(e,n).toString();return Ce(a)?i:i.replace(".",a)}(e,n,t)},delocalizeNumberDecimalSeparatorOnly:function(e){return function(e,t){var n=xe(t);return Ce(n)?+e:+e.replace(n,".")}(e,n)},getDecimalSeparator:function(){return xe(n)},isPercentSignLeading:function(){return function(e){return null!==Oe(.1,e,0).match(/\d$/)}(n)},localizePercentage:function(e,t){return Oe(e,n,t)}}},Le=Object(o.createContext)(Ae({strings:{adjustment_light:"Light",adjustment_color:"Color",adjustment_lightAriaLandmark:"Light Adjustments",adjustment_colorAriaLandmark:"Color Adjustments",adjustment_brightness:"Brightness",adjustment_exposure:"Exposure",adjustment_contrast:"Contrast",adjustment_highlights:"Highlights",adjustment_shadows:"Shadows",adjustment_saturation:"Saturation",adjustment_temperature:"Warmth",adjustment_tint:"Tint",adjustment_vignette:"Vignette",aspectRatio_listTitle:"Aspect ratios",aspectRatio_freeform:"Free",aspectRatio_freeformAriaLabel:"Free aspect ratio",aspectRatio_original:"Original",aspectRatio_originalAriaLabel:"Original aspect ratio",aspectRatio_square:"Square",aspectRatio_squareAriaLabel:"Square aspect ratio",aspectRatio_ratioLabelFormatString:"{0} : {1}",aspectRatio_ratioAriaLabelFormatString:"{0} by {1} aspect ratio",aspectRatio_tooltip:"Aspect ratio options to crop the image",aspectRatio_changedAriaLive:"Changed to {0}",flip_portrait:"Flip to portrait",flip_portraitAriaLabel:"Flip to portrait",flip_landscape:"Flip to landscape",flip_landscapeAriaLabel:"Flip to landscape",autoEnhance_name:"Auto Enhance",autoEnhance_generatingAriaLive:"Generating auto enhance",autoEnhance_appliedAriaLive:"Applied auto enhance with {0} intensity",autoEnhance_removedAriaLive:"Removed auto enhance",autoEnhance_intensitySliderHeader:"Intensity",autoEnhance_intensitySliderAriaLabel:"Auto enhance intensity",crop_topLeftCornerAriaLabel:"Top left crop handle. Corner pixel position is {0} from the left {1} from the top.",crop_topRightCornerAriaLabel:"Top right crop handle. Corner pixel position is {0} from the left {1} from the top.",crop_bottomLeftCornerAriaLabel:"Bottom left crop handle. Corner pixel position is {0} from the left {1} from the top.",crop_bottomRightCornerAriaLabel:"Bottom right crop handle. Corner pixel position is {0} from the left {1} from the top.",crop_cornerTooltip:"Drag handle or use arrow keys to crop the image",crop_rectangleAriaLabel:"Drag the image or use the arrow keys to move image in crop region",crop_rectangleTooltip:"Drag the image or use the arrow keys to move image in crop region",crop_rectanglePositionAriaLive:"Left {0} Top {1} pixels",crop_rectangleCannotMoveInCurrentDirectionAriaLive:"Left {0} Top {1} pixels. Cannot move any further in current direction.",editor_viewingOriginal:"Viewing Original",editor_viewingOriginalAriaLive:"Viewing original image",editor_zoomPercentAriaLive:"{0} percent zoom",editor_imageDimensionLabelFormatString:"{0} x {1}",editor_imageDimensionAriaLabelFormatString:"{0} by {1} pixels",editor_imageDimensionAriaLive:"Dimension is {0} by {1} pixels",filter_listTitle:"Filters",filter_intensitySliderHeader:"Intensity",filter_intensitySliderAriaLabelFormatString:"{0} intensity",filter_nameOriginal:"Original",filter_nameBurn:"Burn",filter_nameBw:"B&W",filter_nameBwAriaLabel:"Black and White",filter_nameBwCool:"B&W Cool",filter_nameBwCoolAriaLabel:"Black and White Cool",filter_nameBwHighContrast:"B&W High Contrast",filter_nameBwHighContrastAriaLabel:"Black and White High Contrast",filter_nameBwWarm:"B&W Warm",filter_nameBwWarmAriaLabel:"Black and White Warm",filter_nameCoolLight:"Cool Light",filter_nameCalm:"Calm",filter_nameDramaticCool:"Dramatic Cool",filter_nameFilm:"Film",filter_nameGolden:"Golden",filter_namePunch:"Punch",filter_nameRadiate:"Radiate",filter_nameVintage:"Vintage",filter_nameVividCool:"Vivid Cool",filter_nameWarmContrast:"Warm Contrast",filter_changedAriaLive:"{0} filter has been applied",filter_changedAriaLiveWithIntensity:"{0} filter at {1} percent intensity has been applied",filter_filtersAriaLandmark:"Filters",footer_done:"Done",nonCrop_imageTooltip:"Click and hold to view the original image",nonCrop_imageAriaLabelWithEdits:"Click and hold or press and hold the space key to view the original image",nonCrop_imageAriaLabelWithoutEdits:"No adjustments have been made or filter applied to the image",nonCrop_panViewPositionAriaLive:"Left {0} Top {1} pixels",pivot_crop:"Crop",pivot_adjustment:"Adjustment",pivot_filter:"Filter",pivot_markup:"Markup",rotate_left90:"Rotate image 90 degrees counter-clockwise",rotate_left90AriaLabel:"Rotate counter-clockwise",rotate_left90FinishedAriaLive:"Rotated 90 degrees counter-clockwise",rotate_right90:"Rotate image 90 degrees clockwise",rotate_right90AriaLabel:"Rotate clockwise",rotate_right90FinishedAriaLive:"Rotated 90 degrees clockwise",rotate_sliderAriaLabel:"Manual rotate",rotate_degree:"°",rotate_sliderTooltip:"Drag or use arrow keys to rotate the image",flip_horizontal:"Flip image horizontally",flip_horizontalAriaLabel:"Flip image horizontally",flip_horizontalFinishedAriaLive:"Flipped image horizontally",flip_vertical:"Flip image vertically",flip_verticalAriaLabel:"Flip image vertically",flip_verticalFinishedAriaLive:"Flipped image vertically",toolbar_imageSave:"Save",toolbar_imageSaveTooltip:"Save options for your image",toolbar_imageSaveAsOriginal:"Save",toolbar_imageSaveAsOriginalAriaLabel:"Save",toolbar_saveMenuSplitButtonAriaLabel:"More save options",toolbar_imageSaveAsOriginalTooltip:"Image will be overwritten with the latest edits",toolbar_imageSaveAsCopy:"Save as copy",toolbar_imageSaveAsCopyAriaLabel:"Save as copy",toolbar_imageSaveAsCopyTooltip:"Create a new image with the applied edits",toolbar_imageReset:"Reset",toolbar_imageResetTooltip:"Reset all edits performed on the image",toolbar_imageResetAriaLabel:"Reset",toolbar_imageResetFinishedAriaLive:"Image edits were reset",toolbar_resetConfirmDialogContentTitle:"Reset image?",toolbar_resetConfirmDialogContentSubText:"This will remove all edits made to this image.",toolbar_resetConfirmDialogCloseButtonAriaLabel:"Close",toolbar_resetConfirmDialogConfirmText:"Reset",toolbar_resetConfirmDialogConfirmAriaLabel:"Reset",toolbar_resetConfirmDialogCancelText:"Cancel",toolbar_resetConfirmDialogCancelAriaLabel:"Cancel",toolbar_zoomLevelAriaLabel:"Zoom level",toolbar_zoomInTooltip:"Zoom into the image",toolbar_zoomInAriaLabel:"Zoom in",toolbar_zoomOutTooltip:"Zoom out of the image",toolbar_zoomOutAriaLabel:"Zoom out",toolbar_cancelAriaLabel:"Cancel",toolbar_cancelTooltip:"Cancel all edits and return to previous screen",toolbar_fitToViewTooltip:"Fit to window",toolbar_viewActualSizeTooltip:"Actual size"},locales:void 0})),ke={adjustment_light:"",adjustment_color:"",adjustment_lightAriaLandmark:"",adjustment_colorAriaLandmark:"",adjustment_brightness:"",adjustment_exposure:"",adjustment_contrast:"",adjustment_highlights:"",adjustment_shadows:"",adjustment_saturation:"",adjustment_temperature:"",adjustment_tint:"",adjustment_vignette:"",aspectRatio_listTitle:"",aspectRatio_freeform:"",aspectRatio_freeformAriaLabel:"",aspectRatio_original:"",aspectRatio_originalAriaLabel:"",aspectRatio_square:"",aspectRatio_squareAriaLabel:"",aspectRatio_ratioLabelFormatString:"",aspectRatio_ratioAriaLabelFormatString:"",aspectRatio_tooltip:"",aspectRatio_changedAriaLive:"",flip_portrait:"",flip_portraitAriaLabel:"",flip_landscape:"",flip_landscapeAriaLabel:"",autoEnhance_name:"",autoEnhance_generatingAriaLive:"",autoEnhance_appliedAriaLive:"",autoEnhance_removedAriaLive:"",autoEnhance_intensitySliderHeader:"",autoEnhance_intensitySliderAriaLabel:"",crop_topLeftCornerAriaLabel:"",crop_topRightCornerAriaLabel:"",crop_bottomLeftCornerAriaLabel:"",crop_bottomRightCornerAriaLabel:"",crop_cornerTooltip:"",crop_rectangleAriaLabel:"",crop_rectangleTooltip:"",crop_rectanglePositionAriaLive:"",crop_rectangleCannotMoveInCurrentDirectionAriaLive:"",editor_viewingOriginal:"",editor_viewingOriginalAriaLive:"",editor_zoomPercentAriaLive:"",editor_imageDimensionLabelFormatString:"",editor_imageDimensionAriaLabelFormatString:"",editor_imageDimensionAriaLive:"",filter_listTitle:"",filter_intensitySliderHeader:"",filter_intensitySliderAriaLabelFormatString:"",filter_nameOriginal:"",filter_nameBurn:"",filter_nameBw:"",filter_nameBwAriaLabel:"",filter_nameBwCool:"",filter_nameBwCoolAriaLabel:"",filter_nameBwHighContrast:"",filter_nameBwHighContrastAriaLabel:"",filter_nameBwWarm:"",filter_nameBwWarmAriaLabel:"",filter_nameCoolLight:"",filter_nameCalm:"",filter_nameDramaticCool:"",filter_nameFilm:"",filter_nameGolden:"",filter_namePunch:"",filter_nameRadiate:"",filter_nameVintage:"",filter_nameVividCool:"",filter_nameWarmContrast:"",filter_changedAriaLive:"",filter_changedAriaLiveWithIntensity:"",filter_filtersAriaLandmark:"",footer_done:"",nonCrop_imageTooltip:"",nonCrop_imageAriaLabelWithEdits:"",nonCrop_imageAriaLabelWithoutEdits:"",nonCrop_panViewPositionAriaLive:"",pivot_crop:"",pivot_adjustment:"",pivot_filter:"",pivot_markup:"",rotate_left90:"",rotate_left90AriaLabel:"",rotate_left90FinishedAriaLive:"",rotate_right90:"",rotate_right90AriaLabel:"",rotate_right90FinishedAriaLive:"",rotate_sliderAriaLabel:"",rotate_degree:"",rotate_sliderTooltip:"",flip_horizontal:"",flip_horizontalAriaLabel:"",flip_horizontalFinishedAriaLive:"",flip_vertical:"",flip_verticalAriaLabel:"",flip_verticalFinishedAriaLive:"",toolbar_imageSave:"",toolbar_imageSaveTooltip:"",toolbar_imageSaveAsOriginal:"",toolbar_imageSaveAsOriginalAriaLabel:"",toolbar_saveMenuSplitButtonAriaLabel:"",toolbar_imageSaveAsOriginalTooltip:"",toolbar_imageSaveAsCopy:"",toolbar_imageSaveAsCopyAriaLabel:"",toolbar_imageSaveAsCopyTooltip:"",toolbar_imageReset:"",toolbar_imageResetTooltip:"",toolbar_imageResetAriaLabel:"",toolbar_imageResetFinishedAriaLive:"",toolbar_resetConfirmDialogContentTitle:"",toolbar_resetConfirmDialogContentSubText:"",toolbar_resetConfirmDialogCloseButtonAriaLabel:"",toolbar_resetConfirmDialogConfirmText:"",toolbar_resetConfirmDialogConfirmAriaLabel:"",toolbar_resetConfirmDialogCancelText:"",toolbar_resetConfirmDialogCancelAriaLabel:"",toolbar_zoomLevelAriaLabel:"",toolbar_zoomInTooltip:"",toolbar_zoomInAriaLabel:"",toolbar_zoomOutTooltip:"",toolbar_zoomOutAriaLabel:"",toolbar_cancelAriaLabel:"",toolbar_cancelTooltip:"",toolbar_fitToViewTooltip:"",toolbar_viewActualSizeTooltip:""},Me=function(e){var t=e.localization,n=e.children,a=Object(o.useMemo)(function(){return Ae(null!=t?t:{strings:ke,locales:void 0})},[t]);return s.a.createElement(Le.Provider,{value:a},n)},Pe=function(e){var t=e.telemetryCallback,n=e.children,a=Object(o.useMemo)(function(){return t?K(t):null},[t]);return s.a.createElement(s.a.Fragment,null,t&&a?s.a.createElement(_e.Provider,{value:a},n):n)},Te=s.a.memo(function(){var e=Object(o.useContext)(_e).logErrorEvent;return Object(o.useEffect)(function(){var t=function(t){var n,a,i=t.message,r=t.filename,o=t.lineno,s=t.colno,c=t.error;e({message:i,source:r,lineNumber:o,columnNumber:s,error:{message:null!==(n=null==c?void 0:c.message)&&void 0!==n?n:"No message available.",stack:null!==(a=null==c?void 0:c.stack)&&void 0!==a?a:"No stack information available."}})};return window.addEventListener("error",t),function(){return window.removeEventListener("error",t)}},[e]),null});!function(e){e.None="None",e.Original="Original",e.Square="Square",e.NineBySixteen="9:16",e.SixteenByNine="16:9",e.FourByFive="4:5",e.FiveByFour="5:4",e.ThreeByFour="3:4",e.FourByThree="4:3",e.TwoByThree="2:3",e.ThreeByTwo="3:2",e.OneByTwo="1:2",e.TwoByOne="2:1"}(we||(we={})),function(e){e.Version1="Version 1",e.Test="Test",e.Latest="Version 1"}(Ee||(Ee={}));var Ue={imageTransform:{x:0,y:0,width:1,height:1,rotation:0},cropRectangle:{top:0,left:0,width:1,height:1},originalImageSize:{x:1,y:1},aspectRatioConstraint:we.None,shouldInvertOriginalAspectRatio:!1},Fe={brightness:0,exposure:0,saturation:0,highlights:0,shadows:0,contrast:0,tint:0,temperature:0,vignette:0,version:Ee.Version1},He=function(e,t){if(typeof e!=typeof t)return!1;if("object"==typeof e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&!He(e[n],t[n]))return!1;return!0},Re=function(e){return e>=0&&e<=1},Ne=function(e){var t={isValid:!0};try{var n=e.colorAdjustments,a=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["colorAdjustments"]);if(void 0!==a.version&&"number"!=typeof a.version)throw new Error("IEditOperations contains invalid data");!function(e){if(!(He(Ue,e)&&Object.values(we).includes(e.aspectRatioConstraint)&&e.originalImageSize.x>=1&&e.originalImageSize.y>=1&&e.imageTransform.height>=1&&e.imageTransform.width>=1&&e.cropRectangle.height>=1&&e.cropRectangle.width>=1))throw new Error("IEditTransformOperations contains invalid data")}(a),n&&function(e){if(!(He(Fe,e)&&Object.values(Ee).includes(e.version)&&Re(e.brightness)&&Re(e.exposure)&&Re(e.saturation)&&Re(e.highlights)&&Re(e.shadows)&&Re(e.contrast)&&Re(e.tint)&&Re(e.vignette)&&Re(e.temperature)))throw new Error("IColorAdjustmentWithoutLutState contains invalid data")}(n)}catch(e){t.isValid=!1,t.message=e.message}return t},Be=function(){return Be=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Be.apply(this,arguments)};function je(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map(function(e){return"'"+e+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Ve(e){return!!e&&!!e[Et]}function ze(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype}(e)||Array.isArray(e)||!!e[wt]||!!e.constructor[wt]||Ye(e)||Je(e))}function Ge(e,t,n){void 0===n&&(n=!1),0===Ke(e)?(n?Object.keys:At)(e).forEach(function(a){n&&"symbol"==typeof a||t(a,e[a],e)}):e.forEach(function(n,a){return t(a,n,e)})}function Ke(e){var t=e[Et];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:Ye(e)?2:Je(e)?3:0}function We(e,t){return 2===Ke(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function qe(e,t,n){var a=Ke(e);2===a?e.set(t,n):3===a?(e.delete(t),e.add(n)):e[t]=n}function Qe(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function Ye(e){return It&&e instanceof Map}function Je(e){return xt&&e instanceof Set}function Xe(e){return e.o||e.t}function Ze(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=Lt(e);delete t[Et];for(var n=At(t),a=0;a<n.length;a++){var i=n[a],r=t[i];!1===r.writable&&(r.writable=!0,r.configurable=!0),(r.get||r.set)&&(t[i]={configurable:!0,writable:!0,enumerable:r.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function $e(e,t){return void 0===t&&(t=!1),tt(e)||Ve(e)||!ze(e)||(Ke(e)>1&&(e.set=e.add=e.clear=e.delete=et),Object.freeze(e),t&&Ge(e,function(e,t){return $e(t,!0)},!0)),e}function et(){je(2)}function tt(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function nt(e){var t=kt[e];return t||je(18,e),t}function at(){return St}function it(e,t){t&&(nt("Patches"),e.u=[],e.s=[],e.v=t)}function rt(e){ot(e),e.p.forEach(ct),e.p=null}function ot(e){e===St&&(St=e.l)}function st(e){return St={p:[],l:St,h:e,m:!0,_:0}}function ct(e){var t=e[Et];0===t.i||1===t.i?t.j():t.g=!0}function dt(e,t){t._=t.p.length;var n=t.p[0],a=void 0!==e&&e!==n;return t.h.O||nt("ES5").S(t,e,a),a?(n[Et].P&&(rt(t),je(4)),ze(e)&&(e=lt(t,e),t.l||ft(t,e)),t.u&&nt("Patches").M(n[Et],e,t.u,t.s)):e=lt(t,n,[]),rt(t),t.u&&t.v(t.u,t.s),e!==Ot?e:void 0}function lt(e,t,n){if(tt(t))return t;var a=t[Et];if(!a)return Ge(t,function(i,r){return ut(e,a,t,i,r,n)},!0),t;if(a.A!==e)return t;if(!a.P)return ft(e,a.t,!0),a.t;if(!a.I){a.I=!0,a.A._--;var i=4===a.i||5===a.i?a.o=Ze(a.k):a.o;Ge(3===a.i?new Set(i):i,function(t,r){return ut(e,a,i,t,r,n)}),ft(e,i,!1),n&&e.u&&nt("Patches").R(a,n,e.u,e.s)}return a.o}function ut(e,t,n,a,i,r){if(Ve(i)){var o=lt(e,i,r&&t&&3!==t.i&&!We(t.D,a)?r.concat(a):void 0);if(qe(n,a,o),!Ve(o))return;e.m=!1}if(ze(i)&&!tt(i)){if(!e.h.N&&e._<1)return;lt(e,i),t&&t.A.l||ft(e,i)}}function ft(e,t,n){void 0===n&&(n=!1),e.h.N&&e.m&&$e(t,n)}function pt(e,t){var n=e[Et];return(n?Xe(n):e)[t]}function mt(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var a=Object.getOwnPropertyDescriptor(n,t);if(a)return a;n=Object.getPrototypeOf(n)}}function _t(e){e.P||(e.P=!0,e.l&&_t(e.l))}function ht(e){e.o||(e.o=Ze(e.t))}function bt(e,t,n){var a=Ye(t)?nt("MapSet").T(t,n):Je(t)?nt("MapSet").F(t,n):e.O?function(e,t){var n=Array.isArray(e),a={i:n?1:0,A:t?t.A:at(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=a,r=Mt;n&&(i=[a],r=Pt);var o=Proxy.revocable(i,r),s=o.revoke,c=o.proxy;return a.k=c,a.j=s,c}(t,n):nt("ES5").J(t,n);return(n?n.A:at()).p.push(a),a}function gt(e){return Ve(e)||je(22,e),function e(t){if(!ze(t))return t;var n,a=t[Et],i=Ke(t);if(a){if(!a.P&&(a.i<4||!nt("ES5").K(a)))return a.t;a.I=!0,n=vt(t,i),a.I=!1}else n=vt(t,i);return Ge(n,function(t,i){a&&function(e,t){return 2===Ke(e)?e.get(t):e[t]}(a.t,t)===i||qe(n,t,e(i))}),3===i?new Set(n):n}(e)}function vt(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return Ze(e)}var yt,St,Dt="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),It="undefined"!=typeof Map,xt="undefined"!=typeof Set,Ct="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,Ot=Dt?Symbol.for("immer-nothing"):((yt={})["immer-nothing"]=!0,yt),wt=Dt?Symbol.for("immer-draftable"):"__$immer_draftable",Et=Dt?Symbol.for("immer-state"):"__$immer_state",At=("undefined"!=typeof Symbol&&Symbol.iterator,"undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames),Lt=Object.getOwnPropertyDescriptors||function(e){var t={};return At(e).forEach(function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)}),t},kt={},Mt={get:function(e,t){if(t===Et)return e;var n=Xe(e);if(!We(n,t))return function(e,t,n){var a,i=mt(t,n);return i?"value"in i?i.value:null===(a=i.get)||void 0===a?void 0:a.call(e.k):void 0}(e,n,t);var a=n[t];return e.I||!ze(a)?a:a===pt(e.t,t)?(ht(e),e.o[t]=bt(e.A.h,a,e)):a},has:function(e,t){return t in Xe(e)},ownKeys:function(e){return Reflect.ownKeys(Xe(e))},set:function(e,t,n){var a=mt(Xe(e),t);if(null==a?void 0:a.set)return a.set.call(e.k,n),!0;if(!e.P){var i=pt(Xe(e),t),r=null==i?void 0:i[Et];if(r&&r.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(Qe(n,i)&&(void 0!==n||We(e.t,t)))return!0;ht(e),_t(e)}return e.o[t]=n,e.D[t]=!0,!0},deleteProperty:function(e,t){return void 0!==pt(e.t,t)||t in e.t?(e.D[t]=!1,ht(e),_t(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=Xe(e),a=Reflect.getOwnPropertyDescriptor(n,t);return a?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:a.enumerable,value:n[t]}:a},defineProperty:function(){je(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){je(12)}},Pt={};Ge(Mt,function(e,t){Pt[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),Pt.deleteProperty=function(e,t){return Mt.deleteProperty.call(this,e[0],t)},Pt.set=function(e,t,n){return Mt.set.call(this,e[0],t,n,e[0])};var Tt=function(){function e(e){this.O=Ct,this.N=!0,"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),this.produce=this.produce.bind(this),this.produceWithPatches=this.produceWithPatches.bind(this)}var t=e.prototype;return t.produce=function(e,t,n){if("function"==typeof e&&"function"!=typeof t){var a=t;t=e;var i=this;return function(e){var n=this;void 0===e&&(e=a);for(var r=arguments.length,o=Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return i.produce(e,function(e){var a;return(a=t).call.apply(a,[n,e].concat(o))})}}var r;if("function"!=typeof t&&je(6),void 0!==n&&"function"!=typeof n&&je(7),ze(e)){var o=st(this),s=bt(this,e,void 0),c=!0;try{r=t(s),c=!1}finally{c?rt(o):ot(o)}return"undefined"!=typeof Promise&&r instanceof Promise?r.then(function(e){return it(o,n),dt(e,o)},function(e){throw rt(o),e}):(it(o,n),dt(r,o))}if(!e||"object"!=typeof e){if((r=t(e))===Ot)return;return void 0===r&&(r=e),this.N&&$e(r,!0),r}je(21,e)},t.produceWithPatches=function(e,t){var n,a,i=this;return"function"==typeof e?function(t){for(var n=arguments.length,a=Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];return i.produceWithPatches(t,function(t){return e.apply(void 0,[t].concat(a))})}:[this.produce(e,t,function(e,t){n=e,a=t}),n,a]},t.createDraft=function(e){ze(e)||je(8),Ve(e)&&(e=gt(e));var t=st(this),n=bt(this,e,void 0);return n[Et].C=!0,ot(t),n},t.finishDraft=function(e,t){var n=(e&&e[Et]).A;return it(n,t),dt(void 0,n)},t.setAutoFreeze=function(e){this.N=e},t.setUseProxies=function(e){e&&!Ct&&je(20),this.O=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var a=t[n];if(0===a.path.length&&"replace"===a.op){e=a.value;break}}var i=nt("Patches").$;return Ve(e)?i(e,t):this.produce(e,function(e){return i(e,t.slice(n+1))})},e}(),Ut=new Tt,Ft=Ut.produce,Ht=(Ut.produceWithPatches.bind(Ut),Ut.setAutoFreeze.bind(Ut),Ut.setUseProxies.bind(Ut),Ut.applyPatches.bind(Ut),Ut.createDraft.bind(Ut),Ut.finishDraft.bind(Ut),Ft),Rt=n(1198);function Nt(e,t){return e===t}function Bt(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var a=t.length,i=0;i<a;i++)if(!e(t[i],n[i]))return!1;return!0}function jt(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every(function(e){return"function"==typeof e})){var n=t.map(function(e){return typeof e}).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+n+"]")}return t}var Vt=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return function(){for(var t=arguments.length,a=Array(t),i=0;i<t;i++)a[i]=arguments[i];var r=0,o=a.pop(),s=jt(a),c=e.apply(void 0,[function(){return r++,o.apply(null,arguments)}].concat(n)),d=e(function(){for(var e=[],t=s.length,n=0;n<t;n++)e.push(s[n].apply(null,arguments));return c.apply(null,e)});return d.resultFunc=o,d.dependencies=s,d.recomputations=function(){return r},d.resetRecomputations=function(){return r=0},d}}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Nt,n=null,a=null;return function(){return Bt(t,n,arguments)||(a=e.apply(null,arguments)),n=arguments,a}});function zt(e){return function(t){var n=t.dispatch,a=t.getState;return function(t){return function(i){return"function"==typeof i?i(n,a,e):t(i)}}}}var Gt=zt();Gt.withExtraArgument=zt;var Kt=Gt;function Wt(){return Wt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Wt.apply(this,arguments)}function qt(e){return qt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qt(e)}function Qt(e,t){return Qt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Qt(e,t)}function Yt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function Jt(e,t,n){return Jt=Yt()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var i=new(Function.bind.apply(e,a));return n&&Qt(i,n.prototype),i},Jt.apply(null,arguments)}function Xt(e){var t="function"==typeof Map?new Map:void 0;return Xt=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,a)}function a(){return Jt(e,arguments,qt(this).constructor)}return a.prototype=Object.create(e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),Qt(a,e)},Xt(e)}var Zt="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?Rt.a:Rt.a.apply(null,arguments)},$t=function(e){var t,n;function a(){return e.apply(this,arguments)||this}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=a.prototype;return i.concat=function(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Jt(a,(t=e.prototype.concat).call.apply(t,[this].concat(i)))},i.prepend=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 1===t.length&&Array.isArray(t[0])?Jt(a,t[0].concat(this)):Jt(a,t.concat(this))},a}(Xt(Array));function en(e){void 0===e&&(e={});var t=e,n=t.thunk,a=void 0===n||n,i=(t.immutableCheck,t.serializableCheck,new $t);return a&&("boolean"==typeof a?i.push(Kt):i.push(Kt.withExtraArgument(a.extraArgument))),i}function tn(e,t){function n(){if(t){var n=t.apply(void 0,arguments);if(!n)throw new Error("prepareAction did not return an object");return Wt({type:e,payload:n.payload},"meta"in n&&{meta:n.meta},{},"error"in n&&{error:n.error})}return{type:e,payload:arguments.length<=0?void 0:arguments[0]}}return n.toString=function(){return""+e},n.type=e,n.match=function(t){return t.type===e},n}function nn(e){var t,n={},a=[],i={addCase:function(e,t){var a="string"==typeof e?e:e.type;if(a in n)throw new Error("addCase cannot be called with two reducers for the same action type");return n[a]=t,i},addMatcher:function(e,t){return a.push({matcher:e,reducer:t}),i},addDefaultCase:function(e){return t=e,i}};return e(i),[n,a,t]}function an(e){var t=e.name,n=e.initialState;if(!t)throw new Error("`name` is a required option for createSlice");var a=e.reducers||{},i=void 0===e.extraReducers?[]:"function"==typeof e.extraReducers?nn(e.extraReducers):[e.extraReducers],r=i[0],o=void 0===r?{}:r,s=i[1],c=void 0===s?[]:s,d=i[2],l=void 0===d?void 0:d,u=Object.keys(a),f={},p={},m={};u.forEach(function(e){var n,i,r=a[e],o=t+"/"+e;"reducer"in r?(n=r.reducer,i=r.prepare):n=r,f[e]=n,p[o]=n,m[e]=i?tn(o,i):tn(o)});var _=function(e,t,n,a){void 0===n&&(n=[]);var i="function"==typeof t?nn(t):[t,n,a],r=i[0],o=i[1],s=i[2];return function(t,n){void 0===t&&(t=e);var a=[r[n.type]].concat(o.filter(function(e){return(0,e.matcher)(n)}).map(function(e){return e.reducer}));return 0===a.filter(function(e){return!!e}).length&&(a=[s]),a.reduce(function(e,t){if(t){if(Ve(e)){var a=t(e,n);return void 0===a?e:a}if(ze(e))return Ht(e,function(e){return t(e,n)});var i=t(e,n);if(void 0===i){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return i}return e},t)}}(n,Wt({},o,{},p),c,l);return{name:t,reducer:_,actions:m,caseReducers:f}}function rn(e,t){return e.x*t.x+e.y*t.y}function on(e){return Math.hypot(e.x,e.y)}function sn(e,t){return{x:e.x+t.x,y:e.y+t.y}}function cn(e,t){return{x:e.x-t.x,y:e.y-t.y}}function dn(e){var t=on(e);if(0===t)throw new RangeError("Invalid Vector: Vector length is 0");return{x:e.x/t,y:e.y/t}}function ln(e,t){return{x:e.x*t,y:e.y*t}}function un(e){return{x:Math.round(e.x),y:Math.round(e.y)}}function fn(e){return{x:V(e.x,0),y:V(e.y,0)}}function pn(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function mn(e,t){if(0===t.x||0===t.y)throw new RangeError("Invalid divisor vector.  Elements must be non-zero.");return{x:e.x/t.x,y:e.y/t.y}}function _n(e,t){return e.x===t.x&&e.y===t.y}function hn(e){return e.x>=0&&e.x<=1&&e.y>=0&&e.y<=1}function bn(e,t,n){return e*(1-n)+t*n}function gn(e,t,n){var a=(n-e)/(t-e);return Math.min(Math.max(a,0),1)}function vn(e,t){return function(n){return bn(e,t,n)}}"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator"))),function(){function e(e,t){var n=i[e];return n?n.enumerable=t:i[e]=n={configurable:!0,enumerable:t,get:function(){var t=this[Et];return Mt.get(t,e)},set:function(t){var n=this[Et];Mt.set(n,e,t)}},n}function t(e){for(var t=e.length-1;t>=0;t--){var i=e[t][Et];if(!i.P)switch(i.i){case 5:a(i)&&_t(i);break;case 4:n(i)&&_t(i)}}}function n(e){for(var t=e.t,n=e.k,a=At(n),i=a.length-1;i>=0;i--){var r=a[i];if(r!==Et){var o=t[r];if(void 0===o&&!We(t,r))return!0;var s=n[r],c=s&&s[Et];if(c?c.t!==o:!Qe(s,o))return!0}}var d=!!t[Et];return a.length!==At(t).length+(d?0:1)}function a(e){var t=e.k;if(t.length!==e.t.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!n||n.get)}var i={};!function(e,t){kt.ES5||(kt.ES5=t)}(0,{J:function(t,n){var a=Array.isArray(t),i=function(t,n){if(t){for(var a=Array(n.length),i=0;i<n.length;i++)Object.defineProperty(a,""+i,e(i,!0));return a}var r=Lt(n);delete r[Et];for(var o=At(r),s=0;s<o.length;s++){var c=o[s];r[c]=e(c,t||!!r[c].enumerable)}return Object.create(Object.getPrototypeOf(n),r)}(a,t),r={i:a?5:4,A:n?n.A:at(),P:!1,I:!1,D:{},l:n,t:t,k:i,o:null,g:!1,C:!1};return Object.defineProperty(i,Et,{value:r,writable:!0}),i},S:function(e,n,i){i?Ve(n)&&n[Et].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var n=t[Et];if(n){var i=n.t,r=n.k,o=n.D,s=n.i;if(4===s)Ge(r,function(t){t!==Et&&(void 0!==i[t]||We(i,t)?o[t]||e(r[t]):(o[t]=!0,_t(n)))}),Ge(i,function(e){void 0!==r[e]||We(r,e)||(o[e]=!1,_t(n))});else if(5===s){if(a(n)&&(_t(n),o.length=!0),r.length<i.length)for(var c=r.length;c<i.length;c++)o[c]=!1;else for(var d=i.length;d<r.length;d++)o[d]=!0;for(var l=Math.min(r.length,i.length),u=0;u<l;u++)void 0===o[u]&&e(r[u])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):a(e)}})}();var yn=180/Math.PI;function Sn(e,t,n){return 0===V(t-e,n)}function Dn(e){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function In(e){return void 0===e&&(e=0),[-1,0,2*e,0,1,0]}function xn(e){return void 0===e&&(e=0),[1,0,0,0,-1,2*e]}function Cn(e,t){return void 0===t&&(t=e),[e,0,0,0,t,0]}function On(e,t,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),[e,0,(e-1)*-n,0,t,(t-1)*-a]}function wn(e,t){return[1,0,e,0,1,t]}function En(e){return[e[0],e[1],Math.round(e[2]),e[3],e[4],Math.round(e[5])]}function An(e){var t=e*Math.PI/180,n=Math.cos(t),a=Math.sin(t);return[n,-a,0,a,n,0]}function Ln(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),Vn(wn(t,n),An(e),wn(-t,-n))}function kn(e){return(t=Math.atan2(e[4],e[1])*yn-90)>180?t-=360:t<=-180&&(t+=360),t;var t}function Mn(e){return e[0]*e[4]-e[1]*e[3]}function Pn(e){return 0!==Mn(e)}function Tn(e){var t=Mn(e);if(0===t)throw new RangeError("Invalid Matrix: determinant is zero");var n=1/t,a=e[0],i=e[1],r=e[2],o=e[3],s=e[4],c=e[5];return[s*n,-i*n,(i*c-r*s)*n,-o*n,a*n,(r*o-a*c)*n]}function Un(e,t){return{x:t.x*e[0]+t.y*e[1]+e[2],y:t.x*e[3]+t.y*e[4]+e[5]}}function Fn(e){return{x:e[0],y:e[3]}}function Hn(e){return{x:e[1],y:e[4]}}function Rn(e){return dn(Fn(e))}function Nn(e){return dn(Hn(e))}function Bn(e){return[{x:e[2],y:e[5]},{x:e[0]+e[2],y:e[3]+e[5]},{x:e[0]+e[1]+e[2],y:e[3]+e[4]+e[5]},{x:e[1]+e[2],y:e[4]+e[5]}]}function jn(e,t){return Un(Tn(e),t)}function Vn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduceRight(function(e,t){return[t[0]*e[0]+t[1]*e[3],t[0]*e[1]+t[1]*e[4],t[0]*e[2]+t[1]*e[5]+t[2],t[3]*e[0]+t[4]*e[3],t[3]*e[1]+t[4]*e[4],t[3]*e[2]+t[4]*e[5]+t[5]]},[1,0,0,0,1,0])}function zn(e){return Gn(e,1,1)}function Gn(e,t,n){if(0===t)throw new RangeError("Width cannot be 0");if(0===n)throw new RangeError("Height cannot be 0");var a=Mn(e=Vn(Cn(1/t,1/n),e));return Math.sqrt(Math.abs(a))}function Kn(e,t,n){return e.every(function(e,a){return Sn(e,t[a],n)})}function Wn(e,t){return e.every(function(e,n){return e===t[n]})}function qn(e){return{x:e[2],y:e[5]}}function Qn(e,t){var n=Fn(e),a=Hn(e),i=qn(e),r=Rn(e),o=Nn(e),s=on(n),c=ln(n,(s+2*t)/s),d=on(a),l=ln(a,(d+2*t)/d),u=cn(i,sn(ln(r,t),ln(o,t)));return[c.x,l.x,u.x,c.y,l.y,u.y]}function Yn(e){return[e[0],e[3],e[1],e[4],e[2],e[5]]}function Jn(e,t,n){if(e.isActive){if(void 0===e.startTime)return{startTime:t,isActive:!0};if(Xn(e,t,n)>=1)return{startTime:void 0,isActive:!1}}return e}function Xn(e,t,n){return e.isActive?void 0!==e.startTime?gn(e.startTime,e.startTime+n,t):0:1}var Zn=function(e){return e},$n=function(e){return.5+.5*Math.sin(-Math.PI/2+e*Math.PI)},ea=function(){return ea=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ea.apply(this,arguments)};function ta(e,t,n,a){return void 0===e&&(e=void 0),void 0===t&&(t=void 0),void 0===n&&(n=void 0),void 0===a&&(a={startTime:void 0,isActive:!1}),ea(ea({},a),{startMatrix:e?Dn(e):[1,0,0,0,1,0],endMatrix:t?Dn(t):[1,0,0,0,1,0],animatedMatrix:n?Dn(n):void 0})}function na(){return ta()}function aa(e,t,n){return e.isActive&&e.animatedMatrix&&(t=e.animatedMatrix),ta(t=En(t),n=En(n),t,{startTime:void 0,isActive:!0})}function ia(e,t,n,a){void 0===a&&(a=Zn);var i,r,o,s=Jn(e,t,n);if(s.isActive){var c=Xn(e,t,n),d=(i=e.startMatrix,r=e.endMatrix,o=a(c),[bn(i[0],r[0],o),bn(i[1],r[1],o),bn(i[2],r[2],o),bn(i[3],r[3],o),bn(i[4],r[4],o),bn(i[5],r[5],o)]);return ta(e.startMatrix,e.endMatrix,d,s)}return na()}var ra=function(){return ra=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ra.apply(this,arguments)};function oa(e,t){return void 0===e&&(e=void 0),void 0===t&&(t={startTime:void 0,isActive:!1}),ra(ra({},t),{numGridLines:e})}function sa(e){return oa(e,{startTime:void 0,isActive:!0})}var ca,da,la,ua=function(e){return{left:e,right:e,top:e,bottom:e}};function fa(e,t,n){var a=function(e,t){return{left:Math.round(t.left*e),right:Math.round(t.right*e),top:Math.round(t.top*e),bottom:Math.round(t.bottom*e)}}(t,n);return{top:a.top,left:a.left,width:Math.max(1,e.x-a.left-a.right),height:Math.max(1,e.y-a.top-a.bottom)}}!function(e){e[e.None=-1]="None",e[e.TopLeft=0]="TopLeft",e[e.TopCenter=1]="TopCenter",e[e.TopRight=2]="TopRight",e[e.SideLeft=3]="SideLeft",e[e.Center=4]="Center",e[e.SideRight=5]="SideRight",e[e.BottomLeft=6]="BottomLeft",e[e.BottomCenter=7]="BottomCenter",e[e.BottomRight=8]="BottomRight"}(ca||(ca={})),function(e){e[e.usingNineSliceCropHandles=0]="usingNineSliceCropHandles",e[e.selectingFirstCorner=1]="selectingFirstCorner",e[e.selectingSecondCorner=2]="selectingSecondCorner",e[e.draggingView=3]="draggingView",e[e.draggingImage=4]="draggingImage",e[e.rotating=5]="rotating",e[e.zoomToCrop=6]="zoomToCrop",e[e.keyboardCropping=7]="keyboardCropping",e[e.keyboardRotating=8]="keyboardRotating",e[e.none=9]="none",e[e.disabled=10]="disabled"}(da||(da={})),function(e){e[e.none=0]="none",e[e.fitCropRectInView=1]="fitCropRectInView",e[e.fitImageInView=2]="fitImageInView",e[e.actualSize=3]="actualSize"}(la||(la={}));var pa=window.devicePixelRatio||1,ma=da.none,_a=la.fitCropRectInView,ha=we.None,ba={userDefinedDefaults:void 0,image:{originalPixelSize:{x:1,y:1},_preciseUvToWorld:[1,0,0,0,1,0],loadedPixelSize:void 0},view:{worldToView:[1,0,0,0,1,0],viewFitting:{mode:_a,marginCssPixels:ua(0)},viewportPixelSize:{x:1,y:1},allowDraggingView:!1,viewportCssSize:{width:"100%",height:"100%"},enableZoomToView:!1,animateViewWhenViewportIsResized:!1},cropUiDisplay:{handleSizeCss:28,handleHitAreaSizeCss:50,areCropOverlaysVisible:!1},cropInteraction:{mode:ma,activeHandleIndex:ca.None,focusedHandleIndex:ca.None,isKeyboardFocused:!1,rectAtStartOfResize:{top:0,left:0,width:0,height:0},uvToWorld:[1,0,0,0,1,0],_uvToWorldBeforeRotate:[1,0,0,0,1,0],_uvToWorldBeforeZoomToCrop:[1,0,0,0,1,0],_lastUvToWorldNotSetByAspectRatioChange:[1,0,0,0,1,0],aspectRatioConstraint:ha,shouldInvertOriginalAspectRatio:!1,rectTopLeftInImageUv:{x:0,y:0},rectBottomRightInImageUv:{x:1,y:1},shouldConstrainInImage:!0,allowDraggingImageOutsideRect:!0,enableZoomToCrop:!0},rotationUi:{isKeyboardFocused:!1,deadZoneCenterPos:0,rotationBarPointer:{movePos:{x:0,y:0},isDown:!1}},device:{pixelRatio:pa},pointer:{movePos:{x:0,y:0},pointerDowns:[],preventShift:!1,offset:{x:0,y:0},imageUvGrabPosition:{x:0,y:0},downOffsetFromCropHandleCenter:{x:0,y:0}},animations:{needsFrameTick:!1,currentTime:0,outsideCropVisibility:{startTime:void 0,isActive:!1},gridLineVisibility:oa(),dismissGridLineVisibility:{startTime:void 0,isActive:!1},dismissOutsideCropVisibility:{startTime:void 0,isActive:!1},worldToView:ta(),image:ta(),crop:ta(),transitionToViewingOriginal:{startTime:void 0,isActive:!1},dismissCropOverlays:{startTime:void 0,isActive:!1}},touch:{scale:1,isDown:!1,downCenterPos:{x:0,y:0}}},ga=function(){return ga=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ga.apply(this,arguments)};function va(e){return{top:Math.round(e.top),left:Math.round(e.left),width:Math.round(Math.max(1,e.width)),height:Math.round(Math.max(1,e.height))}}var ya,Sa={top:0,left:0,width:1,height:1};function Da(e,t){return e.x>=t.left&&e.x<=t.left+t.width&&e.y>=t.top&&e.y<=t.top+t.height}function Ia(e,t){return Da({x:e.left,y:e.top},t)&&Da({x:e.left+e.width,y:e.top+e.height},t)}function xa(e){return{x:e.left+e.width/2,y:e.top+e.height/2}}function Ca(e,t,n){return void 0===n?e.top===t.top&&e.left===t.left&&e.width===t.width&&e.height===t.height:V(e.top,n)===V(t.top,n)&&V(e.left,n)===V(t.left,n)&&V(e.width,n)===V(t.width,n)&&V(e.height,n)===V(t.height,n)}function Oa(e,t){return e.width<t.width||e.height<t.height}function wa(e,t,n){return e.width>=t&&e.height>=(void 0===n?t:n)}function Ea(e){var t=Cn(e.width,e.height);return Vn(wn(e.left,e.top),t)}function Aa(e){var t=Bn(e),n=Math.min.apply(Math,t.map(function(e){return e.x})),a=Math.min.apply(Math,t.map(function(e){return e.y}));return{left:n,top:a,width:Math.max.apply(Math,t.map(function(e){return e.x}))-n,height:Math.max.apply(Math,t.map(function(e){return e.y}))-a}}function La(e){var t=Aa(e);return{x:t.width,y:t.height}}function ka(e){return La(Vn(An(-kn(e)),e))}function Ma(e){return Un(e,{x:.5,y:.5})}function Pa(e,t,n){var a=Ma(t);return Vn(Ln(e,a.x,a.y),n)}function Ta(e,t,n,a){var i=e,r=n,o=a,s=cn(t,i),c=cn(r,o),d=cn(r,i),l=[s.x,c.x,0,s.y,c.y,0];if(Pn(l)){var u=jn(l,d),f=u.x,p=u.y;if(p>=0&&p<=1&&f>0)return f}}function Ua(e,t,n,a){for(var i=a/2,r=[t-i,t+i,t+n-i,t+n+i],o=0;o<3;o++)if(e>=r[o]&&e<=r[o+1])return o;return-1}function Fa(e){return e%3-1}function Ha(e){return Math.floor(e/3)-1}function Ra(e,t,n){var a=t.left,i=t.width,r=t.top,o=t.height,s=Ua(e.x,a,i,n);if(-1===s)return-1;var c=Ua(e.y,r,o,n);return-1===c?-1:3*c+s}function Na(e){return{x:(Fa(e)+1)/2,y:(Ha(e)+1)/2}}function Ba(e,t){return Math.floor(e*t)}function ja(e,t){return e*t}!function(e){e.Right="Right",e.Left="Left",e.Up="Up",e.Down="Down",e.None="None"}(ya||(ya={}));var Va=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)a[i]=r[o];return a};function za(e,t){var n=Bn(e),a=n[0],i=n[1],r=n[2],o=n[3],s=Bn(t),c=s[0],d=s[1],l=s[2],u=s[3],f=on(cn(d,c)),p=on(cn(u,c));if(0===f||0===p){var m=ln(cn(l,c),.5),_=ln(cn(r,a),.5),h=cn(m,_);return{tx:h.x,ty:h.y,scale:0}}var b=dn(cn(d,c)),g={x:-b.y,y:b.x},v={x:rn(a,b),y:rn(a,g)},y={x:rn(i,b),y:rn(i,g)},S={x:rn(r,b),y:rn(r,g)},D={x:rn(o,b),y:rn(o,g)},I=Math.min(v.x,y.x,S.x,D.x),x=Math.min(v.y,y.y,S.y,D.y),C=Math.max(v.x,y.x,S.x,D.x),O=Math.max(v.y,y.y,S.y,D.y)-x,w=C-I,E=on(cn(d,c)),A=on(cn(u,c)),L=Math.min(E/w,A/O),k=Vn(Cn(L,L),e),M=Un(k,{x:0,y:0}),P=pn(Un(k,{x:1,y:1}),M),T=cn(pn(l,c),P);return{tx:T.x,ty:T.y,scale:L}}var Ga={horizontalTopLeftToRight:{fixedEnd:ca.TopLeft,freeEnd:ca.TopRight},horizontalTopRightToLeft:{fixedEnd:ca.TopRight,freeEnd:ca.TopLeft},horizontalBottomLeftToRight:{fixedEnd:ca.BottomLeft,freeEnd:ca.BottomRight},horizontalBottomRightToLeft:{fixedEnd:ca.BottomRight,freeEnd:ca.BottomLeft},verticalLeftTopToBottom:{fixedEnd:ca.TopLeft,freeEnd:ca.BottomLeft},verticalLeftBottomToTop:{fixedEnd:ca.BottomLeft,freeEnd:ca.TopLeft},verticalRightTopToBottom:{fixedEnd:ca.TopRight,freeEnd:ca.BottomRight},verticalRightBottomToTop:{fixedEnd:ca.BottomRight,freeEnd:ca.TopRight},diagonalTopLeftToBottomRight:{fixedEnd:ca.TopLeft,freeEnd:ca.BottomRight},diagonalBottomRightToTopLeft:{fixedEnd:ca.BottomRight,freeEnd:ca.TopLeft},diagonalTopRightToBottomLeft:{fixedEnd:ca.TopRight,freeEnd:ca.BottomLeft},diagonalBottomLeftToTopRight:{fixedEnd:ca.BottomLeft,freeEnd:ca.TopRight}},Ka={leftToRight:[Ga.horizontalTopLeftToRight,Ga.horizontalBottomLeftToRight],rightToLeft:[Ga.horizontalTopRightToLeft,Ga.horizontalBottomRightToLeft],topToBottom:[Ga.verticalLeftTopToBottom,Ga.verticalRightTopToBottom],bottomToTop:[Ga.verticalLeftBottomToTop,Ga.verticalRightBottomToTop],fromTopLeft:[Ga.horizontalTopLeftToRight,Ga.verticalLeftTopToBottom,Ga.diagonalTopLeftToBottomRight],fromTopRight:[Ga.horizontalTopRightToLeft,Ga.verticalRightTopToBottom,Ga.diagonalTopRightToBottomLeft],fromBottomLeft:[Ga.verticalLeftBottomToTop,Ga.horizontalBottomLeftToRight,Ga.diagonalBottomLeftToTopRight],fromBottomRight:[Ga.verticalRightBottomToTop,Ga.horizontalBottomRightToLeft,Ga.diagonalBottomRightToTopLeft]};function Wa(e,t,n,a,i,r){var o,s,c=(s=n,[Math.round(s[0]),Math.round(s[1]),Math.round(s[2]),Math.round(s[3]),Math.round(s[4]),Math.round(s[5])]),d=Bn(c);return e.forEach(function(e){var n=null!=o?o:t,s=function(e,t,n,a,i,r,o){for(var s=Un(e,Na(a.fixedEnd)),c=Un(e,Na(a.freeEnd)),d=0,l=void 0,u=0;u<n.length;u++){var f=Ta(s,c,n[u],n[(u+1)%n.length]);void 0!==f&&hn(jn(t,sn(s,ln(cn(c,s),.5*f))))&&(d=Math.max(d,f))}return d<1&&d>0&&(l=function(e,t,n,a,i,r,o){var s=e===we.None,c=t.x===n.x,d=t.y===n.y,l=s&&c?1:r,u=s&&d?1:r,f=t.x,p=t.y,m=Aa(a);return i===ca.TopCenter||i===ca.BottomCenter?s?l=1:(f=m.left+m.width/2,l-=1-r,u-=1-r):i!==ca.SideLeft&&i!==ca.SideRight||(s?u=1:(p=m.top+m.height/2,l-=1-r,u-=1-r)),o===ya.Right||o===ya.Left?u=1:o!==ya.Up&&o!==ya.Down||(l=1),On(l,u,f,p)}(i,s,c,e,r,d,o)),l}(n,c,d,e,a,i,r);void 0!==s&&(o=Vn(s,n))}),o}function qa(e,t){var n=Tn(e),a=Bn(t).map(function(e){return Un(n,e)}).reduce(function(e,t){var n=0;t.x<0?n=-t.x:t.x>1&&(n=1-t.x);var a=0;return t.y<0?a=-t.y:t.y>1&&(a=1-t.y),Math.abs(n)>Math.abs(e.x)&&(e.x=n),Math.abs(a)>Math.abs(e.y)&&(e.y=a),e},{x:0,y:0}),i=qn(e);return cn(Un(e,a),i)}function Qa(e,t,n,a){var i=Dn(e),r=n===we.None,o=null;switch(a){case ca.TopLeft:o=Ka.fromBottomRight;break;case ca.TopCenter:o=r?Ka.bottomToTop:Va(Ka.fromBottomRight,Ka.fromBottomLeft);break;case ca.TopRight:o=Ka.fromBottomLeft;break;case ca.SideLeft:o=r?Ka.rightToLeft:Va(Ka.fromBottomRight,Ka.fromTopRight);break;case ca.Center:var s=qa(t,e);i=Vn(wn(s.x,s.y),e);break;case ca.SideRight:o=r?Ka.leftToRight:Va(Ka.fromBottomLeft,Ka.fromTopLeft);break;case ca.BottomLeft:o=Ka.fromTopRight;break;case ca.BottomCenter:o=r?Ka.topToBottom:Va(Ka.fromTopLeft,Ka.fromTopRight);break;case ca.BottomRight:o=Ka.fromTopLeft}return o&&(i=Wa(o,e,t,n,a)),i?Ea(va(Aa(i))):e}function Ya(e,t){var n=Bn(e),a=Bn(t),i=pn(n[2],n[0]);if(hn(jn(t,i))){var r=Number.MAX_VALUE;return n.forEach(function(e){for(var t=0;t<a.length;t++){var n=Ta(i,e,a[t],a[(t+1)%a.length]);void 0!==n&&(r=Math.min(r,n))}}),r===Number.MAX_VALUE?void 0:r}}function Ja(e,t,n){var a=Ya(e,t);if(void 0!==a){if(a<1){var i=Ma(e);return Ea(va(Aa(Vn(On(a,a,i.x,i.y),e))))}return e}var r=za(n,t),o=r.tx,s=r.ty,c=n,d=Cn(r.scale);return Vn(wn(o,s),d,c)}function Xa(e){return e!==ca.None&&e!==ca.Center}var Za=function(e,t,n){return Math.min(Math.max(e,t),n)},$a=5/95;function ei(e,t,n){return Vn(function(e,t,n,a,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var o=Gn(e,1,1);if(0===o)throw new RangeError("Invalid Matrix");var s=t/o;return On(s,s,i,r)}(e,t,0,0,n.x,n.y),e)}var ti=function(e,t){return function(){var n=za(t,Ea(e)),a=n.tx,i=n.ty,r=n.scale,o=Cn(r),s=Vn(wn(a,i),o);if(r>50){var c=50/r,d=xa(e);return Vn(On(c,c,d.x,d.y),s)}return s}};function ni(e,t){void 0===t&&(t=!1),e.image.loadedPixelSize||(t=!1);var n,a,i,r,o,s,c=e.pointer.pointerDowns.length>0&&Xa(e.cropInteraction.activeHandleIndex),d=(n=e.view.viewFitting.mode,a=fa(e.view.viewportPixelSize,e.device.pixelRatio,e.view.viewFitting.marginCssPixels),i=function(e,t,n){if(e){var a=Aa(t);return n.width<a.width&&n.height>a.height&&(a.top=n.top,a.height=n.height),n.height<a.height&&n.width>a.width&&(a.left=n.left,a.width=n.width),Ea(a)}return Dn(t)}(c,e.cropInteraction.uvToWorld,e.cropInteraction.rectAtStartOfResize),r=e.image._preciseUvToWorld,o=e.view.worldToView,En(((s={})[la.none]=function(e){return function(){return e}}(o),s[la.fitCropRectInView]=ti(a,i),s[la.fitImageInView]=ti(a,r),s[la.actualSize]=function(e,t){return function(){var n=xa(e);return ei(t,1,n)}}(a,o),s)[n]()));t?(e.animations.needsFrameTick=!0,e.animations.worldToView=aa(e.animations.worldToView,e.view.worldToView,d)):e.animations.worldToView=na(),e.view.worldToView=d}function ai(e){ni(e,!0)}function ii(e){return e===da.zoomToCrop||e===da.keyboardCropping||e===da.keyboardRotating}function ri(e,t){t=Za(t,0,1),t*=e.length-1;var n=Math.floor(t),a=Math.ceil(t);return t===n?e[n]:bn(e[n],e[a],gn(n,a,t))}var oi="Crop",si="Adjustment",ci="Filter",di="Markup";var li=function(){return li=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},li.apply(this,arguments)};function ui(e){var t=En(e.image._preciseUvToWorld);e.cropInteraction.rectTopLeftInImageUv=jn(t,Un(e.cropInteraction.uvToWorld,{x:0,y:0})),e.cropInteraction.rectBottomRightInImageUv=jn(t,Un(e.cropInteraction.uvToWorld,{x:1,y:1}))}function fi(e,t,n,a){void 0===a&&(a=!1),a?(e.needsFrameTick=!0,e.image=aa(e.image,t,n)):e.image=na()}function pi(e,t,n){return Vn(t(n),e)}function mi(e){e.cropUiDisplay.areCropOverlaysVisible=!1,e.animations.needsFrameTick=!0,e.animations.dismissCropOverlays={startTime:void 0,isActive:!0}}function _i(e){return e.animations.image.isActive}function hi(e,t){var n=!_i(e);fi(e.animations,e.image._preciseUvToWorld,t,n),e.animations.crop=na(),e.image._preciseUvToWorld=t,ui(e),mi(e)}var bi,gi=function(){return gi=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},gi.apply(this,arguments)};function vi(e,t){void 0===t&&(t=bi.unspecified);var n=Dn(e),a=gi({uvToWorld:n},function(e,t){var n={};return t!==bi.userIsRotating&&(n._uvToWorldBeforeRotate=Dn(e)),t!==bi.userIsZoomingToCrop&&(n._uvToWorldBeforeZoomToCrop=Dn(e)),t!==bi.userIsChangingAspectRatio&&(n._lastUvToWorldNotSetByAspectRatioChange=Dn(e)),n}(n,t));return a}function yi(e,t,n){void 0===n&&(n=bi.unspecified),e.cropInteraction=gi(gi({},e.cropInteraction),vi(t,n))}function Si(e,t){return void 0===t&&(t=bi.unspecified),vi(Ea(e),t)}function Di(e,t,n){void 0===n&&(n=bi.unspecified),yi(e,Ea(t),n)}function Ii(e,t){return!e||hn(t)}function xi(e,t){e.image._preciseUvToWorld=Pa(t,e.cropInteraction._uvToWorldBeforeRotate,e.image._preciseUvToWorld),e.animations.image=na(),e.animations.crop=na(),e.cropInteraction.shouldConstrainInImage&&yi(e,Ja(e.cropInteraction._uvToWorldBeforeRotate,e.image._preciseUvToWorld,e.cropInteraction.uvToWorld),bi.userIsRotating),ui(e)}!function(e){e[e.userIsRotating=0]="userIsRotating",e[e.userIsZoomingToCrop=1]="userIsZoomingToCrop",e[e.userIsChangingAspectRatio=2]="userIsChangingAspectRatio",e[e.unspecified=3]="unspecified"}(bi||(bi={}));var Ci,Oi=function(){return Oi=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Oi.apply(this,arguments)},wi=new Map([[we.Square,{x:1,y:1}],[we.FourByThree,{x:4,y:3}],[we.FiveByFour,{x:5,y:4}],[we.ThreeByTwo,{x:3,y:2}],[we.TwoByOne,{x:2,y:1}],[we.SixteenByNine,{x:16,y:9}],[we.ThreeByFour,{x:3,y:4}],[we.FourByFive,{x:4,y:5}],[we.TwoByThree,{x:2,y:3}],[we.OneByTwo,{x:1,y:2}],[we.NineBySixteen,{x:9,y:16}]]);function Ei(e){var t=un(La(e));return t.x/t.y}function Ai(e,t,n,a){var i;if(e===we.Original)i=a?n.y/n.x:n.x/n.y;else if(e===we.None){var r=Aa(t);i=r.width/r.height}else{var o=wi.get(e);i=o?o.x/o.y:0}return i}function Li(e){return Array.from(wi.values()).reduce(function(t,n){var a=t.x/t.y,i=n.x/n.y;return Math.abs(i-e)<Math.abs(a-e)&&(t=Oi({},n)),t},{x:1,y:1})}function ki(e,t,n){var a=Oi({},e),i=Math.hypot(e.width,e.height),r=ln(dn({x:t,y:1}),i);if(a.width=r.x,a.height=r.y,void 0!==n){var o=Fa(n),s=Ha(n);-1===o?a.left+=e.width-a.width:0===o&&(a.left+=(e.width-a.width)/2),-1===s?a.top+=e.height-a.height:0===s&&(a.top+=(e.height-a.height)/2)}return a}function Mi(e){var t=function(t,n){return e>t&&e<=n};return t(-45,45)?e:t(45,135)?e-90:t(-135,-45)?e+90:t(135,180)?e-180:e+180}function Pi(e,t){var n=e+t;return n>180?-360+n:n<=-180?360+n:n}function Ti(e,t,n,a){return e.x+a/45*t+n*Math.sign(a)}function Ui(e,t){var n;xi(e,(n=Mi(kn(e.image._preciseUvToWorld)),Za(t,Ni,Ri)-n)),mi(e)}function Fi(e,t,n){if(e.rotationUi.rotationBarPointer.isDown){if(n){var a=kn(e.image._preciseUvToWorld);n.logRotateEvent({angle:a,inputType:t})}e.rotationUi.rotationBarPointer.isDown=!1,e.animations.needsFrameTick=!0,e.animations.gridLineVisibility=sa(8),e.cropInteraction.mode=ma}}!function(e){e[e.Clockwise=0]="Clockwise",e[e.CounterClockwise=1]="CounterClockwise"}(Ci||(Ci={}));var Hi=function(){return Hi=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Hi.apply(this,arguments)},Ri=45-1e-12,Ni=-44.999999999999,Bi=function(){return Bi=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Bi.apply(this,arguments)};function ji(e,t,n){var a=cn(e,t);return En(Vn(wn(a.x,a.y),n))}function Vi(e,t,n){return Un(Tn(Vn(t,En(n))),e)}var zi=function(){return zi=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},zi.apply(this,arguments)};function Gi(e,t,n){return 0!==zn(t)&&Da(Vi(e,t,n),Sa)}function Ki(e,t){return(3*e+8)/t}function Wi(e,t){return Ki(e,zn(t))}function qi(e){var t=e.cropUiDisplay.areCropOverlaysVisible,n=function(e){return e.cropInteraction.mode===da.usingNineSliceCropHandles||e.cropInteraction.mode===da.keyboardCropping||e.cropInteraction.mode===da.zoomToCrop||e.cropInteraction.mode===da.selectingSecondCorner||e.cropInteraction.isKeyboardFocused&&e.cropInteraction.focusedHandleIndex!==ca.Center&&e.cropInteraction.focusedHandleIndex!==ca.None||e.rotationUi.rotationBarPointer.isDown||e.rotationUi.isKeyboardFocused}(e);e.cropUiDisplay.areCropOverlaysVisible=n,!n&&t&&mi(e)}function Qi(e,t){return t||e.cropInteraction.aspectRatioConstraint!==we.None?Ai(e.cropInteraction.aspectRatioConstraint,e.cropInteraction.uvToWorld,e.image.originalPixelSize,e.cropInteraction.shouldInvertOriginalAspectRatio):void 0}function Yi(e,t){e.view.worldToView=ji(t,e.pointer.movePos,e.view.worldToView),e.animations.worldToView=na(),e.view.viewFitting.mode=la.none}function Ji(e,t,n,a,i){var r=Un(Tn(Vn(e,t)),i),o=Un(t,a),s=cn(Un(t,r),o),c=cn(s,qa(Vn(wn(s.x,s.y),t),n));return 0===c.x&&0===c.y?t:Vn(wn(c.x,c.y),t)}function Xi(e,t){var n=ca.TopLeft;return e.x<=t.x?n=e.y<=t.y?ca.BottomRight:ca.TopRight:e.y<=t.y&&(n=ca.BottomLeft),n}function Zi(e,t){if(e.cropInteraction.enableZoomToCrop)throw new Error("getZoomViewResult should not be invoked when in zoom-to-crop mode.");var n=za(e.cropInteraction.uvToWorld,Ea(fa(e.view.viewportPixelSize,e.device.pixelRatio,e.view.viewFitting.marginCssPixels))).scale,a=function(e,t){return Za(e,t,50)}(t,n);return{zoomScaleToFitCroppedImageInView:n,zoomLevel:a,zoomIsMinimum:a<=n,zoomIsMaximum:50===a}}function $i(e,t,n){var a=Aa(Vn(e,t)),i=a.left,r=a.top,o=a.width,s=a.height,c=n.x/2-i,d=n.y/2-r,l=c-o,u=d-s;return{x:c<0?c:l>0?l:0,y:d<0?d:u>0?u:0}}function er(e,t,n,a,i){void 0===i&&(i=!1);var r=Zi(e,t);if(a&&a.logZoomEvent({zoomLevel:r.zoomLevel/r.zoomScaleToFitCroppedImageInView}),r.zoomIsMinimum)return e.view.viewFitting.mode=la.fitCropRectInView,ai(e),r;e.view.viewFitting.mode=la.none;var o=ei(e.view.worldToView,r.zoomLevel,n),s=$i(o,e.cropInteraction.uvToWorld,e.view.viewportPixelSize),c=En(Vn(wn(s.x,s.y),o));return i?(e.animations.needsFrameTick=!0,e.animations.worldToView=aa(e.animations.worldToView,e.view.worldToView,c)):e.animations.worldToView=na(),e.view.worldToView=c,r}var tr=function(){return tr=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},tr.apply(this,arguments)};function nr(e,t,n){return vi(Qa(t,e.image._preciseUvToWorld,e.cropInteraction.aspectRatioConstraint,n),bi.userIsZoomingToCrop)}function ar(e,t){var n=Aa(e.cropInteraction.uvToWorld),a=t>0,i=Wi(Ba(e.cropUiDisplay.handleSizeCss,e.device.pixelRatio),e.view.worldToView),r=Aa(e.cropInteraction._uvToWorldBeforeZoomToCrop),o=r.width/r.height,s=function(e,t,n,a,i,r,o){var s=t!==we.None,c=Aa(n),d=La(n),l=Aa(a),u=La(a),f=ln(d,e),p=cn(u,d),m=mn(p,f),_=f.x>p.x?m.x:1,h=f.y>p.y?m.y:1,b=ln(f,Math.min(_,h)),g=ln(b,.5),v=cn({x:c.left,y:c.top},g),y=sn({x:l.left,y:l.top},u),S=sn(d,b),D=u.y===d.x&&g.x>0,I=u.x===d.y&&g.y>0,x=Za(z(v.x),l.left,y.x),C=Za(z(v.y),l.top,y.y),O=D?c.left:x,w=I?c.top:C,E={left:O,top:w,width:Za(S.x,i,l.left+u.x-O),height:Za(S.y,i,l.top+u.y-w)},A=Ea(E);return ki(E,s?Ai(t,A,u,o):r)}(t,e.cropInteraction.aspectRatioConstraint,e.cropInteraction.uvToWorld,e.image._preciseUvToWorld,i,o,e.cropInteraction.shouldInvertOriginalAspectRatio),c=Si(function(e,t){return{top:Math.round(e.top),left:Math.round(e.left),width:t?Math.ceil(Math.max(1,e.width)):Math.floor(Math.max(1,e.width)),height:t?Math.ceil(Math.max(1,e.height)):Math.floor(Math.max(1,e.height))}}(s,a),bi.userIsZoomingToCrop);return e.cropInteraction.shouldConstrainInImage&&a&&(Mi(kn(e.image._preciseUvToWorld))>0?(c=tr(tr({},c),nr(e,c.uvToWorld,ca.TopRight)),c=tr(tr({},c),nr(e,c.uvToWorld,ca.BottomLeft))):(c=tr(tr({},c),nr(e,c.uvToWorld,ca.TopLeft)),c=tr(tr({},c),nr(e,c.uvToWorld,ca.BottomRight))),Oa(Aa(c.uvToWorld),n)&&(c=tr(tr({},c),Si(n,bi.userIsZoomingToCrop)))),c}function ir(e,t,n,a){if(0!==t){var i=ar(e,t);a&&a.logZoomEvent({zoomLevel:t}),Object.assign(e.cropInteraction,i),e.view.viewFitting.mode=la.fitCropRectInView,n&&(e.animations.needsFrameTick=!0,e.cropInteraction.mode!==da.zoomToCrop&&(e.cropInteraction.mode=da.zoomToCrop,e.animations.gridLineVisibility=sa(2),e.animations.outsideCropVisibility={startTime:void 0,isActive:!0}),e.animations.dismissGridLineVisibility={startTime:void 0,isActive:!0},e.animations.dismissOutsideCropVisibility={startTime:void 0,isActive:!0}),mi(e),ni(e)}}function rr(e,t,n){er(e,t,ln(e.view.viewportPixelSize,.5),n,!0)}var or=function(){return or=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},or.apply(this,arguments)};function sr(e){switch(e){case"ArrowRight":case"ArrowLeft":case"ArrowUp":case"ArrowDown":return!0;default:return!1}}function cr(e){return"ArrowRight"===e||"ArrowLeft"===e}function dr(e){switch(e){case"ArrowRight":return ya.Right;case"ArrowLeft":return ya.Left;case"ArrowUp":return ya.Up;case"ArrowDown":return ya.Down;default:return ya.None}}function lr(e,t,n,a){var i=or({},e);switch(t){case ya.Right:n===ca.TopLeft||n===ca.BottomLeft?(i.left=e.width<a?e.left+e.width:e.left+a,i.width=e.width-a):n===ca.TopRight||n===ca.BottomRight?i.width=e.width+a:n===ca.Center&&(i.left=e.left+a);break;case ya.Left:n===ca.TopRight||n===ca.BottomRight?i.width=e.width-a:n===ca.TopLeft||n===ca.BottomLeft?(i.left=e.left-a,i.width=e.width+a):n===ca.Center&&(i.left=e.left-a);break;case ya.Down:n===ca.TopLeft||n===ca.TopRight?(i.top=e.height<a?e.top+e.height:e.top+a,i.height=e.height-a):n===ca.BottomLeft||n===ca.BottomRight?i.height=e.height+a:n===ca.Center&&(i.top=e.top+a);break;case ya.Up:n===ca.BottomLeft||n===ca.BottomRight?i.height=e.height-a:n===ca.TopLeft||n===ca.TopRight?(i.top=e.top-a,i.height=e.height+a):n===ca.Center&&(i.top=e.top-a)}return va(i)}function ur(){return document.body.className.indexOf("ms-Fabric--isFocusVisible")>-1}function fr(e){return e.shiftKey&&sr(e.key)}function pr(e){return sr(e.key)||fr(e)}function mr(e){return e.shiftKey&&cr(e.key)}function _r(e){return cr(e.key)||mr(e)}function hr(e,t,n,a){return!!e&&(n.handlePosition===ca.Center||(r=e,(i=t).width===r.width&&i.height===r.height||!function(e,t){switch(t){case ya.Up:return[ca.BottomLeft,ca.BottomCenter,ca.BottomRight].indexOf(e)>=0;case ya.Left:return[ca.TopRight,ca.SideRight,ca.BottomRight].indexOf(e)>=0;case ya.Down:return[ca.TopLeft,ca.TopCenter,ca.TopRight].indexOf(e)>=0;case ya.Right:return[ca.TopLeft,ca.SideLeft,ca.BottomLeft].indexOf(e)>=0}return!1}(n.handlePosition,n.direction)?Oa(t,e):Oa(e,t)&&wa(e,a)));var i,r}function br(e,t,n,a,i){for(var r=n.direction,o=n.handlePosition,s=n.cropShiftingValue,c=i-s<0?-1:1,d=s;(i-d)*c>=0;d+=c){var l=lr(t,r,o,d),u=va(ki(l,Ai(e.cropInteraction.aspectRatioConstraint,Ea(l),e.image.originalPixelSize,e.cropInteraction.shouldInvertOriginalAspectRatio),o));if(hr(u,t,n,a))return u}}function gr(e){var t=$i(e.view.worldToView,e.cropInteraction.uvToWorld,e.view.viewportPixelSize);if(0!==t.x||0!==t.y){var n=En(Vn(wn(t.x,t.y),e.view.worldToView));e.animations.needsFrameTick=!0,e.animations.worldToView=aa(e.animations.worldToView,e.view.worldToView,n),e.view.worldToView=n}}function vr(e){return e.filter(function(e){return e.isTouch}).length}function yr(e,t,n){void 0===n&&(n=!0),e.cropInteraction.aspectRatioConstraint!==t&&mi(e),e.cropInteraction.aspectRatioConstraint=t;var a=Dn(e.cropInteraction.uvToWorld);Di(e,function(e,t,n){var a=Aa(e),i=Ma(e),r=Math.hypot(a.width,a.height),o=ln(dn({x:n,y:1}),r),s=a.width/o.x,c=a.height/o.y,d={left:i.x-o.x/2,top:i.y-o.y/2,width:o.x,height:o.y},l=Ea(d),u=Ya(l,t);if(void 0!==u&&(u<=s||u<=c)){var f=wn(-i.x,-i.y),p=Cn(u);return va(Aa(Vn(wn(i.x,i.y),p,f,l)))}return va(d)}(e.cropInteraction._lastUvToWorldNotSetByAspectRatioChange,e.image._preciseUvToWorld,Ai(t,e.cropInteraction._lastUvToWorldNotSetByAspectRatioChange,e.image.originalPixelSize,e.cropInteraction.shouldInvertOriginalAspectRatio)),bi.userIsChangingAspectRatio);var i=Dn(e.cropInteraction.uvToWorld);e.animations.crop=n?aa(e.animations.crop,a,i):na(),ni(e,n)}function Sr(e){var t=Cn(e.x,e.y);return{image:{_preciseUvToWorld:t},cropInteraction:{uvToWorld:t,aspectRatioConstraint:ha}}}function Dr(e,t){void 0===t&&(t=!1);var n=e.userDefinedDefaults||Sr(e.image.originalPixelSize),a=n.image._preciseUvToWorld,i=n.cropInteraction.uvToWorld;!function(e,t,n,a){void 0===a&&(a=!1),a?(e.needsFrameTick=!0,e.crop=aa(e.crop,t,n)):e.crop=na()}(e.animations,e.cropInteraction.uvToWorld,i,t),yi(e,i,bi.userIsRotating),fi(e.animations,e.image._preciseUvToWorld,a,t),e.image._preciseUvToWorld=a,ui(e),e.view.viewFitting.mode=_a,t?ai(e):ni(e),e.cropInteraction.shouldInvertOriginalAspectRatio=!1,yr(e,n.cropInteraction.aspectRatioConstraint,t)}var Ir=function(){return Ir=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ir.apply(this,arguments)},xr=function(){return xr=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},xr.apply(this,arguments)};function Cr(e){var t=e.width,n=e.height,a=e.x,i=e.y,r=e.rotation;return Vn(wn(a,i),An(r),Cn(t,n))}function Or(e){var t=e[0]*e[4]-e[1]*e[3]<0?-1:1,n=qn(e),a=n.x,i=n.y;return{width:Math.hypot(e[0],e[3])*t,height:Math.hypot(e[1],e[4]),rotation:kn(e),x:a,y:i}}var wr=function(){return wr=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},wr.apply(this,arguments)};function Er(e,t){e.image.originalPixelSize=wr({},t.originalImageSize);var n=Cr(t.imageTransform);return yi(e,Ea(t.cropRectangle),bi.unspecified),fi(e.animations,e.image._preciseUvToWorld,n),e.image._preciseUvToWorld=n,e.animations.crop=na(),ui(e),ni(e,!1),e.cropInteraction.aspectRatioConstraint=t.aspectRatioConstraint,e.cropInteraction.shouldInvertOriginalAspectRatio=t.shouldInvertOriginalAspectRatio||!1,e}var Ar,Lr,kr,Mr="editorActivityPrepareMark",Pr={numRedSamplesPerSlice:17,numGreenSamplesPerSlice:17,numBlueSlicesPerRowIn2DLayout:2,numBlueSlicesPerColumnIn2DLayout:17},Tr=[{name:"Original",lutUrlId:"",config:void 0,locStringKey:"filter_nameOriginal",ariaLabelLocStringKey:"filter_nameOriginal"},{name:"Punch",lutUrlId:"lutUrl_punch",config:Pr,locStringKey:"filter_namePunch",ariaLabelLocStringKey:"filter_namePunch"},{name:"Golden",lutUrlId:"lutUrl_golden",config:Pr,locStringKey:"filter_nameGolden",ariaLabelLocStringKey:"filter_nameGolden"},{name:"Radiate",lutUrlId:"lutUrl_radiate",config:Pr,locStringKey:"filter_nameRadiate",ariaLabelLocStringKey:"filter_nameRadiate"},{name:"Warm Contrast",lutUrlId:"lutUrl_warmContrast",config:Pr,locStringKey:"filter_nameWarmContrast",ariaLabelLocStringKey:"filter_nameWarmContrast"},{name:"Calm",lutUrlId:"lutUrl_calm",config:Pr,locStringKey:"filter_nameCalm",ariaLabelLocStringKey:"filter_nameCalm"},{name:"Cool Light",lutUrlId:"lutUrl_coolLight",config:Pr,locStringKey:"filter_nameCoolLight",ariaLabelLocStringKey:"filter_nameCoolLight"},{name:"Vivid Cool",lutUrlId:"lutUrl_vividCool",config:Pr,locStringKey:"filter_nameVividCool",ariaLabelLocStringKey:"filter_nameVividCool"},{name:"Dramatic Cool",lutUrlId:"lutUrl_dramaticCool",config:Pr,locStringKey:"filter_nameDramaticCool",ariaLabelLocStringKey:"filter_nameDramaticCool"},{name:"BW",lutUrlId:"lutUrl_bw",config:Pr,locStringKey:"filter_nameBw",ariaLabelLocStringKey:"filter_nameBwAriaLabel"},{name:"BW Cool",lutUrlId:"lutUrl_bwCool",config:Pr,locStringKey:"filter_nameBwCool",ariaLabelLocStringKey:"filter_nameBwCoolAriaLabel"},{name:"BW Warm",lutUrlId:"lutUrl_bwWarm",config:Pr,locStringKey:"filter_nameBwWarm",ariaLabelLocStringKey:"filter_nameBwWarmAriaLabel"},{name:"BW High Contrast",lutUrlId:"lutUrl_bwHighContrast",config:Pr,locStringKey:"filter_nameBwHighContrast",ariaLabelLocStringKey:"filter_nameBwHighContrastAriaLabel"},{name:"Burn",lutUrlId:"lutUrl_burn",config:Pr,locStringKey:"filter_nameBurn",ariaLabelLocStringKey:"filter_nameBurn"},{name:"Film",lutUrlId:"lutUrl_film",config:Pr,locStringKey:"filter_nameFilm",ariaLabelLocStringKey:"filter_nameFilm"},{name:"Vintage",lutUrlId:"lutUrl_vintage",config:Pr,locStringKey:"filter_nameVintage",ariaLabelLocStringKey:"filter_nameVintage"}],Ur=tn("edit/handlePointerDown"),Fr=tn("edit/handlePointerUp"),Hr=tn("edit/resetEdits"),Rr=tn("edit/setEdits"),Nr={activeFilter:Tr[0],availableFilters:Tr,filterLevel:1},Br=an({name:"filters",initialState:Nr,reducers:{setActiveFilterAndLevel:function(e,t){var n=t.payload,a=n.activeFilter,i=n.filterLevel;e.activeFilter=a,e.filterLevel=i}},extraReducers:(Ar={},Ar[Hr.type]=function(e,t){e.filterLevel=Nr.filterLevel,e.activeFilter=Nr.activeFilter},Ar[Rr.type]=function(e,t){var n=t.payload,a=n.activeFilter,i=n.filterLevel;a&&(e.activeFilter=a),void 0!==i&&(e.filterLevel=i)},Ar)}),jr=Br.actions.setActiveFilterAndLevel,Vr=Br.reducer;!function(e){e.NoArrow="NoArrow",e.SingleArrow="SingleArrow",e.DoubleArrow="DoubleArrow"}(Lr||(Lr={})),function(e){e.Pen="Pen",e.Highlighter="Highlighter"}(kr||(kr={}));var zr,Gr,Kr,Wr,qr="#fed430",Qr="#0078d7",Yr="#1f1f1f",Jr={pen1:{thicknessInCssPixels:4,htmlColor:Qr,inkType:kr.Pen,arrowMode:Lr.NoArrow},pen2:{thicknessInCssPixels:4,htmlColor:Yr,inkType:kr.Pen,arrowMode:Lr.NoArrow},highlighter:{thicknessInCssPixels:16,htmlColor:qr,inkType:kr.Highlighter}},Xr=Object.keys(Jr)[0],Zr=function(){return Zr=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Zr.apply(this,arguments)},$r=Tr.reduce(function(e,t){return e[t.name]=1,e},{}),eo={showAspectRatioOptions:!1,activeAdjustmentKey:void 0,activeEditorActivity:"Crop",activeEditorActivityInputType:"",nextEditorActivity:"",waitingForActiveEditorActivityToComplete:!1,waitingForMarkupOverlayTexture:!1,shouldWaitFromMarkupActivity:!1,numberOfResets:0,isViewingOriginal:!1,filterLevelsByName:$r,activeInkBrushId:Xr,showInkStylePicker:!1,isResetEditsConfirmationDialogVisible:!1},to=an({name:"EditorUiState",initialState:eo,reducers:{setShowAspectRatioOptions:function(e,t){e.showAspectRatioOptions=t.payload},setActiveAdjustment:function(e,t){e.activeAdjustmentKey=t.payload},prepareEditorActivityChange:function(e,t){var n,a=t.payload,i=a.nextEditorActivity,r=a.inputType;i&&e.activeEditorActivity!==i&&(e.activeEditorActivity===di&&e.shouldWaitFromMarkupActivity&&(e.waitingForActiveEditorActivityToComplete=!0),e.nextEditorActivity=i,performance.clearMarks(Mr),performance.mark(Mr),n=e.nextEditorActivity,performance.clearMarks(n),performance.mark(n)),r&&(e.activeEditorActivityInputType=r)},setActiveEditorActivity:function(e,t){if(t.telemetry){var n=function(){var e=performance.getEntriesByName(Mr);if(1===e.length){var t=performance.now()-e[0].startTime;return performance.clearMarks(Mr),t}}();n&&t.payload&&t.telemetry.logEditorActivityChangePrepareTimeEvent({fromEditorActivityName:e.activeEditorActivity,prepareTimeInMs:n,toEditorActivityName:t.payload})}t.payload&&(e.activeEditorActivity=t.payload,e.isViewingOriginal=!1,e.nextEditorActivity="")},handleOverlayTextureLoaded:function(e,t){e.waitingForActiveEditorActivityToComplete=!1,e.waitingForMarkupOverlayTexture=!1},setWaitingForMarkupOverlayTexture:function(e,t){e.waitingForMarkupOverlayTexture=t.payload},setWaitingFromMarkupActivity:function(e,t){e.shouldWaitFromMarkupActivity=t.payload},setIsViewingOriginal:function(e,t){e.isViewingOriginal=t.payload},setActiveMarkupInkBrushId:function(e,t){e.activeInkBrushId=t.payload},setShowInkStylePicker:function(e,t){e.showInkStylePicker=t.payload},setUiState:function(e,t){return Zr({},t.payload)},resetUiState:function(e,t){return Zr({},eo)},toggleIsResetEditsConfirmationDialogVisible:function(e,t){e.isResetEditsConfirmationDialogVisible=!e.isResetEditsConfirmationDialogVisible}},extraReducers:(zr={},zr[Hr.type]=function(e,t){e.numberOfResets+=1,e.filterLevelsByName=$r},zr[Ur.type]=function(e,t){!t.payload.isPrimaryButtonDownOrTouchDown||e.activeEditorActivity!==si&&e.activeEditorActivity!==ci||(e.isViewingOriginal=!0)},zr[Fr.type]=function(e,t){e.isViewingOriginal=!1},zr[jr.type]=function(e,t){var n=t.payload,a=n.activeFilter,i=n.filterLevel;e.filterLevelsByName[a.name]=null!=i?i:1},zr)}),no=(Gr=to.actions).setShowAspectRatioOptions,ao=Gr.setActiveAdjustment,io=Gr.prepareEditorActivityChange,ro=Gr.setActiveEditorActivity,oo=Gr.handleOverlayTextureLoaded,so=Gr.setWaitingForMarkupOverlayTexture,co=Gr.setWaitingFromMarkupActivity,lo=Gr.setIsViewingOriginal,uo=Gr.setUiState,fo=Gr.resetUiState,po=Gr.setActiveMarkupInkBrushId,mo=Gr.setShowInkStylePicker,_o=Gr.toggleIsResetEditsConfirmationDialogVisible,ho=to.reducer;function bo(e,t){if(t){switch(t){case oi:e.cropInteraction.mode=da.none,e.cropInteraction.enableZoomToCrop=!0,e.view.enableZoomToView=!1,e.view.viewFitting.mode=la.fitCropRectInView;break;case ci:case si:e.cropInteraction.mode=da.disabled,e.cropInteraction.enableZoomToCrop=!1,e.view.enableZoomToView=!0;break;case di:e.cropInteraction.mode=da.disabled,e.cropInteraction.enableZoomToCrop=!1,e.view.enableZoomToView=!1,e.view.viewFitting.mode=la.fitCropRectInView}e.view.animateViewWhenViewportIsResized=!0}}var go,vo,yo=an({name:"transformToolsState",initialState:ba,reducers:{setResolutionScaling:function(e,t){!function(e,t){var n,a,i,r,o,s,c,d,l,u,f,p;e.image._preciseUvToWorld=(s=e.image._preciseUvToWorld,c=t,d=e.image.originalPixelSize,p=mn(ka(s),d),l=s,u=mn(c,p),Vn(Ln(f=kn(l),0,0),Cn(u.x,u.y),Ln(-f,0,0),l)),e.animations.image=na(),e.animations.crop=na(),e.cropInteraction.uvToWorld=(n=En(e.image._preciseUvToWorld),a=e.cropInteraction.rectTopLeftInImageUv,i=e.cropInteraction.rectBottomRightInImageUv,r=Un(n,a),o=Un(n,i),Ea(va({left:Math.min(r.x,o.x),top:Math.min(r.y,o.y),width:Math.abs(o.x-r.x),height:Math.abs(o.y-r.y)}))),e.cropInteraction._uvToWorldBeforeRotate=Dn(e.cropInteraction.uvToWorld),ni(e)}(e,t.payload)},handleImageTextureLoaded:function(e,t){!function(e,t){t.resetEditsOnSizeChange&&function(e,t){e.image.originalPixelSize.x===t.x&&e.image.originalPixelSize.y===t.y||(e.image.originalPixelSize=xr({},t),Dr(e),mi(e))}(e,t.sizeInPixels),e.image.loadedPixelSize=t.sizeInPixels}(e,t.payload)},setCanvasPixelSize:function(e,t){!function(e,t,n){var a,i,r,o;e.view.worldToView=En((a=e.view.worldToView,i=e.view.viewportPixelSize,r=t,o=zn(a),Vn(a,wn((r.x-i.x)/2/o,(r.y-i.y)/2/o)))),e.view.viewportPixelSize=li({},t),e.view.viewportCssSize=li({},n),ni(e,e.view.animateViewWhenViewportIsResized),Pn(e.view.worldToView)||(e.view.worldToView=[1,0,0,0,1,0])}(e,t.payload.pixelSize,t.payload.cssSize)},handlePointerMove:function(e,t){!function(e,t){!function(e,t){var n=e.cropInteraction.uvToWorld;e.cropInteraction.uvToWorld=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)a[i]=r[o];return a}(n),t(),Wn(e.cropInteraction.uvToWorld,n)&&(e.cropInteraction.uvToWorld=n)}(e,function(){if(!(e.pointer.pointerDowns.length>1)){if(1===e.pointer.pointerDowns.length&&e.pointer.pointerDowns[0].pointerId!==t.pointerId)return;var n=t.pointerPhysicalPixelPos;e.pointer.preventShift&&(e.cropInteraction.mode!==da.draggingView&&e.cropInteraction.mode!==da.draggingImage||(e.pointer.offset=cn(e.pointer.movePos,n)),e.pointer.preventShift=!1);var a=sn(n,e.pointer.offset);switch(e.cropInteraction.mode){case da.disabled:!function(e,t){e.pointer.pointerDowns.length>0&&e.animations.transitionToViewingOriginal.isActive&&e.view.viewFitting.mode!==la.fitCropRectInView&&(e.cropInteraction.mode=da.draggingView,e.animations.transitionToViewingOriginal={startTime:void 0,isActive:!1},Yi(e,t))}(e,a);break;case da.draggingView:Yi(e,a);break;case da.zoomToCrop:case da.keyboardCropping:case da.keyboardRotating:case da.none:!function(e,t){var n,a=ja(e.cropUiDisplay.handleHitAreaSizeCss,e.device.pixelRatio);e.cropInteraction.activeHandleIndex=(n=a,Ra(t,Aa(Vn(e.view.worldToView,e.cropInteraction.uvToWorld)),n))}(e,a);break;case da.usingNineSliceCropHandles:!function(e,t,n){if(e.cropInteraction.activeHandleIndex!==ca.Center){var a=Aa(e.cropInteraction.uvToWorld),i=cn(t,e.pointer.downOffsetFromCropHandleCenter),r=jn(e.view.worldToView,i),o=function(e,t,n){var a=Aa(e.cropInteraction.uvToWorld),i=Aa(e.image._preciseUvToWorld),r=Wi(Ba(e.cropUiDisplay.handleSizeCss,e.device.pixelRatio),e.view.worldToView);return function(e,t,n,a,i,r,o){if(-1===n)return e;var s=zi({},e),c=a.x,d=a.y,l=Ha(n),u=Fa(n);if(0===u&&0===l){c=Math.max(t.left+e.width/2,c),c=Math.min(t.left+t.width-e.width/2,c),d=Math.max(t.top+e.height/2,d),d=Math.min(t.top+t.height-e.height/2,d);var f=c-(e.left+e.width/2),p=d-(e.top+e.height/2);s.left+=f,s.top+=p}else c=Math.max(t.left,c),c=Math.min(t.left+t.width,c),d=Math.max(t.top,d),d=Math.min(t.top+t.height,d),c-=e.left,d-=e.top,-1===u?(c=Math.min(c,s.width-r),s.left=c+e.left,s.width=s.width-c):1===u&&(c=Math.max(c,r),s.width=c),-1===l?(d=Math.min(d,s.height-r),s.top=d+e.top,s.height=s.height-d):1===l&&(d=Math.max(d,r),s.height=d),s=o?ki(s,o,n):function(e,t,n,a,i,r,o){var s=Li(t.width/t.height),c=s.x/s.y,d=va(t),l=Za(i.x,d.left,d.left+d.width),u=Za(i.y,d.top,d.top+d.height),f=1,p=1;d.width!==e.width&&(f=Math.max(f,Math.min(Math.round(l+a)-(r?d.left:d.width+d.left),n.width-t.width))),d.height!==e.height&&(p=Math.max(p,Math.min(Math.round(u+a)-(o?d.top:d.height+d.top),n.height-t.height)));for(var m=0;m<f;m++)for(var _=0;_<p;_++)if(Math.abs((d.width+m)/(d.height+_)-c)<1e-6)return r&&(d.left-=m),o&&(d.top-=_),d.width+=m,d.height+=_,d;return t}(e,s,t,i,a,-1===u,-1===l);var m=va(s);return wa(m,r)?m:e}(a,i,e.cropInteraction.activeHandleIndex,t,1/Gn(e.view.worldToView,1,1),r,Qi(e,n))}(e,r,n);if(!Ca(o,a)){if(Di(e,o),e.cropInteraction.shouldConstrainInImage&&(yi(e,Qa(e.cropInteraction.uvToWorld,e.image._preciseUvToWorld,e.cropInteraction.aspectRatioConstraint,e.cropInteraction.activeHandleIndex)),Oa(Aa(e.cropInteraction.uvToWorld),a)))switch(e.cropInteraction.activeHandleIndex){case ca.BottomCenter:r.y>a.top+a.height&&Di(e,a);break;case ca.TopCenter:r.y<a.top&&Di(e,a);break;case ca.SideLeft:r.x<a.left&&Di(e,a);break;case ca.SideRight:r.x>a.left+a.width&&Di(e,a)}ui(e);var s=Aa(e.cropInteraction.uvToWorld);(s.width>e.cropInteraction.rectAtStartOfResize.width||s.height>e.cropInteraction.rectAtStartOfResize.height)&&ni(e)}qi(e)}}(e,a,t.shiftKey);break;case da.draggingImage:!function(e,t){e.image._preciseUvToWorld=Ji(e.view.worldToView,e.image._preciseUvToWorld,e.cropInteraction.uvToWorld,e.pointer.imageUvGrabPosition,t),e.animations.image=na(),e.animations.crop=na(),ui(e)}(e,a);break;case da.selectingFirstCorner:break;case da.selectingSecondCorner:!function(e,t){var n,a,i,r=Un(e.image._preciseUvToWorld,e.pointer.imageUvGrabPosition),o=jn(e.view.worldToView,t);e.cropInteraction.shouldConstrainInImage&&(n=o,(i=jn(a=e.image._preciseUvToWorld,n)).x=Za(i.x,0,1),i.y=Za(i.y,0,1),o=Un(a,i));var s,c,d,l,u,f,p=(s=r,c=o,d=Math.min(s.x,c.x),l=Math.min(s.y,c.y),u=Math.max(s.x,c.x),f=Math.max(s.y,c.y),va({left:d,top:l,width:Math.max(1,u-d),height:Math.max(1,f-l)}));Di(e,p=ki(p,Ai(e.cropInteraction.aspectRatioConstraint,Ea(p),e.image.originalPixelSize,e.cropInteraction.shouldInvertOriginalAspectRatio),Xi(r,o))),e.cropInteraction.shouldConstrainInImage&&yi(e,Qa(e.cropInteraction.uvToWorld,e.image._preciseUvToWorld,e.cropInteraction.aspectRatioConstraint,Xi(r,o))),ui(e)}(e,a)}e.pointer.movePos=a}})}(e,t.payload)},adjustCropRect:function(e,t){!function(e,t,n){var a=t.direction,i=t.handlePosition,r=t.cropShiftingValue,o=Aa(e.cropInteraction.uvToWorld),s=Ki(Ba(e.cropUiDisplay.handleSizeCss,e.device.pixelRatio),50),c=o;r>=1&&(c=br(e,o,t,s,1)||c),hr(c,o,t,s)||(c=br(e,o,t,s,Math.ceil(Qi(e,!1)||1))||c),hr(c,o,t,s)&&(Di(e,c),e.cropInteraction.focusedHandleIndex=i,e.cropInteraction.shouldConstrainInImage&&yi(e,function(e,t,n,a,i){var r=Dn(e);if(a===ca.Center){var o=qa(t,e);return Vn(wn(o.x,o.y),e)}var s=function(e,t){switch(t){case ya.Up:if([ca.TopLeft,ca.TopRight,ca.Center].includes(e))return Ka.bottomToTop;break;case ya.Left:if([ca.TopLeft,ca.BottomLeft,ca.Center].includes(e))return Ka.rightToLeft;break;case ya.Right:if([ca.TopRight,ca.BottomRight,ca.Center].includes(e))return Ka.leftToRight;break;case ya.Down:if([ca.BottomLeft,ca.BottomRight,ca.Center].includes(e))return Ka.topToBottom}return[]}(a,i);return s.length>0&&(r=Wa(s,e,t,n,a,i)||r),Ea(va(Aa(r)))}(e.cropInteraction.uvToWorld,e.image._preciseUvToWorld,e.cropInteraction.aspectRatioConstraint,e.cropInteraction.focusedHandleIndex,a)),ui(e),null==n||n.logCropEvent({inputType:t.inputType}),e.animations.needsFrameTick=!0,e.cropInteraction.mode!==da.keyboardCropping&&(e.cropInteraction.mode=da.keyboardCropping,e.animations.gridLineVisibility=sa(2),e.animations.outsideCropVisibility={startTime:void 0,isActive:!0}),e.animations.dismissGridLineVisibility={startTime:void 0,isActive:!0},e.animations.dismissOutsideCropVisibility={startTime:void 0,isActive:!0},qi(e),ni(e))}(e,t.payload,t.telemetry)},panView:function(e,t){!function(e,t){if(e.view.viewFitting.mode!==la.fitCropRectInView){var n=t.direction,a=t.adjustmentCanvasShiftingValue,i=function(e){switch(e){case ya.Left:return{x:1,y:0};case ya.Right:return{x:-1,y:0};case ya.Down:return{x:0,y:-1};case ya.Up:return{x:0,y:1};default:return{x:0,y:0}}}(n),r=ln(i,a),o=wn(r.x,r.y);e.view.worldToView=En(Vn(o,e.view.worldToView)),e.animations.worldToView=na(),e.view.viewFitting.mode=la.none,gr(e)}}(e,t.payload)},setFocusedCropHandle:function(e,t){!function(e,t){var n=t.handlePosition,a=t.isKeyboardFocused;e.cropInteraction.focusedHandleIndex=n,e.cropInteraction.isKeyboardFocused=!!a,qi(e)}(e,t.payload)},handleMouseWheel:function(e,t){!function(e,t,n){var a=t.deltaY,i=t.deltaMode,r=t.mousePhysicalPixelPos,o=t.ctrlKey;if(0!==a)if(!e.cropInteraction.enableZoomToCrop||!Gi(r,e.view.worldToView,e.cropInteraction.uvToWorld)||e.view.viewFitting.mode===la.none||o&&e.view.enableZoomToView){if(e.view.enableZoomToView){var s=function(e,t,n){var a=t===WheelEvent.DOM_DELTA_PIXEL?e:40*e,i=1+.1*Math.abs(a/100),r=zn(n);return e>0?r/i:r*i}(a,i,e.view.worldToView);er(e,s,r,n)}}else ir(e,(a<0?.05:$a)*(a/100),!0,n)}(e,t.payload,t.telemetry)},handleMirrorXClick:function(e){var t=Ma(e.cropInteraction.uvToWorld).x;hi(e,pi(e.image._preciseUvToWorld,In,t))},handleMirrorYClick:function(e){var t=Ma(e.cropInteraction.uvToWorld).y;hi(e,pi(e.image._preciseUvToWorld,xn,t))},setInitialEdits:function(e,t){!function(e,t){Er(e,t)}(e,t.payload)},setDefaultEdits:function(e,t){!function(e,t){e.userDefinedDefaults=function(e,t){var n=Cn(t.x,t.y);return{cropInteraction:{aspectRatioConstraint:e.aspectRatioConstraint||ha,uvToWorld:e.cropRectangle?Ea(e.cropRectangle):n},image:{_preciseUvToWorld:e.imageTransform?Cr(e.imageTransform):n}}}(t,e.image.originalPixelSize)}(e,t.payload)},handleZoomChange:function(e,t){rr(e,t.payload,t.telemetry)},handleZoomDeltaChange:function(e,t){!function(e,t,n){e.cropInteraction.enableZoomToCrop?ir(e,t,!0,n):e.view.enableZoomToView&&rr(e,function(e,t){return e*(1-t)}(zn(e.view.worldToView),t))}(e,t.payload,t.telemetry)},handleSetRotation:function(e,t){!function(e,t){xi(e,t-kn(e.image._preciseUvToWorld)),ni(e)}(e,t.payload)},handleTouchDown:function(e,t){!function(e,t){e.view.allowDraggingView&&(e.cropInteraction.mode=da.draggingView),e.pointer.movePos=t.center,e.pointer.imageUvGrabPosition=Vi(t.center,e.view.worldToView,e.image._preciseUvToWorld),e.touch.downCenterPos=t.center,e.touch.scale=1,e.touch.isDown=!0}(e,t.payload)},handleTouchMove:function(e,t){!function(e,t,n){if(e.touch.isDown){var a=t.center,i=t.scale;if(e.cropInteraction.enableZoomToCrop&&Gi(e.touch.downCenterPos,e.view.worldToView,e.cropInteraction.uvToWorld)&&e.view.viewFitting.mode!==la.none){var r=e.touch.scale-i;e.image._preciseUvToWorld=Ji(e.view.worldToView,e.image._preciseUvToWorld,e.cropInteraction.uvToWorld,e.pointer.imageUvGrabPosition,a),ir(e,r,!1,n),e.cropInteraction.mode=da.draggingImage}else if(e.view.enableZoomToView){var o=i/e.touch.scale;e.view.worldToView=ji(a,e.pointer.movePos,e.view.worldToView),er(e,zn(e.view.worldToView)*o,a,n).zoomIsMinimum&&ni(e),e.cropInteraction.mode=da.draggingView}e.touch.scale=i,e.pointer.movePos=a}}(e,t.payload,t.telemetry)},handleTouchUp:function(e,t){!function(e,t){e.touch.isDown=!1}(e,t.payload)},recenterView:function(e,t){!function(e,t){e.view.viewFitting.mode=la.fitCropRectInView,ai(e),t&&t.logRecenterEvent()}(e,t.telemetry)},setCropHandleSizeCss:function(e,t){!function(e,t){var n=t.handleSizeCss,a=t.handleHitAreaSizeCss;e.cropUiDisplay.handleSizeCss=n,e.cropUiDisplay.handleHitAreaSizeCss=a}(e,t.payload)},setCssToPhysicalPixelRatio:function(e,t){!function(e,t){e.device.pixelRatio=t}(e,t.payload)},setShouldConstrainCropInImage:function(e,t){!function(e,t){e.cropInteraction.shouldConstrainInImage=t,e.cropInteraction.shouldConstrainInImage&&yi(e,Ja(e.cropInteraction._uvToWorldBeforeRotate,e.image._preciseUvToWorld,e.cropInteraction.uvToWorld))}(e,t.payload)},handleFrameTick:function(e,t){!function(e,t){var n;e.animations=function(e,t){var n=e.outsideCropVisibility,a=e.gridLineVisibility,i=e.dismissGridLineVisibility,r=e.dismissOutsideCropVisibility,o=e.transitionToViewingOriginal,s=e.worldToView,c=e.image,d=e.crop,l=e.dismissCropOverlays,u=Jn(n,t,100),f=function(e,t,n){var a=Jn(e,t,100);return a.isActive?oa(e.numGridLines,a):oa()}(a,t),p=Jn(i,t,400),m=Jn(r,t,400),_=Jn(o,t,300),h=ia(s,t,100,$n),b=ia(c,t,100,$n),g=ia(d,t,100,$n),v=Jn(l,t,3e3);return{needsFrameTick:u.isActive||f.isActive||p.isActive||m.isActive||o.isActive||h.isActive||b.isActive||g.isActive||v.isActive,outsideCropVisibility:u,gridLineVisibility:f,dismissGridLineVisibility:p,dismissOutsideCropVisibility:m,transitionToViewingOriginal:_,worldToView:h,image:b,crop:g,dismissCropOverlays:v,currentTime:t}}(e.animations,t),e.view.animateViewWhenViewportIsResized&&!e.animations.worldToView.isActive&&(e.view.animateViewWhenViewportIsResized=!1),!ii(e.cropInteraction.mode)||(n=e.animations).dismissGridLineVisibility.isActive||n.dismissOutsideCropVisibility.isActive||(e.cropInteraction.mode=ma)}(e,t.payload)},setViewFittingMode:function(e,t){!function(e,t){e.view.viewFitting.mode=t,ai(e)}(e,t.payload)},setViewFittingMarginCssPixels:function(e,t){!function(e,t,n){e.view.viewFitting.marginCssPixels=Ir({},t),ni(e,n)}(e,t.payload.marginCssPixels,t.payload.shouldAnimate)},setAllowDraggingImageOutsideCropRect:function(e,t){!function(e,t){e.cropInteraction.allowDraggingImageOutsideRect=t}(e,t.payload)},setAllowDraggingView:function(e,t){!function(e,t){e.view.allowDraggingView=t}(e,t.payload)},setEnableZoomToView:function(e,t){!function(e,t){e.view.enableZoomToView=t}(e,t.payload)},setEnableZoomToCrop:function(e,t){!function(e,t){e.cropInteraction.enableZoomToCrop=t}(e,t.payload)},rotateCropAndImageBy90:function(e,t){!function(e,t){var n,a,i,r=!_i(e),o=t===Ci.Clockwise?90:-90,s=Pa(o,e.cropInteraction._uvToWorldBeforeRotate,e.image._preciseUvToWorld);r?(e.animations.needsFrameTick=!0,e.animations.image=aa(e.animations.image,e.image._preciseUvToWorld,s)):e.animations.image=na(),e.image._preciseUvToWorld=s,e.cropInteraction.aspectRatioConstraint=(n=e.cropInteraction.aspectRatioConstraint,a=n,(i=wi.get(n))&&wi.forEach(function(e,t){e.x===i.y&&e.y===i.x&&(a=t)}),a);var c,d,l,u=Pa(o,e.cropInteraction._uvToWorldBeforeRotate,e.cropInteraction.uvToWorld);e.animations.crop=r?aa(e.animations.crop,e.cropInteraction.uvToWorld,u):na(),e.cropInteraction.shouldInvertOriginalAspectRatio=!e.cropInteraction.shouldInvertOriginalAspectRatio,Di(e,(d=Ma(c=e.cropInteraction.uvToWorld),l=Aa(c),{top:d.y-l.width/2,left:d.x-l.height/2,width:l.height,height:l.width})),ui(e),mi(e),ni(e,r)}(e,t.payload)},startWindowSelectionMode:function(e){e.cropInteraction.mode=da.selectingFirstCorner},handleRotationBarPointerUp:function(e,t){Fi(e,t.payload.inputType,t.telemetry)},handleRotationBarPointerMove:function(e,t){!function(e,t){if(e.rotationUi.rotationBarPointer.isDown&&!t.isPrimaryButtonDownOrTouchDown&&Fi(e,t.inputType),e.rotationUi.rotationBarPointer.isDown){var n=t.pointerPhysicalPixelPos,a=Mi(kn(e.image._preciseUvToWorld)),i=544*e.device.pixelRatio,r=function(e,t,n,a,i){var r=a-n.x;if(Math.abs(r)<28)return 0;var o=(t.x-n.x)/i;return e+Math.min(Math.abs(o),1)*(o<0?Ni:Ri)}(a,e.rotationUi.rotationBarPointer.movePos,n,e.rotationUi.deadZoneCenterPos,i);e.rotationUi.deadZoneCenterPos=function(e,t,n,a,i){return t>=Ri||t<=Ni?Ti(n,i,28,e):a}(a,r,n,e.rotationUi.deadZoneCenterPos,i),Ui(e,r),e.rotationUi.rotationBarPointer.movePos=Hi({},n),ni(e)}}(e,t.payload)},handleRotationBarPointerDown:function(e,t){!function(e,t){var n=t.pointerPhysicalPixelPos,a=e.rotationUi.rotationBarPointer,i=e.device.pixelRatio;a.isDown=!0,a.movePos=Bi({},n),e.rotationUi.deadZoneCenterPos=Ti(n,544*i,28,Mi(kn(e.image._preciseUvToWorld))),e.cropInteraction.mode=da.rotating,e.animations.needsFrameTick=!0,e.animations.gridLineVisibility=sa(8)}(e,t.payload)},setRotationBarIsKeyboardFocused:function(e,t){!function(e,t){e.rotationUi.isKeyboardFocused=t,qi(e)}(e,t.payload)},adjustRotation:function(e,t){!function(e,t,n){var a=t.direction,i=t.sliderShiftingValue,r=function(e,t,n){switch(e){case ya.Right:return t+n;case ya.Left:return t-n;default:return t}}(a,Mi(kn(e.image._preciseUvToWorld)),i);Ui(e,r),null==n||n.logRotateEvent({angle:r,inputType:t.inputType}),e.animations.needsFrameTick=!0,e.cropInteraction.mode!==da.keyboardRotating&&(e.cropInteraction.mode=da.keyboardRotating,e.animations.gridLineVisibility=sa(8),e.animations.outsideCropVisibility={startTime:void 0,isActive:!0}),e.animations.dismissGridLineVisibility={startTime:void 0,isActive:!0},e.animations.dismissOutsideCropVisibility={startTime:void 0,isActive:!0},ni(e)}(e,t.payload,t.telemetry)},abortCurrentMode:function(e){e.cropInteraction.mode!==da.selectingFirstCorner&&e.cropInteraction.mode!==da.selectingSecondCorner||(e.cropInteraction.mode=ma,ai(e))},setAspectRatioConstraint:function(e,t){yr(e,t.payload)},setSessionFullImageSize:function(e,t){!function(e,t){if(t){var n=Cn(t.x,t.y);Er(e,{imageTransform:Or(n),cropRectangle:Aa(n),originalImageSize:t,aspectRatioConstraint:we.None,shouldInvertOriginalAspectRatio:!1})}}(e,t.payload)},handleCleanupCanvasPointers:function(e){!function(e){e.pointer.pointerDowns=[]}(e)},handleCleanupRotationBarPointer:function(e){!function(e){e.rotationUi.rotationBarPointer.isDown=!1}(e)}},extraReducers:(Kr={},Kr[Ur.type]=function(e,t){!function(e,t){if(t.isPrimaryButtonDownOrTouchDown){var n=e.pointer.pointerDowns.length>0;if(e.pointer.pointerDowns=e.pointer.pointerDowns.concat({pointerId:t.pointerId,isTouch:t.isTouch}),!n){e.cropInteraction.isKeyboardFocused=!1;var a=t.pointerPhysicalPixelPos;e.pointer.imageUvGrabPosition=Vi(a,e.view.worldToView,e.image._preciseUvToWorld);var i=Aa(Vn(e.view.worldToView,e.cropInteraction.uvToWorld)),r=ja(e.cropUiDisplay.handleHitAreaSizeCss,e.device.pixelRatio);if(e.cropInteraction.activeHandleIndex=Ra(a,i,r),e.cropInteraction.mode=function(e,t,n,a){switch(e.mode){case da.selectingFirstCorner:if(Ii(e.shouldConstrainInImage,t))return da.selectingSecondCorner;break;case da.zoomToCrop:case da.keyboardCropping:case da.keyboardRotating:case da.none:return n?a?da.draggingView:da.none:e.activeHandleIndex!==ca.None||Da(t,Sa)?e.activeHandleIndex===ca.Center||e.activeHandleIndex===ca.None&&e.allowDraggingImageOutsideRect&&Da(t,Sa)?da.draggingImage:da.usingNineSliceCropHandles:a?da.draggingView:da.none}return e.mode}(e.cropInteraction,e.pointer.imageUvGrabPosition,t.ctrlKey,e.view.allowDraggingView),e.cropInteraction.mode===da.selectingSecondCorner){var o=jn(e.view.worldToView,a);Di(e,va({left:o.x,top:o.y,width:1,height:1})),ui(e)}else e.cropInteraction.mode===da.usingNineSliceCropHandles&&(e.cropInteraction.focusedHandleIndex=e.cropInteraction.activeHandleIndex,e.cropInteraction.activeHandleIndex!==ca.None&&(e.pointer.downOffsetFromCropHandleCenter=cn(a,(s=e.cropInteraction.activeHandleIndex,d=(c=i).left,l=c.width,u=c.top,f=c.height,p=Ha(s),{x:d+(Fa(s)+1)*(l/2),y:u+(p+1)*(f/2)}))),e.cropInteraction.rectAtStartOfResize=Aa(e.cropInteraction.uvToWorld));e.cropInteraction.mode!==da.draggingView&&e.cropInteraction.mode!==da.none&&e.cropInteraction.mode!==da.disabled&&(e.animations.needsFrameTick=!0,e.animations.outsideCropVisibility={startTime:void 0,isActive:!0},e.animations.gridLineVisibility=sa(2)),e.cropInteraction.mode===da.disabled&&(e.animations.transitionToViewingOriginal={startTime:void 0,isActive:!0},e.animations.needsFrameTick=!0),e.pointer.movePos=a,qi(e)}}var s,c,d,l,u,f,p}(e,t.payload)},Kr[Fr.type]=function(e,t){!function(e,t,n,a){if(0!==e.pointer.pointerDowns.length&&e.pointer.pointerDowns.some(function(e){return e.pointerId===t})){var i,r,o,s,c,d,l=(i=e.pointer.pointerDowns,r=t,o=vr(i),d=(c=vr(s=i.filter(function(e){return e.pointerId!==r})))<o,1===s.length&&1===c&&d);if(e.pointer.pointerDowns=e.pointer.pointerDowns.filter(function(e){return e.pointerId!==t}),l)e.pointer.preventShift=!0;else if(!(e.pointer.pointerDowns.length>0)){if(e.pointer.offset={x:0,y:0},a){var u=Aa(e.cropInteraction.uvToWorld);Ca(e.cropInteraction.rectAtStartOfResize,u)||a.logCropEvent({inputType:n})}e.cropInteraction.mode!==da.draggingView&&e.cropInteraction.mode!==da.none&&e.cropInteraction.mode!==da.disabled&&(e.animations.needsFrameTick=!0,e.animations.outsideCropVisibility={startTime:void 0,isActive:!0},e.animations.gridLineVisibility=sa(2)),e.cropInteraction.mode===da.selectingSecondCorner&&(e.view.viewFitting.mode=la.fitCropRectInView),e.cropInteraction.mode===da.draggingView||e.cropInteraction.mode===da.disabled?(gr(e),e.cropInteraction.mode=da.disabled):(ai(e),e.cropInteraction.mode=ma),qi(e)}}}(e,t.payload.pointerId,t.payload.inputType,t.telemetry)},Kr[ro.type]=function(e,t){bo(e,t.payload)},Kr[uo.type]=function(e,t){bo(e,t.payload.activeEditorActivity)},Kr[fo.type]=function(e,t){bo(e,eo.activeEditorActivity)},Kr[ao.type]=function(e){ai(e)},Kr[Hr.type]=function(e,t){!function(e,t){void 0===t&&(t=!1),Dr(e,t),mi(e)}(e,t.payload)},Kr[Rr.type]=function(e,t){Er(e,t.payload)},Kr)}),So=(Wr=yo.actions).handleFrameTick,Do=Wr.setCanvasPixelSize,Io=(Wr.setResolutionScaling,Wr.handleImageTextureLoaded),xo=Wr.handlePointerMove,Co=Wr.handleMouseWheel,Oo=Wr.handleMirrorXClick,wo=Wr.handleMirrorYClick,Eo=Wr.setInitialEdits,Ao=Wr.setDefaultEdits,Lo=(Wr.handleZoomChange,Wr.handleZoomDeltaChange),ko=(Wr.handleSetRotation,Wr.handleTouchDown),Mo=Wr.handleTouchMove,Po=Wr.handleTouchUp,To=Wr.handleCleanupCanvasPointers,Uo=Wr.handleCleanupRotationBarPointer,Fo=Wr.recenterView,Ho=Wr.setCropHandleSizeCss,Ro=Wr.setCssToPhysicalPixelRatio,No=(Wr.setShouldConstrainCropInImage,Wr.setViewFittingMode,Wr.setViewFittingMarginCssPixels),Bo=(Wr.setAllowDraggingImageOutsideCropRect,Wr.setAllowDraggingView,Wr.setEnableZoomToView,Wr.setEnableZoomToCrop,Wr.rotateCropAndImageBy90),jo=(Wr.startWindowSelectionMode,Wr.handleRotationBarPointerUp),Vo=Wr.handleRotationBarPointerMove,zo=Wr.handleRotationBarPointerDown,Go=Wr.setRotationBarIsKeyboardFocused,Ko=Wr.abortCurrentMode,Wo=Wr.setAspectRatioConstraint,qo=Wr.adjustCropRect,Qo=Wr.adjustRotation,Yo=Wr.setFocusedCropHandle,Jo=Wr.panView,Xo=Wr.setSessionFullImageSize,Zo=yo.reducer,$o={sliderMinValue:-100,sliderMaxValue:100,sliderStepValue:1,sliderValueFormat:function(e){return e.toFixed(0)},sliderDeadZoneOffset:4},es=.5;function ts(){return Object.values(vo)}function ns(e){return rs[e].iconName}function as(e,t){return{iconName:e,configuration:t||$o}}!function(e){e.Brightness="brightness",e.Exposure="exposure",e.Contrast="contrast",e.Highlights="highlights",e.Shadows="shadows",e.Saturation="saturation",e.Temperature="temperature",e.Tint="tint",e.Vignette="vignette"}(vo||(vo={}));var is,rs=((go={})[vo.Exposure]=as("Exposure-Havana"),go[vo.Brightness]=as("Brightness-Havana"),go[vo.Contrast]=as("Contrast-Havana"),go[vo.Highlights]=as("Highlights-Havana"),go[vo.Shadows]=as("Shadows-Havana"),go[vo.Saturation]=as("Saturation-Havana"),go[vo.Temperature]=as("Temperature-Havana"),go[vo.Tint]=as("Tint-Havana"),go[vo.Vignette]=as("Vignette-Havana"),go),os=function(){return os=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},os.apply(this,arguments)},ss=os(os({},(is={},ts().forEach(function(e){is[e]=es}),is)),{version:Ee.Latest}),cs=function(){return cs=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},cs.apply(this,arguments)};function ds(e,t){return t?cs(cs({},e),t):e}var ls,us,fs=function(){return fs=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},fs.apply(this,arguments)},ps=an({name:"colorAdjustments",initialState:ss,reducers:{setAdjustmentValue:function(e,t){e[t.payload.adjustmentKey]=t.payload.adjustmentValue},setAllAdjustments:function(e,t){return ds(e,t.payload)},setAdjustmentVersion:function(e,t){e.version=t.payload}},extraReducers:(ls={},ls[Hr.type]=function(e,t){return fs({},ss)},ls[Rr.type]=function(e,t){return ds(e,t.payload.colorAdjustments)},ls)}),ms=(us=ps.actions).setAdjustmentValue,_s=us.setAllAdjustments,hs=(us.setAdjustmentVersion,ps.reducer),bs=function(){return bs=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},bs.apply(this,arguments)};function gs(e){return e&&"object"==typeof e&&!Array.isArray(e)}function vs(e,t){var n=bs(bs({},e),t);return gs(e)&&gs(t)&&Object.keys(t).forEach(function(a){var i;if(!(a in e))throw new Error("override object has a key that does not exist in base object: "+a);if(t[a]&&e[a]&&typeof t[a]!=typeof e[a])throw new Error("override object value at key: '"+a+"' type does not match base object type at key:'"+a+"'");gs(t[a])?n[a]=vs(e[a],t[a]):Object.assign(n,((i={})[a]=t[a],i))}),n}var ys,Ss,Ds=Object.freeze({width:0,height:0}),Is={ariaAnnouncementMessage:void 0,ariaAnnouncementScenario:void 0},xs=an({name:"AriaAnnouncementState",initialState:Is,reducers:{setAriaAnnouncement:function(e,t){!function(e,t){var n;e.ariaAnnouncementMessage=e.ariaAnnouncementMessage===(n=t)?n+"​":n}(e,t.payload)},setAriaAnnouncementScenario:function(e,t){!function(e,t){e.ariaAnnouncementScenario=t}(e,t.payload)}}}),Cs=(ys=xs.actions).setAriaAnnouncement,Os=ys.setAriaAnnouncementScenario,ws=xs.reducer;!function(e){e[e.InkContent=0]="InkContent",e[e.TextContent=1]="TextContent"}(Ss||(Ss={}));var Es=0;function As(){return Es++}var Ls,ks,Ms=function(){return Ms=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ms.apply(this,arguments)};function Ps(e){var t=As();return Ms(Ms({},e),{id:t})}var Ts,Us,Fs={inkBrushes:Jr,markupContentItems:[],activeMarkupToolType:"Pen",isClearAllInkConfirmationDialogVisible:!1},Hs=an({name:"MarkupSlice",initialState:Fs,reducers:{setInkBrushes:function(e,t){e.inkBrushes=t.payload},setInkBrush:function(e,t){!function(e,t,n){e.inkBrushes[n]=t}(e,t.payload.inkBrush,t.payload.id);var n=t.payload.inkBrush,a=n.htmlColor,i=n.inkType,r=n.thicknessInCssPixels;t.telemetry&&t.telemetry.logInkBrushUpdateEvent({color:a,inkType:i,thicknessInCssPixels:r})},addMarkupContent:{reducer:function(e,t){e.markupContentItems.push(t.payload)},prepare:function(e){return{payload:Ps(e)}}},removeMarkupContent:function(e,t){var n=new Set(t.payload);e.markupContentItems=e.markupContentItems.filter(function(e){return!n.has(e.id)})},clearAllInkContent:function(e,t){var n=e.markupContentItems.length;e.markupContentItems=e.markupContentItems.filter(function(e){return e.contentType!==Ss.InkContent});var a=n-e.markupContentItems.length;t.telemetry&&t.telemetry.logClearAllInkStrokesEvent({numberOfInkStrokesRemoved:a})},setActiveMarkupToolType:function(e,t){e.activeMarkupToolType=t.payload,t.telemetry&&t.telemetry.logMarkupToolSelectEvent({activeMarkupToolType:t.payload})},setActiveMarkupToolTypeWithoutTelemetry:function(e,t){e.activeMarkupToolType=t.payload},toggleIsClearAllInkConfirmationDialogVisible:function(e,t){e.isClearAllInkConfirmationDialogVisible=!e.isClearAllInkConfirmationDialogVisible}},extraReducers:(Ls={},Ls[Hr.type]=function(e,t){e.markupContentItems=Fs.markupContentItems},Ls[Rr.type]=function(e,t){var n=t.payload.markupContentItems;n&&(e.markupContentItems=n.map(Ps))},Ls)}),Rs=(ks=Hs.actions).setInkBrushes,Ns=ks.setInkBrush,Bs=ks.setActiveMarkupToolType,js=ks.setActiveMarkupToolTypeWithoutTelemetry,Vs=ks.toggleIsClearAllInkConfirmationDialogVisible,zs=ks.addMarkupContent,Gs=ks.removeMarkupContent,Ks=ks.clearAllInkContent,Ws=Hs.reducer,qs={autoEnhanceLevel:0,autoEnhanceStatus:"off"},Qs={autoEnhanceLevel:.5,autoEnhanceStatus:"off"},Ys=an({name:"autoEnhance",initialState:Qs,reducers:{setValue:function(e,t){e.autoEnhanceLevel=t.payload},setAutoEnhanceStatus:function(e,t){e.autoEnhanceStatus=t.payload}},extraReducers:(Ts={},Ts[Hr.type]=function(e,t){e.autoEnhanceLevel=Qs.autoEnhanceLevel,e.autoEnhanceStatus=Qs.autoEnhanceStatus},Ts)}),Js=(Us=Ys.actions).setValue,Xs=Us.setAutoEnhanceStatus,Zs=Ys.reducer,$s=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),ec=function(e){function t(t){return e.call(this,"Unhandled value: "+t)||this}return $s(t,e),t}(Error);function tc(e){switch(e){case kr.Highlighter:return"Highlighter";case kr.Pen:return"Pen";default:throw new ec(e)}}var nc,ac=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)a[i]=r[o];return a},ic=n(2265),rc="0 0 96 108",oc="none",sc="40px",cc=n(33);!function(e){e.Desktop="Desktop",e.Mobile="Mobile",e.DuoDouble="DuoDouble",e.DuoSingle="DuoSingle"}(nc||(nc={}));var dc=function(){return dc=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},dc.apply(this,arguments)},lc="0 8px",uc="inkTool";function fc(e){return{"&:active":{backgroundColor:e.palette.neutralLighter},"&:hover":{backgroundColor:e.palette.neutralLighter}}}function pc(e,t,n,a){var i=fc(e),r={color:e.palette.themePrimary,border:"none",backgroundColor:"transparent",textTransform:"uppercase",padding:0,minWidth:"none"};return{inkToolbarTools:{activeToolbarIcon:{backgroundColor:e.palette.neutralLighter},toolbarIcon:Object(cc.U)(i,{width:t,height:t})},inkToolbarButton:{root:{height:t,width:t,minWidth:t,margin:lc}},clearAllInkIcon:{styles:dc({},n),disabledColor:e.palette.neutralQuaternary},confirmationDialog:{dialog:{root:a===nc.DuoDouble&&{position:"inherit"}},dialogFooter:{actionsRight:{display:"flex",flexDirection:"row-reverse"},action:{margin:"0px 8px"}},dialogContent:{title:{color:e.palette.black,padding:"24px!important 24px!important 4px!important"},subText:{fontSize:"16px",color:e.palette.neutralPrimaryAlt},inner:{padding:"8px!important"},innerContent:{padding:"0 16px",width:"auto"}},layer:{root:a===nc.DuoDouble&&{position:"absolute",top:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},confirmButton:{root:r,rootPressed:r,rootHovered:r},cancelButton:{root:r,rootHovered:r,rootPressed:r}}}}function mc(e,t,n){return{colorCellSVG:{border:"1.5px solid transparent","&:hover":{backgroundColor:e.palette.neutralQuaternaryAlt},"&:active":{backgroundColor:e.palette.neutralLight}},colorCellSize:t,colorCellSVGRadius:n,colorCellSelected:{border:"1.5px solid "+e.palette.neutralTertiaryAlt},colorCellDisabled:{backgroundColor:"transparent"}}}var _c=Object(o.memo)(function(e){var t=e.styles,n="EraserIcon",a=Object(ic.e)(n),i=Object(ic.e)(n),r=Object(ic.e)(n),o=Object(ic.e)(n),c=Object(ic.e)(n),d=Object(ic.e)(n),l=Object(ic.e)(n),u=Object(ic.e)(n),f=Object(ic.e)(n),p=Object(ic.e)(n),m=Object(ic.e)(n);return s.a.createElement("svg",{className:uc,width:"48px",height:"56px",viewBox:rc,fill:oc,style:t},s.a.createElement("g",{clipPath:"url(#"+m+")"},s.a.createElement("g",{opacity:"0.3",filter:"url(#"+a+")"},s.a.createElement("path",{d:"M69.2524 93V39H26.0524V93H69.2524Z",fill:"black"})),s.a.createElement("path",{d:"M71.6523 117V29.4C71.6523 26.749 69.5033 24.6 66.8523 24.6H28.4523C25.8014 24.6 23.6523 26.749 23.6523 29.4V117H71.6523Z",fill:"url(#"+l+")"}),s.a.createElement("path",{d:"M71.6523 117V29.4C71.6523 26.749 69.5033 24.6 66.8523 24.6H28.4523C25.8014 24.6 23.6523 26.749 23.6523 29.4V117H71.6523Z",fill:"url(#"+u+")"}),s.a.createElement("g",{opacity:"0.3",filter:"url(#"+i+")"},s.a.createElement("path",{d:"M71.6523 117V29.4C71.6523 26.749 69.5033 24.6 66.8523 24.6H28.4523C25.8014 24.6 23.6523 26.749 23.6523 29.4V117H71.6523Z",fill:"black",fillOpacity:"0.01"})),s.a.createElement("g",{filter:"url(#"+r+")"},s.a.createElement("path",{d:"M71.6523 117V29.4C71.6523 26.749 69.5033 24.6 66.8523 24.6H28.4523C25.8014 24.6 23.6523 26.749 23.6523 29.4V117H71.6523Z",fill:"black",fillOpacity:"0.01"})),s.a.createElement("g",{filter:"url(#"+o+")"},s.a.createElement("path",{d:"M71.6523 117V29.4C71.6523 26.749 69.5033 24.6 66.8523 24.6H28.4523C25.8014 24.6 23.6523 26.749 23.6523 29.4V117H71.6523Z",fill:"black",fillOpacity:"0.01"})),s.a.createElement("path",{opacity:"0.08",d:"M23.6523 29.4C23.6523 26.749 25.8014 24.6 28.4523 24.6H66.8523C69.5033 24.6 71.6523 26.749 71.6523 29.4V53.4H23.6523V29.4Z",fill:"black"}),s.a.createElement("path",{d:"M28.4523 12.6C28.4523 7.29807 32.7504 3 38.0523 3H57.2523C62.5543 3 66.8523 7.29807 66.8523 12.6V24.6H28.4523V12.6Z",fill:"url(#"+f+")"}),s.a.createElement("path",{d:"M28.7523 12.6C28.7523 7.46376 32.9161 3.3 38.0523 3.3H57.2523C62.3886 3.3 66.5523 7.46375 66.5523 12.6V24.3H28.7523V12.6Z",stroke:"url(#"+p+")",strokeOpacity:"0.16",strokeWidth:"0.6"}),s.a.createElement("g",{opacity:"0.6",filter:"url(#"+c+")"},s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M57.2524 10.8H42.8524V7.19998H57.2524C60.8974 7.19998 63.8523 10.1549 63.8523 13.8V24.6H60.2523V13.8C60.2523 12.1431 58.9092 10.8 57.2524 10.8Z",fill:"white"})),s.a.createElement("path",{opacity:"0.12",fillRule:"evenodd",clipRule:"evenodd",d:"M71.6523 54.6H23.6523V53.4H71.6523V54.6Z",fill:"white"}),s.a.createElement("g",{opacity:"0.1",filter:"url(#"+d+")"},s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M55.818 111V36.6H58.218V111H55.818Z",fill:"white"}))),s.a.createElement("defs",null,s.a.createElement("filter",{id:a,x:"18.8524",y:"31.8",width:"57.6",height:"68.4",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feGaussianBlur",{stdDeviation:"3.6",result:"effect1_foregroundBlur"})),s.a.createElement("filter",{id:i,x:"23.6523",y:"24.6",width:"56.4",height:"92.4",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),s.a.createElement("feOffset",{dx:"8.4"}),s.a.createElement("feGaussianBlur",{stdDeviation:"4.8"}),s.a.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),s.a.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.2 0 0 0 0 0.2 0 0 0 0 0.2 0 0 0 1 0"}),s.a.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"})),s.a.createElement("filter",{id:r,x:"23.6523",y:"24.6",width:"50.4",height:"92.4",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),s.a.createElement("feOffset",{dx:"2.4"}),s.a.createElement("feGaussianBlur",{stdDeviation:"3.6"}),s.a.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),s.a.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.225634 0"}),s.a.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"})),s.a.createElement("filter",{id:o,x:"23.6523",y:"24.6",width:"49.2",height:"92.4",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),s.a.createElement("feOffset",{dx:"1.2"}),s.a.createElement("feGaussianBlur",{stdDeviation:"4.2"}),s.a.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),s.a.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.1 0"}),s.a.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"})),s.a.createElement("filter",{id:c,x:"30.8524",y:"-4.80002",width:"45",height:"41.4",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feGaussianBlur",{stdDeviation:"6",result:"effect1_foregroundBlur"})),s.a.createElement("filter",{id:d,x:"46.218",y:"27",width:"21.6",height:"93.6",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feGaussianBlur",{stdDeviation:"4.8",result:"effect1_foregroundBlur"})),s.a.createElement("linearGradient",{id:l,x1:"27.2523",y1:"39.6",x2:"71.191",y2:"44.1024",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"#333333"}),s.a.createElement("stop",{offset:"0.792969",stopColor:"#605A5D"})),s.a.createElement("linearGradient",{id:u,x1:"28.4523",y1:"45.6",x2:"47.4937",y2:"47.3382",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"#333333"}),s.a.createElement("stop",{offset:"1",stopColor:"#605A5D",stopOpacity:"0"})),s.a.createElement("linearGradient",{id:f,x1:"47.6523",y1:"3",x2:"47.6523",y2:"24.6",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"#EA9FAA"}),s.a.createElement("stop",{offset:"1",stopColor:"#FA7E90"})),s.a.createElement("linearGradient",{id:p,x1:"47.6523",y1:"3",x2:"47.6523",y2:"24.6",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"white"}),s.a.createElement("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})),s.a.createElement("clipPath",{id:m},s.a.createElement("rect",{width:"96",height:"126",fill:"white",transform:"translate(-0.347656 -9)"}))))}),hc=Object(o.memo)(function(e){var t=e.styles,n=e.inkBrushColor,a="InkPenIcon",i=Object(ic.e)(a),r=Object(ic.e)(a),o=Object(ic.e)(a),c=Object(ic.e)(a),d=Object(ic.e)(a),l=Object(ic.e)(a),u=Object(ic.e)(a);return s.a.createElement("svg",{className:uc,width:"48px",height:"56px",viewBox:rc,fill:oc,style:t},s.a.createElement("g",{clipPath:"url(#"+i+")"},s.a.createElement("g",{opacity:"0.4",filter:"url(#"+r+")"},s.a.createElement("path",{d:"M69.6 116V60.8H26.4V116H69.6Z",fill:"black"})),s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M48.0003 3.1998C43.5003 3.1998 40.8003 17.5998 40.8003 17.5998H55.2003C55.2003 17.5998 52.5003 3.1998 48.0003 3.1998ZM25.9449 60.7998H70.0551C71.346 68.851 72 77.0143 72 85.2142V116H24V85.2142C24 77.0143 24.6539 68.851 25.9449 60.7998Z",fill:n}),s.a.createElement("path",{d:"M41.5543 17.6H54.4456C55.6388 17.6 56.725 18.2883 57.2345 19.3672C63.456 32.5422 67.7611 46.4942 70.055 60.8H25.9449C28.2388 46.4942 32.5439 32.5422 38.7654 19.3672C39.2749 18.2882 40.3611 17.6 41.5543 17.6Z",fill:"url(#"+c+")"}),s.a.createElement("path",{d:"M41.5543 17.6H54.4456C55.6388 17.6 56.725 18.2883 57.2345 19.3672C63.456 32.5422 67.7611 46.4942 70.055 60.8H25.9449C28.2388 46.4942 32.5439 32.5422 38.7654 19.3672C39.2749 18.2882 40.3611 17.6 41.5543 17.6Z",fill:"url(#"+d+")"}),s.a.createElement("path",{opacity:"0.2",d:"M70.0551 60.8L25.9449 60.8C24.6539 68.8512 24 77.0145 24 85.2144V116H72V85.2144C72 77.0145 71.346 68.8512 70.0551 60.8Z",fill:"url(#"+l+")"}),s.a.createElement("path",{opacity:"0.12",d:"M25.9448 60.8H70.0549C70.119 61.1997 70.1815 61.5997 70.2425 62H25.7572C25.8182 61.5997 25.8807 61.1997 25.9448 60.8Z",fill:"white"}),s.a.createElement("path",{opacity:"0.32",d:"M40.8 17.6C40.8 17.6 43.5 3.2 48 3.2C52.5 3.2 55.2 17.6 55.2 17.6H40.8Z",fill:"url(#"+u+")"}),s.a.createElement("g",{opacity:"0.4",filter:"url(#"+o+")"},s.a.createElement("path",{d:"M49.1994 21.2C49.1994 21.2 61.8773 51.2 61.8773 72.5941C61.8773 78.807 61.8773 126.104 61.8773 126.104",stroke:"white",strokeWidth:"1.2"}))),s.a.createElement("defs",null,s.a.createElement("filter",{id:r,x:"19.2",y:"53.6",width:"57.6",height:"69.6",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feGaussianBlur",{stdDeviation:"3.6",result:"effect1_foregroundBlur"})),s.a.createElement("filter",{id:o,x:"41.4468",y:"13.7669",width:"28.2305",height:"119.537",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feGaussianBlur",{stdDeviation:"3.6",result:"effect1_foregroundBlur"})),s.a.createElement("linearGradient",{id:c,x1:"27.6002",y1:"35.6",x2:"70.8002",y2:"48.8",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"#333333"}),s.a.createElement("stop",{offset:"0.792969",stopColor:"#605A5D"})),s.a.createElement("linearGradient",{id:d,x1:"28.8002",y1:"42.8",x2:"46.8002",y2:"47.6",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"#333333"}),s.a.createElement("stop",{offset:"1",stopColor:"#605A5D",stopOpacity:"0"})),s.a.createElement("linearGradient",{id:l,x1:"24",y1:"70.4",x2:"58.8",y2:"70.4",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",null),s.a.createElement("stop",{offset:"1",stopOpacity:"0"})),s.a.createElement("linearGradient",{id:u,x1:"56",y1:"3.2",x2:"48",y2:"17.6",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"white"}),s.a.createElement("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})),s.a.createElement("clipPath",{id:i},s.a.createElement("rect",{width:"96",height:"120",fill:"white"}))))}),bc=Object(o.memo)(function(e){var t=e.styles,n=e.inkBrushColor,a="HighlighterIcon",i=Object(ic.e)(a),r=Object(ic.e)(a),o=Object(ic.e)(a),c=Object(ic.e)(a),d=Object(ic.e)(a),l=Object(ic.e)(a),u=Object(ic.e)(a),f=Object(ic.e)(a),p=Object(ic.e)(a),m=Object(ic.e)(a);return s.a.createElement("svg",{className:uc,width:"48px",height:"56px",viewBox:rc,fill:oc,style:t},s.a.createElement("g",{clipPath:"url(#"+i+")"},s.a.createElement("g",{opacity:"0.4",filter:"url(#"+r+")"},s.a.createElement("path",{d:"M76.8 117V59.4H19.2V117H76.8Z",fill:"black"})),s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M28.8 42.6L30.7255 25.2699C30.9956 22.8391 33.0504 21 35.4962 21H60.5038C62.9496 21 65.0043 22.8391 65.2744 25.2699L67.2 42.6L73.7956 47.8765C77.2115 50.6092 79.2 54.7465 79.2 59.121V95.4H16.8V59.121C16.8 54.7465 18.7885 50.6092 22.2044 47.8765L28.8 42.6Z",fill:"url(#"+d+")"}),s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M28.8 42.6L30.7255 25.2699C30.9956 22.8391 33.0504 21 35.4962 21H60.5038C62.9496 21 65.0043 22.8391 65.2744 25.2699L67.2 42.6L73.7956 47.8765C77.2115 50.6092 79.2 54.7465 79.2 59.121V95.4H16.8V59.121C16.8 54.7465 18.7885 50.6092 22.2044 47.8765L28.8 42.6Z",fill:"url(#"+l+")"}),s.a.createElement("g",{opacity:"0.2",filter:"url(#"+o+")"},s.a.createElement("path",{d:"M55.2002 27L60.2197 57.3868L73.2 63V117",stroke:"white",strokeWidth:"1.2"})),s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M36 21.0002V12.6002C36 11.062 36.9773 9.6937 38.4324 9.19482L56.8216 2.88996C58.3794 2.35587 60 3.51345 60 5.16022V21.0002H36ZM79.2 61.8002H16.8V117H79.2V61.8002Z",fill:n}),s.a.createElement("rect",{opacity:"0.2",x:"16.8",y:"61.8",width:"26.4",height:"55.2",fill:"url(#"+u+")"}),s.a.createElement("rect",{opacity:"0.06",width:"26.4",height:"55.2",transform:"matrix(-1 0 0 1 79.2 61.8)",fill:"url(#"+f+")"}),s.a.createElement("path",{opacity:"0.3",d:"M36 12.6V21H60V5.15999C60 3.51321 58.3794 2.35563 56.8216 2.88972L38.4324 9.19458C36.9773 9.69347 36 11.0618 36 12.6Z",fill:"url(#"+p+")"}),s.a.createElement("path",{d:"M59.7 20.7H36.3V12.6C36.3 11.1899 37.1959 9.93568 38.5297 9.47837L56.9189 3.1735C58.282 2.70617 59.7 3.71906 59.7 5.15999V20.7Z",stroke:"url(#"+m+")",strokeOpacity:"0.3",strokeWidth:"0.6"}),s.a.createElement("g",{opacity:"0.4",filter:"url(#"+c+")"},s.a.createElement("path",{d:"M73.2 117V59.4",stroke:"white",strokeWidth:"1.2"})),s.a.createElement("line",{opacity:"0.12",x1:"16.8",y1:"62.4",x2:"79.2",y2:"62.4",stroke:"white",strokeWidth:"1.2"})),s.a.createElement("defs",null,s.a.createElement("filter",{id:r,x:"12",y:"52.2",width:"72",height:"72",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feGaussianBlur",{stdDeviation:"3.6",result:"effect1_foregroundBlur"})),s.a.createElement("filter",{id:o,x:"47.4082",y:"19.7022",width:"33.5918",height:"104.498",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feGaussianBlur",{stdDeviation:"3.6",result:"effect1_foregroundBlur"})),s.a.createElement("filter",{id:c,x:"63",y:"49.8",width:"20.4",height:"76.8",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.a.createElement("feGaussianBlur",{stdDeviation:"4.8",result:"effect1_foregroundBlur"})),s.a.createElement("linearGradient",{id:d,x1:"17.4",y1:"36.5",x2:"72.6093",y2:"65.8856",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"#333333"}),s.a.createElement("stop",{offset:"0.792969",stopColor:"#605A5D"})),s.a.createElement("linearGradient",{id:l,x1:"19.2",y1:"42.7",x2:"44.1733",y2:"55.8611",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"#333333"}),s.a.createElement("stop",{offset:"1",stopColor:"#605A5D",stopOpacity:"0"})),s.a.createElement("linearGradient",{id:u,x1:"16.8",y1:"78.7846",x2:"35.94",y2:"78.7846",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",null),s.a.createElement("stop",{offset:"1",stopOpacity:"0"})),s.a.createElement("linearGradient",{id:f,x1:"-9.02706e-08",y1:"16.9846",x2:"19.14",y2:"16.9846",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",null),s.a.createElement("stop",{offset:"1",stopOpacity:"0"})),s.a.createElement("linearGradient",{id:p,x1:"44.9143",y1:"-1.25961",x2:"47.3195",y2:"23.1916",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",null),s.a.createElement("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})),s.a.createElement("linearGradient",{id:m,x1:"48",y1:"-1.25961",x2:"48",y2:"18.774",gradientUnits:"userSpaceOnUse"},s.a.createElement("stop",{stopColor:"white"}),s.a.createElement("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})),s.a.createElement("clipPath",{id:i},s.a.createElement("rect",{width:"96",height:"120",fill:"white",transform:"translate(0 -3)"}))))}),gc=n(3051),vc=Object(o.memo)(function(e){var t=e.enabled,n=e.enabledColor,a=e.disabledColor,i=e.styles,r=Object(gc.e)(),o=null!=n?n:r.palette.black,c=null!=a?a:r.palette.neutralTertiary,d=Object(cc.U)({fill:t?o:c});return s.a.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",style:i},s.a.createElement("g",{className:d},s.a.createElement("path",{d:"M2 6.75C2 5.23122 3.23122 4 4.75 4L19.25 4C20.7688 4 22 5.23122 22 6.75V12.5356L21.1991 11.7347C20.9899 11.5255 20.7529 11.3612 20.5 11.2416V6.75C20.5 6.05964 19.9404 5.5 19.25 5.5L4.75 5.5C4.05964 5.5 3.5 6.05964 3.5 6.75L3.5 17.25C3.5 17.9404 4.05964 18.5 4.75 18.5H12.0149C12.0319 19.0338 12.2189 19.5632 12.576 20H4.75C3.23122 20 2 18.7688 2 17.25L2 6.75Z"}),s.a.createElement("path",{d:"M20.4919 12.4418C19.9062 11.856 18.9564 11.856 18.3706 12.4417L15.26 15.5524L19.4671 19.7595L22.5777 16.6489C23.1635 16.0631 23.1635 15.1133 22.5777 14.5275L20.4919 12.4418Z"}),s.a.createElement("path",{d:"M13.453 17.3593L14.5529 16.2595L18.76 20.4666L17.6601 21.5665C17.0743 22.1522 16.1246 22.1522 15.5388 21.5665L13.453 19.4807C12.8672 18.8949 12.8672 17.9451 13.453 17.3593Z"})))}),yc=function(){return yc=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},yc.apply(this,arguments)},Sc={activeInkBrushId:"pen1",brushes:[{inkBrushId:"pen1",getIcon:function(e){var t;return s.a.createElement(hc,{styles:null==e?void 0:e.styles,inkBrushColor:null!==(t=null==e?void 0:e.inkBrushColor)&&void 0!==t?t:Jr.pen1.htmlColor})}},{inkBrushId:"pen2",getIcon:function(e){var t;return s.a.createElement(hc,{styles:null==e?void 0:e.styles,inkBrushColor:null!==(t=null==e?void 0:e.inkBrushColor)&&void 0!==t?t:Jr.pen2.htmlColor})}},{inkBrushId:"highlighter",getIcon:function(e){var t;return s.a.createElement(bc,{styles:null==e?void 0:e.styles,inkBrushColor:null!==(t=null==e?void 0:e.inkBrushColor)&&void 0!==t?t:Jr.highlighter.htmlColor})}}],eraser:{getIcon:function(e){return s.a.createElement(_c,{styles:null==e?void 0:e.styles})}},clearInk:{getIcon:function(e){return s.a.createElement(vc,yc({},e))}}},Dc=function(){throw new Error("Error: Components must be wrapped in a MarkupProvider")},Ic={},xc=Object(o.createContext)({enableMarkup:!1,Canvas:Dc,canvasMethods:Ic,setCanvasMethods:function(){},InkCanvasInteraction:Dc,inkConfigurations:{Pen:{cssThicknesses:[1,2,3,4,5,6],minSliderValue:1},Highlighter:{cssThicknesses:[1,2,3,4,5,6],minSliderValue:1}},localizationStrings:{markup_inkToolbarPenTooltip:"Pen",markup_inkToolbarPenAriaLabel:"Pen",markup_inkToolbarPenAriaDescription:"Select and drag on image to add an ink stroke. Select this button again to change ink properties.",markup_inkToolbarEraserTooltip:"Remove ink strokes",markup_inkToolbarEraserAriaLabel:"Remove ink strokes",markup_inkToolbarEraserAriaDescription:"Select and drag over ink to remove ink strokes.",markup_inkToolbarHighlighterTooltip:"Highlighter",markup_inkToolbarHighlighterAriaLabel:"Highlighter",markup_inkToolbarHighlighterAriaDescription:"Select and drag on image to add an ink stroke. Select this button again to change ink properties.",markup_inkToolbarClearAllInkTooltip:"Clear all ink strokes",markup_inkToolbarClearAllInkAriaLabel:"Clear all ink strokes",markup_inkToolbarThickness:"Thickness",markup_clearAllInkDialogCloseButtonAriaLabel:"Close",markup_clearAllInkDialogTitle:"Clear all ink strokes?",markup_clearAllInkDialogSubText:"All ink strokes applied to the image will be permanently removed.",markup_clearAllInkDialogConfirmButtonText:"Confirm",markup_clearAllInkDialogConfirmButtonAriaLabel:"Confirm",markup_clearAllInkDialogCancelButtonText:"Cancel",markup_clearAllInkDialogCancelButtonAriaLabel:"Cancel",markup_inkToolbarBrushFormatString:"{0}: {1}, {2}: {3}, {4}",markup_inkToolbarTooltipChangeInkProperties:"Select again to change ink properties.",markup_inkThicknessSliderHeaderLabel:"Stroke Thickness",markup_inkThicknessSliderAriaLabel:"Slider to pick the thickness of the selected brush.",markup_addedInkStrokeAriaLive:"Added an ink stroke to image, {0}, {1}, thickness {2}",markup_removedInkStrokesAriaLive:"Removed {0} out of {1} ink strokes",markup_clearedAllInkStrokesAriaLive:"Cleared all ink strokes",markup_inkPenThicknessSliderAriaLabel:"Slider to adjust pen thickness.",markup_inkHighlighterThicknessSliderAriaLabel:"Slider to adjust highlighter thickness.",markup_inkToolbarAriaLandmark:"Markup Toolbar",markup_colorDarkYellow:"Dark Yellow",markup_colorLightOrange:"Light Orange",markup_colorOrange:"Orange",markup_colorRed:"Red",markup_colorDarkPurple:"Dark Purple",markup_colorPurple:"Purple",markup_colorMagenta:"Magenta",markup_colorDarkRed:"Dark Red",markup_colorLightBlue:"Light Blue",markup_colorBlue:"Blue",markup_colorDarkBlue:"Dark Blue",markup_colorLightGreen:"Light Green",markup_colorGreen:"Green",markup_colorLightGray:"Light Gray",markup_colorGray:"Gray",markup_colorBlack:"Black",markup_colorTableAriaLabel:"Colors",markup_noArrowButtonText:"No Arrow",markup_noArrowButtonTooltip:"No arrow head line",markup_noArrowButtonAriaLabel:"No arrows will appear on the ends of your ink stroke",markup_singleArrowButtonText:"Single Arrow",markup_singleArrowButtonTooltip:"Single arrow head line",markup_singleArrowButtonAriaLabel:"An arrow will appear on the end of your ink stroke",markup_doubleArrowButtonText:"Double Arrow",markup_doubleArrowButtonTooltip:"Arrows at beginning and end head line",markup_doubleArrowButtonAriaLabel:"Arrows will appear at the beginning and end points of your ink stroke",markup_inkToolbarSingleArrowTip:"Single arrow tip",markup_inkToolbarDoubleArrowTips:"Double arrow tips"},scriptsToLoadJSBundles:[],inkBrushConfigurations:Sc,getInkToolbarPosition:function(){return"Bottom"},inkToolbarStyles:void 0,enableArrowhead:!1,wetCanvasIsReady:!1,setWetCanvasIsReady:function(){}});function Cc(e,t){var n=Object(o.useRef)(e);return n.current!==e&&t&&t(n.current,e),n.current}var Oc=["pen1","pen2","highlighter"];function wc(e){var t=Se(),n=Cc(e,Object(o.useCallback)(function(){t({id:"InitialInkBrushConfigIgnored",message:"Change to initialInkBrushConfigurations prop was ignored. initialInkBrushConfigurations is for initial state only. For subsequent changes use the state or reset method"})},[t]));try{!function(e){if(!e.activeInkBrushId)throw new Error("initialInkBrushConfiguration must contain a activeInkBrushId");if(!Oc.includes(e.activeInkBrushId))throw new Error("initialInkBrushConfiguration contains an invalid activeInkBrushId");if(!e.eraser.getIcon)throw new Error("initialInkBrushConfiguration must provide a getIcon callback for the eraser tool");if(!e.clearInk.getIcon)throw new Error("initialInkBrushConfiguration must provide a getIcon callback for the clear-ink button");e.brushes.forEach(function(e){if(!e.getIcon)throw new Error("initialInkBrushConfiguration must provide a getIcon callback for "+e.inkBrushId)}),Oc.forEach(function(t){if(!e.brushes.find(function(e){return e.inkBrushId===t}))throw new Error("initialInkBrushConfiguration must include configuration for brushId: "+t)})}(e)}catch(e){n=Sc,e instanceof Error?t({id:"InitialInkBrushConfigIgnored",message:e.message}):t({id:"InitialInkBrushConfigIgnored",message:"Change to initialInkBrushConfigurations prop was ignored. initialInkBrushConfigurations is invalid"})}return n}var Ec,Ac=function(){return Ac=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ac.apply(this,arguments)},Lc=s.a.memo(function(e){var t=e.serializedState,n=e.defaultEdits,a=e.initialEdits,i=e.initialUiState,r=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["serializedState","defaultEdits","initialEdits","initialUiState"]),c=Object(o.useContext)(_e),d=Object(o.useContext)(xc).inkBrushConfigurations,l=Se(),u=wc(d),f=Object(o.useRef)(n).current,p=function(e,t){if(t){var n=Ne(t),a=n.isValid,i=n.message;if(a)return t;e({id:"InitialEditsIgnored",message:"ValidationError: "+i})}}(l,a),m=Object(o.useMemo)(function(){return function(e,t,n,a,i,r){var o=e?JSON.parse(decodeURI(e)):{},s=function(e){var t,n=function(e){return en(e)},a=e||{},i=a.reducer,r=void 0===i?void 0:i,o=a.middleware,s=void 0===o?n():o,c=a.devTools,d=void 0===c||c,l=a.preloadedState,u=void 0===l?void 0:l,f=a.enhancers,p=void 0===f?void 0:f;if("function"==typeof r)t=r;else{if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(r))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');t=Object(Rt.n)(r)}var m=Rt.e.apply(void 0,"function"==typeof s?s(n):s),_=Rt.a;d&&(_=Zt(Wt({trace:!1},"object"==typeof d&&d)));var h=[m];Array.isArray(p)?h=[m].concat(p):"function"==typeof p&&(h=p(h));var b=_.apply(void 0,h);return Object(Rt.i)(t,u,b)}({reducer:{colorAdjustments:hs,transformTools:Zo,uiState:ho,ariaAnnouncement:ws,filters:Vr,autoEnhance:Zs,markup:Ws},preloadedState:{transformTools:vs(ba,o.transformTools),colorAdjustments:vs(ss,o.colorAdjustments),uiState:vs(eo,o.uiState),ariaAnnouncement:vs(Is,o.ariaAnnouncement),filters:vs(Nr,o.filters),autoEnhance:vs(Qs,o.autoEnhance),markup:vs(Fs,o.markup)},middleware:ac(en(),r||[])});if(t&&s.dispatch(Ao(t)),n&&(s.dispatch(Eo(n)),n.colorAdjustments&&s.dispatch(_s(n.colorAdjustments))),i){var c={};i.brushes.forEach(function(e){c[e.inkBrushId]=Jr[e.inkBrushId]}),s.dispatch(Rs(c)),s.dispatch(po(i.activeInkBrushId)),s.dispatch(js(tc(c[i.activeInkBrushId].inkType)))}return a&&s.dispatch(uo(a)),s}(t,f,p,i,u,[(e=c,function(t){return function(t){return function(n){return t(Be(Be({},n),{telemetry:e}))}}})]);var e},[t,c,f,p,i,u]);return Object(o.useEffect)(function(){n&&m.dispatch(Ao(n))},[m,n]),s.a.createElement(R.Provider,Ac({},r,{store:m}))});function kc(e){return(0|e)===e}Lc.displayName="ImageEditorProvider",function(e){e.ActualMipMapsWithFakeFallBack="ActualMipMapsWithFakeFallBack",e.NoMipMaps="NoMipMaps",e.FakeMipMaps="FakeMipMaps"}(Ec||(Ec={}));var Mc,Pc=Ec.ActualMipMapsWithFakeFallBack,Tc=function(){return Tc=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Tc.apply(this,arguments)};function Uc(e,t,n,a){if(void 0===n&&(n=Mc.RGBA),!kc(e)||!kc(t))throw new Error("Dimensions of ("+e+","+t+") are not integers. ImageBytes cannot be created.");if(e<1||t<1)throw new RangeError("Dimensions of ("+e+","+t+") must be non-negative. ImageBytes cannot be created.");if(a&&!Vc(e,t,n,a))throw new Error("Given byte array length is invalid. ImageBytes cannot be created.");var i;try{i=null!=a?a:new Uint8Array(e*t*jc(n))}catch(n){if(n instanceof RangeError)throw new RangeError("Byte array length for "+e+" x "+t+" image is too big. ImageBytes cannot be created. "+n.message);throw n}return{bytes:i,width:e,height:t,format:n,id:""}}function Fc(e){return!!e.bytes}function Hc(e){return!!e.canvasMethods}function Rc(e){return null!==e&&void 0!==e.main}function Nc(e){return Rc(e)?e:Tc(Tc({},{main:null,blend:null,overlay:null}),{main:e})}function Bc(e){return Fc(e)?""+e.id:e instanceof HTMLImageElement?""+e.src:""+e.id}function jc(e){var t;return((t={})[Mc.RGB]=3,t[Mc.RGBA]=4,t)[e]}function Vc(e,t,n,a){return!(!kc(e)||!kc(t))&&a.byteLength===e*t*jc(n)}!function(e){e.RGBA="RGBA",e.RGB="RGB"}(Mc||(Mc={}));var zc=Object(o.createContext)({image:null,setImageOverlay:function(){},offscreenRenderer:null,setOffscreenRenderer:function(){}}),Gc=function(){return Gc=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Gc.apply(this,arguments)},Kc=function(e){var t=e.image,n=e.children,a=Object(o.useState)(t),i=a[0],r=a[1],c=Object(o.useState)(null),d=c[0],l=c[1],u=Object(o.useContext)(xc).enableMarkup;Object(o.useEffect)(function(){r(function(e){return u&&Rc(e)&&e.overlay?Gc(Gc({},Nc(t)),{overlay:e.overlay}):t})},[t,u]);var f=Object(o.useCallback)(function(e){r(function(t){return!Rc(t)&&!e||Rc(t)&&(!t.overlay&&!e||e&&t.overlay&&Bc(t.overlay)===Bc(e))?t:Gc(Gc({},Nc(t)),{overlay:e})})},[]);return s.a.createElement(zc.Provider,{value:{image:i,setImageOverlay:f,offscreenRenderer:d,setOffscreenRenderer:l}},n)};function Wc(e,t){return e.brightness===t.brightness&&e.exposure===t.exposure&&e.saturation===t.saturation&&e.highlights===t.highlights&&e.shadows===t.shadows&&e.contrast===t.contrast&&e.tint===t.tint&&e.vignette===t.vignette&&e.temperature===t.temperature&&e.version===t.version}var qc=function(e){return!!(e&&e.lutUrlId&&e.config)},Qc=function(){return Qc=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Qc.apply(this,arguments)};function Yc(e,t){return qc(e.activeFilter)&&qc(t.activeFilter)&&e.activeFilter.config.numRedSamplesPerSlice===t.activeFilter.config.numRedSamplesPerSlice&&e.activeFilter.config.numGreenSamplesPerSlice===t.activeFilter.config.numGreenSamplesPerSlice&&e.activeFilter.config.numBlueSlicesPerRowIn2DLayout===t.activeFilter.config.numBlueSlicesPerRowIn2DLayout&&e.activeFilter.config.numBlueSlicesPerColumnIn2DLayout===t.activeFilter.config.numBlueSlicesPerColumnIn2DLayout&&e.activeFilter.lutUrlId===t.activeFilter.lutUrlId&&e.activeFilter.name===t.activeFilter.name&&e.filterLevel===t.filterLevel||!qc(e.activeFilter)&&!qc(t.activeFilter)}function Jc(e){return Qc({},e)}function Xc(e,t){return e.autoEnhanceLevel===t.autoEnhanceLevel}function Zc(e,t){var n=e.markupContentItems||[],a=t.markupContentItems||[];return n.length===a.length&&n.every(function(e,t){return e.id===a[t].id})}function $c(e){return function(e){var t=e.cropRectangle,n=e.imageTransform,a=e.originalImageSize,i=Ea(t),r=Kn(Cr(n),i,5),o=!Sn(n.height,a.y,5)||!Sn(n.width,a.x,5);return!r||o}(e)||function(e){var t=!!e.colorAdjustments&&!Wc(e.colorAdjustments,ss),n=!Yc(e,Jc(Nr)),a=!Xc(e,qs),i=!Zc(e,Fs);return t||n||a||i}(e)}var ed=function(){return ed=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ed.apply(this,arguments)};function td(e,t,n,a,i,r,o,s,c){return{imageTransform:Or(t),cropRectangle:Aa(e),originalImageSize:ed({},n),colorAdjustments:ed({},a),activeFilter:i.activeFilter,filterLevel:i.filterLevel,autoEnhanceLevel:"on"===r.autoEnhanceStatus?r.autoEnhanceLevel:0,version:1,aspectRatioConstraint:o,shouldInvertOriginalAspectRatio:s,markupContentItems:c}}var nd,ad=function(e){return e.cropInteraction.uvToWorld},id=function(e){return e.animations.crop.animatedMatrix||ad(e)},rd=function(e){return e.cropInteraction.mode},od=function(e){return e.cropInteraction.activeHandleIndex},sd=function(e){return e.cropInteraction.aspectRatioConstraint},cd=function(e){return e.cropInteraction.shouldInvertOriginalAspectRatio},dd=function(e){return e.view.worldToView},ld=function(e){return e.view.viewportPixelSize},ud=function(e){return e.view.viewFitting.mode},fd=function(e){return e.device.pixelRatio},pd=function(e){return e.image._preciseUvToWorld},md=function(e){return!!e.image.loadedPixelSize},_d=function(e){return e.image.loadedPixelSize},hd=function(e){return e.image.originalPixelSize},bd=function(e){return e.pointer.movePos},gd=function(e){return e.pointer.pointerDowns.length>0},vd=function(e){return e.animations.worldToView.animatedMatrix},yd=Vt([pd],function(e){return En(e)}),Sd=Vt([yd],function(e){return ka(e)}),Dd=Vt([hd],function(e){return e}),Id=function(e){return e.colorAdjustments},xd=function(e){return e.filters},Cd=function(e){return e.autoEnhance},Od=function(e){return e.markup.markupContentItems},wd=Vt([ad,yd,Dd,Id,xd,Cd,sd,cd,Od],function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=td.apply(void 0,e);return $c(n)}),Ed=Vt([ad,yd,Dd,Id,xd,Cd,sd,cd,Od,function(e){return e.userDefinedDefaults||Sr(e.image.originalPixelSize)}],function(e,t,n,a,i,r,o,s,c,d){return function(e,t){var n=function(e,t){var n,a=t.image._preciseUvToWorld,i=null===(n=t.cropInteraction)||void 0===n?void 0:n.uvToWorld,r=cn({x:e.cropRectangle.left,y:e.cropRectangle.top},qn(i)),o=wn(r.x,r.y),s=Kn(Vn(o,a),Cr(e.imageTransform),5);return Kn(Vn(o,i),Ea(e.cropRectangle),5)&&s}(e,t),a=!e.colorAdjustments||Wc(e.colorAdjustments,ss),i=Yc(e,Jc(Nr)),r=Xc(e,qs),o=Zc(e,Fs);return n&&a&&i&&r&&o}(td(e,t,n,a,i,r,o,s,c),d)}),Ad=Object(o.createContext)(new Set);!function(e){e.SaveAs="SaveAs",e.SaveAsOriginal="SaveAsOriginal"}(nd||(nd={}));var Ld=new Set([nd.SaveAs,nd.SaveAsOriginal]),kd=new Set,Md=function(e,t,n){return t&&n?Ld:kd},Pd=Vt([_d,hd,md],function(e,t,n){return n&&!!e&&_n(e,t)}),Td=function(){return Td=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Td.apply(this,arguments)},Ud=s.a.memo(function(e){var t,n=e.editsAreSameAsDefaults,a=e.editsWouldModifyImage,i=e.isFullSizeInputImageAvailable,r=e.onDecideEnabledSaveTypes,o=e.children,c=(t=(r||Md)(n,a,i),new Set(Array.from(t)));return s.a.createElement(Ad.Provider,{value:c},o)}),Fd=Object(R.connect)(function(e,t){var n=Td(Td({},e.transformTools),{colorAdjustments:e.colorAdjustments,filters:e.filters,autoEnhance:e.autoEnhance,markup:e.markup});return{editsAreSameAsDefaults:Ed(n),editsWouldModifyImage:wd(n),isFullSizeInputImageAvailable:Pd(e.transformTools)}})(Ud),Hd=Object(o.createContext)(void 0),Rd=s.a.memo(function(e){var t=e.sessionFullImageSize,n=e.setSessionFullImageSize,a=e.resetEdits,i=e.children,r=Se(),c=Cc(t,Object(o.useCallback)(function(){r({id:"SessionFullImageSizeIgnored",message:"Change to sessionFullImageSize prop was ignored. sessionFullImageSize is for initial state only."})},[r]));return Object(o.useEffect)(function(){c&&(n(c),a(!1))},[a,c,n]),s.a.createElement(Hd.Provider,{value:c},i)}),Nd={setSessionFullImageSize:Xo,resetEdits:Hr},Bd=Object(R.connect)(null,Nd)(Rd),jd=s.a.memo(function(e){var t=e.image,n=e.localization,a=e.telemetryCallback,i=e.serializedState,r=e.onComponentError,c=e.defaultEdits,d=e.initialEdits,l=e.initialUiState,u=e.children,f=e.onDecideEnabledSaveTypes,p=e.sessionFullImageSize,m=Cc(d,Object(o.useCallback)(function(){r({id:"InitialEditsIgnored",message:"Change to initialEdits prop was ignored. initialEdits is for initial state only. For subsequent changes use the setEdits method, or the reset method"})},[r])),_=Cc(l,Object(o.useCallback)(function(){r({id:"InitialUiStateIgnored",message:"Change to initialUiState prop was ignored. initialUiState is for initial state only. For subsequent changes use the setUiState method"})},[r]));return s.a.createElement(ye,{onError:r},s.a.createElement(Pe,{telemetryCallback:a},s.a.createElement(Me,{localization:n},s.a.createElement(Lc,{serializedState:i,defaultEdits:c,initialEdits:m,initialUiState:_},s.a.createElement(Fd,{onDecideEnabledSaveTypes:f},s.a.createElement(Bd,{sessionFullImageSize:p},s.a.createElement(Kc,{image:t},u,s.a.createElement(ge,null)))))),s.a.createElement(Te,null)))});function Vd(e,t){return void 0===t&&(t=18),s.a.createElement("svg",{viewBox:"0 0 "+t+" "+t},s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:zd(e,t)}))}function zd(e,t){var n=e>1,a=n?t:t*e,i=n?t/e:t,r={left:(t-a)/2,top:(t-i)/2,width:a,height:i};return Gd({left:r.left+1.5,top:r.top+1.5,width:a-3,height:i-3},1.5)+Gd(r,3)}function Gd(e,t){var n=e.left,a=e.top,i=e.width,r=e.height-2*t,o=i-2*t,s=.5*t;return"M"+n+" "+(a+t)+"v"+r+"c0 "+s+" "+s+" "+t+" "+t+" "+t+"h"+o+"c"+s+" 0 "+t+" -"+s+" "+t+" -"+t+"v-"+r+"c0 -"+s+" -"+s+" -"+t+" -"+t+" -"+t+"h-"+o+"c-"+s+" 0 -"+t+" "+s+" -"+t+" "+t+"z"}jd.displayName="ImageEditorContext";var Kd=Vd(.5),Wd=Vd(2),qd=Vd(2/3),Qd=Vd(1.5),Yd=Vd(3/4),Jd=Vd(4/3),Xd=Vd(.8),Zd=Vd(5/4),$d=Vd(9/16),el=Vd(16/9),tl=Vd(1),nl=s.a.createElement("svg",{viewBox:"0 0 20 20"},s.a.createElement("path",{d:"M19.2502 11C19.6298 11 19.9436 11.2822 19.9933 11.6482L20.0002 11.75V16.75C20.0002 18.483 18.6437 19.8992 16.9346 19.9949L16.7502 20L12.0823 20.0002C12.6186 19.6147 13.0556 19.0997 13.3475 18.5011L16.7502 18.5C17.6683 18.5 18.4213 17.7929 18.4944 16.8935L18.5002 16.75V11.75C18.5002 11.3358 18.8359 11 19.2502 11ZM9.75015 7C11.5451 7 13.0002 8.45507 13.0002 10.25V16.75C13.0002 18.5449 11.5451 20 9.75015 20H3.25015C1.45523 20 0.0001508 18.5449 0.0001508 16.75V10.25C0.0001508 8.45507 1.45523 7 3.25015 7H9.75015ZM5.71776 15.3534L5.61627 15.4445L2.66355 18.3993C2.84693 18.4645 3.04439 18.5 3.25015 18.5H9.75015C9.95591 18.5 10.1534 18.4645 10.3368 18.3993L7.38403 15.4445C6.96097 15.0215 6.31009 14.9651 5.82627 15.2753L5.71776 15.3534ZM9.75015 8.5H3.25015C2.28365 8.5 1.50015 9.2835 1.50015 10.25V16.75C1.50015 16.9558 1.53566 17.1532 1.60089 17.3366L4.55561 14.3839C5.5848 13.3547 7.22681 13.3118 8.30707 14.2552L8.44469 14.3839L11.3994 17.3366C11.4646 17.1532 11.5002 16.9558 11.5002 16.75V10.25C11.5002 9.2835 10.7166 8.5 9.75015 8.5ZM9.00015 10C9.55243 10 10.0002 10.4477 10.0002 11C10.0002 11.5523 9.55243 12 9.00015 12C8.44787 12 8.00015 11.5523 8.00015 11C8.00015 10.4477 8.44787 10 9.00015 10ZM16.7502 0C18.4832 0 19.8994 1.35645 19.995 3.06558L20.0002 3.25V8.25C20.0002 8.66421 19.6644 9 19.2502 9C18.8705 9 18.5567 8.71785 18.507 8.35177L18.5002 8.25V3.25C18.5002 2.33183 17.793 1.57881 16.8937 1.5058L16.7502 1.5H11.7502C11.3359 1.5 11.0002 1.16421 11.0002 0.75C11.0002 0.370304 11.2823 0.0565091 11.6484 0.00684667L11.7502 0H16.7502ZM8.25015 0C8.66436 0 9.00015 0.335786 9.00015 0.75C9.00015 1.1297 8.718 1.44349 8.35192 1.49315L8.25015 1.5H3.25015C2.33198 1.5 1.57896 2.20711 1.50595 3.10647L1.50015 3.25L1.50011 6.65214C0.901018 6.94409 0.385711 7.38126 0 7.91785L0.0001508 3.25C0.0001508 1.51697 1.35661 0.100754 3.06573 0.00514483L3.25015 0H8.25015Z"})),al=s.a.createElement("svg",{viewBox:"0 0 18 18"},s.a.createElement("path",{d:"M14.75 0C16.5449 0 18 1.45507 18 3.25V14.75C18 16.5449 16.5449 18 14.75 18H3.25C1.45507 18 0 16.5449 0 14.75V3.25C0 1.45507 1.45507 0 3.25 0H14.75ZM15.3305 16.4014L9.52467 10.7148C9.25962 10.4553 8.85013 10.4316 8.55879 10.644L8.4752 10.7148L2.66845 16.4011C2.8504 16.4651 3.04613 16.5 3.25 16.5H14.75C14.9535 16.5 15.1489 16.4653 15.3305 16.4014L9.52467 10.7148L15.3305 16.4014ZM14.75 1.5H3.25C2.2835 1.5 1.5 2.2835 1.5 3.25V14.75C1.5 14.9584 1.53643 15.1583 1.60326 15.3437L7.42578 9.64299C8.25887 8.82729 9.56746 8.7885 10.4458 9.52658L10.5742 9.64312L16.3964 15.3447C16.4634 15.159 16.5 14.9588 16.5 14.75V3.25C16.5 2.2835 15.7165 1.5 14.75 1.5ZM12.2521 3.5C13.4959 3.5 14.5042 4.50831 14.5042 5.75212C14.5042 6.99592 13.4959 8.00423 12.2521 8.00423C11.0083 8.00423 10 6.99592 10 5.75212C10 4.50831 11.0083 3.5 12.2521 3.5ZM12.2521 5C11.8367 5 11.5 5.33673 11.5 5.75212C11.5 6.1675 11.8367 6.50423 12.2521 6.50423C12.6675 6.50423 13.0042 6.1675 13.0042 5.75212C13.0042 5.33673 12.6675 5 12.2521 5Z"})),il=s.a.createElement("svg",{viewBox:"0 0 16 16"},s.a.createElement("path",{d:"M7.99685 13.7862C8.2423 13.7862 8.4465 13.9629 8.4888 14.1958L8.4969 14.2856V15.5005C8.4969 15.7764 8.273 16 7.99685 16C7.75139 16 7.54724 15.8234 7.50491 15.5903L7.49685 15.5005V14.2856C7.49685 14.0098 7.72071 13.7862 7.99685 13.7862ZM12.7337 12.0179L12.803 12.0756L13.663 12.9348C13.8582 13.1298 13.8582 13.446 13.663 13.6411C13.4894 13.8144 13.22 13.8337 13.0251 13.6989L12.9559 13.6411L12.0958 12.782C11.9006 12.587 11.9006 12.2707 12.0958 12.0756C12.2694 11.9023 12.5388 11.883 12.7337 12.0179ZM3.89746 12.0756C4.07103 12.249 4.09031 12.5181 3.95532 12.7128L3.89746 12.782L3.03745 13.6411C2.84219 13.8361 2.5256 13.8361 2.33034 13.6411C2.15678 13.4677 2.13749 13.1986 2.27249 13.0039L2.33034 12.9348L3.19035 12.0756C3.38562 11.8806 3.7022 11.8806 3.89746 12.0756ZM8.0072 3.51284C10.4866 3.51284 12.4965 5.52061 12.4965 7.99731C12.4965 10.4741 10.4866 12.4818 8.0072 12.4818C5.52781 12.4818 3.51787 10.4741 3.51787 7.99731C3.51787 5.52061 5.52781 3.51284 8.0072 3.51284ZM15.4999 7.51538C15.776 7.51538 15.9999 7.739 15.9999 8.01483C15.9999 8.26007 15.823 8.46395 15.5898 8.5063L15.4999 8.51429H14.2836C14.0075 8.51429 13.7836 8.29073 13.7836 8.01483C13.7836 7.76965 13.9605 7.56572 14.1938 7.52343L14.2836 7.51538H15.4999ZM1.71624 7.49206C1.99238 7.49206 2.21624 7.71567 2.21624 7.99151C2.21624 8.23669 2.03936 8.44067 1.80612 8.48293L1.71624 8.49102H0.5C0.22386 8.49102 0 8.26736 0 7.99151C0 7.74631 0.17688 7.54239 0.41012 7.5001L0.5 7.49206H1.71624ZM2.9682 2.30115L3.03745 2.35893L3.89746 3.21803C4.09272 3.41307 4.09272 3.72931 3.89746 3.92436C3.72389 4.09774 3.45447 4.117 3.2596 3.98216L3.19035 3.92436L2.33034 3.06528C2.13508 2.87023 2.13508 2.55399 2.33034 2.35893C2.50391 2.18556 2.77333 2.16629 2.9682 2.30115ZM13.663 2.35893C13.8365 2.53232 13.8558 2.80146 13.7208 2.99611L13.663 3.06528L12.803 3.92436C12.6077 4.11941 12.2911 4.11941 12.0958 3.92436C11.9223 3.75099 11.903 3.48185 12.038 3.28719L12.0958 3.21803L12.9559 2.35893C13.1511 2.16388 13.4677 2.16388 13.663 2.35893ZM8.0001 0C8.2456 0 8.4498 0.176689 8.4921 0.409688L8.5001 0.499461V1.71439C8.5001 1.99023 8.2763 2.21385 8.0001 2.21385C7.75468 2.21385 7.55054 2.03717 7.5082 1.80417L7.50014 1.71439V0.499461C7.50014 0.223619 7.724 0 8.0001 0Z"})),rl=s.a.createElement("svg",{viewBox:"0 0 16 16"},s.a.createElement("path",{d:"M15.2353 0.76375C14.2155 -0.254592 12.5621 -0.254582 11.5424 0.76377L10.5071 1.79773L10.1574 1.44848C9.57382 0.865754 8.62779 0.865754 8.04425 1.44848L7.4607 2.0312C6.87718 2.61393 6.87717 3.55871 7.4607 4.14144L7.81043 4.49069L1.48156 10.8109C1.20135 11.0907 1.04392 11.4703 1.04392 11.8661V12.3649L0.0831169 14.6114C-0.271229 15.4399 0.571603 16.2745 1.3982 15.9136L3.63826 14.9357H4.11779C4.51407 14.9357 4.89413 14.7785 5.17435 14.4986L11.5032 8.17842L11.8552 8.52998C12.4387 9.11262 13.3847 9.11262 13.9683 8.52998L14.5518 7.94721C15.1354 7.36448 15.1354 6.41969 14.5518 5.83697L14.1999 5.48547L15.2353 4.45148C16.2549 3.43314 16.2549 1.78209 15.2353 0.76375ZM8.51483 5.19411L10.7989 7.47503L4.46997 13.7952C4.37657 13.8885 4.24989 13.941 4.11779 13.941H3.53415C3.46549 13.941 3.39756 13.9551 3.33465 13.9825L0.999194 15.0021L2.00003 12.6621C2.02644 12.6003 2.04006 12.5338 2.04006 12.4667V11.8661C2.04006 11.7341 2.09253 11.6076 2.18594 11.5143L8.51483 5.19411Z"})),ol=s.a.createElement("svg",{viewBox:"0 0 16 16"},s.a.createElement("path",{d:"M9.9462 0.239097C11.3059 0.578692 12.5937 1.28004 13.6569 2.34315C16.781 5.46734 16.781 10.5327 13.6569 13.6569C10.5327 16.7811 5.46734 16.7811 2.34314 13.6569C-0.781049 10.5327 -0.781048 5.46734 2.34315 2.34315C3.98115 0.705139 6.15275 -0.074067 8.29843 0.00553347C8.39082 0.00896099 8.48317 0.0139849 8.57543 0.0205977C9.03652 0.0536426 9.49532 0.126492 9.9462 0.239097ZM12.9497 12.9498C15.6834 10.2161 15.6834 5.78393 12.9497 3.05026C12.6157 2.71617 12.2562 2.42292 11.8776 2.17049L12.3536 2.64645C12.5488 2.84171 12.5488 3.15829 12.3536 3.35356C12.1583 3.54882 11.8417 3.54882 11.6464 3.35355L9.44226 1.14937C8.87302 1.03008 8.29181 0.982245 7.71296 1.00585L9.35355 2.64645C9.54881 2.84171 9.54881 3.15829 9.35355 3.35355C9.15829 3.54882 8.84171 3.54882 8.64645 3.35355L6.46284 1.16994C6.05435 1.26147 5.65247 1.38997 5.26255 1.55544L7.35355 3.64645C7.54882 3.84171 7.54882 4.15829 7.35355 4.35356C7.15829 4.54882 6.84171 4.54882 6.64645 4.35355L4.33014 2.03725C4.01204 2.2334 3.70624 2.45737 3.41621 2.70915L5.35354 4.64645C5.54881 4.84171 5.54881 5.15829 5.35355 5.35355C5.15829 5.54882 4.84171 5.54882 4.64644 5.35356L2.70911 3.41626C2.45734 3.70627 2.23338 4.01206 2.03725 4.33014L4.35355 6.64645C4.54882 6.84171 4.54882 7.15829 4.35355 7.35356C4.15829 7.54882 3.84171 7.54882 3.64645 7.35356L1.55544 5.26255C1.38997 5.65247 1.26147 6.05435 1.16994 6.46284L3.35355 8.64645C3.54882 8.84171 3.54882 9.15829 3.35355 9.35356C3.15829 9.54882 2.84171 9.54882 2.64645 9.35356L1.00585 7.71296C0.982241 8.29181 1.03008 8.87302 1.14936 9.44226L3.35355 11.6464C3.54882 11.8417 3.54882 12.1583 3.35355 12.3536C3.15829 12.5488 2.84171 12.5488 2.64645 12.3536L2.17048 11.8776C2.42291 12.2562 2.71617 12.6157 3.05025 12.9498C5.78392 15.6834 10.2161 15.6834 12.9497 12.9498Z"})),sl=s.a.createElement("svg",{viewBox:"0 0 16 16"},s.a.createElement("path",{d:"M9.5001 10.0001C9.2239 10.0001 9.0001 10.224 9.0001 10.5001C9.0001 10.7762 9.2239 11.0001 9.5001 11.0001H12.5001C12.7762 11.0001 13.0001 10.7762 13.0001 10.5001C13.0001 10.224 12.7762 10.0001 12.5001 10.0001H9.5001ZM8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16ZM8 15C6.247 15 4.6445 14.3556 3.41645 13.2908L13.2908 3.41645C14.3556 4.6445 15 6.247 15 8C15 11.866 11.866 15 8 15ZM3.50003 5.00005C3.50003 4.7239 3.72389 4.50004 4.00004 4.50004H5.00005V3.50003C5.00005 3.22389 5.22391 3.00003 5.50005 3.00003C5.7762 3.00003 6.00006 3.22389 6.00006 3.50003V4.50004H7.00006C7.27621 4.50004 7.50007 4.7239 7.50007 5.00005C7.50007 5.27619 7.27621 5.50005 7.00006 5.50005H6.00006V6.50006C6.00006 6.7762 5.7762 7.00006 5.50005 7.00006C5.22391 7.00006 5.00005 6.7762 5.00005 6.50006V5.50005H4.00004C3.72389 5.50005 3.50003 5.27619 3.50003 5.00005Z"})),cl=s.a.createElement("svg",{viewBox:"0 0 16 16"},s.a.createElement("path",{d:"M16 8C16 3.58172 12.4183 -1.56562e-07 8 -3.49691e-07C3.5817 -5.42821e-07 -1.56562e-07 3.58172 -3.49691e-07 8C-5.42821e-07 12.4183 3.5817 16 8 16C12.4183 16 16 12.4183 16 8ZM15 8C15 11.6979 12.1326 14.726 8.5 14.9824L8.5 1.01758C12.1326 1.27396 15 4.30212 15 8Z"})),dl=s.a.createElement("svg",{viewBox:"0 0 16 16"},s.a.createElement("path",{d:"M7.64645 0.146453C7.84171 -0.0488175 8.1583 -0.0488175 8.3536 0.146453C8.8853 0.678212 10.1584 2.20981 11.2998 4.04882C12.4297 5.86917 13.5 8.0985 13.5 10C13.5 11.8438 12.972 13.3521 11.9905 14.4037C11.0058 15.4587 9.6148 16 8 16C6.38524 16 4.99415 15.4587 4.00947 14.4037C3.02801 13.3521 2.5 11.8438 2.5 10C2.5 8.0985 3.5703 5.86917 4.70018 4.04882C5.84163 2.20981 7.11469 0.678212 7.64645 0.146453Z"})),ll=s.a.createElement("svg",{viewBox:"0 0 20 20"},s.a.createElement("path",{d:"M2.5 0C1.11929 0 0 1.11929 0 2.5V17.5C0 18.8807 1.11929 20 2.5 20H17.5C18.8807 20 20 18.8807 20 17.5V2.5C20 1.11929 18.8807 0 17.5 0H2.5ZM10 18.5C5.30558 18.5 1.5 14.6944 1.5 10C1.5 5.30558 5.30558 1.5 10 1.5C14.6944 1.5 18.5 5.30558 18.5 10C18.5 14.6944 14.6944 18.5 10 18.5Z"})),ul=s.a.createElement("svg",{viewBox:"0 0 16 16"},s.a.createElement("path",{d:"M2.34315 2.34315C5.46734 -0.781049 10.5327 -0.781049 13.6569 2.34315C14.72 3.40625 15.4213 4.69413 15.7609 6.0538L13.3536 3.64645C13.1583 3.45118 12.8417 3.45118 12.6464 3.64645C12.4512 3.84171 12.4512 4.15829 12.6464 4.35355L15.9945 7.70157C16.0131 8.20286 15.9848 8.70555 15.9096 9.20253L13.3536 6.64645C13.1583 6.45118 12.8417 6.45118 12.6464 6.64645C12.4512 6.84171 12.4512 7.15829 12.6464 7.35355L15.6474 10.3545C15.5283 10.7423 15.3791 11.123 15.1997 11.4926L12.3536 8.64645C12.1583 8.45119 11.8417 8.45119 11.6464 8.64645C11.4512 8.84171 11.4512 9.15829 11.6464 9.35355L14.6871 12.3942C14.4819 12.7056 14.2528 13.0059 13.9996 13.2924L11.3536 10.6464C11.1583 10.4512 10.8417 10.4512 10.6465 10.6465C10.4512 10.8417 10.4512 11.1583 10.6465 11.3536L13.2925 13.9995C13.006 14.2527 12.7057 14.4819 12.3942 14.6871L9.35355 11.6464C9.15829 11.4512 8.84171 11.4512 8.64645 11.6464C8.45118 11.8417 8.45118 12.1583 8.64645 12.3536L11.4926 15.1997C11.123 15.3791 10.7424 15.5283 10.3545 15.6474L7.35355 12.6464C7.15829 12.4512 6.84171 12.4512 6.64645 12.6464C6.45118 12.8417 6.45118 13.1583 6.64645 13.3536L9.20253 15.9096C8.70555 15.9848 8.20286 16.0131 7.70157 15.9945L4.35355 12.6464C4.15829 12.4512 3.84171 12.4512 3.64645 12.6464C3.45118 12.8417 3.45118 13.1583 3.64645 13.3536L6.0538 15.7609C4.69413 15.4213 3.40625 14.72 2.34315 13.6569C-0.781049 10.5327 -0.781049 5.46734 2.34315 2.34315Z"})),fl=s.a.createElement("svg",{viewBox:"0 0 16 16"},s.a.createElement("path",{d:"M8.5 5C8.5 4.72386 8.2761 4.5 8 4.5C7.72386 4.5 7.5 4.72386 7.5 5V10.063C6.63739 10.285 6 11.0681 6 12C6 13.1046 6.89543 14 8 14C9.1046 14 10 13.1046 10 12C10 11.0681 9.3626 10.285 8.5 10.063V5Z"}),s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5 3C5 1.34315 6.34315 0 8 0C9.6569 0 11 1.34315 11 3L10.9999 9.3541C11.6219 10.0589 12 10.9857 12 12C12 14.2091 10.2091 16 8 16C5.79086 16 4 14.2091 4 12C4 10.9857 4.37808 10.0589 5.00008 9.3541L5 3ZM10 3C10 1.89543 9.1046 1 8 1C6.89543 1 6 1.89543 6 3L6.00008 9.7546L5.85719 9.9004C5.32642 10.442 5 11.1824 5 12C5 13.6568 6.34315 15 8 15C9.6569 15 11 13.6568 11 12C11 11.1824 10.6736 10.442 10.1428 9.9004L9.9999 9.7546L10 3Z"})),pl=s.a.createElement("svg",{viewBox:"0 0 17 17"},s.a.createElement("path",{d:"M0.772726 15.197C0.500211 15.197 0.247849 15.0534 0.108562 14.8192C-0.0307244 14.585 -0.0363398 14.2947 0.0937875 14.0552L6.53315 2.2068C6.70191 1.89625 7.05994 1.73979 7.40252 1.82687C7.74499 1.91395 7.98485 2.22234 7.98485 2.57578V14.4243C7.98485 14.851 7.63887 15.197 7.21212 15.197H0.772726Z"}),s.a.createElement("path",{d:"M16.8914 14.8192C16.7521 15.0534 16.4998 15.197 16.2273 15.197H9.78786C9.36111 15.197 9.01514 14.851 9.01514 14.4243V2.57578C9.01514 2.22234 9.25499 1.91395 9.59746 1.82687C9.94004 1.73979 10.2981 1.89625 10.4668 2.2068L16.9062 14.0552C17.0364 14.2947 17.0307 14.585 16.8914 14.8192ZM10.5606 5.61584V13.6516H14.9278L10.5606 5.61584Z"})),ml=s.a.createElement("svg",{viewBox:"0 0 17 17"},s.a.createElement("path",{d:"M14.8192 0.108562C15.0534 0.247849 15.197 0.500211 15.197 0.772726V7.21212C15.197 7.63887 14.851 7.98485 14.4243 7.98485H2.57578C2.22234 7.98485 1.91395 7.74499 1.82687 7.40252C1.73979 7.05994 1.89625 6.70191 2.2068 6.53315L14.0552 0.0937875C14.2947 -0.0363398 14.585 -0.0307244 14.8192 0.108562ZM5.61584 6.43939H13.6516V2.07217L5.61584 6.43939Z"}),s.a.createElement("path",{d:"M15.197 16.2273C15.197 16.4998 15.0534 16.7521 14.8192 16.8914C14.585 17.0307 14.2947 17.0364 14.0552 16.9062L2.2068 10.4668C1.89625 10.2981 1.73979 9.94004 1.82687 9.59746C1.91395 9.25499 2.22234 9.01514 2.57578 9.01514H14.4243C14.851 9.01514 15.197 9.36111 15.197 9.78786V16.2273Z"})),_l=s.a.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.38561 17.6144C2.69008 16.4943 0 13.0613 0 9C0 4.02944 4.02944 0 9 0C13.0613 0 16.4943 2.69008 17.6144 6.38561C21.3099 7.5057 24 10.9387 24 15C24 19.9706 19.9706 24 15 24C10.9387 24 7.5057 21.3099 6.38561 17.6144ZM6.04394 15.895C6.01488 15.6006 6 15.302 6 15C6 10.0294 10.0294 6 15 6C15.302 6 15.6006 6.01488 15.895 6.04394C14.7478 3.37164 12.0925 1.5 9 1.5C4.85786 1.5 1.5 4.85786 1.5 9C1.5 12.0925 3.37164 14.7478 6.04394 15.895ZM17.9561 8.10504C17.9571 8.11555 17.9581 8.12606 17.9591 8.13658C17.9862 8.42074 18 8.70876 18 9C18 13.9706 13.9706 18 9 18C8.69798 18 8.39942 17.9851 8.10504 17.9561C9.25223 20.6284 11.9075 22.5 15 22.5C19.1421 22.5 22.5 19.1421 22.5 15C22.5 11.9075 20.6284 9.25223 17.9561 8.10504Z"})),hl=s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},s.a.createElement("path",{d:"M345 1792q-69 0-131-28t-110-75-76-110-28-132V601q0-69 28-131t75-110 110-76 132-28h1358q69 0 131 28t110 75 76 110 28 132v846q0 69-28 131t-75 110-110 76-132 28H345zm1351-128q46 0 87-17t71-48 48-72 18-87V608q0-46-17-87t-48-71-72-48-87-18H352q-46 0-87 17t-71 48-48 72-18 87v832q0 46 17 87t48 71 72 48 87 18h1344zM512 808q-15 8-31 16t-33 8q-26 0-45-19t-19-45q0-17 9-33t26-24l128-64q14-7 29-7 27 0 45 18t19 46v640q0 26-19 45t-45 19q-26 0-45-19t-19-45V808zm896 0q-15 8-31 16t-33 8q-26 0-45-19t-19-45q0-17 9-33t26-24l128-64q14-7 29-7 27 0 45 18t19 46v640q0 26-19 45t-45 19q-26 0-45-19t-19-45V808zm-512 24q0-26 19-45t45-19q26 0 45 19t19 45q0 26-19 45t-45 19q-26 0-45-19t-19-45zm0 384q0-26 19-45t45-19q26 0 45 19t19 45q0 26-19 45t-45 19q-26 0-45-19t-19-45z"})),bl=s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},s.a.createElement("path",{d:"M251 1792q-50 0-95-20t-80-55-55-80-21-96V507q0-50 20-95t55-80 80-55 96-21h1546q50 0 95 20t80 55 55 80 21 96v1034q0 50-20 95t-55 80-80 55-96 21H251zm1541-128q27 0 50-10t40-27 28-41 10-50V512q0-26-10-49t-27-41-41-28-50-10H256q-27 0-50 10t-40 27-28 41-10 50v1024q0 27 10 50t27 41 40 27 51 10h1536zM256 832V704q0-39 15-74t41-61 62-42 74-15h128q26 0 45 19t19 45q0 26-19 45t-45 19H448q-21 0-34 7t-20 21-9 31-2 37q0 16 1 32t1 32q0 20-2 37t-9 30-20 21-34 8q-26 0-45-19t-19-45zm1152-256q0-26 19-45t45-19h128q39 0 74 15t61 41 42 62 15 74v128q0 26-19 45t-45 19q-26 0-45-19t-19-45V704q0-21-7-34t-21-19-31-9-37-3q-16 0-32 1t-32 1q-20 0-37-2t-30-9-21-20-8-34zm-960 960q-39 0-74-15t-61-41-42-62-15-74v-128q0-26 19-45t45-19q26 0 45 19t19 45v128q0 21 7 34t21 20 31 9 37 2q16 0 32-1t32-1q19 0 36 2t31 9 21 20 8 34q0 26-19 45t-45 19H448zm1024 0q-26 0-45-19t-19-45q0-26 19-45t45-19h128q21 0 34-7t19-21 9-31 3-37q0-16-1-32t-1-32q0-19 2-36t9-31 20-21 34-8q26 0 45 19t19 45v128q0 39-15 74t-41 61-62 42-74 15h-128z"})),gl=s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},s.a.createElement("path",{d:"M640 1755L19 1133l90-90 531 530L1939 275l90 90L640 1755z"})),vl=s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},s.a.createElement("path",{d:"M2048 1088H250l787 787-90 90L6 1024 947 83l90 90-787 787h1798v128z"})),yl=s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},s.a.createElement("path",{d:"M2042 1024l-941 941-90-90 787-787H0V960h1798l-787-787 90-90 941 941z"})),Sl=s.a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},s.a.createElement("path",{d:"M10.7481 1.00122L18.3019 1.00173L18.4021 1.01565L18.5009 1.04325L18.562 1.06918C18.6411 1.10407 18.715 1.1546 18.7799 1.21953L18.8206 1.26357L18.8812 1.34505L18.9183 1.41008L18.957 1.50039L18.9762 1.56452L18.9898 1.62846L18.9991 1.72165L18.9996 9.25511C18.9996 9.66933 18.6638 10.0051 18.2496 10.0051C17.8699 10.0051 17.5561 9.72296 17.5065 9.35688L17.4996 9.25511L17.4991 3.55922L3.55911 17.5042L9.24963 17.5051C9.62933 17.5051 9.94313 17.7873 9.99279 18.1533L9.99963 18.2551C9.99963 18.6348 9.71748 18.9486 9.35141 18.9983L9.24963 19.0051L1.71378 19.0043L1.68479 19.0015C1.61873 18.9969 1.55602 18.983 1.49674 18.9619L1.40661 18.923L1.38942 18.9125C1.18522 18.8021 1.03877 18.5991 1.00535 18.3597L0.998108 18.2551V10.7512C0.998108 10.337 1.33389 10.0012 1.74811 10.0012C2.1278 10.0012 2.4416 10.2834 2.49126 10.6495L2.49811 10.7512V16.4432L16.4381 2.50022L10.7481 2.50122C10.3684 2.50122 10.0546 2.21907 10.005 1.85299L9.99811 1.75122C9.99811 1.37152 10.2803 1.05773 10.6463 1.00807L10.7481 1.00122Z"})),Dl=s.a.createElement("svg",{viewBox:"0 0 14 24",xmlns:"http://www.w3.org/2000/svg"},s.a.createElement("path",{d:"M6.04545 3.50454V20.4955L1.64659 15.6446C1.2835 15.2442 0.67931 15.2279 0.297105 15.6083C-0.0851011 15.9887 -0.100593 16.6217 0.262502 17.0221L6.30795 23.6887C6.48817 23.8875 6.73835 24 7 24C7.26165 24 7.51183 23.8875 7.69204 23.6887L13.7375 17.0221C14.1006 16.6217 14.0851 15.9887 13.7029 15.6083C13.3207 15.2279 12.7165 15.2442 12.3534 15.6446L7.95454 20.4955V3.50454L12.3534 8.35542C12.7165 8.75582 13.3207 8.77205 13.7029 8.39167C14.0851 8.01128 14.1006 7.37832 13.7375 6.97792L7.69346 0.31281C7.51947 0.120177 7.27313 0 7 0C6.72687 0 6.48053 0.120177 6.30654 0.31281L0.262502 6.97792C-0.100593 7.37832 -0.0851011 8.01128 0.297105 8.39167C0.67931 8.77205 1.2835 8.75582 1.64659 8.35542L6.04545 3.50454Z"})),Il=s.a.createElement("svg",{viewBox:"0 0 8 9",xmlns:"http://www.w3.org/2000/svg"},s.a.createElement("path",{d:"M4 9C3.72386 9 3.5 8.77614 3.5 8.5L3.5 1.70711L0.853554 4.35355C0.658292 4.54882 0.341709 4.54882 0.146447 4.35355C-0.0488153 4.15829 -0.0488153 3.84171 0.146447 3.64645L3.64645 0.146446C3.84171 -0.0488161 4.15829 -0.0488161 4.35355 0.146446L7.85355 3.64645C8.04882 3.84171 8.04882 4.15829 7.85355 4.35355C7.65829 4.54882 7.34171 4.54882 7.14645 4.35355L4.5 1.70711L4.5 8.5C4.5 8.77614 4.27614 9 4 9Z"})),xl=!1,Cl=n(20);Object(Cl.n)([{rawString:".actionsPaneContainer_0f4047fc{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.actionsPaneBody_0f4047fc{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow-y:auto;padding:0 16px}"}]);var Ol=function(){return Ol=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ol.apply(this,arguments)},wl=Object(o.memo)(function(e){var t=e.header,n=e.children,a=e.footer,i=e.size,r=e.containerId,o=e.styles,c=void 0===o?{}:o;return s.a.createElement("div",{id:r,className:Object(cc.U)("actionsPaneContainer_0f4047fc",c.container,Ol({},i))},t&&s.a.createElement("div",{className:Object(cc.U)(c.header)},t),s.a.createElement("div",{className:Object(cc.U)("actionsPaneBody_0f4047fc",c.body)},n),a&&s.a.createElement("div",{className:Object(cc.U)(c.footer)},a))});Object(Cl.n)([{rawString:".sectionHeader_7b43c21b{font-size:16px;font-weight:500;line-height:42px;margin:25px 0 6px 0}.sectionFooter_7b43c21b{height:38px}"}]);var El="sectionHeader_7b43c21b",Al=n(3411);function Ll(e){return{activeSection:{backgroundColor:e.palette.neutralPrimary},container:{},inactiveSection:{backgroundColor:e.palette.neutralTertiaryAlt},line:{},lineContainer:{},root:{},slideBox:{margin:"0px -12px",padding:"0px 12px","&:hover":{".ms-Slider-active":{backgroundColor:e.palette.neutralPrimary},".ms-Slider-inactive":{backgroundColor:e.palette.neutralTertiaryAlt},".ms-Slider-thumb":{border:"none"}},"&:active":{".ms-Slider-active":{backgroundColor:e.palette.neutralPrimary},".ms-Slider-inactive":{backgroundColor:e.palette.neutralTertiaryAlt},".ms-Slider-thumb":{border:"none"}}},thumb:{border:"none",background:e.palette.neutralPrimary},titleLabel:{},valueLabel:{},zeroTick:{display:"none"}}}function kl(e){return function(t){var n="adjustment_"+t;return{key:t,text:e[n],ariaLabel:e[n]}}}Object(Cl.n)([{rawString:".sliderHeaderContainer_9dab0d57{position:relative;height:42px;font-size:14px;line-height:42px;letter-spacing:0}"}]),Object(Cl.n)([{rawString:".headerContainer_f63b6e20{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.headerContainer_f63b6e20 .name_f63b6e20{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-margin-end:auto;margin-inline-end:auto}"}]);var Ml=n(551),Pl=function(e){var t=e.value,n=e.valueFormatter,a=e.label,i=e.iconName,r=e.styles,c=Object(gc.e)().palette.neutralPrimary,d=Object(o.useMemo)(function(){var e={root:{fill:c,fontSize:"16px",height:"16px",width:"16px",lineHeight:"16px",marginInlineEnd:"8px"}};return Object(cc.g)(e,null==r?void 0:r.icon)},[c,null==r?void 0:r.icon]);return s.a.createElement("div",{className:"headerContainer_f63b6e20"},s.a.createElement("span",{className:"name_f63b6e20"},!!i&&s.a.createElement(Ml.e,{iconName:i,styles:d}),!!a&&a),s.a.createElement("span",{style:null==r?void 0:r.valueText},n?n(t):t))};Object(Cl.n)([{rawString:".valueWrapper_61cd23c6{position:absolute}"}]);var Tl=n(416),Ul=function(e){var t,n,a=e.value,i=e.labelHorizontalPosition0to1,r=e.maxValue,c=e.minValue,d=e.valueFormatter,l=e.styles,u=e.shouldShow,f=Object(o.useRef)(null),p=Object(gc.e)(),m=Object(o.useMemo)(function(){var e=Object(Tl.e)(p),t=void 0===i?function(e,t,n){return 100*gn(t,n,e)}(a,c,r):100*i;return e?{right:t+"%",transform:"translate(50%)"}:{left:t+"%",transform:"translate(-50%)"}},[i,a,r,c,p]);return t=f,n=!u,Object(o.useEffect)(function(){var e=t.current;if(e){if(n){var a=setTimeout(function(){e.hidden=!0},3e3);return function(){clearTimeout(a)}}e.hidden=!1}},[n,t,3e3]),s.a.createElement("span",{className:Object(cc.U)("valueWrapper_61cd23c6",l),style:m,ref:f,"data-test-id":"slider-value"},d?d(a):a)},Fl=function(){return Fl=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Fl.apply(this,arguments)},Hl=s.a.memo(function(e){var t=e.layout,n=e.headerProps,a=e.styles,i="Labeled"===t;return s.a.createElement("div",{className:"sliderHeaderContainer_9dab0d57",style:null==a?void 0:a.container},i?s.a.createElement(Pl,Fl({},n,{styles:null==a?void 0:a.labelValueHeader})):s.a.createElement(Ul,Fl({},n,{styles:null==a?void 0:a.valueHeader})))}),Rl=n(3370),Nl=n.n(Rl),Bl=es;function jl(e,t,n){return Math.round(bn(t,n,e))}function Vl(e,t,n,a){var i;if(e<-a){var r=gn(t,-a,e);i=bn(0,Bl,r)}else if(e>a){var o=gn(a,n,e);i=bn(Bl,1,o)}else i=Bl;return i}var zl=Number.POSITIVE_INFINITY;function Gl(e){var t="Keyboard";return e instanceof MouseEvent?t="Mouse":e.touches&&(t="Touch"),t}var Kl=s.a.memo(function(e){var t=e.adjustmentKey,n=e.layout,a=e.setAdjustmentValue,i=e.normalizedValue,r=e.styles,c=e.hideSliderValueAfterInactivity,d=rs[t].configuration,l=d.sliderMinValue,u=d.sliderMaxValue,f=d.sliderStepValue,p=d.sliderDeadZoneOffset,m=d.sliderValueFormat,_=ns(t),h=Object(o.useContext)(Le),b=h.strings,g=h.localizeNumber,v=kl(b)(t),y=v.text,S=v.ariaLabel,D=Object(o.useContext)(_e).logAdjustmentEvent,I=Object(gc.e)(),x=Object(Tl.e)(I),C=Object(o.useState)(!1),O=C[0],w=C[1],E=Object(o.useRef)(null),A=l-p,L=u+p,k=function(e){var t=Object(o.useState)(!0),n=t[0],a=t[1],i=Object(o.useState)(!1),r=i[0],s=i[1],c=Object(o.useRef)(!1),d=Object(o.useMemo)(function(){return e?new Nl.a(e,{recognizers:[[Nl.a.Pan,{direction:Nl.a.DIRECTION_VERTICAL}]],touchAction:"pan-y"}):null},[e]),l=Object(o.useCallback)(function(e){e instanceof MouseEvent||e instanceof KeyboardEvent||(a(!1),s(!1),c.current=!1)},[]);return Object(o.useEffect)(function(){if(d&&e){var t=function(e){"touch"===e.pointerType&&(c.current=!0)},n=function(){a(!1)};return d.on("panstart",t),e.addEventListener("touchend",l),e.addEventListener("touchstart",n),function(){d.off("panstart",t),e.removeEventListener("touchend",l),e.removeEventListener("touchstart",n)}}},[l,d,e]),Object(o.useEffect)(function(){var e=0;return r&&(e=window.setTimeout(function(){c.current||a(!0)},100)),function(){window.clearTimeout(e)}},[r]),{shouldUpdateSlider:n,setSliderAdjustmentTriggered:s,cleanupTouchAction:l}}(E.current),M=k.shouldUpdateSlider,P=k.setSliderAdjustmentTriggered,T=k.cleanupTouchAction,U=Object(o.useMemo)(function(){return function(e,t,n,a){return e<Bl?bn(t,-a,gn(0,Bl,e)):e>Bl?bn(a,n,gn(Bl,1,e)):0}(i,A,L,p)},[A,L,i,p]),F=Object(o.useMemo)(function(){return jl(i,l,u)},[i,l,u]),H=Object(o.useCallback)(function(){return gn(A,L,U)},[U,A,L]),R=Object(o.useState)(H()),N=R[0],B=R[1],j=Object(o.useCallback)(function(e){if(P(!0),M){B(gn(A,L,e));var n=Vl(e,A,L,p);a({adjustmentKey:t,adjustmentValue:n}),w(!0)}},[t,a,A,L,p,P,M]);Object(o.useEffect)(function(){i!==es&&B(H())},[i]),Object(o.useEffect)(function(){B(H())},[t]),Object(o.useEffect)(function(){var e=function(e){if(pr(e)){var n=dr(e.key);if(.5===i&&n!==ya.None){var r=Vl(n===ya.Right&&!x||n===ya.Up||n===ya.Left&&x?p+.1:-p-.1,A,L,p);a({adjustmentKey:t,adjustmentValue:r})}}},n=E.current;if(n)return n.addEventListener("keydown",e),function(){n.removeEventListener("keydown",e)}},[t,i,E,a,L,A,p,x]);var V={value:F,labelHorizontalPosition0to1:N,maxValue:u,minValue:l,valueFormatter:m,label:y,iconName:_,shouldShow:!c||O},z=Object(o.useMemo)(function(){var e=Ll(I);return Object(cc.g)(e,(null==r?void 0:r.getSliderStyles)&&(null==r?void 0:r.getSliderStyles(I,U)))},[r,I,U]),G=Object(o.useMemo)(function(){var e=null==r?void 0:r.getSliderHeaderStyles;return"function"==typeof e?e(I):e},[r,I]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(Hl,{headerProps:V,layout:n,styles:G}),s.a.createElement("div",{ref:E},s.a.createElement(Al.e,{min:A,max:L,step:M?f:zl,value:U,showValue:!1,originFromZero:!0,onChanged:function(e){D({adjustmentKey:t,value:i,inputType:Gl(e)}),T(e),w(!1),B(H())},onChange:j,styles:z,ariaLabel:S,ariaValueText:function(e){var t=Vl(e,A,L,p);return g(jl(t,l,u))}})))}),Wl=Object(o.memo)(function(e){return s.a.createElement(s.a.Fragment,null,e.adjustmentKeys.map(function(t){return s.a.createElement(Kl,{key:t,adjustmentKey:t,layout:"Labeled",styles:e.styles,normalizedValue:e[t],setAdjustmentValue:e.setAdjustmentValue})}))});function ql(e,t){return function(e,t){var n={};return t.forEach(function(t){!function(e,t,n){Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}(e,n,t)}),n}(e,Object.values(t))}var Ql=function(){return Ql=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ql.apply(this,arguments)},Yl=[vo.Brightness,vo.Exposure,vo.Contrast,vo.Highlights,vo.Shadows,vo.Vignette],Jl=[vo.Saturation,vo.Temperature,vo.Tint],Xl=Object(o.memo)(function(e){var t,n,a,i=Object(o.useContext)(Le).strings,r=Ql(Ql({},ql(e,vo)),{styles:null===(t=e.styles)||void 0===t?void 0:t.adjustmentSlider,setAdjustmentValue:e.setAdjustmentValue});return s.a.createElement(wl,{size:e.size,styles:e.styles,header:e.header,footer:e.footer},s.a.createElement("section",{"aria-label":i.adjustment_lightAriaLandmark},s.a.createElement("div",{className:El,style:null===(n=e.styles)||void 0===n?void 0:n.sectionHeader},i.adjustment_light),s.a.createElement(Wl,Ql({},r,{adjustmentKeys:Yl}))),s.a.createElement("section",{"aria-label":i.adjustment_colorAriaLandmark},s.a.createElement("div",{className:El,style:null===(a=e.styles)||void 0===a?void 0:a.sectionHeader},i.adjustment_color),s.a.createElement(Wl,Ql({},r,{adjustmentKeys:Jl})),s.a.createElement("div",{className:"sectionFooter_7b43c21b"})))}),Zl=function(){return Zl=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Zl.apply(this,arguments)},$l={setAdjustmentValue:ms},eu=Object(R.connect)(function(e){var t=e.uiState.numberOfResets;return Zl(Zl({},ql(e.colorAdjustments,vo)),{key:t})},$l)(Xl),tu=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)a[i]=r[o];return a};function nu(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(/{(\d+)}/g,function(n,a){if(void 0===t[a])throw new Error("Argument at index "+a+" is undefined. String is "+e+". Max index provided was "+(t.length-1)+".");return t[a]})}function au(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];var i=n.map(function(e){return t(e)});return nu.apply(void 0,tu([e],i))}var iu=n(2567);function ru(e,t){return void 0===t?"rgb("+e.r+", "+e.g+", "+e.b+")":"rgba("+e.r+", "+e.g+", "+e.b+", "+t+")"}Object(Cl.n)([{rawString:".display_09eb8103{position:absolute;z-index:2;-webkit-transform:translateX(-50%);transform:translateX(-50%);border-radius:2px;font-size:14px;line-height:20px;padding:4px 8px;pointer-events:none;text-align:center;opacity:0}.visible_09eb8103{opacity:1;-webkit-transition:opacity .25s;transition:opacity .25s}"}]);var ou=function(){return ou=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ou.apply(this,arguments)},su=s.a.memo(function(e){var t=e.children,n=e.visible,a=void 0!==n&&n,i=e.style,r=void 0===i?{}:i,o=Object(gc.e)(),d=Object(c.e)("display_09eb8103",a&&"visible_09eb8103"),l=Object(iu.e)(o.palette.white);return s.a.createElement("div",{className:d,style:ou({color:""+o.palette.neutralPrimary,background:l&&ru(l,.6)},r),"data-test-id":"aspect_ratio_display","aria-hidden":a?"false":"true"},t)}),cu=s.a.memo(function(e){var t=e.aspectRatioDisplay,n=e.position,a=e.opacity,i=Object(o.useContext)(Le),r=i.localizeNumber,c=i.strings,d=a>0,l=Object(o.useMemo)(function(){return d?au(c.aspectRatio_ratioLabelFormatString,r,t.x,t.y):""},[t,r,c,d]),u=Object(o.useMemo)(function(){return d?au(c.aspectRatio_ratioAriaLabelFormatString,r,t.x,t.y):""},[t,r,c,d]);return s.a.createElement(su,{style:{top:n.y,left:n.x,transform:"translateX(-50%)",opacity:a},visible:d},s.a.createElement("span",{"aria-label":u},l))}),du=Vt([ad],function(e){return Li(Ei(e))}),lu=Vt([sd,du],function(e,t){if(e!==we.None&&e!==we.Original){var n=wi.get(e);if(n)return n}return t}),uu=Vt([id,dd,vd,fd],function(e,t,n,a){return Aa(Vn(Cn(1/a),n||t,e))}),fu=Vt([uu],function(e){return{x:e.left+e.width/2,y:e.top+8}}),pu=[1,1,1,1,1,0],mu=function(e){if(e.cropUiDisplay.areCropOverlaysVisible)return 1;var t=Xn(e.animations.dismissCropOverlays,e.animations.currentTime,3e3);return ri(pu,t)},_u=Vt([du,ad,mu],function(e,t,n){var a,i;return a=Ei(t),i=e,Math.abs(i.x/i.y-a)<.01?n:0}),hu=Object(R.connect)(function(e){return{aspectRatioDisplay:lu(e.transformTools),position:fu(e.transformTools),opacity:_u(e.transformTools)}},{})(cu),bu=n(2373),gu=n(2057),vu={auto:!0,scroll:!0,hidden:!0};function yu(e){var t=getComputedStyle(e);return vu[t.overflow]||vu[t.overflowY]||vu[t.overflowX]}var Su=n(952),Du=n(1034),Iu=s.a.memo(function(e){var t=e.nextEditorActivity,n=e.waitingForActiveEditorActivityToComplete,a=e.setActiveEditorActivity;return Object(o.useEffect)(function(){n||""===t||a(t)},[t,a,n]),null}),xu={setActiveEditorActivity:ro},Cu=Object(R.connect)(function(e){return{nextEditorActivity:e.uiState.nextEditorActivity,waitingForActiveEditorActivityToComplete:e.uiState.waitingForActiveEditorActivityToComplete}},xu)(Iu);function Ou(e){var t="Mouse";return e.nativeEvent instanceof PointerEvent&&(t=wu(e.nativeEvent)),t}function wu(e){var t="";switch(e.pointerType){case"touch":t="Touch";break;case"pen":t="Pen";break;case"mouse":t="Mouse";break;default:0===e.screenX&&0===e.screenY&&(t="Keyboard")}return t}var Eu=function(){return Eu=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Eu.apply(this,arguments)},Au=s.a.memo(function(e){var t=e.activePivot,n=e.pivotItems,a=e.styles,i=e.showHeaderText,r=void 0===i||i,c=e.onChange,d=Object(o.useContext)(_e).logWarningEvent,l=Object(o.useContext)(Le).strings,u=Object(o.useState)(null),f=u[0],p=u[1],m=Object(o.useRef)({}),_=Object(o.useCallback)(function(e,n){e&&(e.props.itemKey||d({id:"InvalidPivotKey",message:"Missing pivot key on ControlPivot click. Current active pivot is "+t}),c({pivotKey:e.props.itemKey,inputType:n?Ou(n):"Keyboard"}))},[c,d,t]),h=function(e,t,n){var a=Object(gc.e)();return Object(o.useCallback)(function(i){if(!i)return null;var r=i.itemCount,o=i.itemIcon,c=i.headerText,d=t?t.props.styles:e,l=Object(Su.e)()(d,{theme:a});return s.a.createElement("span",{ref:function(e){n.current&&i.itemKey&&(n.current[i.itemKey]=e)},className:l.linkContent},void 0!==o&&s.a.createElement("span",{className:l.icon},s.a.createElement(Du.e,{iconName:o})),void 0!==c&&s.a.createElement("span",{className:l.text}," ",i.headerText),void 0!==r&&s.a.createElement("span",{className:l.count}," (",r,")"))},[n,t,e,a])}(a,f,m);return function(e,t){Object(o.useEffect)(function(){var n,a;t.current&&function(e,t){if(e){var n=function(e){for(var t=null==e?void 0:e.parentElement;t;){if(yu(t))return t;t=t.parentElement}return null}(e);if(n){var a=e.getBoundingClientRect(),i=n.getBoundingClientRect();if(Ia(a,i))return;n.scrollTo(e.offsetLeft+a.width/2-i.width/2,e.offsetTop+a.height/2-i.height/2)}}}(null===(a=null===(n=t.current[e])||void 0===n?void 0:n.parentElement)||void 0===a?void 0:a.parentElement)},[e,t])}(t,m),s.a.createElement(s.a.Fragment,null,s.a.createElement(Cu,null),s.a.createElement(bu.e,{ref:p,selectedKey:t,onLinkClick:_,headersOnly:!0,styles:a},n.map(function(e){var t=r?l[e.localizationKey]:"";return s.a.createElement(gu.e,Eu({key:e.itemKey},e,{headerText:t,ariaLabel:l[e.localizationKey],onRenderItemLink:h}))})))}),Lu=Object(R.connect)(function(e){return{activePivot:e.uiState.activeEditorActivity}},function(e){return Object(Rt.t)({onChange:function(e){var t=e.inputType,n=e.pivotKey;return io({nextEditorActivity:n,inputType:t})}},e)})(Au),ku=Vt([function(e){return e.animations.gridLineVisibility.numGridLines},rd],function(e,t){return function(e,t){if(e)return e;switch(t){case da.keyboardRotating:case da.rotating:return 8;case da.usingNineSliceCropHandles:case da.selectingSecondCorner:case da.draggingImage:case da.keyboardCropping:case da.zoomToCrop:return 2;default:return 0}}(e,t)}),Mu=Vt([function(e){return Xn(e.animations.gridLineVisibility,e.animations.currentTime,100)},function(e){return Xn(e.animations.dismissGridLineVisibility,e.animations.currentTime,400)},function(e){return gd(e)||e.rotationUi.rotationBarPointer.isDown},dd,ad,rd],function(e,t,n,a,i,r){return function(e,t,n,a,i,r){return function(e,t,n){var a=e||ii(n);return bn(a?0:.75,a?.75:0,t)}(e,a,r)*function(e,t){return ii(t)?ri([1,1,1,1,0],e):1}(i,r)*function(e){return gn(8,3,zn(e))}(t)*function(e,t){var n=Aa(Vn(e,t));return gn(50,80,Math.min(n.height,n.width))}(t,n)}(n,a,i,e,t,r)}),Pu=s.a.createContext({textures:{main:null,blend:null,overlay:null},shouldUseFakeMipMaps:!1});function Tu(e){return function(t){return t.split("@").join("_"+e)}}var Uu=function(){function e(e){void 0===e&&(e=[]),this._effects=[],this._effects=e}return e.prototype.getShaderProgramName=function(){return this._effects.reduce(function(e,t){return e+" "+t.getName()},"image")},e.prototype.getUniformNames=function(){var e=[];return this._effects.forEach(function(t,n){e=e.concat(t.getUniformNames(Tu(n)))}),e},e.prototype.getSamplerNames=function(){var e=[];return this._effects.forEach(function(t,n){t.getSamplerNames&&(e=e.concat(t.getSamplerNames(Tu(n))))}),e},e.prototype.getEffects=function(){return this._effects},e.prototype.registerEffect=function(e){this.unRegisterEffect(e),this._effects.push(e)},e.prototype.unRegisterEffect=function(e){this._effects=this._effects.filter(function(t){return t!==e})},e.prototype.getHeaderCode=function(){var e=this._effects.reduce(function(e,t,n){return t.getFunctions(Tu(n)).forEach(function(t){e[t]=""}),e},{});return"// functions -- \n"+Object.keys(e).join("\n\n")+this._effects.reduce(function(e,t,n){return e+t.getHeaderCode(Tu(n))},"// shader effects -- \n")},e.prototype.getBodyCode=function(){return this._effects.reduce(function(e,t,n){return e+t.getShaderFunctionBody(Tu(n))},"// shader effects -- \n")},e.prototype.onBeforeBabylonRender=function(e){this._effects.forEach(function(t,n){t.onBeforeBabylonRender(e,Tu(n))})},e}(),Fu="\n#ifndef GAMMALINEARSPACE\n#define GAMMALINEARSPACE\n\nconst float LinearEncodePowerApprox = 2.2;\nconst float GammaEncodePowerApprox = 1.0 / LinearEncodePowerApprox;\n\nvec3 toLinearSpace(vec3 color)\n{\n    return pow(color, vec3(LinearEncodePowerApprox));\n}\n\nvec3 toGammaSpace(vec3 color)\n{\n    return pow(color, vec3(GammaEncodePowerApprox));\n}\n#endif\n",Hu=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)a[i]=r[o];return a},Ru="textureSampler",Nu="uTransform",Bu="uTransformInverse",ju="uDisplaySize",Vu="uColorOverrideLevel",zu="uColorOverride",Gu="secondaryBlendTextureSampler",Ku="uSecondaryBlend",Wu="secondaryOverlayTextureSampler",qu="uOverlayTextureAlpha",Qu="uIsRenderingForExport",Yu="uFakeMipMapsEnabled",Ju=[zu,Vu,ju,Ru,"uScreenPixelPos",Nu,Bu,"uv",Gu,Ku,Wu,qu,Qu,Yu],Xu=["position"],Zu=[Ru,Gu,Wu],$u="ENABLE_SECONDARY_BLEND",ef="ENABLE_SECONDARY_OVERLAY",tf=function(e,t){return"\n    #ifdef GL_ES\n    precision highp float;\n    #endif\n    varying highp vec2 uScreenPixelPos;\n    uniform sampler2D textureSampler;\n    uniform vec4 uColorOverride;\n    uniform float uColorOverrideLevel;\n    uniform mat3 uTransform;\n    uniform mat3 uTransformInverse;\n    uniform vec2 uDisplaySize;\n    uniform float uIsRenderingForExport;\n    varying vec3 uvPosition;\n\n    "+e+"\n\n    "+Fu+"\n\n    #ifdef ENABLE_SECONDARY_BLEND\n      uniform sampler2D secondaryBlendTextureSampler;\n      uniform float uSecondaryBlend;\n    #endif\n\n    #ifdef ENABLE_SECONDARY_OVERLAY\n      uniform sampler2D secondaryOverlayTextureSampler;\n      uniform float uOverlayTextureAlpha;\n    #endif\n\n    #ifdef ENABLE_FAKE_MIP_MAPS_EFFECT\n        uniform float uFakeMipMapsEnabled;\n    #endif\n\n    vec4 sampleTexture(sampler2D sampler, vec2 uv){\n      #ifdef ENABLE_FAKE_MIP_MAPS_EFFECT\n        if(uFakeMipMapsEnabled==0.0 || uIsRenderingForExport==1.0){\n          return texture2D(sampler,uv);\n        }else{\n          vec3 originOffset = vec3(0.,0.,1.0) * uTransformInverse;\n          vec3 uvOffset3 = vec3(0.5,0.5,1.0) * uTransformInverse;\n          uvOffset3 -= originOffset;\n          vec2 uvOffset = uvOffset3.xy;\n          vec2 diagonalOffset = vec2(uvOffset.x,-uvOffset.y);\n          return 0.2 * (  texture2D(sampler,uv)\n                           + texture2D(sampler,uv - uvOffset) \n                           + texture2D(sampler,uv + uvOffset)\n                           + texture2D(sampler,uv + diagonalOffset)\n                           + texture2D(sampler,uv - diagonalOffset)\n                           );\n        }\n      #else\n        return texture2D(sampler,uv);\n      #endif\n    }\n\n    vec4 getTextureColor(vec2 uv){\n      #ifdef ENABLE_SECONDARY_BLEND\n        if(uSecondaryBlend == 0.){\n          return sampleTexture(textureSampler, uv);\n        }\n        return mix(sampleTexture(textureSampler, uv),sampleTexture(secondaryBlendTextureSampler, uv),uSecondaryBlend);\n      #else\n        return sampleTexture(textureSampler, uv);\n      #endif\n    }\n\n    void main(void) {\n\n        float finalAlphaMultiply = 1.;\n        vec3 uv = uvPosition;\n        gl_FragColor = getTextureColor(uv.xy);\n        gl_FragColor = mix(gl_FragColor,uColorOverride,uColorOverrideLevel);\n\n        // effect 'body' code is inserted here.\n        // effect can can modify the above variables.\n        "+t+"\n\n      #ifdef ENABLE_SECONDARY_OVERLAY\n        vec4 overlayColor = texture2D(secondaryOverlayTextureSampler, uv.xy);\n\n        float overlayBlendedAlpha = overlayColor.a + gl_FragColor.a * (1. - overlayColor.a);\n        vec4 overlayBlendedColor = vec4((overlayColor.rgb * overlayColor.a + gl_FragColor.rgb * gl_FragColor.a * (1. - overlayColor.a)) / overlayBlendedAlpha, overlayBlendedAlpha);\n        gl_FragColor = mix(gl_FragColor, overlayBlendedColor, uOverlayTextureAlpha);\n\n        #endif\n\n      gl_FragColor.a *= finalAlphaMultiply;\n    }\n  "},nf=function(e){var t=Object(o.useMemo)(function(){return"\n    #ifdef GL_ES\n    precision highp float;\n    #endif\n\n    attribute vec4 position;\n    varying highp vec2 uScreenPixelPos;\n    uniform vec2 uDisplaySize;\n    uniform mat3 uTransform;\n    uniform mat3 uTransformInverse;\n    varying vec3 uvPosition;\n\n    void main(void) {\n      vec3 pos = vec3(position.x* 0.5 + 0.5, position.y* 0.5 + 0.5, 1.0) * uTransform;\n\n      uScreenPixelPos = pos.xy;\n      uvPosition = vec3(uScreenPixelPos.x, uScreenPixelPos.y,1.0) * uTransformInverse;\n\n      //convert to GL coordinates.\n      pos.x = (pos.x / uDisplaySize.x) * 2.0 - 1.0;\n      pos.y = (-pos.y /uDisplaySize.y) * 2.0 + 1.0;\n\n      gl_Position = vec4(pos.x,pos.y,0.0,1.0);\n    }\n  "},[]),n=Object(o.useState)(tf("","")),a=n[0],i=n[1],r=Object(o.useState)(""),s=r[0],c=r[1],d=Object(o.useState)(Ju),l=d[0],u=d[1],f=Object(o.useState)(Zu),p=f[0],m=f[1],_=Object(o.useMemo)(function(){return Xu},[]),h=e.getShaderProgramName();return Object(o.useLayoutEffect)(function(){s!==h&&(c(e.getShaderProgramName()),u(Hu(e.getUniformNames(),Ju)),i(tf(e.getHeaderCode(),e.getBodyCode())),m(Hu(e.getSamplerNames(),Zu)))},[e,s,h]),[h,t,a,_,p,l]},af=[0,0,0,1],rf=[1,0,0,1],of=[0,0,0,0];function sf(e){return{x:e[0],y:e[1],z:e[2],w:e[3]}}var cf=new Map([[1,{angle:0,mirror:!1}],[2,{angle:0,mirror:!0}],[3,{angle:180,mirror:!1}],[4,{angle:180,mirror:!0}],[5,{angle:-90,mirror:!0}],[6,{angle:90,mirror:!1}],[7,{angle:90,mirror:!0}],[8,{angle:-90,mirror:!1}]]);function df(e,t,n){void 0===t&&(t={x:1,y:1}),void 0===n&&(n=t);var a=cf.get(e),i=a.angle,r=a.mirror,o=Vn(An(i),r?In():[1,0,0,0,1,0],Cn(t.x,t.y)),s=Un(o,{x:0,y:0}),c=Un(o,{x:n.x,y:0}),d=Un(o,{x:n.x,y:n.y}),l=Un(o,{x:0,y:n.y});return Vn(wn(-Math.min(s.x,c.x,d.x,l.x),-Math.min(s.y,c.y,d.y,l.y)),o)}var lf=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)a[i]=r[o];return a};function uf(e,t,n,a,i,r,o,s){void 0===s&&(s=!1);var c=null==i?void 0:i.main,d=function(e,t){return void 0===e&&(e=1),Vn(t,df(e))}(null==c?void 0:c.orientation,e);c&&0!==c.parts.length?c.parts.forEach(function(e,l){var u,f,p,m,_=Vn(d,wn(e.rect.left/c.width,e.rect.top/c.height),Cn(e.rect.width/c.width,e.rect.height/c.height));ff(_,t,s,n,a,{main:e.texture,blend:(null===(f=null===(u=null==i?void 0:i.blend)||void 0===u?void 0:u.parts[l])||void 0===f?void 0:f.texture)||null,overlay:(null===(m=null===(p=null==i?void 0:i.overlay)||void 0===p?void 0:p.parts[l])||void 0===m?void 0:m.texture)||null},r,o)}):ff(d,t,s,n,a,void 0,r,o)}var ff=function(e,t,n,a,i,r,o,s){var c,d;if((null==i?void 0:i.effect.isReady())&&i&&o&&s&&Pn(e)){var l=i.effect;if(s.applyEffectWrapper(i),l.setFloat2(ju,(null===(c=o.getRenderingCanvas())||void 0===c?void 0:c.width)||0,(null===(d=o.getRenderingCanvas())||void 0===d?void 0:d.height)||0),l.setMatrix3x3(Nu,new Float32Array(lf(e,[0,0,1]))),l.setMatrix3x3(Bu,new Float32Array(lf(Tn(e),[0,0,1]))),l.setFloat(Qu,n?1:0),null==r?void 0:r.main)l.setTexture(Ru,r.main),(null==r?void 0:r.blend)&&l.setTexture(Gu,r.blend),(null==r?void 0:r.overlay)&&l.setTexture(Wu,r.overlay),l.setFloat(Vu,0);else{var u=a||af;l.setVector4(zu,sf(u)),l.setFloat(Vu,1)}t.onBeforeBabylonRender(l),s.render(i)}},pf=s.a.createContext({canvasContextIsValid:!1});function mf(e,t,n,a,i,r){var s=Object(o.useState)(void 0),c=s[0],d=s[1],l=function(){var e=Object(o.useState)(!0),t=e[0],n=e[1];return Object(o.useEffect)(function(){n(!1)},[]),t}(),u=Object(o.useContext)(pf).effectWrapperManager;return Object(o.useEffect)(function(){l||u&&u.getEffectWrapper(e,t,n,a,i,r).then(d,function(e){throw new Error(e)})},[e,t,n,i,a,r,u,l]),c}var _f,hf=function(){function e(){this._needsRender=!1,this._isRendering=!1,this._renderers=new Map}return e.prototype.register=function(e,t,n){this._renderers.set(e,{func:t,zIndex:n}),this._needsRender=!0},e.prototype.unregister=function(e){this._renderers.delete(e),this._needsRender=!0},e.prototype.requestRender=function(){this._needsRender=!0},e.prototype.startRendering=function(){this._isRendering||(this._isRendering=!0,this._renderNextFrame())},e.prototype.stopRendering=function(){this._isRendering=!1},e.prototype.renderNow=function(){this._render()},e.prototype._render=function(){var e=[];this._renderers.forEach(function(t){e.push(t)}),e.sort(function(e,t){return e.zIndex-t.zIndex}),e.forEach(function(e){return e.func()})},e.prototype._renderNextFrame=function(){var e=this;this._isRendering&&(this._needsRender&&(this._render(),this._needsRender=!1),window.requestAnimationFrame(function(){e._renderNextFrame()}))},e}(),bf=Object(o.createContext)({renderList:new hf}),gf=s.a.memo(function(e){var t=Object(o.useMemo)(function(){return{renderList:new hf}},[]);return Object(o.useEffect)(function(){return t.renderList.startRendering(),function(){t.renderList.stopRendering()}},[t]),s.a.createElement(bf.Provider,{value:t},e.children)}),vf=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)a[i]=r[o];return a};function yf(e,t){var n=Object(o.useContext)(bf).renderList;Object(o.useLayoutEffect)(function(){if(n){var a=As();return n.register(a,e,t),function(){n.unregister(a)}}},[n,e,t]),Object(o.useLayoutEffect)(function(){n&&n.requestRender()},[n])}function Sf(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Object(o.useContext)(bf).renderList;Object(o.useLayoutEffect)(function(){n&&n.requestRender()},vf([n],e))}function Df(e){void 0===e&&(e=[0,0,0,0,0,0]);var t=Object(o.useContext)(bf).renderList,n=e[0],a=e[1],i=e[2],r=e[3],s=e[4],c=e[5];Object(o.useLayoutEffect)(function(){t&&t.requestRender()},[t,n,a,i,r,s,c])}!function(e){e[e.main=0]="main",e[e.lut=1]="lut",e[e.blend=2]="blend",e[e.overlay=3]="overlay"}(_f||(_f={}));var If=function(){return If=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},If.apply(this,arguments)},xf={disposalCondition:"whenSourceIdChanges",shouldDisposeWhenSourceIsNull:!0};function Cf(e,t,n,a,i,r){void 0===a&&(a=!1),void 0===r&&(r={});var s=Object(o.useState)(void 0),c=s[0],d=s[1];return function(e,t,n,a,i){void 0===a&&(a=!1);var r=Se();!function(e,t,n){var a=t?Bc(t):null,i=Object(o.useRef)(e);i.current=e,Object(o.useLayoutEffect)(function(){i.current()},[a,n])}(Object(o.useCallback)(function(){e&&(null==n||n.getTexture(e,i,t,a,r))},[e,t,n,r,a,i]),e,n)}(e,t,n,a,Object(o.useCallback)(function(e){d(e),null==i||i({x:e.width,y:e.height})},[i])),function(e,t,n,a,i){var r,s,c=function(e,t,n){return Object(o.useCallback)(function(){e&&(null==t||t.forceReleaseTexture(e.id),n())},[t,e,n])}(t,n,function(){return d(void 0)});r=c,(s=Object(o.useRef)(r)).current=r,Object(o.useEffect)(function(){return function(){s.current()}},[]);var l,u,f,p=function(e,t,n){var a=If(If({},xf),n),i=a.disposalCondition,r=a.shouldDisposeWhenSourceIsNull;return"whenSourceIdChanges"===i&&function(e,t){return!!e&&(null==t?void 0:t.id)!==Bc(e)}(e,t)||r&&null===e}(e,t,a);l=p,u=c,f=Object(o.useRef)(l),!0===l&&!1===f.current&&u(),f.current=l,function(e,t){var n=Object(o.useRef)(e);n.current&&n.current.id!==(null==e?void 0:e.id)&&(null==t||t.forceReleaseTexture(n.current.id)),n.current=e}(t,n)}(e,c,n,r),(null==c?void 0:c.texture)||null}function Of(e){return 2===(null==e?void 0:e.webGLVersion)}var wf=function(){return wf=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},wf.apply(this,arguments)},Ef=function(e){var t=e.children,n=e.zIndex,a=e.color,i=e.transform,r=e.image,c=e.onMainTextureLoaded,d=e.onOverlayTextureLoaded,l=e.imageEffectsRegistry,u=Object(o.useContext)(pf),f=u.engine,p=u.effectRenderer,m=u.textures,_=function(e){return Object(o.useMemo)(function(){return e||new Uu},[e])}(l),h=Object(o.useRef)([1,0,0,0,1,0]);h.current=Dn(i);var b=nf(_),g=mf(b[0],b[1],b[2],b[3],b[4],b[5]),v=Of(f),y=function(e,t){var n={main:!1,blend:!1,overlay:!1};switch(e){case Ec.ActualMipMapsWithFakeFallBack:return{mipMapsEnabledByLayer:wf(wf({},n),{main:t,blend:t}),shouldUseFakeMipMaps:!t};case Ec.FakeMipMaps:return{mipMapsEnabledByLayer:n,shouldUseFakeMipMaps:!0};case Ec.NoMipMaps:return{mipMapsEnabledByLayer:n,shouldUseFakeMipMaps:!1};default:throw new ec(e)}}(function(e){var t;return(Rc(e)?null===(t=e.main)||void 0===t?void 0:t.mipMapType:null==e?void 0:e.mipMapType)||Pc}(r),v),S=y.mipMapsEnabledByLayer,D=y.shouldUseFakeMipMaps,I=function(e,t,n,a,i){var r=Object(o.useContext)(Hd),s=Nc(t),c=Object(o.useCallback)(function(e){null==a||a({sizeInPixels:e,resetEditsOnSizeChange:!r})},[a,r]),d=Object(o.useCallback)(function(e){null==i||i()},[i]),l=Cf(s.main,_f.main,e,!!n.main,c,{disposalCondition:"whenNewTextureLoads"}),u=Cf(s.blend,_f.blend,e,!!n.blend),f=Cf(s.overlay,_f.overlay,e,!!n.overlay,d),p=Object(o.useMemo)(function(){return{main:l,blend:u,overlay:f}},[l,u,f]);return Sf(p),p}(m,r,S,c,d),x=function(e,t,n,a,i,r,s){return Object(o.useCallback)(function(){uf(e.current,t,n,a,i,r,s)},[e,t,n,a,i,r,s])}(h,_,a,g,I,f,p);return yf(x,n),Df(i),s.a.createElement(Pu.Provider,{value:{registry:_,textures:I,shouldUseFakeMipMaps:D}},t)},Af=function(){return Af=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Af.apply(this,arguments)},Lf=s.a.memo(function(e){return s.a.createElement(Ef,Af({image:null},e))}),kf=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)a[i]=r[o];return a},Mf=function(){function e(){this._visible=!1,this._shadowSize=3,this._cropTransform=[1,0,0,0,1,0],this._handleTransform=[1,0,0,0,1,0]}return e.prototype.setVisible=function(e){this._visible=e},e.prototype.setShadowSize=function(e){this._shadowSize=e},e.prototype.setCropTransform=function(e){this._cropTransform=e},e.prototype.setHandleTransform=function(e){this._handleTransform=e},e.prototype.getName=function(){return"CropHandleShapeShader"},e.prototype.getUniformNames=function(e){return[e("uVisible@"),e("uShadowSize@"),e("uCropTransformInverse@"),e("uHandleTransformInverse@")]},e.prototype.getFunctions=function(){return["\nfloat inTransform(mat3 posToUv, vec2 pixelPos){\n  vec3 uv = vec3(pixelPos, 1.) * posToUv;\n  if(uv.x < 0. || uv.x > 1. || uv.y < 0. || uv.y > 1.) {\n    return 0.;\n  }\n  return 1.;\n}\n","\nfloat handleShape(in vec2 pixelPos, mat3 handleTransform, mat3 cropTransform) {\n  float inCrop = inTransform(cropTransform, pixelPos);\n  float inHandleRect = inTransform(handleTransform, pixelPos);\n  return clamp(inHandleRect - inCrop, 0., 1.);\n}\n","\nfloat shadowLevel(vec2 shadowPos, mat3 handleTransform, mat3 cropTransform) {\n  #define shadowSamples 15\n  float angle = 0.;\n  float total = 0.;\n  float fSamples = float(shadowSamples);\n\n  for(int i = 0; i < shadowSamples; i++) {\n    float normalizedRadius = sqrt(float(i + 1) / fSamples);\n    float r = 5. * normalizedRadius;\n    vec2 sampleDir = vec2(cos(angle), sin(angle));\n    total += handleShape(shadowPos + sampleDir * r, handleTransform, cropTransform);\n    angle += 2.39996;\n  }\n\n  return total / fSamples;\n}\n","\nvec4 cropHandle(in vec4 handleColor, in vec2 pixelPos, mat3 handleTransform, mat3 cropTransform, float shadowSize) {\n  vec4 fragColor = vec4(0.);\n  vec2 shadowOffset = vec2(0., 3.);\n  vec4 shadowColor = vec4(vec3(0.), 0.33);\n\n  float inHandle = handleShape(pixelPos, handleTransform, cropTransform);\n  if(inHandle >= 1. ) { //if we are in the shape, no need to calculate the shadow.\n      return mix(fragColor, handleColor, handleColor.a);\n  } else {\n    vec2 shadowPos = pixelPos - shadowOffset;\n    float shadowBlend = shadowLevel(shadowPos, handleTransform, cropTransform);\n    return mix(fragColor, shadowColor, shadowBlend);\n  }\n}\n"]},e.prototype.getHeaderCode=function(e){return e("//CropHandleShapeShader effect---\n        uniform float uVisible@;\n        uniform float uShadowSize@;\n        uniform mat3 uCropTransformInverse@;\n        uniform mat3 uHandleTransformInverse@;\n    ")},e.prototype.getShaderFunctionBody=function(e){return e("//CropHandleShapeShader effect---\n        gl_FragColor = cropHandle(gl_FragColor,uScreenPixelPos.xy,uHandleTransformInverse@,uCropTransformInverse@,uShadowSize@);\n        gl_FragColor.a = gl_FragColor.a * uVisible@;\n        ")},e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t("uVisible@"),this._visible?1:0),e.setFloat(t("uShadowSize@"),this._shadowSize),e.setMatrix3x3(t("uCropTransformInverse@"),new Float32Array(kf(Tn(this._cropTransform),[0,0,1]))),e.setMatrix3x3(t("uHandleTransformInverse@"),new Float32Array(kf(Tn(this._handleTransform),[0,0,1])))},e}();function Pf(e){var t=Object(o.useContext)(Pu).registry;Object(o.useLayoutEffect)(function(){if(t){var n="function"==typeof e?e():e;return t.registerEffect(n),function(){t&&t.unRegisterEffect(n)}}},[e,t])}var Tf=function(e){var t=e.visible,n=e.shadowSize,a=e.cropTransform,i=e.handleTransform,r=Object(o.useMemo)(function(){return new Mf},[]);return r.setVisible(t),r.setShadowSize(n),r.setCropTransform(a),r.setHandleTransform(i),Sf(t),Pf(r),null},Uf=function(e){if(e){var t=Object(iu.e)(e);return t&&[t.r/255,t.g/255,t.b/255,t.a||1]}};function Ff(e){return Object(o.useMemo)(function(){var t=Uf(e),n=of;return t&&(n=[t[0],t[1],t[2],1]),n},[e])}var Hf=function(){function e(e,t){this.width=e,this.height=t}return e.prototype.toString=function(){return"{W: ".concat(this.width,", H: ").concat(this.height,"}")},e.prototype.getClassName=function(){return"Size"},e.prototype.getHashCode=function(){return 397*(0|this.width)^(0|this.height)},e.prototype.copyFrom=function(e){this.width=e.width,this.height=e.height},e.prototype.copyFromFloats=function(e,t){return this.width=e,this.height=t,this},e.prototype.set=function(e,t){return this.copyFromFloats(e,t)},e.prototype.multiplyByFloats=function(t,n){return new e(this.width*t,this.height*n)},e.prototype.clone=function(){return new e(this.width,this.height)},e.prototype.equals=function(e){return!!e&&this.width===e.width&&this.height===e.height},Object.defineProperty(e.prototype,"surface",{get:function(){return this.width*this.height},enumerable:!1,configurable:!0}),e.Zero=function(){return new e(0,0)},e.prototype.add=function(t){return new e(this.width+t.width,this.height+t.height)},e.prototype.subtract=function(t){return new e(this.width-t.width,this.height-t.height)},e.Lerp=function(t,n,a){return new e(t.width+(n.width-t.width)*a,t.height+(n.height-t.height)*a)},e}(),Rf=function(){function e(e){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=Hf.Zero(),this._cachedBaseSize=Hf.Zero(),this._initialSamplingMode=2,this._texture=e,this._texture&&(this._engine=this._texture.getEngine())}return Object.defineProperty(e.prototype,"wrapU",{get:function(){return this._wrapU},set:function(e){this._wrapU=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wrapV",{get:function(){return this._wrapV},set:function(e){this._wrapV=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"coordinatesMode",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCube",{get:function(){return!!this._texture&&this._texture.isCube},set:function(e){this._texture&&(this._texture.isCube=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"is3D",{get:function(){return!!this._texture&&this._texture.is3D},set:function(e){this._texture&&(this._texture.is3D=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"is2DArray",{get:function(){return!!this._texture&&this._texture.is2DArray},set:function(e){this._texture&&(this._texture.is2DArray=e)},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return"ThinTexture"},e.prototype.isReady=function(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady},e.prototype.delayLoad=function(){},e.prototype.getInternalTexture=function(){return this._texture},e.prototype.getSize=function(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize},e.prototype.getBaseSize=function(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)},Object.defineProperty(e.prototype,"samplingMode",{get:function(){return this._texture?this._texture.samplingMode:this._initialSamplingMode},enumerable:!1,configurable:!0}),e.prototype.updateSamplingMode=function(e){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(e,this._texture)},e.prototype.releaseInternalTexture=function(){this._texture&&(this._texture.dispose(),this._texture=null)},e.prototype.dispose=function(){this._texture&&(this.releaseInternalTexture(),this._engine=null)},e}(),Nf=function(){function e(){}return e.ALPHA_COMBINE=2,e.TEXTURE_CLAMP_ADDRESSMODE=0,e.TEXTURE_DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,e.TEXTUREFORMAT_RGB=4,e.TEXTUREFORMAT_RGBA=5,e.TEXTURETYPE_UNSIGNED_BYTE=0,e.TEXTURE_TRILINEAR_SAMPLINGMODE=3,e.MATERIAL_LineListDrawMode=4,e.MATERIAL_LineLoopDrawMode=5,e}(),Bf=function(e,t){return Bf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Bf(e,t)},jf=function(){return jf=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},jf.apply(this,arguments)},Vf=function(e){function t(n,a){var i=e.call(this,null)||this;return a=jf(jf({},t.DefaultOptions),a),i._generateMipMaps=a.generateMipMaps,i._samplingMode=a.samplingMode,i._engine=a.engine,i.element=n,i.anisotropicFilteringLevel=1,i._createInternalTexture(),i}return function(e,t){function n(){this.constructor=e}Bf(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype._createInternalTexture=function(){var e,t;e=this.element.width,t=this.element.height;var n=this._engine;n&&(this._texture=n.createDynamicTexture(e,t,this._generateMipMaps,this._samplingMode)),this.update()},t.prototype.update=function(){var e=this._engine;if(null!=this._texture&&null!=e){var t=this.element;e.updateDynamicTexture(this._texture,t,!0,!1)}},t.DefaultOptions={generateMipMaps:!1,samplingMode:Nf.TEXTURE_TRILINEAR_SAMPLINGMODE,engine:null},t}(Rf),zf=function(){function e(){this.references=0,this.capacity=0,this.is32Bits=!1,this.uniqueId=e._Counter++}return Object.defineProperty(e.prototype,"underlyingResource",{get:function(){return null},enumerable:!1,configurable:!0}),e._Counter=0,e}(),Gf=function(){function e(){}return e.Slice=function(e,t,n){return e.slice?e.slice(t,n):Array.prototype.slice.call(e,t,n)},e.SliceToArray=function(e,t,n){return Array.isArray(e)?e.slice(t,n):Array.prototype.slice.call(e,t,n)},e}(),Kf=function(){function e(e,t,n,a,i,r,o,s){void 0===a&&(a=0),void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===o&&(o=!1),this._isAlreadyOwned=!1,e.getScene?this._engine=e.getScene().getEngine():this._engine=e,this._updatable=n,this._instanced=r,this._divisor=s||1,t instanceof zf?(this._data=null,this._buffer=t):(this._data=t,this._buffer=null),this.byteStride=o?a:a*Float32Array.BYTES_PER_ELEMENT,i||this.create()}return e.prototype.createVertexBuffer=function(e,t,n,a,i,r,o){void 0===r&&(r=!1);var s=r?t:t*Float32Array.BYTES_PER_ELEMENT,c=a?r?a:a*Float32Array.BYTES_PER_ELEMENT:this.byteStride;return new Wf(this._engine,this,e,this._updatable,!0,c,void 0===i?this._instanced:i,s,n,void 0,void 0,!0,this._divisor||o)},e.prototype.isUpdatable=function(){return this._updatable},e.prototype.getData=function(){return this._data},e.prototype.getBuffer=function(){return this._buffer},e.prototype.getStrideSize=function(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT},e.prototype.create=function(e){void 0===e&&(e=null),!e&&this._buffer||(e=e||this._data)&&(this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e),this._data=e):this._updatable?(this._buffer=this._engine.createDynamicVertexBuffer(e),this._data=e):this._buffer=this._engine.createVertexBuffer(e))},e.prototype._rebuild=function(){this._buffer=null,this.create(this._data)},e.prototype.update=function(e){this.create(e)},e.prototype.updateDirectly=function(e,t,n,a){void 0===a&&(a=!1),this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e,a?t:t*Float32Array.BYTES_PER_ELEMENT,n?n*this.byteStride:void 0),this._data=0===t&&void 0===n?e:null)},e.prototype._increaseReferences=function(){this._buffer&&(this._isAlreadyOwned?this._buffer.references++:this._isAlreadyOwned=!0)},e.prototype.dispose=function(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null,this._data=null)},e}(),Wf=function(){function e(t,n,a,i,r,o,s,c,d,l,u,f,p,m){if(void 0===u&&(u=!1),void 0===f&&(f=!1),void 0===p&&(p=1),void 0===m&&(m=!1),n instanceof Kf?(this._buffer=n,this._ownsBuffer=m):(this._buffer=new Kf(t,n,i,o,r,s,f),this._ownsBuffer=!0),this.uniqueId=e._Counter++,this._kind=a,null==l){var _=this.getData();this.type=e.FLOAT,_ instanceof Int8Array?this.type=e.BYTE:_ instanceof Uint8Array?this.type=e.UNSIGNED_BYTE:_ instanceof Int16Array?this.type=e.SHORT:_ instanceof Uint16Array?this.type=e.UNSIGNED_SHORT:_ instanceof Int32Array?this.type=e.INT:_ instanceof Uint32Array&&(this.type=e.UNSIGNED_INT)}else this.type=l;var h=e.GetTypeByteLength(this.type);f?(this._size=d||(o?o/h:e.DeduceStride(a)),this.byteStride=o||this._buffer.byteStride||this._size*h,this.byteOffset=c||0):(this._size=d||o||e.DeduceStride(a),this.byteStride=o?o*h:this._buffer.byteStride||this._size*h,this.byteOffset=(c||0)*h),this.normalized=u,this._instanced=void 0!==s&&s,this._instanceDivisor=s?p:0,this._computeHashCode()}return Object.defineProperty(e.prototype,"instanceDivisor",{get:function(){return this._instanceDivisor},set:function(e){this._instanceDivisor=e,this._instanced=0!=e,this._computeHashCode()},enumerable:!1,configurable:!0}),e.prototype._computeHashCode=function(){this.hashCode=(this.type-5120<<0)+((this.normalized?1:0)<<3)+(this._size<<4)+((this._instanced?1:0)<<6)+(this.byteStride<<12)},e.prototype._rebuild=function(){this._buffer&&this._buffer._rebuild()},e.prototype.getKind=function(){return this._kind},e.prototype.isUpdatable=function(){return this._buffer.isUpdatable()},e.prototype.getData=function(){return this._buffer.getData()},e.prototype.getFloatData=function(t,n){var a=this.getData();if(!a)return null;var i=this.getSize()*e.GetTypeByteLength(this.type),r=t*this.getSize();if(this.type!==e.FLOAT||this.byteStride!==i){var o=new Float32Array(r);return this.forEach(r,function(e,t){return o[t]=e}),o}if(!(a instanceof Array||a instanceof Float32Array)||0!==this.byteOffset||a.length!==r){if(a instanceof Array){var s=this.byteOffset/4;return Gf.Slice(a,s,s+r)}if(a instanceof ArrayBuffer)return new Float32Array(a,this.byteOffset,r);if(s=a.byteOffset+this.byteOffset,n){var c=new Float32Array(r),d=new Float32Array(a.buffer,s,r);return c.set(d),c}var l=s%4;return l&&(s=Math.max(0,s-l)),new Float32Array(a.buffer,s,r)}return n?Gf.Slice(a):a},e.prototype.getBuffer=function(){return this._buffer.getBuffer()},e.prototype.getStrideSize=function(){return this.byteStride/e.GetTypeByteLength(this.type)},e.prototype.getOffset=function(){return this.byteOffset/e.GetTypeByteLength(this.type)},e.prototype.getSize=function(t){return void 0===t&&(t=!1),t?this._size*e.GetTypeByteLength(this.type):this._size},e.prototype.getIsInstanced=function(){return this._instanced},e.prototype.getInstanceDivisor=function(){return this._instanceDivisor},e.prototype.create=function(e){this._buffer.create(e)},e.prototype.update=function(e){this._buffer.update(e)},e.prototype.updateDirectly=function(e,t,n){void 0===n&&(n=!1),this._buffer.updateDirectly(e,t,void 0,n)},e.prototype.dispose=function(){this._ownsBuffer&&this._buffer.dispose()},e.prototype.forEach=function(t,n){e.ForEach(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,t,this.normalized,n)},e.DeduceStride=function(t){switch(t){case e.UVKind:case e.UV2Kind:case e.UV3Kind:case e.UV4Kind:case e.UV5Kind:case e.UV6Kind:return 2;case e.NormalKind:case e.PositionKind:return 3;case e.ColorKind:case e.MatricesIndicesKind:case e.MatricesIndicesExtraKind:case e.MatricesWeightsKind:case e.MatricesWeightsExtraKind:case e.TangentKind:return 4;default:throw new Error("Invalid kind '"+t+"'")}},e.GetTypeByteLength=function(t){switch(t){case e.BYTE:case e.UNSIGNED_BYTE:return 1;case e.SHORT:case e.UNSIGNED_SHORT:return 2;case e.INT:case e.UNSIGNED_INT:case e.FLOAT:return 4;default:throw new Error("Invalid type '".concat(t,"'"))}},e.ForEach=function(t,n,a,i,r,o,s,c){if(t instanceof Array)for(var d=n/4,l=a/4,u=0;u<o;u+=i){for(var f=0;f<i;f++)c(t[d+f],u+f);d+=l}else{var p=t instanceof ArrayBuffer?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),m=e.GetTypeByteLength(r);for(u=0;u<o;u+=i){var _=n;for(f=0;f<i;f++)c(e._GetFloatValue(p,r,_,s),u+f),_+=m;n+=a}}},e._GetFloatValue=function(t,n,a,i){switch(n){case e.BYTE:var r=t.getInt8(a);return i&&(r=Math.max(r/127,-1)),r;case e.UNSIGNED_BYTE:return r=t.getUint8(a),i&&(r/=255),r;case e.SHORT:return r=t.getInt16(a,!0),i&&(r=Math.max(r/32767,-1)),r;case e.UNSIGNED_SHORT:return r=t.getUint16(a,!0),i&&(r/=65535),r;case e.INT:return t.getInt32(a,!0);case e.UNSIGNED_INT:return t.getUint32(a,!0);case e.FLOAT:return t.getFloat32(a,!0);default:throw new Error("Invalid component type ".concat(n))}},e._Counter=0,e.BYTE=5120,e.UNSIGNED_BYTE=5121,e.SHORT=5122,e.UNSIGNED_SHORT=5123,e.INT=5124,e.UNSIGNED_INT=5125,e.FLOAT=5126,e.PositionKind="position",e.NormalKind="normal",e.TangentKind="tangent",e.UVKind="uv",e.UV2Kind="uv2",e.UV3Kind="uv3",e.UV4Kind="uv4",e.UV5Kind="uv5",e.UV6Kind="uv6",e.ColorKind="color",e.ColorInstanceKind="instanceColor",e.MatricesIndicesKind="matricesIndices",e.MatricesWeightsKind="matricesWeights",e.MatricesIndicesExtraKind="matricesIndicesExtra",e.MatricesWeightsExtraKind="matricesWeightsExtra",e}(),qf=function(){function e(e,t,n,a){this.x=e,this.y=t,this.width=n,this.height=a}return e.prototype.toGlobal=function(t,n){return new e(this.x*t,this.y*n,this.width*t,this.height*n)},e.prototype.toGlobalToRef=function(e,t,n){return n.x=this.x*e,n.y=this.y*t,n.width=this.width*e,n.height=this.height*t,this},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e}(),Qf=function(){function e(e,t,n,a){void 0===t&&(t=!1),this.initialize(e,t,n,a)}return e.prototype.initialize=function(e,t,n,a){return void 0===t&&(t=!1),this.mask=e,this.skipNextObservers=t,this.target=n,this.currentTarget=a,this},e}(),Yf=function(e,t,n){void 0===n&&(n=null),this.callback=e,this.mask=t,this.scope=n,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1},Jf=(function(){function e(){}e.prototype.dispose=function(){if(this._observers&&this._observables)for(var e=0;e<this._observers.length;e++)this._observables[e].remove(this._observers[e]);this._observers=null,this._observables=null},e.Watch=function(t,n,a,i){void 0===a&&(a=-1),void 0===i&&(i=null);var r=new e;r._observers=new Array,r._observables=t;for(var o=0,s=t;o<s.length;o++){var c=s[o].add(n,a,!1,i);c&&r._observers.push(c)}return r}}(),function(){function e(e){this._observers=new Array,this._eventState=new Qf(0),e&&(this._onObserverAdded=e)}return e.FromPromise=function(t,n){var a=new e;return t.then(function(e){a.notifyObservers(e)}).catch(function(e){if(!n)throw e;n.notifyObservers(e)}),a},Object.defineProperty(e.prototype,"observers",{get:function(){return this._observers},enumerable:!1,configurable:!0}),e.prototype.add=function(e,t,n,a,i){if(void 0===t&&(t=-1),void 0===n&&(n=!1),void 0===a&&(a=null),void 0===i&&(i=!1),!e)return null;var r=new Yf(e,t,a);return r.unregisterOnNextCall=i,n?this._observers.unshift(r):this._observers.push(r),this._onObserverAdded&&this._onObserverAdded(r),r},e.prototype.addOnce=function(e){return this.add(e,void 0,void 0,void 0,!0)},e.prototype.remove=function(e){return!!e&&-1!==this._observers.indexOf(e)&&(this._deferUnregister(e),!0)},e.prototype.removeCallback=function(e,t){for(var n=0;n<this._observers.length;n++){var a=this._observers[n];if(!(a._willBeUnregistered||a.callback!==e||t&&t!==a.scope))return this._deferUnregister(a),!0}return!1},e.prototype._deferUnregister=function(e){var t=this;e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout(function(){t._remove(e)},0)},e.prototype._remove=function(e){if(!e)return!1;var t=this._observers.indexOf(e);return-1!==t&&(this._observers.splice(t,1),!0)},e.prototype.makeObserverTopPriority=function(e){this._remove(e),this._observers.unshift(e)},e.prototype.makeObserverBottomPriority=function(e){this._remove(e),this._observers.push(e)},e.prototype.notifyObservers=function(e,t,n,a,i){if(void 0===t&&(t=-1),!this._observers.length)return!0;var r=this._eventState;r.mask=t,r.target=n,r.currentTarget=a,r.skipNextObservers=!1,r.lastReturnValue=e,r.userInfo=i;for(var o=0,s=this._observers;o<s.length;o++){var c=s[o];if(!c._willBeUnregistered&&(c.mask&t&&(c.scope?r.lastReturnValue=c.callback.apply(c.scope,[e,r]):r.lastReturnValue=c.callback(e,r),c.unregisterOnNextCall&&this._deferUnregister(c)),r.skipNextObservers))return!1}return!0},e.prototype.notifyObserversWithPromise=function(e,t,n,a,i){var r=this;void 0===t&&(t=-1);var o=Promise.resolve(e);if(!this._observers.length)return o;var s=this._eventState;return s.mask=t,s.target=n,s.currentTarget=a,s.skipNextObservers=!1,s.userInfo=i,this._observers.forEach(function(n){s.skipNextObservers||n._willBeUnregistered||n.mask&t&&(o=n.scope?o.then(function(t){return s.lastReturnValue=t,n.callback.apply(n.scope,[e,s])}):o.then(function(t){return s.lastReturnValue=t,n.callback(e,s)}),n.unregisterOnNextCall&&r._deferUnregister(n))}),o.then(function(){return e})},e.prototype.notifyObserver=function(e,t,n){if(void 0===n&&(n=-1),!e._willBeUnregistered){var a=this._eventState;a.mask=n,a.skipNextObservers=!1,e.callback(t,a),e.unregisterOnNextCall&&this._deferUnregister(e)}},e.prototype.hasObservers=function(){return this._observers.length>0},e.prototype.clear=function(){this._observers=new Array,this._onObserverAdded=null},e.prototype.clone=function(){var t=new e;return t._observers=this._observers.slice(0),t},e.prototype.hasSpecificMask=function(e){void 0===e&&(e=-1);for(var t=0,n=this._observers;t<n.length;t++){var a=n[t];if(a.mask&e||a.mask===e)return!0}return!1},e}());function Xf(){return"undefined"!=typeof window}function Zf(){return"undefined"!=typeof navigator}function $f(){return"undefined"!=typeof document}function ep(e){for(var t="",n=e.firstChild;n;)3===n.nodeType&&(t+=n.textContent),n=n.nextSibling;return t}var tp,np={IsWindowObjectExist:Xf,IsNavigatorAvailable:Zf,IsDocumentAvailable:$f,GetDOMTextContent:ep},ap=function(){function e(){}return e._CheckLimit=function(t,n){var a=e._LogLimitOutputs[t];return a?a.current++:(a={limit:n,current:1},e._LogLimitOutputs[t]=a),a.current<=a.limit},e._GenerateLimitMessage=function(t,n){var a=e._LogLimitOutputs[t];if(a&&e.MessageLimitReached&&a.current===a.limit)switch(n){case 0:e.Log(e.MessageLimitReached.replace(/%LIMIT%/g,""+a.limit).replace(/%TYPE%/g,"log"));break;case 1:e.Warn(e.MessageLimitReached.replace(/%LIMIT%/g,""+a.limit).replace(/%TYPE%/g,"warning"));break;case 2:e.Error(e.MessageLimitReached.replace(/%LIMIT%/g,""+a.limit).replace(/%TYPE%/g,"error"))}},e._AddLogEntry=function(t){e._LogCache=t+e._LogCache,e.OnNewCacheEntry&&e.OnNewCacheEntry(t)},e._FormatMessage=function(e){var t=function(e){return e<10?"0"+e:""+e},n=new Date;return"["+t(n.getHours())+":"+t(n.getMinutes())+":"+t(n.getSeconds())+"]: "+e},e._LogDisabled=function(e,t){},e._LogEnabled=function(t,n){if(void 0===n||e._CheckLimit(t,n)){var a=e._FormatMessage(t);console.log("BJS - "+a);var i="<div style='color:white'>"+a+"</div><br>";e._AddLogEntry(i),e._GenerateLimitMessage(t,0)}},e._WarnDisabled=function(e,t){},e._WarnEnabled=function(t,n){if(void 0===n||e._CheckLimit(t,n)){var a=e._FormatMessage(t);console.warn("BJS - "+a);var i="<div style='color:orange'>"+t+"</div><br>";e._AddLogEntry(i),e._GenerateLimitMessage(t,1)}},e._ErrorDisabled=function(e,t){},e._ErrorEnabled=function(t,n){if(void 0===n||e._CheckLimit(t,n)){var a=e._FormatMessage(t);e.errorsCount++,console.error("BJS - "+a);var i="<div style='color:red'>"+a+"</div><br>";e._AddLogEntry(i),e._GenerateLimitMessage(t,2)}},Object.defineProperty(e,"LogCache",{get:function(){return e._LogCache},enumerable:!1,configurable:!0}),e.ClearLogCache=function(){e._LogCache="",e._LogLimitOutputs={},e.errorsCount=0},Object.defineProperty(e,"LogLevels",{set:function(t){(t&e.MessageLogLevel)===e.MessageLogLevel?e.Log=e._LogEnabled:e.Log=e._LogDisabled,(t&e.WarningLogLevel)===e.WarningLogLevel?e.Warn=e._WarnEnabled:e.Warn=e._WarnDisabled,(t&e.ErrorLogLevel)===e.ErrorLogLevel?e.Error=e._ErrorEnabled:e.Error=e._ErrorDisabled},enumerable:!1,configurable:!0}),e.NoneLogLevel=0,e.MessageLogLevel=1,e.WarningLogLevel=2,e.ErrorLogLevel=4,e.AllLogLevel=7,e.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",e._LogCache="",e._LogLimitOutputs={},e.errorsCount=0,e.Log=e._LogEnabled,e.Warn=e._WarnEnabled,e.Error=e._ErrorEnabled,e}(),ip=function(e,t){return!!e&&0===e.indexOf(t)},rp=function(e){return atob(e)},op=function(){function e(){this.children=[]}return e.prototype.isValid=function(e){return!0},e.prototype.process=function(e,t){var n="";if(this.line){var a=this.line,i=t.processor;i&&(i.lineProcessor&&(a=i.lineProcessor(a,t.isFragment,t.processingContext)),i.attributeProcessor&&ip(this.line,"attribute")?a=i.attributeProcessor(this.line,e,t.processingContext):i.varyingProcessor&&ip(this.line,"varying")?a=i.varyingProcessor(this.line,t.isFragment,e,t.processingContext):i.uniformProcessor&&i.uniformRegexp&&i.uniformRegexp.test(this.line)?t.lookForClosingBracketForUniformBuffer||(a=i.uniformProcessor(this.line,t.isFragment,e,t.processingContext)):i.uniformBufferProcessor&&i.uniformBufferRegexp&&i.uniformBufferRegexp.test(this.line)?t.lookForClosingBracketForUniformBuffer||(a=i.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0):i.textureProcessor&&i.textureRegexp&&i.textureRegexp.test(this.line)?a=i.textureProcessor(this.line,t.isFragment,e,t.processingContext):(i.uniformProcessor||i.uniformBufferProcessor)&&ip(this.line,"uniform")&&!t.lookForClosingBracketForUniformBuffer&&(/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?i.uniformProcessor&&(a=i.uniformProcessor(this.line,t.isFragment,e,t.processingContext)):i.uniformBufferProcessor&&(a=i.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0)),t.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(t.lookForClosingBracketForUniformBuffer=!1,i.endOfUniformBufferProcessor&&(a=i.endOfUniformBufferProcessor(this.line,t.isFragment,t.processingContext)))),n+=a+"\r\n"}return this.children.forEach(function(a){n+=a.process(e,t)}),this.additionalDefineKey&&(e[this.additionalDefineKey]=this.additionalDefineValue||"true"),n},e}(),sp=function(){function e(){}return Object.defineProperty(e.prototype,"currentLine",{get:function(){return this._lines[this.lineIndex]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canRead",{get:function(){return this.lineIndex<this._lines.length-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lines",{set:function(e){this._lines=[];for(var t=0,n=e;t<n.length;t++){var a=n[t];if("#"!==a[0])if(a.trim().startsWith("//"))this._lines.push(a);else for(var i=a.split(";"),r=0;r<i.length;r++){var o=i[r];(o=o.trim())&&this._lines.push(o+(r!==i.length-1?";":""))}else this._lines.push(a)}},enumerable:!1,configurable:!0}),e}(),cp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.process=function(e,t){for(var n=0;n<this.children.length;n++){var a=this.children[n];if(a.isValid(e))return a.process(e,t)}return""},t}(op),dp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.isValid=function(e){return this.testExpression.isTrue(e)},t}(op),lp=function(){function e(){}return e.prototype.isTrue=function(e){return!0},e.postfixToInfix=function(t){for(var n=[],a=0,i=t;a<i.length;a++){var r=i[a];if(void 0===e._OperatorPriority[r])n.push(r);else{var o=n[n.length-1],s=n[n.length-2];n.length-=2,n.push("(".concat(s).concat(r).concat(o,")"))}}return n[n.length-1]},e.infixToPostfix=function(t){for(var n=[],a=-1,i=function(){""!==(d=d.trim())&&(n.push(d),d="")},r=function(t){a<e._Stack.length-1&&(e._Stack[++a]=t)},o=function(){return e._Stack[a]},s=function(){return-1===a?"!!INVALID EXPRESSION!!":e._Stack[a--]},c=0,d="";c<t.length;){var l=t.charAt(c),u=c<t.length-1?t.substr(c,2):"";if("("===l)d="",r(l);else if(")"===l){for(i();-1!==a&&"("!==o();)n.push(s());s()}else if(e._OperatorPriority[u]>1){for(i();-1!==a&&e._OperatorPriority[o()]>=e._OperatorPriority[u];)n.push(s());r(u),c++}else d+=l;c++}for(i();-1!==a;)"("===o()?s():n.push(s());return n},e._OperatorPriority={")":0,"(":1,"||":2,"&&":3},e._Stack=["","","","","","","","","","","","","","","","","","","",""],e}(),up=function(e){function t(t,n){void 0===n&&(n=!1);var a=e.call(this)||this;return a.define=t,a.not=n,a}return Object(r.__extends)(t,e),t.prototype.isTrue=function(e){var t=void 0!==e[this.define];return this.not&&(t=!t),t},t}(lp),fp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.isTrue=function(e){return this.leftOperand.isTrue(e)||this.rightOperand.isTrue(e)},t}(lp),pp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.isTrue=function(e){return this.leftOperand.isTrue(e)&&this.rightOperand.isTrue(e)},t}(lp),mp=function(e){function t(t,n,a){var i=e.call(this)||this;return i.define=t,i.operand=n,i.testValue=a,i}return Object(r.__extends)(t,e),t.prototype.isTrue=function(e){var t=e[this.define];void 0===t&&(t=this.define);var n=!1,a=parseInt(t),i=parseInt(this.testValue);switch(this.operand){case">":n=a>i;break;case"<":n=a<i;break;case"<=":n=a<=i;break;case">=":n=a>=i;break;case"==":n=a===i}return n},t}(lp);function _p(e){return"".concat(e," needs to be imported before as it contains a side-effect required by your code.")}!function(e){e[e.GLSL=0]="GLSL",e[e.WGSL=1]="WGSL"}(tp||(tp={}));var hp=/defined\s*?\((.+?)\)/g,bp=/defined\s*?\[(.+?)\]/g,gp=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,vp=function(){function e(){}return e.Initialize=function(e){e.processor&&e.processor.initializeShaders&&e.processor.initializeShaders(e.processingContext)},e.Process=function(e,t,n,a){var i,r=this;(null===(i=t.processor)||void 0===i?void 0:i.preProcessShaderCode)&&(e=t.processor.preProcessShaderCode(e,t.isFragment)),this._ProcessIncludes(e,t,function(e){t.processCodeAfterIncludes&&(e=t.processCodeAfterIncludes(t.isFragment?"fragment":"vertex",e));var i=r._ProcessShaderConversion(e,t,a);n(i)})},e.PreProcess=function(e,t,n,a){var i,r=this;(null===(i=t.processor)||void 0===i?void 0:i.preProcessShaderCode)&&(e=t.processor.preProcessShaderCode(e,t.isFragment)),this._ProcessIncludes(e,t,function(e){t.processCodeAfterIncludes&&(e=t.processCodeAfterIncludes(t.isFragment?"fragment":"vertex",e));var i=r._ApplyPreProcessing(e,t,a);n(i)})},e.Finalize=function(e,t,n){return n.processor&&n.processor.finalizeShaders?n.processor.finalizeShaders(e,t,n.processingContext):{vertexCode:e,fragmentCode:t}},e._ProcessPrecision=function(e,t){var n;if(null===(n=t.processor)||void 0===n?void 0:n.noPrecision)return e;var a=t.shouldUseHighPrecisionShader;return-1===e.indexOf("precision highp float")?e=a?"precision highp float;\n"+e:"precision mediump float;\n"+e:a||(e=e.replace("precision highp float","precision mediump float")),e},e._ExtractOperation=function(e){var t=/defined\((.+)\)/.exec(e);if(t&&t.length)return new up(t[1].trim(),"!"===e[0]);for(var n="",a=0,i=0,r=["==",">=","<=","<",">"];i<r.length&&(n=r[i],!((a=e.indexOf(n))>-1));i++);if(-1===a)return new up(e);var o=e.substring(0,a).trim(),s=e.substring(a+n.length).trim();return new mp(o,n,s)},e._BuildSubExpression=function(e){e=e.replace(hp,"defined[$1]");for(var t=[],n=0,a=lp.infixToPostfix(e);n<a.length;n++){var i=a[n];if("||"!==i&&"&&"!==i)t.push(i);else if(t.length>=2){var r=t[t.length-1],o=t[t.length-2];t.length-=2;var s="&&"==i?new pp:new fp;"string"==typeof r&&(r=r.replace(bp,"defined($1)")),"string"==typeof o&&(o=o.replace(bp,"defined($1)")),s.leftOperand="string"==typeof o?this._ExtractOperation(o):o,s.rightOperand="string"==typeof r?this._ExtractOperation(r):r,t.push(s)}}var c=t[t.length-1];return"string"==typeof c&&(c=c.replace(bp,"defined($1)")),"string"==typeof c?this._ExtractOperation(c):c},e._BuildExpression=function(e,t){var n=new dp,a=e.substring(0,t),i=e.substring(t);return i=i.substring(0,(i.indexOf("//")+1||i.length+1)-1).trim(),n.testExpression="#ifdef"===a?new up(i):"#ifndef"===a?new up(i,!0):this._BuildSubExpression(i),n},e._MoveCursorWithinIf=function(e,t,n){for(var a=e.currentLine;this._MoveCursor(e,n);){var i=(a=e.currentLine).substring(0,5).toLowerCase();if("#else"===i){var r=new op;return t.children.push(r),void this._MoveCursor(e,r)}if("#elif"===i){var o=this._BuildExpression(a,5);t.children.push(o),n=o}}},e._MoveCursor=function(e,t){for(;e.canRead;){e.lineIndex++;var n=e.currentLine,a=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/.exec(n);if(a&&a.length)switch(a[0]){case"#ifdef":var i=new cp;t.children.push(i);var r=this._BuildExpression(n,6);i.children.push(r),this._MoveCursorWithinIf(e,i,r);break;case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":i=new cp,t.children.push(i),r=this._BuildExpression(n,7),i.children.push(r),this._MoveCursorWithinIf(e,i,r);break;case"#if":i=new cp,r=this._BuildExpression(n,3),t.children.push(i),i.children.push(r),this._MoveCursorWithinIf(e,i,r)}else{var o=new op;if(o.line=n,t.children.push(o),"#"===n[0]&&"d"===n[1]){var s=n.replace(";","").split(" ");o.additionalDefineKey=s[1],3===s.length&&(o.additionalDefineValue=s[2])}}}return!1},e._EvaluatePreProcessors=function(e,t,n){var a=new op,i=new sp;return i.lineIndex=-1,i.lines=e.split("\n"),this._MoveCursor(i,a),a.process(t,n)},e._PreparePreProcessors=function(e,t){for(var n,a={},i=0,r=e.defines;i<r.length;i++){var o=r[i].replace("#define","").replace(";","").trim().split(" ");a[o[0]]=o.length>1?o[1]:""}return(null===(n=e.processor)||void 0===n?void 0:n.shaderLanguage)===tp.GLSL&&(a.GL_ES="true"),a.__VERSION__=e.version,a[e.platformName]="true",t._getGlobalDefines(a),a},e._ProcessShaderConversion=function(e,t,n){var a=this._ProcessPrecision(e,t);if(!t.processor)return a;if(t.processor.shaderLanguage===tp.GLSL&&-1!==a.indexOf("#version 3"))return a.replace("#version 300 es","");var i=t.defines,r=this._PreparePreProcessors(t,n);return t.processor.preProcessor&&(a=t.processor.preProcessor(a,i,t.isFragment,t.processingContext)),a=this._EvaluatePreProcessors(a,r,t),t.processor.postProcessor&&(a=t.processor.postProcessor(a,i,t.isFragment,t.processingContext,n)),n._features.needShaderCodeInlining&&(a=n.inlineShaderCode(a)),a},e._ApplyPreProcessing=function(e,t,n){var a,i,r=e,o=t.defines,s=this._PreparePreProcessors(t,n);return(null===(a=t.processor)||void 0===a?void 0:a.preProcessor)&&(r=t.processor.preProcessor(r,o,t.isFragment,t.processingContext)),r=this._EvaluatePreProcessors(r,s,t),(null===(i=t.processor)||void 0===i?void 0:i.postProcessor)&&(r=t.processor.postProcessor(r,o,t.isFragment,t.processingContext,n)),n._features.needShaderCodeInlining&&(r=n.inlineShaderCode(r)),r},e._ProcessIncludes=function(t,n,a){for(var i=this,r=gp.exec(t),o=new String(t),s=!1,c=function(){var c=r[1];if(-1!==c.indexOf("__decl__")&&(c=c.replace(/__decl__/,""),n.supportsUniformBuffers&&(c=(c=c.replace(/Vertex/,"Ubo")).replace(/Fragment/,"Ubo")),c+="Declaration"),!n.includesShadersStore[c]){var d=n.shadersRepository+"ShadersInclude/"+c+".fx";return e._FileToolsLoadFile(d,function(e){n.includesShadersStore[c]=e,i._ProcessIncludes(o,n,a)}),{value:void 0}}var l=n.includesShadersStore[c];if(r[2])for(var u=r[3].split(","),f=0;f<u.length;f+=2){var p=new RegExp(u[f],"g"),m=u[f+1];l=l.replace(p,m)}if(r[4]){var _=r[5];if(-1!==_.indexOf("..")){var h=_.split(".."),b=parseInt(h[0]),g=parseInt(h[1]),v=l.slice(0);l="",isNaN(g)&&(g=n.indexParameters[h[1]]);for(var y=b;y<g;y++)n.supportsUniformBuffers||(v=v.replace(/light\{X\}.(\w*)/g,function(e,t){return t+"{X}"})),l+=v.replace(/\{X\}/g,y.toString())+"\n"}else n.supportsUniformBuffers||(l=l.replace(/light\{X\}.(\w*)/g,function(e,t){return t+"{X}"})),l=l.replace(/\{X\}/g,_)}o=o.replace(r[0],l),s=s||l.indexOf("#include<")>=0||l.indexOf("#include <")>=0,r=gp.exec(t)};null!=r;){var d=c();if("object"==typeof d)return d.value}s?this._ProcessIncludes(o.toString(),n,a):a(o)},e._FileToolsLoadFile=function(e,t,n,a,i,r){throw _p("FileTools")},e}(),yp=function(){function e(){}return e.GetShadersRepository=function(t){return void 0===t&&(t=tp.GLSL),t===tp.GLSL?e.ShadersRepository:e.ShadersRepositoryWGSL},e.GetShadersStore=function(t){return void 0===t&&(t=tp.GLSL),t===tp.GLSL?e.ShadersStore:e.ShadersStoreWGSL},e.GetIncludesShadersStore=function(t){return void 0===t&&(t=tp.GLSL),t===tp.GLSL?e.IncludesShadersStore:e.IncludesShadersStoreWGSL},e.ShadersRepository="src/Shaders/",e.ShadersStore={},e.IncludesShadersStore={},e.ShadersRepositoryWGSL="src/ShadersWGSL/",e.ShadersStoreWGSL={},e.IncludesShadersStoreWGSL={},e}(),Sp=function(){function e(t,n,a,i,r,o,s,c,d,l,u,f){void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),void 0===c&&(c=null),void 0===d&&(d=null),void 0===u&&(u=""),void 0===f&&(f=tp.GLSL);var p,m,_,h=this;this.name=null,this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new Jf,this.onErrorObservable=new Jf,this._onBindObservable=null,this._wasPreviouslyReady=!1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this.name=t,this._key=u;var b,g,v=void 0,y=null;if(n.attributes){var S=n;if(this._engine=a,this._attributesNames=S.attributes,this._uniformsNames=S.uniformsNames.concat(S.samplers),this._samplerList=S.samplers.slice(),this.defines=S.defines,this.onError=S.onError,this.onCompiled=S.onCompiled,this._fallbacks=S.fallbacks,this._indexParameters=S.indexParameters,this._transformFeedbackVaryings=S.transformFeedbackVaryings||null,this._multiTarget=!!S.multiTarget,this._shaderLanguage=null!==(p=S.shaderLanguage)&&void 0!==p?p:tp.GLSL,S.uniformBuffersNames){this._uniformBuffersNamesList=S.uniformBuffersNames.slice();for(var D=0;D<S.uniformBuffersNames.length;D++)this._uniformBuffersNames[S.uniformBuffersNames[D]]=D}y=null!==(m=S.processFinalCode)&&void 0!==m?m:null,v=null!==(_=S.processCodeAfterIncludes)&&void 0!==_?_:void 0}else this._engine=r,this.defines=null==o?"":o,this._uniformsNames=a.concat(i),this._samplerList=i?i.slice():[],this._attributesNames=n,this._uniformBuffersNamesList=[],this._shaderLanguage=f,this.onError=d,this.onCompiled=c,this._indexParameters=l,this._fallbacks=s;this._attributeLocationByName={},this.uniqueId=e._UniqueIdSeed++;var I=Xf()?this._engine.getHostDocument():null;t.vertexSource?b="source:"+t.vertexSource:t.vertexElement?(b=I?I.getElementById(t.vertexElement):null)||(b=t.vertexElement):b=t.vertex||t,t.fragmentSource?g="source:"+t.fragmentSource:t.fragmentElement?(g=I?I.getElementById(t.fragmentElement):null)||(g=t.fragmentElement):g=t.fragment||t,this._processingContext=this._engine._getShaderProcessingContext(this._shaderLanguage);var x={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:yp.GetShadersRepository(this._shaderLanguage),includesShadersStore:yp.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:v},C=[void 0,void 0],O=function(){if(C[0]&&C[1]){x.isFragment=!0;var e=C[0],n=C[1];vp.Process(n,x,function(n){y&&(n=y("fragment",n));var a=vp.Finalize(e,n,x);h._useFinalCode(a.vertexCode,a.fragmentCode,t)},h._engine)}};this._loadShader(b,"Vertex","",function(e){vp.Initialize(x),vp.Process(e,x,function(t){h._rawVertexSourceCode=e,y&&(t=y("vertex",t)),C[0]=t,O()},h._engine)}),this._loadShader(g,"Fragment","Pixel",function(e){h._rawFragmentSourceCode=e,C[1]=e,O()})}return Object.defineProperty(e,"ShadersRepository",{get:function(){return yp.ShadersRepository},set:function(e){yp.ShadersRepository=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onBindObservable",{get:function(){return this._onBindObservable||(this._onBindObservable=new Jf),this._onBindObservable},enumerable:!1,configurable:!0}),e.prototype._useFinalCode=function(e,t,n){if(n){var a=n.vertexElement||n.vertex||n.spectorName||n,i=n.fragmentElement||n.fragment||n.spectorName||n;this._vertexSourceCode=(this._shaderLanguage===tp.WGSL?"//":"")+"#define SHADER_NAME vertex:"+a+"\n"+e,this._fragmentSourceCode=(this._shaderLanguage===tp.WGSL?"//":"")+"#define SHADER_NAME fragment:"+i+"\n"+t}else this._vertexSourceCode=e,this._fragmentSourceCode=t;this._prepareEffect()},Object.defineProperty(e.prototype,"key",{get:function(){return this._key},enumerable:!1,configurable:!0}),e.prototype.isReady=function(){try{return this._isReadyInternal()}catch(e){return!1}},e.prototype._isReadyInternal=function(){return!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady},e.prototype.getEngine=function(){return this._engine},e.prototype.getPipelineContext=function(){return this._pipelineContext},e.prototype.getAttributesNames=function(){return this._attributesNames},e.prototype.getAttributeLocation=function(e){return this._attributes[e]},e.prototype.getAttributeLocationByName=function(e){return this._attributeLocationByName[e]},e.prototype.getAttributesCount=function(){return this._attributes.length},e.prototype.getUniformIndex=function(e){return this._uniformsNames.indexOf(e)},e.prototype.getUniform=function(e){return this._uniforms[e]},e.prototype.getSamplers=function(){return this._samplerList},e.prototype.getUniformNames=function(){return this._uniformsNames},e.prototype.getUniformBuffersNames=function(){return this._uniformBuffersNamesList},e.prototype.getIndexParameters=function(){return this._indexParameters},e.prototype.getCompilationError=function(){return this._compilationError},e.prototype.allFallbacksProcessed=function(){return this._allFallbacksProcessed},e.prototype.executeWhenCompiled=function(e){var t=this;this.isReady()?e(this):(this.onCompileObservable.add(function(t){e(t)}),this._pipelineContext&&!this._pipelineContext.isAsync||setTimeout(function(){t._checkIsReady(null)},16))},e.prototype._checkIsReady=function(e){var t=this;try{if(this._isReadyInternal())return}catch(t){return void this._processCompilationErrors(t,e)}setTimeout(function(){t._checkIsReady(e)},16)},e.prototype._loadShader=function(e,t,n,a){if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)a(ep(e));else if("source:"!==e.substr(0,7))if("base64:"!==e.substr(0,7)){var i,r=yp.GetShadersStore(this._shaderLanguage);r[e+t+"Shader"]?a(r[e+t+"Shader"]):n&&r[e+n+"Shader"]?a(r[e+n+"Shader"]):(i="."===e[0]||"/"===e[0]||e.indexOf("http")>-1?e:yp.GetShadersRepository(this._shaderLanguage)+e,this._engine._loadFile(i+"."+t.toLowerCase()+".fx",a))}else a(window.atob(e.substr(7)));else a(e.substr(7))},Object.defineProperty(e.prototype,"vertexSourceCode",{get:function(){var e,t;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:null!==(t=null===(e=this._pipelineContext)||void 0===e?void 0:e._getVertexShaderCode())&&void 0!==t?t:this._vertexSourceCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragmentSourceCode",{get:function(){var e,t;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:null!==(t=null===(e=this._pipelineContext)||void 0===e?void 0:e._getFragmentShaderCode())&&void 0!==t?t:this._fragmentSourceCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rawVertexSourceCode",{get:function(){return this._rawVertexSourceCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rawFragmentSourceCode",{get:function(){return this._rawFragmentSourceCode},enumerable:!1,configurable:!0}),e.prototype._rebuildProgram=function(e,t,n,a){var i=this;this._isReady=!1,this._vertexSourceCodeOverride=e,this._fragmentSourceCodeOverride=t,this.onError=function(e,t){a&&a(t)},this.onCompiled=function(){var e=i.getEngine().scenes;if(e)for(var t=0;t<e.length;t++)e[t].markAllMaterialsAsDirty(63);i._pipelineContext._handlesSpectorRebuildCallback(n)},this._fallbacks=null,this._prepareEffect()},e.prototype._prepareEffect=function(){var e=this,t=this._attributesNames,n=this.defines,a=this._pipelineContext;this._isReady=!1;try{var i=this._engine;this._pipelineContext=i.createPipelineContext(this._processingContext),this._pipelineContext._name=this._key;var r=this._rebuildProgram.bind(this);this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?i._preparePipelineContext(this._pipelineContext,this._vertexSourceCodeOverride,this._fragmentSourceCodeOverride,!0,this._rawVertexSourceCode,this._rawFragmentSourceCode,r,null,this._transformFeedbackVaryings,this._key):i._preparePipelineContext(this._pipelineContext,this._vertexSourceCode,this._fragmentSourceCode,!1,this._rawVertexSourceCode,this._rawFragmentSourceCode,r,n,this._transformFeedbackVaryings,this._key),i._executeWhenRenderingStateIsCompiled(this._pipelineContext,function(){if(e._attributes=[],e._pipelineContext._fillEffectInformation(e,e._uniformBuffersNames,e._uniformsNames,e._uniforms,e._samplerList,e._samplers,t,e._attributes),t)for(var n=0;n<t.length;n++){var r=t[n];e._attributeLocationByName[r]=e._attributes[n]}i.bindSamplers(e),e._compilationError="",e._isReady=!0,e.onCompiled&&e.onCompiled(e),e.onCompileObservable.notifyObservers(e),e.onCompileObservable.clear(),e._fallbacks&&e._fallbacks.unBindMesh(),a&&e.getEngine()._deletePipelineContext(a)}),this._pipelineContext.isAsync&&this._checkIsReady(a)}catch(e){this._processCompilationErrors(e,a)}},e.prototype._getShaderCodeAndErrorLine=function(e,t,n){var a=n?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/,i=null;if(t&&e){var r=t.match(a);if(r&&2===r.length){var o=parseInt(r[1]),s=e.split("\n",-1);s.length>=o&&(i="Offending line [".concat(o,"] in ").concat(n?"fragment":"vertex"," code: ").concat(s[o-1]))}}return[e,i]},e.prototype._processCompilationErrors=function(t,n){var a,i,r,o,s;void 0===n&&(n=null),this._compilationError=t.message;var c=this._attributesNames,d=this._fallbacks;if(ap.Error("Unable to compile effect:"),ap.Error("Uniforms: "+this._uniformsNames.map(function(e){return" "+e})),ap.Error("Attributes: "+c.map(function(e){return" "+e})),ap.Error("Defines:\r\n"+this.defines),e.LogShaderCodeOnCompilationError){var l=null,u=null,f=null;(null===(r=this._pipelineContext)||void 0===r?void 0:r._getVertexShaderCode())&&(f=(a=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1))[0],l=a[1],f&&(ap.Error("Vertex code:"),ap.Error(f))),(null===(o=this._pipelineContext)||void 0===o?void 0:o._getFragmentShaderCode())&&(f=(i=this._getShaderCodeAndErrorLine(null===(s=this._pipelineContext)||void 0===s?void 0:s._getFragmentShaderCode(),this._compilationError,!0))[0],u=i[1],f&&(ap.Error("Fragment code:"),ap.Error(f))),l&&ap.Error(l),u&&ap.Error(u)}ap.Error("Error: "+this._compilationError),n&&(this._pipelineContext=n,this._isReady=!0,this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this)),d?(this._pipelineContext=null,d.hasMoreFallbacks?(this._allFallbacksProcessed=!1,ap.Error("Trying next fallback."),this.defines=d.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):this._allFallbacksProcessed=!0},Object.defineProperty(e.prototype,"isSupported",{get:function(){return""===this._compilationError},enumerable:!1,configurable:!0}),e.prototype._bindTexture=function(e,t){this._engine._bindTexture(this._samplers[e],t,e)},e.prototype.setTexture=function(e,t){this._engine.setTexture(this._samplers[e],this._uniforms[e],t,e)},e.prototype.setDepthStencilTexture=function(e,t){this._engine.setDepthStencilTexture(this._samplers[e],this._uniforms[e],t,e)},e.prototype.setTextureArray=function(e,t){var n=e+"Ex";if(-1===this._samplerList.indexOf(n+"0")){for(var a=this._samplerList.indexOf(e),i=1;i<t.length;i++){var r=n+(i-1).toString();this._samplerList.splice(a+i,0,r)}for(var o=0,s=0,c=this._samplerList;s<c.length;s++){var d=c[s];this._samplers[d]=o,o+=1}}this._engine.setTextureArray(this._samplers[e],this._uniforms[e],t,e)},e.prototype.setTextureFromPostProcess=function(e,t){this._engine.setTextureFromPostProcess(this._samplers[e],t,e)},e.prototype.setTextureFromPostProcessOutput=function(e,t){this._engine.setTextureFromPostProcessOutput(this._samplers[e],t,e)},e.prototype.bindUniformBuffer=function(t,n){var a=this._uniformBuffersNames[n];void 0===a||e._BaseCache[a]===t&&this._engine._features.useUBOBindingCache||(e._BaseCache[a]=t,this._engine.bindUniformBufferBase(t,a,n))},e.prototype.bindUniformBlock=function(e,t){this._engine.bindUniformBlock(this._pipelineContext,e,t)},e.prototype.setInt=function(e,t){return this._pipelineContext.setInt(e,t),this},e.prototype.setInt2=function(e,t,n){return this._pipelineContext.setInt2(e,t,n),this},e.prototype.setInt3=function(e,t,n,a){return this._pipelineContext.setInt3(e,t,n,a),this},e.prototype.setInt4=function(e,t,n,a,i){return this._pipelineContext.setInt4(e,t,n,a,i),this},e.prototype.setIntArray=function(e,t){return this._pipelineContext.setIntArray(e,t),this},e.prototype.setIntArray2=function(e,t){return this._pipelineContext.setIntArray2(e,t),this},e.prototype.setIntArray3=function(e,t){return this._pipelineContext.setIntArray3(e,t),this},e.prototype.setIntArray4=function(e,t){return this._pipelineContext.setIntArray4(e,t),this},e.prototype.setFloatArray=function(e,t){return this._pipelineContext.setArray(e,t),this},e.prototype.setFloatArray2=function(e,t){return this._pipelineContext.setArray2(e,t),this},e.prototype.setFloatArray3=function(e,t){return this._pipelineContext.setArray3(e,t),this},e.prototype.setFloatArray4=function(e,t){return this._pipelineContext.setArray4(e,t),this},e.prototype.setArray=function(e,t){return this._pipelineContext.setArray(e,t),this},e.prototype.setArray2=function(e,t){return this._pipelineContext.setArray2(e,t),this},e.prototype.setArray3=function(e,t){return this._pipelineContext.setArray3(e,t),this},e.prototype.setArray4=function(e,t){return this._pipelineContext.setArray4(e,t),this},e.prototype.setMatrices=function(e,t){return this._pipelineContext.setMatrices(e,t),this},e.prototype.setMatrix=function(e,t){return this._pipelineContext.setMatrix(e,t),this},e.prototype.setMatrix3x3=function(e,t){return this._pipelineContext.setMatrix3x3(e,t),this},e.prototype.setMatrix2x2=function(e,t){return this._pipelineContext.setMatrix2x2(e,t),this},e.prototype.setFloat=function(e,t){return this._pipelineContext.setFloat(e,t),this},e.prototype.setBool=function(e,t){return this._pipelineContext.setInt(e,t?1:0),this},e.prototype.setVector2=function(e,t){return this._pipelineContext.setVector2(e,t),this},e.prototype.setFloat2=function(e,t,n){return this._pipelineContext.setFloat2(e,t,n),this},e.prototype.setVector3=function(e,t){return this._pipelineContext.setVector3(e,t),this},e.prototype.setFloat3=function(e,t,n,a){return this._pipelineContext.setFloat3(e,t,n,a),this},e.prototype.setVector4=function(e,t){return this._pipelineContext.setVector4(e,t),this},e.prototype.setFloat4=function(e,t,n,a,i){return this._pipelineContext.setFloat4(e,t,n,a,i),this},e.prototype.setColor3=function(e,t){return this._pipelineContext.setColor3(e,t),this},e.prototype.setColor4=function(e,t,n){return this._pipelineContext.setColor4(e,t,n),this},e.prototype.setDirectColor4=function(e,t){return this._pipelineContext.setDirectColor4(e,t),this},e.prototype.dispose=function(){this._pipelineContext&&this._pipelineContext.dispose(),this._engine._releaseEffect(this)},e.RegisterShader=function(e,t,n,a){void 0===a&&(a=tp.GLSL),t&&(yp.GetShadersStore(a)["".concat(e,"PixelShader")]=t),n&&(yp.GetShadersStore(a)["".concat(e,"VertexShader")]=n)},e.ResetCache=function(){e._BaseCache={}},e.LogShaderCodeOnCompilationError=!0,e._UniqueIdSeed=0,e._BaseCache={},e.ShadersStore=yp.ShadersStore,e.IncludesShadersStore=yp.IncludesShadersStore,e}(),Dp=function(){function e(e,t){void 0===t&&(t=!0),this.effect=null,this.defines=null,this.drawContext=e.createDrawContext(),t&&(this.materialContext=e.createMaterialContext())}return e.IsWrapper=function(e){return void 0===e.getPipelineContext},e.GetEffect=function(e){return void 0===e.getPipelineContext?e.effect:e},e.prototype.setEffect=function(e,t,n){var a;void 0===n&&(n=!0),this.effect=e,void 0!==t&&(this.defines=t),n&&(null===(a=this.drawContext)||void 0===a||a.reset())},e.prototype.dispose=function(){var e;null===(e=this.drawContext)||void 0===e||e.dispose()},e}();yp.ShadersStore.postprocessVertexShader="attribute vec2 position;\nuniform vec2 scale;\nvarying vec2 vUV;\nconst vec2 madd=vec2(0.5,0.5);\n#define CUSTOM_VERTEX_DEFINITIONS\nvoid main(void) {\n#define CUSTOM_VERTEX_MAIN_BEGIN\nvUV=(position*madd+madd)*scale;\ngl_Position=vec4(position,0.0,1.0);\n#define CUSTOM_VERTEX_MAIN_END\n}";var Ip,xp=function(){function e(t,n){var a;void 0===n&&(n=e._DefaultOptions);var i=this;this._engine=t,this._fullscreenViewport=new qf(0,0,1,1),n=Object(r.__assign)(Object(r.__assign)({},e._DefaultOptions),n),this._vertexBuffers=((a={})[Wf.PositionKind]=new Wf(t,n.positions,Wf.PositionKind,!1,!1,2),a),this._indexBuffer=t.createIndexBuffer(n.indices),this._onContextRestoredObserver=t.onContextRestoredObservable.add(function(){for(var e in i._indexBuffer=t.createIndexBuffer(n.indices),i._vertexBuffers)i._vertexBuffers[e]._rebuild()})}return e.prototype.setViewport=function(e){void 0===e&&(e=this._fullscreenViewport),this._engine.setViewport(e)},e.prototype.bindBuffers=function(e){this._engine.bindBuffers(this._vertexBuffers,this._indexBuffer,e)},e.prototype.applyEffectWrapper=function(e){this._engine.depthCullingState.depthTest=!1,this._engine.stencilState.stencilTest=!1,this._engine.enableEffect(e._drawWrapper),this.bindBuffers(e.effect),e.onApplyObservable.notifyObservers({})},e.prototype.restoreStates=function(){this._engine.depthCullingState.depthTest=!0,this._engine.stencilState.stencilTest=!0},e.prototype.draw=function(){this._engine.drawElementsType(0,0,6)},e.prototype._isRenderTargetTexture=function(e){return void 0!==e.renderTarget},e.prototype.render=function(e,t){if(void 0===t&&(t=null),e.effect.isReady()){this.setViewport();var n=null===t?null:this._isRenderTargetTexture(t)?t.renderTarget:t;n&&this._engine.bindFramebuffer(n),this.applyEffectWrapper(e),this.draw(),n&&this._engine.unBindFramebuffer(n),this.restoreStates()}},e.prototype.dispose=function(){var e=this._vertexBuffers[Wf.PositionKind];e&&(e.dispose(),delete this._vertexBuffers[Wf.PositionKind]),this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._onContextRestoredObserver&&(this._engine.onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null)},e._DefaultOptions={positions:[1,1,-1,1,-1,-1,1,-1],indices:[0,1,2,0,2,3]},e}(),Cp=function(){function e(e){var t,n=this;this.onApplyObservable=new Jf;var a=e.uniformNames||[];e.vertexShader?t={fragmentSource:e.fragmentShader,vertexSource:e.vertexShader,spectorName:e.name||"effectWrapper"}:(a.push("scale"),t={fragmentSource:e.fragmentShader,vertex:"postprocess",spectorName:e.name||"effectWrapper"},this.onApplyObservable.add(function(){n.effect.setFloat2("scale",1,1)}));var i=e.defines?e.defines.join("\n"):"";this._drawWrapper=new Dp(e.engine),e.useShaderStore?(t.fragment=t.fragmentSource,t.vertex||(t.vertex=t.vertexSource),delete t.fragmentSource,delete t.vertexSource,this.effect=e.engine.createEffect(t,e.attributeNames||["position"],a,e.samplerNames,i,void 0,e.onCompiled,void 0,void 0,e.shaderLanguage)):(this.effect=new Sp(t,e.attributeNames||["position"],a,e.samplerNames,e.engine,i,void 0,e.onCompiled,void 0,void 0,void 0,e.shaderLanguage),this._onContextRestoredObserver=e.engine.onContextRestoredObservable.add(function(){n.effect._pipelineContext=null,n.effect._wasPreviouslyReady=!1,n.effect._prepareEffect()}))}return Object.defineProperty(e.prototype,"effect",{get:function(){return this._drawWrapper.effect},set:function(e){this._drawWrapper.effect=e},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._onContextRestoredObserver&&(this.effect.getEngine().onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null),this.effect.dispose()},e}(),Op=function(){function e(){}return Object.defineProperty(e,"LastCreatedEngine",{get:function(){return 0===this.Instances.length?null:this.Instances[this.Instances.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastCreatedScene",{get:function(){return this._LastCreatedScene},enumerable:!1,configurable:!0}),e.Instances=new Array,e._LastCreatedScene=null,e.UseFallbackTexture=!0,e.FallbackTexture="",e}(),wp=function(){function e(e){void 0===e&&(e=!0),this._isDepthTestDirty=!1,this._isDepthMaskDirty=!1,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1,this._isFrontFaceDirty=!1,e&&this.reset()}return Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty||this._isFrontFaceDirty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zOffset",{get:function(){return this._zOffset},set:function(e){this._zOffset!==e&&(this._zOffset=e,this._isZOffsetDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zOffsetUnits",{get:function(){return this._zOffsetUnits},set:function(e){this._zOffsetUnits!==e&&(this._zOffsetUnits=e,this._isZOffsetDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cullFace",{get:function(){return this._cullFace},set:function(e){this._cullFace!==e&&(this._cullFace=e,this._isCullFaceDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cull",{get:function(){return this._cull},set:function(e){this._cull!==e&&(this._cull=e,this._isCullDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthFunc",{get:function(){return this._depthFunc},set:function(e){this._depthFunc!==e&&(this._depthFunc=e,this._isDepthFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthMask",{get:function(){return this._depthMask},set:function(e){this._depthMask!==e&&(this._depthMask=e,this._isDepthMaskDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthTest",{get:function(){return this._depthTest},set:function(e){this._depthTest!==e&&(this._depthTest=e,this._isDepthTestDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frontFace",{get:function(){return this._frontFace},set:function(e){this._frontFace!==e&&(this._frontFace=e,this._isFrontFaceDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this._depthMask=!0,this._depthTest=!0,this._depthFunc=null,this._cullFace=null,this._cull=null,this._zOffset=0,this._zOffsetUnits=0,this._frontFace=null,this._isDepthTestDirty=!0,this._isDepthMaskDirty=!0,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!0,this._isFrontFaceDirty=!1},e.prototype.apply=function(e){this.isDirty&&(this._isCullDirty&&(this.cull?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(e.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(e.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this._isDepthTestDirty=!1),this._isDepthFuncDirty&&(e.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset||this.zOffsetUnits?(e.enable(e.POLYGON_OFFSET_FILL),e.polygonOffset(this.zOffset,this.zOffsetUnits)):e.disable(e.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1),this._isFrontFaceDirty&&(e.frontFace(this.frontFace),this._isFrontFaceDirty=!1))},e}(),Ep=function(){function e(){this.reset()}return e.prototype.reset=function(){this.enabled=!1,this.mask=255,this.func=e.ALWAYS,this.funcRef=1,this.funcMask=255,this.opStencilFail=e.KEEP,this.opDepthFail=e.KEEP,this.opStencilDepthPass=e.REPLACE},Object.defineProperty(e.prototype,"stencilFunc",{get:function(){return this.func},set:function(e){this.func=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilFuncRef",{get:function(){return this.funcRef},set:function(e){this.funcRef=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilFuncMask",{get:function(){return this.funcMask},set:function(e){this.funcMask=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilOpStencilFail",{get:function(){return this.opStencilFail},set:function(e){this.opStencilFail=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilOpDepthFail",{get:function(){return this.opDepthFail},set:function(e){this.opDepthFail=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilOpStencilDepthPass",{get:function(){return this.opStencilDepthPass},set:function(e){this.opStencilDepthPass=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilMask",{get:function(){return this.mask},set:function(e){this.mask=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilTest",{get:function(){return this.enabled},set:function(e){this.enabled=e},enumerable:!1,configurable:!0}),e.ALWAYS=519,e.KEEP=7680,e.REPLACE=7681,e}(),Ap=function(){function e(){this._blendFunctionParameters=new Array(4),this._blendEquationParameters=new Array(2),this._blendConstants=new Array(4),this._isBlendConstantsDirty=!1,this._alphaBlend=!1,this._isAlphaBlendDirty=!1,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this.reset()}return Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty||this._isBlendEquationParametersDirty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alphaBlend",{get:function(){return this._alphaBlend},set:function(e){this._alphaBlend!==e&&(this._alphaBlend=e,this._isAlphaBlendDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.setAlphaBlendConstants=function(e,t,n,a){this._blendConstants[0]===e&&this._blendConstants[1]===t&&this._blendConstants[2]===n&&this._blendConstants[3]===a||(this._blendConstants[0]=e,this._blendConstants[1]=t,this._blendConstants[2]=n,this._blendConstants[3]=a,this._isBlendConstantsDirty=!0)},e.prototype.setAlphaBlendFunctionParameters=function(e,t,n,a){this._blendFunctionParameters[0]===e&&this._blendFunctionParameters[1]===t&&this._blendFunctionParameters[2]===n&&this._blendFunctionParameters[3]===a||(this._blendFunctionParameters[0]=e,this._blendFunctionParameters[1]=t,this._blendFunctionParameters[2]=n,this._blendFunctionParameters[3]=a,this._isBlendFunctionParametersDirty=!0)},e.prototype.setAlphaEquationParameters=function(e,t){this._blendEquationParameters[0]===e&&this._blendEquationParameters[1]===t||(this._blendEquationParameters[0]=e,this._blendEquationParameters[1]=t,this._isBlendEquationParametersDirty=!0)},e.prototype.reset=function(){this._alphaBlend=!1,this._blendFunctionParameters[0]=null,this._blendFunctionParameters[1]=null,this._blendFunctionParameters[2]=null,this._blendFunctionParameters[3]=null,this._blendEquationParameters[0]=null,this._blendEquationParameters[1]=null,this._blendConstants[0]=null,this._blendConstants[1]=null,this._blendConstants[2]=null,this._blendConstants[3]=null,this._isAlphaBlendDirty=!0,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this._isBlendConstantsDirty=!1},e.prototype.apply=function(e){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?e.enable(e.BLEND):e.disable(e.BLEND),this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(e.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),this._isBlendFunctionParametersDirty=!1),this._isBlendEquationParametersDirty&&(e.blendEquationSeparate(this._blendEquationParameters[0],this._blendEquationParameters[1]),this._isBlendEquationParametersDirty=!1),this._isBlendConstantsDirty&&(e.blendColor(this._blendConstants[0],this._blendConstants[1],this._blendConstants[2],this._blendConstants[3]),this._isBlendConstantsDirty=!1))},e}(),Lp=function(){function e(){this.samplingMode=-1,this._useMipMaps=!0,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this._comparisonFunction=0}return Object.defineProperty(e.prototype,"wrapU",{get:function(){return this._cachedWrapU},set:function(e){this._cachedWrapU=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wrapV",{get:function(){return this._cachedWrapV},set:function(e){this._cachedWrapV=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wrapR",{get:function(){return this._cachedWrapR},set:function(e){this._cachedWrapR=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anisotropicFilteringLevel",{get:function(){return this._cachedAnisotropicFilteringLevel},set:function(e){this._cachedAnisotropicFilteringLevel=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"comparisonFunction",{get:function(){return this._comparisonFunction},set:function(e){this._comparisonFunction=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"useMipMaps",{get:function(){return this._useMipMaps},set:function(e){this._useMipMaps=e},enumerable:!1,configurable:!0}),e.prototype.setParameters=function(e,t,n,a,i,r){return void 0===e&&(e=1),void 0===t&&(t=1),void 0===n&&(n=1),void 0===a&&(a=1),void 0===i&&(i=2),void 0===r&&(r=0),this._cachedWrapU=e,this._cachedWrapV=t,this._cachedWrapR=n,this._cachedAnisotropicFilteringLevel=a,this.samplingMode=i,this._comparisonFunction=r,this},e.prototype.compareSampler=function(e){return this._cachedWrapU===e._cachedWrapU&&this._cachedWrapV===e._cachedWrapV&&this._cachedWrapR===e._cachedWrapR&&this._cachedAnisotropicFilteringLevel===e._cachedAnisotropicFilteringLevel&&this.samplingMode===e.samplingMode&&this._comparisonFunction===e._comparisonFunction&&this._useMipMaps===e._useMipMaps},e}();!function(e){e[e.Unknown=0]="Unknown",e[e.Url=1]="Url",e[e.Temp=2]="Temp",e[e.Raw=3]="Raw",e[e.Dynamic=4]="Dynamic",e[e.RenderTarget=5]="RenderTarget",e[e.MultiRenderTarget=6]="MultiRenderTarget",e[e.Cube=7]="Cube",e[e.CubeRaw=8]="CubeRaw",e[e.CubePrefiltered=9]="CubePrefiltered",e[e.Raw3D=10]="Raw3D",e[e.Raw2DArray=11]="Raw2DArray",e[e.DepthStencil=12]="DepthStencil",e[e.CubeRawRGBD=13]="CubeRawRGBD",e[e.Depth=14]="Depth"}(Ip||(Ip={}));var kp=function(e){function t(n,a,i){void 0===i&&(i=!1);var r=e.call(this)||this;return r.isReady=!1,r.isCube=!1,r.is3D=!1,r.is2DArray=!1,r.isMultiview=!1,r.url="",r.generateMipMaps=!1,r.samples=0,r.type=-1,r.format=-1,r.onLoadedObservable=new Jf,r.onErrorObservable=new Jf,r.onRebuildCallback=null,r.width=0,r.height=0,r.depth=0,r.baseWidth=0,r.baseHeight=0,r.baseDepth=0,r.invertY=!1,r._invertVScale=!1,r._associatedChannel=-1,r._source=Ip.Unknown,r._buffer=null,r._bufferView=null,r._bufferViewArray=null,r._bufferViewArrayArray=null,r._size=0,r._extension="",r._files=null,r._workingCanvas=null,r._workingContext=null,r._cachedCoordinatesMode=null,r._isDisabled=!1,r._compression=null,r._sphericalPolynomial=null,r._sphericalPolynomialPromise=null,r._sphericalPolynomialComputed=!1,r._lodGenerationScale=0,r._lodGenerationOffset=0,r._useSRGBBuffer=!1,r._lodTextureHigh=null,r._lodTextureMid=null,r._lodTextureLow=null,r._isRGBD=!1,r._linearSpecularLOD=!1,r._irradianceTexture=null,r._hardwareTexture=null,r._maxLodLevel=null,r._references=1,r._gammaSpace=null,r._engine=n,r._source=a,r._uniqueId=t._Counter++,i||(r._hardwareTexture=n._createHardwareTexture()),r}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"useMipMaps",{get:function(){return this.generateMipMaps},set:function(e){this.generateMipMaps=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uniqueId",{get:function(){return this._uniqueId},enumerable:!1,configurable:!0}),t.prototype.getEngine=function(){return this._engine},Object.defineProperty(t.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),t.prototype.incrementReferences=function(){this._references++},t.prototype.updateSize=function(e,t,n){void 0===n&&(n=1),this._engine.updateTextureDimensions(this,e,t,n),this.width=e,this.height=t,this.depth=n,this.baseWidth=e,this.baseHeight=t,this.baseDepth=n,this._size=e*t*n},t.prototype._rebuild=function(){var e,t=this;if(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this.onRebuildCallback){var n=this.onRebuildCallback(this),a=function(e){e._swapAndDie(t,!1),t.isReady=n.isReady};n.isAsync?n.proxy.then(a):a(n.proxy)}else{var i;switch(this.source){case Ip.Temp:break;case Ip.Url:return void(i=this._engine.createTexture(null!==(e=this._originalUrl)&&void 0!==e?e:this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,function(){i._swapAndDie(t,!1),t.isReady=!0},null,this._buffer,void 0,this.format,this._extension,void 0,void 0,void 0,this._useSRGBBuffer));case Ip.Raw:(i=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type))._swapAndDie(this,!1),this.isReady=!0;break;case Ip.Raw3D:(i=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type))._swapAndDie(this,!1),this.isReady=!0;break;case Ip.Raw2DArray:(i=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type))._swapAndDie(this,!1),this.isReady=!0;break;case Ip.Dynamic:(i=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode))._swapAndDie(this,!1),this._engine.updateDynamicTexture(this,this._engine.getRenderingCanvas(),this.invertY,void 0,void 0,!0);break;case Ip.Cube:return void(i=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,function(){i._swapAndDie(t,!1),t.isReady=!0},null,this.format,this._extension,!1,0,0,null,void 0,this._useSRGBBuffer));case Ip.CubeRaw:(i=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this,!1),this.isReady=!0;break;case Ip.CubeRawRGBD:return;case Ip.CubePrefiltered:return void((i=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,function(e){e&&e._swapAndDie(t,!1),t.isReady=!0},null,this.format,this._extension))._sphericalPolynomial=this._sphericalPolynomial)}}},t.prototype._swapAndDie=function(e,t){var n;void 0===t&&(t=!0),null===(n=this._hardwareTexture)||void 0===n||n.setUsage(e._source,this.generateMipMaps,this.isCube,this.width,this.height),e._hardwareTexture=this._hardwareTexture,t&&(e._isRGBD=this._isRGBD),this._lodTextureHigh&&(e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureHigh=this._lodTextureHigh),this._lodTextureMid&&(e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureMid=this._lodTextureMid),this._lodTextureLow&&(e._lodTextureLow&&e._lodTextureLow.dispose(),e._lodTextureLow=this._lodTextureLow),this._irradianceTexture&&(e._irradianceTexture&&e._irradianceTexture.dispose(),e._irradianceTexture=this._irradianceTexture);var a=this._engine.getLoadedTexturesCache(),i=a.indexOf(this);-1!==i&&a.splice(i,1),-1===(i=a.indexOf(e))&&a.push(e)},t.prototype.dispose=function(){this._references--,this.onLoadedObservable.clear(),this.onErrorObservable.clear(),0===this._references&&(this._engine._releaseTexture(this),this._hardwareTexture=null)},t._Counter=0,t}(Lp),Mp=function(){function e(){this.shaderLanguage=tp.GLSL}return e.prototype.postProcessor=function(e,t,n,a,i){return i.getCaps().drawBuffersExtension||(e=e.replace(/#extension.+GL_EXT_draw_buffers.+(enable|require)/g,"")),e},e}(),Pp=function(){function e(){this.shaderLanguage=tp.GLSL}return e.prototype.attributeProcessor=function(e){return e.replace("attribute","in")},e.prototype.varyingProcessor=function(e,t){return e.replace("varying",t?"in":"out")},e.prototype.postProcessor=function(e,t,n){var a=-1!==e.search(/#extension.+GL_EXT_draw_buffers.+require/);if(e=(e=e.replace(/#extension.+(GL_OVR_multiview2|GL_OES_standard_derivatives|GL_EXT_shader_texture_lod|GL_EXT_frag_depth|GL_EXT_draw_buffers).+(enable|require)/g,"")).replace(/texture2D\s*\(/g,"texture("),n)e=(e=(e=(e=(e=(e=(e=e.replace(/texture2DLodEXT\s*\(/g,"textureLod(")).replace(/textureCubeLodEXT\s*\(/g,"textureLod(")).replace(/textureCube\s*\(/g,"texture(")).replace(/gl_FragDepthEXT/g,"gl_FragDepth")).replace(/gl_FragColor/g,"glFragColor")).replace(/gl_FragData/g,"glFragData")).replace(/void\s+?main\s*\(/g,(a?"":"out vec4 glFragColor;\n")+"void main(");else if(-1!==t.indexOf("#define MULTIVIEW"))return"#extension GL_OVR_multiview2 : require\nlayout (num_views = 2) in;\n"+e;return e},e}(),Tp=function(e){function t(t){var n=e.call(this)||this;return n._buffer=t,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"underlyingResource",{get:function(){return this._buffer},enumerable:!1,configurable:!0}),t}(zf),Up=function(){function e(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null}return Object.defineProperty(e.prototype,"isAsync",{get:function(){return this.isParallelCompiled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isReady",{get:function(){return!!this.program&&(!this.isParallelCompiled||this.engine._isRenderingStateCompiled(this))},enumerable:!1,configurable:!0}),e.prototype._handlesSpectorRebuildCallback=function(e){e&&this.program&&e(this.program)},e.prototype._fillEffectInformation=function(e,t,n,a,i,r,o,s){var c,d=this.engine;if(d.supportsUniformBuffers)for(var l in t)e.bindUniformBlock(l,t[l]);for(this.engine.getUniforms(this,n).forEach(function(e,t){a[n[t]]=e}),this._uniforms=a,c=0;c<i.length;c++)null==e.getUniform(i[c])&&(i.splice(c,1),c--);i.forEach(function(e,t){r[e]=t});for(var u=0,f=d.getAttributes(this,o);u<f.length;u++){var p=f[u];s.push(p)}},e.prototype.dispose=function(){this._uniforms={}},e.prototype._cacheMatrix=function(e,t){var n=this._valueCache[e],a=t.updateFlag;return(void 0===n||n!==a)&&(this._valueCache[e]=a,!0)},e.prototype._cacheFloat2=function(e,t,n){var a=this._valueCache[e];if(!a||2!==a.length)return a=[t,n],this._valueCache[e]=a,!0;var i=!1;return a[0]!==t&&(a[0]=t,i=!0),a[1]!==n&&(a[1]=n,i=!0),i},e.prototype._cacheFloat3=function(e,t,n,a){var i=this._valueCache[e];if(!i||3!==i.length)return i=[t,n,a],this._valueCache[e]=i,!0;var r=!1;return i[0]!==t&&(i[0]=t,r=!0),i[1]!==n&&(i[1]=n,r=!0),i[2]!==a&&(i[2]=a,r=!0),r},e.prototype._cacheFloat4=function(e,t,n,a,i){var r=this._valueCache[e];if(!r||4!==r.length)return r=[t,n,a,i],this._valueCache[e]=r,!0;var o=!1;return r[0]!==t&&(r[0]=t,o=!0),r[1]!==n&&(r[1]=n,o=!0),r[2]!==a&&(r[2]=a,o=!0),r[3]!==i&&(r[3]=i,o=!0),o},e.prototype.setInt=function(e,t){var n=this._valueCache[e];void 0!==n&&n===t||this.engine.setInt(this._uniforms[e],t)&&(this._valueCache[e]=t)},e.prototype.setInt2=function(e,t,n){this._cacheFloat2(e,t,n)&&(this.engine.setInt2(this._uniforms[e],t,n)||(this._valueCache[e]=null))},e.prototype.setInt3=function(e,t,n,a){this._cacheFloat3(e,t,n,a)&&(this.engine.setInt3(this._uniforms[e],t,n,a)||(this._valueCache[e]=null))},e.prototype.setInt4=function(e,t,n,a,i){this._cacheFloat4(e,t,n,a,i)&&(this.engine.setInt4(this._uniforms[e],t,n,a,i)||(this._valueCache[e]=null))},e.prototype.setIntArray=function(e,t){this._valueCache[e]=null,this.engine.setIntArray(this._uniforms[e],t)},e.prototype.setIntArray2=function(e,t){this._valueCache[e]=null,this.engine.setIntArray2(this._uniforms[e],t)},e.prototype.setIntArray3=function(e,t){this._valueCache[e]=null,this.engine.setIntArray3(this._uniforms[e],t)},e.prototype.setIntArray4=function(e,t){this._valueCache[e]=null,this.engine.setIntArray4(this._uniforms[e],t)},e.prototype.setArray=function(e,t){this._valueCache[e]=null,this.engine.setArray(this._uniforms[e],t)},e.prototype.setArray2=function(e,t){this._valueCache[e]=null,this.engine.setArray2(this._uniforms[e],t)},e.prototype.setArray3=function(e,t){this._valueCache[e]=null,this.engine.setArray3(this._uniforms[e],t)},e.prototype.setArray4=function(e,t){this._valueCache[e]=null,this.engine.setArray4(this._uniforms[e],t)},e.prototype.setMatrices=function(e,t){t&&(this._valueCache[e]=null,this.engine.setMatrices(this._uniforms[e],t))},e.prototype.setMatrix=function(e,t){this._cacheMatrix(e,t)&&(this.engine.setMatrices(this._uniforms[e],t.toArray())||(this._valueCache[e]=null))},e.prototype.setMatrix3x3=function(e,t){this._valueCache[e]=null,this.engine.setMatrix3x3(this._uniforms[e],t)},e.prototype.setMatrix2x2=function(e,t){this._valueCache[e]=null,this.engine.setMatrix2x2(this._uniforms[e],t)},e.prototype.setFloat=function(e,t){var n=this._valueCache[e];void 0!==n&&n===t||this.engine.setFloat(this._uniforms[e],t)&&(this._valueCache[e]=t)},e.prototype.setVector2=function(e,t){this._cacheFloat2(e,t.x,t.y)&&(this.engine.setFloat2(this._uniforms[e],t.x,t.y)||(this._valueCache[e]=null))},e.prototype.setFloat2=function(e,t,n){this._cacheFloat2(e,t,n)&&(this.engine.setFloat2(this._uniforms[e],t,n)||(this._valueCache[e]=null))},e.prototype.setVector3=function(e,t){this._cacheFloat3(e,t.x,t.y,t.z)&&(this.engine.setFloat3(this._uniforms[e],t.x,t.y,t.z)||(this._valueCache[e]=null))},e.prototype.setFloat3=function(e,t,n,a){this._cacheFloat3(e,t,n,a)&&(this.engine.setFloat3(this._uniforms[e],t,n,a)||(this._valueCache[e]=null))},e.prototype.setVector4=function(e,t){this._cacheFloat4(e,t.x,t.y,t.z,t.w)&&(this.engine.setFloat4(this._uniforms[e],t.x,t.y,t.z,t.w)||(this._valueCache[e]=null))},e.prototype.setFloat4=function(e,t,n,a,i){this._cacheFloat4(e,t,n,a,i)&&(this.engine.setFloat4(this._uniforms[e],t,n,a,i)||(this._valueCache[e]=null))},e.prototype.setColor3=function(e,t){this._cacheFloat3(e,t.r,t.g,t.b)&&(this.engine.setFloat3(this._uniforms[e],t.r,t.g,t.b)||(this._valueCache[e]=null))},e.prototype.setColor4=function(e,t,n){this._cacheFloat4(e,t.r,t.g,t.b,n)&&(this.engine.setFloat4(this._uniforms[e],t.r,t.g,t.b,n)||(this._valueCache[e]=null))},e.prototype.setDirectColor4=function(e,t){this._cacheFloat4(e,t.r,t.g,t.b,t.a)&&(this.engine.setFloat4(this._uniforms[e],t.r,t.g,t.b,t.a)||(this._valueCache[e]=null))},e.prototype._getVertexShaderCode=function(){return this.vertexShader?this.engine._getShaderSource(this.vertexShader):null},e.prototype._getFragmentShaderCode=function(){return this.fragmentShader?this.engine._getShaderSource(this.fragmentShader):null},e}(),Fp=function(){function e(){}return e.SetMatrixPrecision=function(t){if(e.MatrixTrackPrecisionChange=!1,t&&!e.MatrixUse64Bits&&e.MatrixTrackedMatrices)for(var n=0;n<e.MatrixTrackedMatrices.length;++n){var a=e.MatrixTrackedMatrices[n],i=a._m;a._m=new Array(16);for(var r=0;r<16;++r)a._m[r]=i[r]}e.MatrixUse64Bits=t,e.MatrixCurrentType=e.MatrixUse64Bits?Array:Float32Array,e.MatrixTrackedMatrices=null},e.MatrixUse64Bits=!1,e.MatrixTrackPrecisionChange=!0,e.MatrixCurrentType=Float32Array,e.MatrixTrackedMatrices=[],e}(),Hp=function(){function e(e,t){if(void 0===e&&(e=null),this._MSAARenderBuffer=null,this._context=t,!e&&!(e=t.createTexture()))throw new Error("Unable to create webGL texture");this.set(e)}return Object.defineProperty(e.prototype,"underlyingResource",{get:function(){return this._webGLTexture},enumerable:!1,configurable:!0}),e.prototype.setUsage=function(){},e.prototype.set=function(e){this._webGLTexture=e},e.prototype.reset=function(){this._webGLTexture=null,this._MSAARenderBuffer=null},e.prototype.release=function(){this._MSAARenderBuffer&&(this._context.deleteRenderbuffer(this._MSAARenderBuffer),this._MSAARenderBuffer=null),this._webGLTexture&&this._context.deleteTexture(this._webGLTexture),this.reset()},e}(),Rp=function(){function e(e){void 0===e&&(e=!0),this._isStencilTestDirty=!1,this._isStencilMaskDirty=!1,this._isStencilFuncDirty=!1,this._isStencilOpDirty=!1,this.useStencilGlobalOnly=!1,e&&this.reset()}return Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._isStencilTestDirty||this._isStencilMaskDirty||this._isStencilFuncDirty||this._isStencilOpDirty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"func",{get:function(){return this._func},set:function(e){this._func!==e&&(this._func=e,this._isStencilFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"funcRef",{get:function(){return this._funcRef},set:function(e){this._funcRef!==e&&(this._funcRef=e,this._isStencilFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"funcMask",{get:function(){return this._funcMask},set:function(e){this._funcMask!==e&&(this._funcMask=e,this._isStencilFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"opStencilFail",{get:function(){return this._opStencilFail},set:function(e){this._opStencilFail!==e&&(this._opStencilFail=e,this._isStencilOpDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"opDepthFail",{get:function(){return this._opDepthFail},set:function(e){this._opDepthFail!==e&&(this._opDepthFail=e,this._isStencilOpDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"opStencilDepthPass",{get:function(){return this._opStencilDepthPass},set:function(e){this._opStencilDepthPass!==e&&(this._opStencilDepthPass=e,this._isStencilOpDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(e){this._mask!==e&&(this._mask=e,this._isStencilMaskDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e,this._isStencilTestDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.reset=function(){var e;this.stencilMaterial=void 0,null===(e=this.stencilGlobal)||void 0===e||e.reset(),this._isStencilTestDirty=!0,this._isStencilMaskDirty=!0,this._isStencilFuncDirty=!0,this._isStencilOpDirty=!0},e.prototype.apply=function(e){var t;if(e){var n=!this.useStencilGlobalOnly&&!!(null===(t=this.stencilMaterial)||void 0===t?void 0:t.enabled);this.enabled=n?this.stencilMaterial.enabled:this.stencilGlobal.enabled,this.func=n?this.stencilMaterial.func:this.stencilGlobal.func,this.funcRef=n?this.stencilMaterial.funcRef:this.stencilGlobal.funcRef,this.funcMask=n?this.stencilMaterial.funcMask:this.stencilGlobal.funcMask,this.opStencilFail=n?this.stencilMaterial.opStencilFail:this.stencilGlobal.opStencilFail,this.opDepthFail=n?this.stencilMaterial.opDepthFail:this.stencilGlobal.opDepthFail,this.opStencilDepthPass=n?this.stencilMaterial.opStencilDepthPass:this.stencilGlobal.opStencilDepthPass,this.mask=n?this.stencilMaterial.mask:this.stencilGlobal.mask,this.isDirty&&(this._isStencilTestDirty&&(this.enabled?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this._isStencilTestDirty=!1),this._isStencilMaskDirty&&(e.stencilMask(this.mask),this._isStencilMaskDirty=!1),this._isStencilFuncDirty&&(e.stencilFunc(this.func,this.funcRef,this.funcMask),this._isStencilFuncDirty=!1),this._isStencilOpDirty&&(e.stencilOp(this.opStencilFail,this.opDepthFail,this.opStencilDepthPass),this._isStencilOpDirty=!1))}},e}(),Np=function(){},Bp=function(){function e(t,n,a,i){var r=this;this._name="WebGL",this.forcePOTTextures=!1,this.isFullscreen=!1,this.cullBackFaces=null,this.renderEvenInBackground=!0,this.preventCacheWipeBetweenFrames=!1,this.validateShaderPrograms=!1,this._useReverseDepthBuffer=!1,this.isNDCHalfZRange=!1,this.hasOriginBottomLeft=!0,this.disableUniformBuffers=!1,this.onDisposeObservable=new Jf,this._frameId=0,this._uniformBuffers=new Array,this._storageBuffers=new Array,this._webGLVersion=1,this._windowIsBackground=!1,this._highPrecisionShadersAllowed=!0,this._badOS=!1,this._badDesktopOS=!1,this._renderingQueueLaunched=!1,this._activeRenderLoops=new Array,this.onContextLostObservable=new Jf,this.onContextRestoredObservable=new Jf,this._contextWasLost=!1,this._doNotHandleContextLost=!1,this.disableVertexArrayObjects=!1,this._colorWrite=!0,this._colorWriteChanged=!0,this._depthCullingState=new wp,this._stencilStateComposer=new Rp,this._stencilState=new Ep,this._alphaState=new Ap,this._alphaMode=1,this._alphaEquation=0,this._internalTexturesCache=new Array,this._renderTargetWrapperCache=new Array,this._activeChannel=0,this._currentTextureChannel=-1,this._boundTexturesCache={},this._compiledEffects={},this._vertexAttribArraysEnabled=[],this._uintIndicesCurrentlySet=!1,this._currentBoundBuffer=new Array,this._currentFramebuffer=null,this._dummyFramebuffer=null,this._currentBufferPointers=new Array,this._currentInstanceLocations=new Array,this._currentInstanceBuffers=new Array,this._vaoRecordInProgress=!1,this._mustWipeVertexAttributes=!1,this._nextFreeTextureSlots=new Array,this._maxSimultaneousTextures=0,this._activeRequests=new Array,this._adaptToDeviceRatio=!1,this._transformTextureUrl=null,this.hostInformation={isMobile:!1},this.premultipliedAlpha=!0,this.onBeforeTextureInitObservable=new Jf,this._isWebGPU=!1,this._snapshotRenderingMode=0,this._viewportCached={x:0,y:0,z:0,w:0},this._unpackFlipYCached=null,this.enableUnpackFlipYCached=!0,this._boundUniforms={};var o=null;if(a=a||{},this._creationOptions=a,this._adaptToDeviceRatio=null!=i&&i,this._stencilStateComposer.stencilGlobal=this._stencilState,Fp.SetMatrixPrecision(!!a.useHighPrecisionMatrix),t){if(i=i||a.adaptToDeviceRatio||!1,t.getContext){if(o=t,this._renderingCanvas=o,void 0!==n&&(a.antialias=n),void 0===a.deterministicLockstep&&(a.deterministicLockstep=!1),void 0===a.lockstepMaxSteps&&(a.lockstepMaxSteps=4),void 0===a.timeStep&&(a.timeStep=1/60),void 0===a.preserveDrawingBuffer&&(a.preserveDrawingBuffer=!1),void 0===a.audioEngine&&(a.audioEngine=!0),void 0!==a.audioEngineOptions&&void 0!==a.audioEngineOptions.audioContext&&(this._audioContext=a.audioEngineOptions.audioContext),void 0!==a.audioEngineOptions&&void 0!==a.audioEngineOptions.audioDestination&&(this._audioDestination=a.audioEngineOptions.audioDestination),void 0===a.stencil&&(a.stencil=!0),!1===a.premultipliedAlpha&&(this.premultipliedAlpha=!1),void 0===a.xrCompatible&&(a.xrCompatible=!0),this._doNotHandleContextLost=!!a.doNotHandleContextLost,navigator&&navigator.userAgent){this._checkForMobile=function(){var e=navigator.userAgent;r.hostInformation.isMobile=-1!==e.indexOf("Mobile")||-1!==e.indexOf("Mac")&&$f()&&"ontouchend"in document},this._checkForMobile(),Xf()&&window.addEventListener("resize",this._checkForMobile);for(var s=navigator.userAgent,c=0,d=e.ExceptionList;c<d.length;c++){var l=d[c],u=l.key,f=l.targets;if(new RegExp(u).test(s)){if(l.capture&&l.captureConstraint){var p=l.capture,m=l.captureConstraint,_=new RegExp(p).exec(s);if(_&&_.length>0&&parseInt(_[_.length-1])>=m)continue}for(var h=0,b=f;h<b.length;h++)switch(b[h]){case"uniformBuffer":this.disableUniformBuffers=!0;break;case"vao":this.disableVertexArrayObjects=!0}}}}if(this._doNotHandleContextLost||(this._onContextLost=function(e){e.preventDefault(),r._contextWasLost=!0,ap.Warn("WebGL context lost."),r.onContextLostObservable.notifyObservers(r)},this._onContextRestored=function(){r._restoreEngineAfterContextLost(r._initGLContext.bind(r))},o.addEventListener("webglcontextlost",this._onContextLost,!1),o.addEventListener("webglcontextrestored",this._onContextRestored,!1),a.powerPreference="high-performance"),this._badDesktopOS=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this._badDesktopOS&&(a.xrCompatible=!1),!a.disableWebGL2Support)try{this._gl=o.getContext("webgl2",a)||o.getContext("experimental-webgl2",a),this._gl&&(this._webGLVersion=2,this._shaderPlatformName="WEBGL2",this._gl.deleteQuery||(this._webGLVersion=1,this._shaderPlatformName="WEBGL1"))}catch(e){}if(!this._gl){if(!o)throw new Error("The provided canvas is null or undefined.");try{this._gl=o.getContext("webgl",a)||o.getContext("experimental-webgl",a)}catch(e){throw new Error("WebGL not supported")}}if(!this._gl)throw new Error("WebGL not supported")}else{this._gl=t,this._renderingCanvas=this._gl.canvas,this._gl.renderbufferStorageMultisample?(this._webGLVersion=2,this._shaderPlatformName="WEBGL2"):this._shaderPlatformName="WEBGL1";var g=this._gl.getContextAttributes();g&&(a.stencil=g.stencil)}this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),void 0!==a.useHighPrecisionFloats&&(this._highPrecisionShadersAllowed=a.useHighPrecisionFloats);var v=Xf()&&window.devicePixelRatio||1,y=a.limitDeviceRatio||v;this._hardwareScalingLevel=i?1/Math.min(y,v):1,this.resize(),this._isStencilEnable=!!a.stencil,this._initGLContext(),this._initFeatures();for(var S=0;S<this._caps.maxVertexAttribs;S++)this._currentBufferPointers[S]=new Np;this._shaderProcessor=this.webGLVersion>1?new Pp:new Mp,this._badOS=/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent);var D="Babylon.js v".concat(e.Version);console.log(D+" - ".concat(this.description)),this._renderingCanvas&&this._renderingCanvas.setAttribute&&this._renderingCanvas.setAttribute("data-engine",D)}}return Object.defineProperty(e,"NpmPackage",{get:function(){return"babylonjs@5.5.5"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Version",{get:function(){return"5.5.5"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){var e=this.name+this.webGLVersion;return this._caps.parallelShaderCompile&&(e+=" - Parallel shader compilation"),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._webGLVersion},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ShadersRepository",{get:function(){return Sp.ShadersRepository},set:function(e){Sp.ShadersRepository=e},enumerable:!1,configurable:!0}),e.prototype._getShaderProcessor=function(e){return this._shaderProcessor},Object.defineProperty(e.prototype,"useReverseDepthBuffer",{get:function(){return this._useReverseDepthBuffer},set:function(e){e!==this._useReverseDepthBuffer&&(this._useReverseDepthBuffer=e,this._depthCullingState.depthFunc=e?518:515)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameId",{get:function(){return this._frameId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"supportsUniformBuffers",{get:function(){return this.webGLVersion>1&&!this.disableUniformBuffers},enumerable:!1,configurable:!0}),e.prototype.getCreationOptions=function(){return this._creationOptions},Object.defineProperty(e.prototype,"_shouldUseHighPrecisionShader",{get:function(){return!(!this._caps.highPrecisionShaderSupported||!this._highPrecisionShadersAllowed)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"needPOTTextures",{get:function(){return this._webGLVersion<2||this.forcePOTTextures},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeRenderLoops",{get:function(){return this._activeRenderLoops},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doNotHandleContextLost",{get:function(){return this._doNotHandleContextLost},set:function(e){this._doNotHandleContextLost=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_supportsHardwareTextureRescaling",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"framebufferDimensionsObject",{set:function(e){this._framebufferDimensionsObject=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentViewport",{get:function(){return this._cachedViewport},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emptyTexture",{get:function(){return this._emptyTexture||(this._emptyTexture=this.createRawTexture(new Uint8Array(4),1,1,5,!1,!1,1)),this._emptyTexture},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emptyTexture3D",{get:function(){return this._emptyTexture3D||(this._emptyTexture3D=this.createRawTexture3D(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture3D},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emptyTexture2DArray",{get:function(){return this._emptyTexture2DArray||(this._emptyTexture2DArray=this.createRawTexture2DArray(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture2DArray},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emptyCubeTexture",{get:function(){if(!this._emptyCubeTexture){var e=new Uint8Array(4),t=[e,e,e,e,e,e];this._emptyCubeTexture=this.createRawCubeTexture(t,1,5,0,!1,!1,1)}return this._emptyCubeTexture},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWebGPU",{get:function(){return this._isWebGPU},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shaderPlatformName",{get:function(){return this._shaderPlatformName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"snapshotRendering",{get:function(){return!1},set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"snapshotRenderingMode",{get:function(){return this._snapshotRenderingMode},set:function(e){this._snapshotRenderingMode=e},enumerable:!1,configurable:!0}),e.prototype.snapshotRenderingReset=function(){this.snapshotRendering=!1},e._CreateCanvas=function(e,t){if("undefined"==typeof document)return new OffscreenCanvas(e,t);var n=document.createElement("canvas");return n.width=e,n.height=t,n},e.prototype.createCanvas=function(t,n){return e._CreateCanvas(t,n)},e.prototype.createCanvasImage=function(){return document.createElement("img")},e.prototype._restoreEngineAfterContextLost=function(e){var t=this;setTimeout(function(){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,n,a,i,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return this._dummyFramebuffer=null,t=this._depthCullingState.depthTest,n=this._depthCullingState.depthFunc,a=this._depthCullingState.depthMask,i=this._stencilState.stencilTest,[4,e()];case 1:return r.sent(),this._rebuildEffects(),null===(o=this._rebuildComputeEffects)||void 0===o||o.call(this),this._rebuildInternalTextures(),this._rebuildRenderTargetWrappers(),this._rebuildBuffers(),this.wipeCaches(!0),this._depthCullingState.depthTest=t,this._depthCullingState.depthFunc=n,this._depthCullingState.depthMask=a,this._stencilState.stencilTest=i,ap.Warn(this.name+" context successfully restored."),this.onContextRestoredObservable.notifyObservers(this),this._contextWasLost=!1,[2]}})})},0)},e.prototype._sharedInit=function(e,t,n){this._renderingCanvas=e},e.prototype._getShaderProcessingContext=function(e){return null},e.prototype._rebuildInternalTextures=function(){for(var e=0,t=this._internalTexturesCache.slice();e<t.length;e++)t[e]._rebuild()},e.prototype._rebuildRenderTargetWrappers=function(){for(var e=0,t=this._renderTargetWrapperCache.slice();e<t.length;e++)t[e]._rebuild()},e.prototype._rebuildEffects=function(){for(var e in this._compiledEffects){var t=this._compiledEffects[e];t._pipelineContext=null,t._wasPreviouslyReady=!1,t._prepareEffect()}Sp.ResetCache()},e.prototype.areAllEffectsReady=function(){for(var e in this._compiledEffects)if(!this._compiledEffects[e].isReady())return!1;return!0},e.prototype._rebuildBuffers=function(){for(var e=0,t=this._uniformBuffers;e<t.length;e++)t[e]._rebuild();for(var n=0,a=this._storageBuffers;n<a.length;n++)a[n]._rebuild()},e.prototype._initGLContext=function(){this._caps={maxTexturesImageUnits:this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),maxCombinedTexturesImageUnits:this._gl.getParameter(this._gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),maxVertexTextureImageUnits:this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),maxSamples:this._webGLVersion>1?this._gl.getParameter(this._gl.MAX_SAMPLES):1,maxCubemapTextureSize:this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),maxRenderTextureSize:this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),maxVertexAttribs:this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS),maxVaryingVectors:this._gl.getParameter(this._gl.MAX_VARYING_VECTORS),maxFragmentUniformVectors:this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS),maxVertexUniformVectors:this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS),parallelShaderCompile:this._gl.getExtension("KHR_parallel_shader_compile")||void 0,standardDerivatives:this._webGLVersion>1||null!==this._gl.getExtension("OES_standard_derivatives"),maxAnisotropy:1,astc:this._gl.getExtension("WEBGL_compressed_texture_astc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_astc"),bptc:this._gl.getExtension("EXT_texture_compression_bptc")||this._gl.getExtension("WEBKIT_EXT_texture_compression_bptc"),s3tc:this._gl.getExtension("WEBGL_compressed_texture_s3tc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),s3tc_srgb:this._gl.getExtension("WEBGL_compressed_texture_s3tc_srgb")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc_srgb"),pvrtc:this._gl.getExtension("WEBGL_compressed_texture_pvrtc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:this._gl.getExtension("WEBGL_compressed_texture_etc1")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"),etc2:this._gl.getExtension("WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBGL_compressed_texture_es3_0"),textureAnisotropicFilterExtension:this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic"),uintIndices:this._webGLVersion>1||null!==this._gl.getExtension("OES_element_index_uint"),fragmentDepthSupported:this._webGLVersion>1||null!==this._gl.getExtension("EXT_frag_depth"),highPrecisionShaderSupported:!1,timerQuery:this._gl.getExtension("EXT_disjoint_timer_query_webgl2")||this._gl.getExtension("EXT_disjoint_timer_query"),supportOcclusionQuery:this._webGLVersion>1,canUseTimestampForTimerQuery:!1,drawBuffersExtension:!1,maxMSAASamples:1,colorBufferFloat:!!(this._webGLVersion>1&&this._gl.getExtension("EXT_color_buffer_float")),textureFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_float")),textureHalfFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_half_float")),textureHalfFloatRender:!1,textureFloatLinearFiltering:!1,textureFloatRender:!1,textureHalfFloatLinearFiltering:!1,vertexArrayObject:!1,instancedArrays:!1,textureLOD:!!(this._webGLVersion>1||this._gl.getExtension("EXT_shader_texture_lod")),blendMinMax:!1,multiview:this._gl.getExtension("OVR_multiview2"),oculusMultiview:this._gl.getExtension("OCULUS_multiview"),depthTextureExtension:!1,canUseGLInstanceID:this._webGLVersion>1,canUseGLVertexID:this._webGLVersion>1,supportComputeShaders:!1,supportSRGBBuffers:!1,supportTransformFeedbacks:this._webGLVersion>1,textureMaxLevel:this._webGLVersion>1},this._glVersion=this._gl.getParameter(this._gl.VERSION);var e=this._gl.getExtension("WEBGL_debug_renderer_info");if(null!=e&&(this._glRenderer=this._gl.getParameter(e.UNMASKED_RENDERER_WEBGL),this._glVendor=this._gl.getParameter(e.UNMASKED_VENDOR_WEBGL)),this._glVendor||(this._glVendor=this._gl.getParameter(this._gl.VENDOR)||"Unknown vendor"),this._glRenderer||(this._glRenderer=this._gl.getParameter(this._gl.RENDERER)||"Unknown renderer"),36193!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=36193),34842!==this._gl.RGBA16F&&(this._gl.RGBA16F=34842),34836!==this._gl.RGBA32F&&(this._gl.RGBA32F=34836),35056!==this._gl.DEPTH24_STENCIL8&&(this._gl.DEPTH24_STENCIL8=35056),this._caps.timerQuery&&(1===this._webGLVersion&&(this._gl.getQuery=this._caps.timerQuery.getQueryEXT.bind(this._caps.timerQuery)),this._caps.canUseTimestampForTimerQuery=this._gl.getQuery(this._caps.timerQuery.TIMESTAMP_EXT,this._caps.timerQuery.QUERY_COUNTER_BITS_EXT)>0),this._caps.maxAnisotropy=this._caps.textureAnisotropicFilterExtension?this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,this._caps.textureFloatLinearFiltering=!(!this._caps.textureFloat||!this._gl.getExtension("OES_texture_float_linear")),this._caps.textureFloatRender=!(!this._caps.textureFloat||!this._canRenderToFloatFramebuffer()),this._caps.textureHalfFloatLinearFiltering=!!(this._webGLVersion>1||this._caps.textureHalfFloat&&this._gl.getExtension("OES_texture_half_float_linear")),this._caps.astc&&(this._gl.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=this._caps.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR),this._caps.bptc&&(this._gl.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=this._caps.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT),this._caps.s3tc_srgb&&(this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT),this._webGLVersion>1&&5131!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=5131),this._caps.textureHalfFloatRender=this._caps.textureHalfFloat&&this._canRenderToHalfFloatFramebuffer(),this._webGLVersion>1)this._caps.drawBuffersExtension=!0,this._caps.maxMSAASamples=this._gl.getParameter(this._gl.MAX_SAMPLES);else{var t=this._gl.getExtension("WEBGL_draw_buffers");if(null!==t){this._caps.drawBuffersExtension=!0,this._gl.drawBuffers=t.drawBuffersWEBGL.bind(t),this._gl.DRAW_FRAMEBUFFER=this._gl.FRAMEBUFFER;for(var n=0;n<16;n++)this._gl["COLOR_ATTACHMENT"+n+"_WEBGL"]=t["COLOR_ATTACHMENT"+n+"_WEBGL"]}}if(this._webGLVersion>1)this._caps.depthTextureExtension=!0;else{var a=this._gl.getExtension("WEBGL_depth_texture");null!=a&&(this._caps.depthTextureExtension=!0,this._gl.UNSIGNED_INT_24_8=a.UNSIGNED_INT_24_8_WEBGL)}if(this.disableVertexArrayObjects)this._caps.vertexArrayObject=!1;else if(this._webGLVersion>1)this._caps.vertexArrayObject=!0;else{var i=this._gl.getExtension("OES_vertex_array_object");null!=i&&(this._caps.vertexArrayObject=!0,this._gl.createVertexArray=i.createVertexArrayOES.bind(i),this._gl.bindVertexArray=i.bindVertexArrayOES.bind(i),this._gl.deleteVertexArray=i.deleteVertexArrayOES.bind(i))}if(this._webGLVersion>1)this._caps.instancedArrays=!0;else{var r=this._gl.getExtension("ANGLE_instanced_arrays");null!=r?(this._caps.instancedArrays=!0,this._gl.drawArraysInstanced=r.drawArraysInstancedANGLE.bind(r),this._gl.drawElementsInstanced=r.drawElementsInstancedANGLE.bind(r),this._gl.vertexAttribDivisor=r.vertexAttribDivisorANGLE.bind(r)):this._caps.instancedArrays=!1}if(this._gl.getShaderPrecisionFormat){var o=this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER,this._gl.HIGH_FLOAT),s=this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER,this._gl.HIGH_FLOAT);o&&s&&(this._caps.highPrecisionShaderSupported=0!==o.precision&&0!==s.precision)}if(this._webGLVersion>1)this._caps.blendMinMax=!0;else{var c=this._gl.getExtension("EXT_blend_minmax");null!=c&&(this._caps.blendMinMax=!0,this._gl.MAX=c.MAX_EXT,this._gl.MIN=c.MIN_EXT)}if(!this._caps.supportSRGBBuffers){if(this._webGLVersion>1)this._caps.supportSRGBBuffers=!0;else{var d=this._gl.getExtension("EXT_sRGB");null!=d&&(this._caps.supportSRGBBuffers=!0,this._gl.SRGB=d.SRGB_EXT,this._gl.SRGB8=d.SRGB_ALPHA_EXT,this._gl.SRGB8_ALPHA8=d.SRGB_ALPHA_EXT)}this._caps.supportSRGBBuffers=this._caps.supportSRGBBuffers&&!(!this._creationOptions||!this._creationOptions.forceSRGBBufferSupportState)}this._depthCullingState.depthTest=!0,this._depthCullingState.depthFunc=this._gl.LEQUAL,this._depthCullingState.depthMask=!0,this._maxSimultaneousTextures=this._caps.maxCombinedTexturesImageUnits;for(var l=0;l<this._maxSimultaneousTextures;l++)this._nextFreeTextureSlots.push(l)},e.prototype._initFeatures=function(){this._features={forceBitmapOverHTMLImageElement:!1,supportRenderAndCopyToLodForFloatTextures:1!==this._webGLVersion,supportDepthStencilTexture:1!==this._webGLVersion,supportShadowSamplers:1!==this._webGLVersion,uniformBufferHardCheckMatrix:!1,allowTexturePrefiltering:1!==this._webGLVersion,trackUbosInFrame:!1,checkUbosContentBeforeUpload:!1,supportCSM:1!==this._webGLVersion,basisNeedsPOT:1===this._webGLVersion,support3DTextures:1!==this._webGLVersion,needTypeSuffixInShaderConstants:1!==this._webGLVersion,supportMSAA:1!==this._webGLVersion,supportSSAO2:1!==this._webGLVersion,supportExtendedTextureFormats:1!==this._webGLVersion,supportSwitchCaseInShader:1!==this._webGLVersion,supportSyncTextureRead:!0,needsInvertingBitmap:!0,useUBOBindingCache:!0,needShaderCodeInlining:!1,needToAlwaysBindUniformBuffers:!1,supportRenderPasses:!1,_collectUbosUpdatedInFrame:!1}},Object.defineProperty(e.prototype,"webGLVersion",{get:function(){return this._webGLVersion},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return"ThinEngine"},Object.defineProperty(e.prototype,"isStencilEnable",{get:function(){return this._isStencilEnable},enumerable:!1,configurable:!0}),e.prototype._prepareWorkingCanvas=function(){if(!this._workingCanvas){this._workingCanvas=this.createCanvas(1,1);var e=this._workingCanvas.getContext("2d");e&&(this._workingContext=e)}},e.prototype.resetTextureCache=function(){for(var e in this._boundTexturesCache)Object.prototype.hasOwnProperty.call(this._boundTexturesCache,e)&&(this._boundTexturesCache[e]=null);this._currentTextureChannel=-1},e.prototype.getInfo=function(){return this.getGlInfo()},e.prototype.getGlInfo=function(){return{vendor:this._glVendor,renderer:this._glRenderer,version:this._glVersion}},e.prototype.setHardwareScalingLevel=function(e){this._hardwareScalingLevel=e,this.resize()},e.prototype.getHardwareScalingLevel=function(){return this._hardwareScalingLevel},e.prototype.getLoadedTexturesCache=function(){return this._internalTexturesCache},e.prototype.getCaps=function(){return this._caps},e.prototype.stopRenderLoop=function(e){if(e){var t=this._activeRenderLoops.indexOf(e);t>=0&&this._activeRenderLoops.splice(t,1)}else this._activeRenderLoops=[]},e.prototype._renderLoop=function(){if(!this._contextWasLost){var e=!0;if(!this.renderEvenInBackground&&this._windowIsBackground&&(e=!1),e){this.beginFrame();for(var t=0;t<this._activeRenderLoops.length;t++)(0,this._activeRenderLoops[t])();this.endFrame()}}this._activeRenderLoops.length>0?this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()):this._renderingQueueLaunched=!1},e.prototype.getRenderingCanvas=function(){return this._renderingCanvas},e.prototype.getAudioContext=function(){return this._audioContext},e.prototype.getAudioDestination=function(){return this._audioDestination},e.prototype.getHostWindow=function(){return Xf()?this._renderingCanvas&&this._renderingCanvas.ownerDocument&&this._renderingCanvas.ownerDocument.defaultView?this._renderingCanvas.ownerDocument.defaultView:window:null},e.prototype.getRenderWidth=function(e){return void 0===e&&(e=!1),!e&&this._currentRenderTarget?this._currentRenderTarget.width:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferWidth:this._gl.drawingBufferWidth},e.prototype.getRenderHeight=function(e){return void 0===e&&(e=!1),!e&&this._currentRenderTarget?this._currentRenderTarget.height:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferHeight:this._gl.drawingBufferHeight},e.prototype._queueNewFrame=function(t,n){return e.QueueNewFrame(t,n)},e.prototype.runRenderLoop=function(e){-1===this._activeRenderLoops.indexOf(e)&&(this._activeRenderLoops.push(e),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,this._boundRenderFunction=this._renderLoop.bind(this),this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow())))},e.prototype.clear=function(e,t,n,a){void 0===a&&(a=!1);var i=this.stencilStateComposer.useStencilGlobalOnly;this.stencilStateComposer.useStencilGlobalOnly=!0,this.applyStates(),this.stencilStateComposer.useStencilGlobalOnly=i;var r=0;t&&e&&(this._gl.clearColor(e.r,e.g,e.b,void 0!==e.a?e.a:1),r|=this._gl.COLOR_BUFFER_BIT),n&&(this.useReverseDepthBuffer?(this._depthCullingState.depthFunc=this._gl.GEQUAL,this._gl.clearDepth(0)):this._gl.clearDepth(1),r|=this._gl.DEPTH_BUFFER_BIT),a&&(this._gl.clearStencil(0),r|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(r)},e.prototype._viewport=function(e,t,n,a){e===this._viewportCached.x&&t===this._viewportCached.y&&n===this._viewportCached.z&&a===this._viewportCached.w||(this._viewportCached.x=e,this._viewportCached.y=t,this._viewportCached.z=n,this._viewportCached.w=a,this._gl.viewport(e,t,n,a))},e.prototype.setViewport=function(e,t,n){var a=t||this.getRenderWidth(),i=n||this.getRenderHeight(),r=e.x||0,o=e.y||0;this._cachedViewport=e,this._viewport(r*a,o*i,a*e.width,i*e.height)},e.prototype.beginFrame=function(){},e.prototype.endFrame=function(){this._badOS&&this.flushFramebuffer(),this._frameId++},e.prototype.resize=function(e){var t,n;if(void 0===e&&(e=!1),this._adaptToDeviceRatio){var a=Xf()&&window.devicePixelRatio||1,i=this._creationOptions.limitDeviceRatio||a;this._hardwareScalingLevel=this._adaptToDeviceRatio?1/Math.min(i,a):1}Xf()?(t=this._renderingCanvas?this._renderingCanvas.clientWidth||this._renderingCanvas.width:window.innerWidth,n=this._renderingCanvas?this._renderingCanvas.clientHeight||this._renderingCanvas.height:window.innerHeight):(t=this._renderingCanvas?this._renderingCanvas.width:100,n=this._renderingCanvas?this._renderingCanvas.height:100),this.setSize(t/this._hardwareScalingLevel,n/this._hardwareScalingLevel,e)},e.prototype.setSize=function(e,t,n){return void 0===n&&(n=!1),!(!this._renderingCanvas||(e|=0,t|=0,!n&&this._renderingCanvas.width===e&&this._renderingCanvas.height===t||(this._renderingCanvas.width=e,this._renderingCanvas.height=t,0)))},e.prototype.bindFramebuffer=function(e,t,n,a,i,r,o){var s,c,d,l,u;void 0===t&&(t=0),void 0===r&&(r=0),void 0===o&&(o=0);var f=e;this._currentRenderTarget&&this.unBindFramebuffer(this._currentRenderTarget),this._currentRenderTarget=e,this._bindUnboundFramebuffer(f._MSAAFramebuffer?f._MSAAFramebuffer:f._framebuffer);var p=this._gl;e.is2DArray?p.framebufferTextureLayer(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,null===(s=e.texture._hardwareTexture)||void 0===s?void 0:s.underlyingResource,r,o):e.isCube&&p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_CUBE_MAP_POSITIVE_X+t,null===(c=e.texture._hardwareTexture)||void 0===c?void 0:c.underlyingResource,r);var m=e._depthStencilTexture;if(m){var _=e._depthStencilTextureWithStencil?p.DEPTH_STENCIL_ATTACHMENT:p.DEPTH_ATTACHMENT;e.is2DArray?p.framebufferTextureLayer(p.FRAMEBUFFER,_,null===(d=m._hardwareTexture)||void 0===d?void 0:d.underlyingResource,r,o):e.isCube?p.framebufferTexture2D(p.FRAMEBUFFER,_,p.TEXTURE_CUBE_MAP_POSITIVE_X+t,null===(l=m._hardwareTexture)||void 0===l?void 0:l.underlyingResource,r):p.framebufferTexture2D(p.FRAMEBUFFER,_,p.TEXTURE_2D,null===(u=m._hardwareTexture)||void 0===u?void 0:u.underlyingResource,r)}this._cachedViewport&&!i?this.setViewport(this._cachedViewport,n,a):(n||(n=e.width,r&&(n/=Math.pow(2,r))),a||(a=e.height,r&&(a/=Math.pow(2,r))),this._viewport(0,0,n,a)),this.wipeCaches()},e.prototype.setState=function(e,t,n,a,i,r,o){var s,c;void 0===t&&(t=0),void 0===a&&(a=!1),void 0===o&&(o=0),(this._depthCullingState.cull!==e||n)&&(this._depthCullingState.cull=e);var d=null===(c=null!==(s=this.cullBackFaces)&&void 0!==s?s:i)||void 0===c||c?this._gl.BACK:this._gl.FRONT;(this._depthCullingState.cullFace!==d||n)&&(this._depthCullingState.cullFace=d),this.setZOffset(t),this.setZOffsetUnits(o);var l=a?this._gl.CW:this._gl.CCW;(this._depthCullingState.frontFace!==l||n)&&(this._depthCullingState.frontFace=l),this._stencilStateComposer.stencilMaterial=r},e.prototype.setZOffset=function(e){this._depthCullingState.zOffset=this.useReverseDepthBuffer?-e:e},e.prototype.getZOffset=function(){var e=this._depthCullingState.zOffset;return this.useReverseDepthBuffer?-e:e},e.prototype.setZOffsetUnits=function(e){this._depthCullingState.zOffsetUnits=this.useReverseDepthBuffer?-e:e},e.prototype.getZOffsetUnits=function(){var e=this._depthCullingState.zOffsetUnits;return this.useReverseDepthBuffer?-e:e},e.prototype._bindUnboundFramebuffer=function(e){this._currentFramebuffer!==e&&(this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,e),this._currentFramebuffer=e)},e.prototype._currentFrameBufferIsDefaultFrameBuffer=function(){return null===this._currentFramebuffer},e.prototype.generateMipmaps=function(e){this._bindTextureDirectly(this._gl.TEXTURE_2D,e,!0),this._gl.generateMipmap(this._gl.TEXTURE_2D),this._bindTextureDirectly(this._gl.TEXTURE_2D,null)},e.prototype.unBindFramebuffer=function(e,t,n){var a;void 0===t&&(t=!1);var i=e;this._currentRenderTarget=null;var r=this._gl;if(i._MSAAFramebuffer){if(e.isMulti)return void this.unBindMultiColorAttachmentFramebuffer(e,t,n);r.bindFramebuffer(r.READ_FRAMEBUFFER,i._MSAAFramebuffer),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,i._framebuffer),r.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,r.COLOR_BUFFER_BIT,r.NEAREST)}!(null===(a=e.texture)||void 0===a?void 0:a.generateMipMaps)||t||e.isCube||this.generateMipmaps(e.texture),n&&(i._MSAAFramebuffer&&this._bindUnboundFramebuffer(i._framebuffer),n()),this._bindUnboundFramebuffer(null)},e.prototype.flushFramebuffer=function(){this._gl.flush()},e.prototype.restoreDefaultFramebuffer=function(){this._currentRenderTarget?this.unBindFramebuffer(this._currentRenderTarget):this._bindUnboundFramebuffer(null),this._cachedViewport&&this.setViewport(this._cachedViewport),this.wipeCaches()},e.prototype._resetVertexBufferBinding=function(){this.bindArrayBuffer(null),this._cachedVertexBuffers=null},e.prototype.createVertexBuffer=function(e){return this._createVertexBuffer(e,this._gl.STATIC_DRAW)},e.prototype._createVertexBuffer=function(e,t){var n=this._gl.createBuffer();if(!n)throw new Error("Unable to create vertex buffer");var a=new Tp(n);return this.bindArrayBuffer(a),e instanceof Array?this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(e),t):this._gl.bufferData(this._gl.ARRAY_BUFFER,e,t),this._resetVertexBufferBinding(),a.references=1,a},e.prototype.createDynamicVertexBuffer=function(e){return this._createVertexBuffer(e,this._gl.DYNAMIC_DRAW)},e.prototype._resetIndexBufferBinding=function(){this.bindIndexBuffer(null),this._cachedIndexBuffer=null},e.prototype.createIndexBuffer=function(e,t){var n=this._gl.createBuffer(),a=new Tp(n);if(!n)throw new Error("Unable to create index buffer");this.bindIndexBuffer(a);var i=this._normalizeIndexData(e);return this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,i,t?this._gl.DYNAMIC_DRAW:this._gl.STATIC_DRAW),this._resetIndexBufferBinding(),a.references=1,a.is32Bits=4===i.BYTES_PER_ELEMENT,a},e.prototype._normalizeIndexData=function(e){if(2===e.BYTES_PER_ELEMENT)return e;if(this._caps.uintIndices){if(e instanceof Uint32Array)return e;for(var t=0;t<e.length;t++)if(e[t]>=65535)return new Uint32Array(e);return new Uint16Array(e)}return new Uint16Array(e)},e.prototype.bindArrayBuffer=function(e){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this._bindBuffer(e,this._gl.ARRAY_BUFFER)},e.prototype.bindUniformBlock=function(e,t,n){var a=e.program,i=this._gl.getUniformBlockIndex(a,t);this._gl.uniformBlockBinding(a,i,n)},e.prototype.bindIndexBuffer=function(e){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this._bindBuffer(e,this._gl.ELEMENT_ARRAY_BUFFER)},e.prototype._bindBuffer=function(e,t){(this._vaoRecordInProgress||this._currentBoundBuffer[t]!==e)&&(this._gl.bindBuffer(t,e?e.underlyingResource:null),this._currentBoundBuffer[t]=e)},e.prototype.updateArrayBuffer=function(e){this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,e)},e.prototype._vertexAttribPointer=function(e,t,n,a,i,r,o){var s=this._currentBufferPointers[t];if(s){var c=!1;s.active?(s.buffer!==e&&(s.buffer=e,c=!0),s.size!==n&&(s.size=n,c=!0),s.type!==a&&(s.type=a,c=!0),s.normalized!==i&&(s.normalized=i,c=!0),s.stride!==r&&(s.stride=r,c=!0),s.offset!==o&&(s.offset=o,c=!0)):(c=!0,s.active=!0,s.index=t,s.size=n,s.type=a,s.normalized=i,s.stride=r,s.offset=o,s.buffer=e),(c||this._vaoRecordInProgress)&&(this.bindArrayBuffer(e),this._gl.vertexAttribPointer(t,n,a,i,r,o))}},e.prototype._bindIndexBufferWithCache=function(e){null!=e&&this._cachedIndexBuffer!==e&&(this._cachedIndexBuffer=e,this.bindIndexBuffer(e),this._uintIndicesCurrentlySet=e.is32Bits)},e.prototype._bindVertexBuffersAttributes=function(e,t,n){var a=t.getAttributesNames();this._vaoRecordInProgress||this._unbindVertexArrayObject(),this.unbindAllAttributes();for(var i=0;i<a.length;i++){var r=t.getAttributeLocation(i);if(r>=0){var o=a[i],s=null;if(n&&(s=n[o]),s||(s=e[o]),!s)continue;this._gl.enableVertexAttribArray(r),this._vaoRecordInProgress||(this._vertexAttribArraysEnabled[r]=!0);var c=s.getBuffer();c&&(this._vertexAttribPointer(c,r,s.getSize(),s.type,s.normalized,s.byteStride,s.byteOffset),s.getIsInstanced()&&(this._gl.vertexAttribDivisor(r,s.getInstanceDivisor()),this._vaoRecordInProgress||(this._currentInstanceLocations.push(r),this._currentInstanceBuffers.push(c))))}}},e.prototype.recordVertexArrayObject=function(e,t,n,a){var i=this._gl.createVertexArray();return this._vaoRecordInProgress=!0,this._gl.bindVertexArray(i),this._mustWipeVertexAttributes=!0,this._bindVertexBuffersAttributes(e,n,a),this.bindIndexBuffer(t),this._vaoRecordInProgress=!1,this._gl.bindVertexArray(null),i},e.prototype.bindVertexArrayObject=function(e,t){this._cachedVertexArrayObject!==e&&(this._cachedVertexArrayObject=e,this._gl.bindVertexArray(e),this._cachedVertexBuffers=null,this._cachedIndexBuffer=null,this._uintIndicesCurrentlySet=null!=t&&t.is32Bits,this._mustWipeVertexAttributes=!0)},e.prototype.bindBuffersDirectly=function(e,t,n,a,i){if(this._cachedVertexBuffers!==e||this._cachedEffectForVertexBuffers!==i){this._cachedVertexBuffers=e,this._cachedEffectForVertexBuffers=i;var r=i.getAttributesCount();this._unbindVertexArrayObject(),this.unbindAllAttributes();for(var o=0,s=0;s<r;s++)if(s<n.length){var c=i.getAttributeLocation(s);c>=0&&(this._gl.enableVertexAttribArray(c),this._vertexAttribArraysEnabled[c]=!0,this._vertexAttribPointer(e,c,n[s],this._gl.FLOAT,!1,a,o)),o+=4*n[s]}}this._bindIndexBufferWithCache(t)},e.prototype._unbindVertexArrayObject=function(){this._cachedVertexArrayObject&&(this._cachedVertexArrayObject=null,this._gl.bindVertexArray(null))},e.prototype.bindBuffers=function(e,t,n,a){this._cachedVertexBuffers===e&&this._cachedEffectForVertexBuffers===n||(this._cachedVertexBuffers=e,this._cachedEffectForVertexBuffers=n,this._bindVertexBuffersAttributes(e,n,a)),this._bindIndexBufferWithCache(t)},e.prototype.unbindInstanceAttributes=function(){for(var e,t=0,n=this._currentInstanceLocations.length;t<n;t++){var a=this._currentInstanceBuffers[t];e!=a&&a.references&&(e=a,this.bindArrayBuffer(a));var i=this._currentInstanceLocations[t];this._gl.vertexAttribDivisor(i,0)}this._currentInstanceBuffers.length=0,this._currentInstanceLocations.length=0},e.prototype.releaseVertexArrayObject=function(e){this._gl.deleteVertexArray(e)},e.prototype._releaseBuffer=function(e){return e.references--,0===e.references&&(this._deleteBuffer(e),!0)},e.prototype._deleteBuffer=function(e){this._gl.deleteBuffer(e.underlyingResource)},e.prototype.updateAndBindInstancesBuffer=function(e,t,n){if(this.bindArrayBuffer(e),t&&this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t),void 0!==n[0].index)this.bindInstancesBuffer(e,n,!0);else for(var a=0;a<4;a++){var i=n[a];this._vertexAttribArraysEnabled[i]||(this._gl.enableVertexAttribArray(i),this._vertexAttribArraysEnabled[i]=!0),this._vertexAttribPointer(e,i,4,this._gl.FLOAT,!1,64,16*a),this._gl.vertexAttribDivisor(i,1),this._currentInstanceLocations.push(i),this._currentInstanceBuffers.push(e)}},e.prototype.bindInstancesBuffer=function(e,t,n){void 0===n&&(n=!0),this.bindArrayBuffer(e);var a=0;if(n)for(var i=0;i<t.length;i++)a+=4*(r=t[i]).attributeSize;for(i=0;i<t.length;i++){var r;void 0===(r=t[i]).index&&(r.index=this._currentEffect.getAttributeLocationByName(r.attributeName)),r.index<0||(this._vertexAttribArraysEnabled[r.index]||(this._gl.enableVertexAttribArray(r.index),this._vertexAttribArraysEnabled[r.index]=!0),this._vertexAttribPointer(e,r.index,r.attributeSize,r.attributeType||this._gl.FLOAT,r.normalized||!1,a,r.offset),this._gl.vertexAttribDivisor(r.index,void 0===r.divisor?1:r.divisor),this._currentInstanceLocations.push(r.index),this._currentInstanceBuffers.push(e))}},e.prototype.disableInstanceAttributeByName=function(e){if(this._currentEffect){var t=this._currentEffect.getAttributeLocationByName(e);this.disableInstanceAttribute(t)}},e.prototype.disableInstanceAttribute=function(e){for(var t,n=!1;-1!==(t=this._currentInstanceLocations.indexOf(e));)this._currentInstanceLocations.splice(t,1),this._currentInstanceBuffers.splice(t,1),n=!0,t=this._currentInstanceLocations.indexOf(e);n&&(this._gl.vertexAttribDivisor(e,0),this.disableAttributeByIndex(e))},e.prototype.disableAttributeByIndex=function(e){this._gl.disableVertexAttribArray(e),this._vertexAttribArraysEnabled[e]=!1,this._currentBufferPointers[e].active=!1},e.prototype.draw=function(e,t,n,a){this.drawElementsType(e?0:1,t,n,a)},e.prototype.drawPointClouds=function(e,t,n){this.drawArraysType(2,e,t,n)},e.prototype.drawUnIndexed=function(e,t,n,a){this.drawArraysType(e?0:1,t,n,a)},e.prototype.drawElementsType=function(e,t,n,a){this.applyStates(),this._reportDrawCall();var i=this._drawMode(e),r=this._uintIndicesCurrentlySet?this._gl.UNSIGNED_INT:this._gl.UNSIGNED_SHORT,o=this._uintIndicesCurrentlySet?4:2;a?this._gl.drawElementsInstanced(i,n,r,t*o,a):this._gl.drawElements(i,n,r,t*o)},e.prototype.drawArraysType=function(e,t,n,a){this.applyStates(),this._reportDrawCall();var i=this._drawMode(e);a?this._gl.drawArraysInstanced(i,t,n,a):this._gl.drawArrays(i,t,n)},e.prototype._drawMode=function(e){switch(e){default:return this._gl.TRIANGLES;case 2:case 3:return this._gl.POINTS;case 1:case 4:return this._gl.LINES;case 5:return this._gl.LINE_LOOP;case 6:return this._gl.LINE_STRIP;case 7:return this._gl.TRIANGLE_STRIP;case 8:return this._gl.TRIANGLE_FAN}},e.prototype._reportDrawCall=function(){},e.prototype._releaseEffect=function(e){if(this._compiledEffects[e._key]){delete this._compiledEffects[e._key];var t=e.getPipelineContext();t&&this._deletePipelineContext(t)}},e.prototype._deletePipelineContext=function(e){var t=e;t&&t.program&&(t.program.__SPECTOR_rebuildProgram=null,this._gl.deleteProgram(t.program))},e.prototype._getGlobalDefines=function(e){if(e)return this.isNDCHalfZRange?e.IS_NDC_HALF_ZRANGE="":delete e.IS_NDC_HALF_ZRANGE,void(this.useReverseDepthBuffer?e.USE_REVERSE_DEPTHBUFFER="":delete e.USE_REVERSE_DEPTHBUFFER);var t="";return this.isNDCHalfZRange&&(t+="#define IS_NDC_HALF_ZRANGE"),this.useReverseDepthBuffer&&(t&&(t+="\n"),t+="#define USE_REVERSE_DEPTHBUFFER"),t},e.prototype.createEffect=function(e,t,n,a,i,r,o,s,c,d){var l;void 0===d&&(d=tp.GLSL);var u=e.vertexElement||e.vertex||e.vertexToken||e.vertexSource||e,f=e.fragmentElement||e.fragment||e.fragmentToken||e.fragmentSource||e,p=this._getGlobalDefines(),m=null!==(l=null!=i?i:t.defines)&&void 0!==l?l:"";p&&(m+=p);var _=u+"+"+f+"@"+m;if(this._compiledEffects[_]){var h=this._compiledEffects[_];return o&&h.isReady()&&o(h),h}var b=new Sp(e,t,n,a,this,i,r,o,s,c,_,d);return this._compiledEffects[_]=b,b},e._ConcatenateShader=function(e,t,n){return void 0===n&&(n=""),n+(t?t+"\n":"")+e},e.prototype._compileShader=function(t,n,a,i){return this._compileRawShader(e._ConcatenateShader(t,a,i),n)},e.prototype._compileRawShader=function(e,t){var n=this._gl,a=n.createShader("vertex"===t?n.VERTEX_SHADER:n.FRAGMENT_SHADER);if(!a){for(var i=n.NO_ERROR,r=n.NO_ERROR;(r=n.getError())!==n.NO_ERROR;)i=r;throw new Error("Something went wrong while creating a gl ".concat(t," shader object. gl error=").concat(i,", gl isContextLost=").concat(n.isContextLost(),", _contextWasLost=").concat(this._contextWasLost))}return n.shaderSource(a,e),n.compileShader(a),a},e.prototype._getShaderSource=function(e){return this._gl.getShaderSource(e)},e.prototype.createRawShaderProgram=function(e,t,n,a,i){void 0===i&&(i=null),a=a||this._gl;var r=this._compileRawShader(t,"vertex"),o=this._compileRawShader(n,"fragment");return this._createShaderProgram(e,r,o,a,i)},e.prototype.createShaderProgram=function(e,t,n,a,i,r){void 0===r&&(r=null),i=i||this._gl;var o=this._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"",s=this._compileShader(t,"vertex",a,o),c=this._compileShader(n,"fragment",a,o);return this._createShaderProgram(e,s,c,i,r)},e.prototype.inlineShaderCode=function(e){return e},e.prototype.createPipelineContext=function(e){var t=new Up;return t.engine=this,this._caps.parallelShaderCompile&&(t.isParallelCompiled=!0),t},e.prototype.createMaterialContext=function(){},e.prototype.createDrawContext=function(){},e.prototype._createShaderProgram=function(e,t,n,a,i){void 0===i&&(i=null);var r=a.createProgram();if(e.program=r,!r)throw new Error("Unable to create program");return a.attachShader(r,t),a.attachShader(r,n),a.linkProgram(r),e.context=a,e.vertexShader=t,e.fragmentShader=n,e.isParallelCompiled||this._finalizePipelineContext(e),r},e.prototype._finalizePipelineContext=function(e){var t=e.context,n=e.vertexShader,a=e.fragmentShader,i=e.program;if(!t.getProgramParameter(i,t.LINK_STATUS)){var r,o;if(!this._gl.getShaderParameter(n,this._gl.COMPILE_STATUS)&&(r=this._gl.getShaderInfoLog(n)))throw e.vertexCompilationError=r,new Error("VERTEX SHADER "+r);if(!this._gl.getShaderParameter(a,this._gl.COMPILE_STATUS)&&(r=this._gl.getShaderInfoLog(a)))throw e.fragmentCompilationError=r,new Error("FRAGMENT SHADER "+r);if(o=t.getProgramInfoLog(i))throw e.programLinkError=o,new Error(o)}if(this.validateShaderPrograms&&(t.validateProgram(i),!t.getProgramParameter(i,t.VALIDATE_STATUS)&&(o=t.getProgramInfoLog(i))))throw e.programValidationError=o,new Error(o);t.deleteShader(n),t.deleteShader(a),e.vertexShader=void 0,e.fragmentShader=void 0,e.onCompiled&&(e.onCompiled(),e.onCompiled=void 0)},e.prototype._preparePipelineContext=function(e,t,n,a,i,r,o,s,c,d){var l=e;l.program=a?this.createRawShaderProgram(l,t,n,void 0,c):this.createShaderProgram(l,t,n,s,void 0,c),l.program.__SPECTOR_rebuildProgram=o},e.prototype._isRenderingStateCompiled=function(e){var t=e;return!!this._gl.getProgramParameter(t.program,this._caps.parallelShaderCompile.COMPLETION_STATUS_KHR)&&(this._finalizePipelineContext(t),!0)},e.prototype._executeWhenRenderingStateIsCompiled=function(e,t){var n=e;if(n.isParallelCompiled){var a=n.onCompiled;n.onCompiled=a?function(){a(),t()}:t}else t()},e.prototype.getUniforms=function(e,t){for(var n=new Array,a=e,i=0;i<t.length;i++)n.push(this._gl.getUniformLocation(a.program,t[i]));return n},e.prototype.getAttributes=function(e,t){for(var n=[],a=e,i=0;i<t.length;i++)try{n.push(this._gl.getAttribLocation(a.program,t[i]))}catch(e){n.push(-1)}return n},e.prototype.enableEffect=function(e){(e=null!==e&&Dp.IsWrapper(e)?e.effect:e)&&e!==this._currentEffect&&(this._stencilStateComposer.stencilMaterial=void 0,e=e,this.bindSamplers(e),this._currentEffect=e,e.onBind&&e.onBind(e),e._onBindObservable&&e._onBindObservable.notifyObservers(e))},e.prototype.setInt=function(e,t){return!!e&&(this._gl.uniform1i(e,t),!0)},e.prototype.setInt2=function(e,t,n){return!!e&&(this._gl.uniform2i(e,t,n),!0)},e.prototype.setInt3=function(e,t,n,a){return!!e&&(this._gl.uniform3i(e,t,n,a),!0)},e.prototype.setInt4=function(e,t,n,a,i){return!!e&&(this._gl.uniform4i(e,t,n,a,i),!0)},e.prototype.setIntArray=function(e,t){return!!e&&(this._gl.uniform1iv(e,t),!0)},e.prototype.setIntArray2=function(e,t){return!(!e||t.length%2!=0||(this._gl.uniform2iv(e,t),0))},e.prototype.setIntArray3=function(e,t){return!(!e||t.length%3!=0||(this._gl.uniform3iv(e,t),0))},e.prototype.setIntArray4=function(e,t){return!(!e||t.length%4!=0||(this._gl.uniform4iv(e,t),0))},e.prototype.setArray=function(e,t){return!(!e||t.length<1||(this._gl.uniform1fv(e,t),0))},e.prototype.setArray2=function(e,t){return!(!e||t.length%2!=0||(this._gl.uniform2fv(e,t),0))},e.prototype.setArray3=function(e,t){return!(!e||t.length%3!=0||(this._gl.uniform3fv(e,t),0))},e.prototype.setArray4=function(e,t){return!(!e||t.length%4!=0||(this._gl.uniform4fv(e,t),0))},e.prototype.setMatrices=function(e,t){return!!e&&(this._gl.uniformMatrix4fv(e,!1,t),!0)},e.prototype.setMatrix3x3=function(e,t){return!!e&&(this._gl.uniformMatrix3fv(e,!1,t),!0)},e.prototype.setMatrix2x2=function(e,t){return!!e&&(this._gl.uniformMatrix2fv(e,!1,t),!0)},e.prototype.setFloat=function(e,t){return!!e&&(this._gl.uniform1f(e,t),!0)},e.prototype.setFloat2=function(e,t,n){return!!e&&(this._gl.uniform2f(e,t,n),!0)},e.prototype.setFloat3=function(e,t,n,a){return!!e&&(this._gl.uniform3f(e,t,n,a),!0)},e.prototype.setFloat4=function(e,t,n,a,i){return!!e&&(this._gl.uniform4f(e,t,n,a,i),!0)},e.prototype.applyStates=function(){if(this._depthCullingState.apply(this._gl),this._stencilStateComposer.apply(this._gl),this._alphaState.apply(this._gl),this._colorWriteChanged){this._colorWriteChanged=!1;var e=this._colorWrite;this._gl.colorMask(e,e,e,e)}},e.prototype.setColorWrite=function(e){e!==this._colorWrite&&(this._colorWriteChanged=!0,this._colorWrite=e)},e.prototype.getColorWrite=function(){return this._colorWrite},Object.defineProperty(e.prototype,"depthCullingState",{get:function(){return this._depthCullingState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alphaState",{get:function(){return this._alphaState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilState",{get:function(){return this._stencilState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilStateComposer",{get:function(){return this._stencilStateComposer},enumerable:!1,configurable:!0}),e.prototype.clearInternalTexturesCache=function(){this._internalTexturesCache=[]},e.prototype.wipeCaches=function(e){this.preventCacheWipeBetweenFrames&&!e||(this._currentEffect=null,this._viewportCached.x=0,this._viewportCached.y=0,this._viewportCached.z=0,this._viewportCached.w=0,this._unbindVertexArrayObject(),e&&(this._currentProgram=null,this.resetTextureCache(),this._stencilStateComposer.reset(),this._depthCullingState.reset(),this._depthCullingState.depthFunc=this._gl.LEQUAL,this._alphaState.reset(),this._alphaMode=1,this._alphaEquation=0,this._colorWrite=!0,this._colorWriteChanged=!0,this._unpackFlipYCached=null,this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),this._mustWipeVertexAttributes=!0,this.unbindAllAttributes()),this._resetVertexBufferBinding(),this._cachedIndexBuffer=null,this._cachedEffectForVertexBuffers=null,this.bindIndexBuffer(null))},e.prototype._getSamplingParameters=function(e,t){var n=this._gl,a=n.NEAREST,i=n.NEAREST;switch(e){case 11:a=n.LINEAR,i=t?n.LINEAR_MIPMAP_NEAREST:n.LINEAR;break;case 3:a=n.LINEAR,i=t?n.LINEAR_MIPMAP_LINEAR:n.LINEAR;break;case 8:a=n.NEAREST,i=t?n.NEAREST_MIPMAP_LINEAR:n.NEAREST;break;case 4:a=n.NEAREST,i=t?n.NEAREST_MIPMAP_NEAREST:n.NEAREST;break;case 5:a=n.NEAREST,i=t?n.LINEAR_MIPMAP_NEAREST:n.LINEAR;break;case 6:a=n.NEAREST,i=t?n.LINEAR_MIPMAP_LINEAR:n.LINEAR;break;case 7:a=n.NEAREST,i=n.LINEAR;break;case 1:a=n.NEAREST,i=n.NEAREST;break;case 9:a=n.LINEAR,i=t?n.NEAREST_MIPMAP_NEAREST:n.NEAREST;break;case 10:a=n.LINEAR,i=t?n.NEAREST_MIPMAP_LINEAR:n.NEAREST;break;case 2:a=n.LINEAR,i=n.LINEAR;break;case 12:a=n.LINEAR,i=n.NEAREST}return{min:i,mag:a}},e.prototype._createTexture=function(){var e=this._gl.createTexture();if(!e)throw new Error("Unable to create texture");return e},e.prototype._createHardwareTexture=function(){return new Hp(this._createTexture(),this._gl)},e.prototype._createInternalTexture=function(e,t,n,a){void 0===n&&(n=!0),void 0===a&&(a=Ip.Unknown);var i={};void 0!==t&&"object"==typeof t?(i.generateMipMaps=t.generateMipMaps,i.type=void 0===t.type?0:t.type,i.samplingMode=void 0===t.samplingMode?3:t.samplingMode,i.format=void 0===t.format?5:t.format):(i.generateMipMaps=t,i.type=0,i.samplingMode=3,i.format=5),(1!==i.type||this._caps.textureFloatLinearFiltering)&&(2!==i.type||this._caps.textureHalfFloatLinearFiltering)||(i.samplingMode=1),1!==i.type||this._caps.textureFloat||(i.type=0,ap.Warn("Float textures are not supported. Type forced to TEXTURETYPE_UNSIGNED_BYTE"));var r=this._gl,o=new kp(this,a),s=e.width||e,c=e.height||e,d=e.layers||0,l=this._getSamplingParameters(i.samplingMode,!!i.generateMipMaps),u=0!==d?r.TEXTURE_2D_ARRAY:r.TEXTURE_2D,f=this._getRGBABufferInternalSizedFormat(i.type,i.format),p=this._getInternalFormat(i.format),m=this._getWebGLTextureType(i.type);return this._bindTextureDirectly(u,o),0!==d?(o.is2DArray=!0,r.texImage3D(u,0,f,s,c,d,0,p,m,null)):r.texImage2D(u,0,f,s,c,0,p,m,null),r.texParameteri(u,r.TEXTURE_MAG_FILTER,l.mag),r.texParameteri(u,r.TEXTURE_MIN_FILTER,l.min),r.texParameteri(u,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(u,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),i.generateMipMaps&&this._gl.generateMipmap(u),this._bindTextureDirectly(u,null),o.baseWidth=s,o.baseHeight=c,o.width=s,o.height=c,o.depth=d,o.isReady=!0,o.samples=1,o.generateMipMaps=!!i.generateMipMaps,o.samplingMode=i.samplingMode,o.type=i.type,o.format=i.format,this._internalTexturesCache.push(o),o},e.prototype._getUseSRGBBuffer=function(e,t){return e&&this._caps.supportSRGBBuffers&&(this.webGLVersion>1||this.isWebGPU||t)},e.prototype._createTextureBase=function(t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h){var b=this;void 0===r&&(r=3),void 0===o&&(o=null),void 0===s&&(s=null),void 0===l&&(l=null),void 0===u&&(u=null),void 0===f&&(f=null),void 0===p&&(p=null);var g="data:"===(t=t||"").substr(0,5),v="blob:"===t.substr(0,5),y=g&&-1!==t.indexOf(";base64,"),S=u||new kp(this,Ip.Url),D=t;!this._transformTextureUrl||y||u||l||(t=this._transformTextureUrl(t)),D!==t&&(S._originalUrl=D);var I=t.lastIndexOf("."),x=p||(I>-1?t.substring(I).toLowerCase():""),C=null;x.indexOf("?")>-1&&(x=x.split("?")[0]);for(var O=0,w=e._TextureLoaders;O<w.length;O++){var E=w[O];if(E.canLoad(x,m)){C=E;break}}i&&i._addPendingData(S),S.url=t,S.generateMipMaps=!n,S.samplingMode=r,S.invertY=a,S._useSRGBBuffer=this._getUseSRGBBuffer(!!h,n),this._doNotHandleContextLost||(S._buffer=l);var A=null;o&&!u&&(A=S.onLoadedObservable.add(o)),u||this._internalTexturesCache.push(S);var L=function(e,a){i&&i._removePendingData(S),t===D?(A&&S.onLoadedObservable.remove(A),Op.UseFallbackTexture&&b._createTextureBase(Op.FallbackTexture,n,S.invertY,i,r,null,s,c,d,l,S),e=(e||"Unknown error")+(Op.UseFallbackTexture?" - Fallback texture was used":""),S.onErrorObservable.notifyObservers({message:e,exception:a}),s&&s(e,a)):(ap.Warn("Failed to load ".concat(t,", falling back to ").concat(D)),b._createTextureBase(D,n,S.invertY,i,r,o,s,c,d,l,S,f,p,m,_,h))};if(C){var k=function(e){C.loadData(e,S,function(e,t,n,a,o,s){s?L("TextureLoader failed to load data"):c(S,x,i,{width:e,height:t},S.invertY,!n,a,function(){return o(),!1},r)},_)};l?l instanceof ArrayBuffer?k(new Uint8Array(l)):ArrayBuffer.isView(l)?k(l):s&&s("Unable to load: only ArrayBuffer or ArrayBufferView is supported",null):this._loadFile(t,function(e){return k(new Uint8Array(e))},void 0,i?i.offlineProvider:void 0,!0,function(e,t){L("Unable to load "+(e&&e.responseURL,t))})}else{var M=function(e){v&&!b._doNotHandleContextLost&&(S._buffer=e),c(S,x,i,e,S.invertY,n,!1,d,r)};!g||y?l&&("string"==typeof l.decoding||l.close)?M(l):e._FileToolsLoadImage(t,M,L,i?i.offlineProvider:null,m,S.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0):"string"==typeof l||l instanceof ArrayBuffer||ArrayBuffer.isView(l)||l instanceof Blob?e._FileToolsLoadImage(l,M,L,i?i.offlineProvider:null,m,S.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0):l&&M(l)}return S},e.prototype.createTexture=function(e,t,n,a,i,r,o,s,c,d,l,u,f,p,m){var _=this;return void 0===i&&(i=3),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),void 0===c&&(c=null),void 0===d&&(d=null),void 0===l&&(l=null),this._createTextureBase(e,t,n,a,i,r,o,this._prepareWebGLTexture.bind(this),function(e,t,n,i,r,o){var s=_._gl,c=n.width===e&&n.height===t,l=d?_._getInternalFormat(d,r._useSRGBBuffer):".jpg"!==i||r._useSRGBBuffer?r._useSRGBBuffer?s.SRGB8_ALPHA8:s.RGBA:s.RGB,u=d?_._getInternalFormat(d):".jpg"!==i||r._useSRGBBuffer?s.RGBA:s.RGB;if(r._useSRGBBuffer&&1===_.webGLVersion&&(u=l),c)return s.texImage2D(s.TEXTURE_2D,0,l,u,s.UNSIGNED_BYTE,n),!1;var f=_._caps.maxTextureSize;if(n.width>f||n.height>f||!_._supportsHardwareTextureRescaling)return _._prepareWorkingCanvas(),!(!_._workingCanvas||!_._workingContext||(_._workingCanvas.width=e,_._workingCanvas.height=t,_._workingContext.drawImage(n,0,0,n.width,n.height,0,0,e,t),s.texImage2D(s.TEXTURE_2D,0,l,u,s.UNSIGNED_BYTE,_._workingCanvas),r.width=e,r.height=t,1));var p=new kp(_,Ip.Temp);return _._bindTextureDirectly(s.TEXTURE_2D,p,!0),s.texImage2D(s.TEXTURE_2D,0,l,u,s.UNSIGNED_BYTE,n),_._rescaleTexture(p,r,a,l,function(){_._releaseTexture(p),_._bindTextureDirectly(s.TEXTURE_2D,r,!0),o()}),!0},s,c,d,l,u,f,m)},e._FileToolsLoadImage=function(e,t,n,a,i,r){throw _p("FileTools")},e.prototype._rescaleTexture=function(e,t,n,a,i){},e.prototype.createRawTexture=function(e,t,n,a,i,r,o,s,c){throw void 0===s&&(s=null),void 0===c&&(c=0),_p("Engine.RawTexture")},e.prototype.createRawCubeTexture=function(e,t,n,a,i,r,o,s){throw void 0===s&&(s=null),_p("Engine.RawTexture")},e.prototype.createRawTexture3D=function(e,t,n,a,i,r,o,s,c,d){throw void 0===c&&(c=null),void 0===d&&(d=0),_p("Engine.RawTexture")},e.prototype.createRawTexture2DArray=function(e,t,n,a,i,r,o,s,c,d){throw void 0===c&&(c=null),void 0===d&&(d=0),_p("Engine.RawTexture")},e.prototype._unpackFlipY=function(e){this._unpackFlipYCached!==e&&(this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,e?1:0),this.enableUnpackFlipYCached&&(this._unpackFlipYCached=e))},e.prototype._getUnpackAlignement=function(){return this._gl.getParameter(this._gl.UNPACK_ALIGNMENT)},e.prototype._getTextureTarget=function(e){return e.isCube?this._gl.TEXTURE_CUBE_MAP:e.is3D?this._gl.TEXTURE_3D:e.is2DArray||e.isMultiview?this._gl.TEXTURE_2D_ARRAY:this._gl.TEXTURE_2D},e.prototype.updateTextureSamplingMode=function(e,t,n){void 0===n&&(n=!1);var a=this._getTextureTarget(t),i=this._getSamplingParameters(e,t.generateMipMaps||n);this._setTextureParameterInteger(a,this._gl.TEXTURE_MAG_FILTER,i.mag,t),this._setTextureParameterInteger(a,this._gl.TEXTURE_MIN_FILTER,i.min),n&&(t.generateMipMaps=!0,this._gl.generateMipmap(a)),this._bindTextureDirectly(a,null),t.samplingMode=e},e.prototype.updateTextureDimensions=function(e,t,n,a){void 0===a&&(a=1)},e.prototype.updateTextureWrappingMode=function(e,t,n,a){void 0===n&&(n=null),void 0===a&&(a=null);var i=this._getTextureTarget(e);null!==t&&(this._setTextureParameterInteger(i,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(t),e),e._cachedWrapU=t),null!==n&&(this._setTextureParameterInteger(i,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(n),e),e._cachedWrapV=n),(e.is2DArray||e.is3D)&&null!==a&&(this._setTextureParameterInteger(i,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(a),e),e._cachedWrapR=a),this._bindTextureDirectly(i,null)},e.prototype._setupDepthStencilTexture=function(e,t,n,a,i,r){void 0===r&&(r=1);var o=t.width||t,s=t.height||t,c=t.layers||0;e.baseWidth=o,e.baseHeight=s,e.width=o,e.height=s,e.is2DArray=c>0,e.depth=c,e.isReady=!0,e.samples=r,e.generateMipMaps=!1,e.samplingMode=a?2:1,e.type=0,e._comparisonFunction=i;var d=this._gl,l=this._getTextureTarget(e),u=this._getSamplingParameters(e.samplingMode,!1);d.texParameteri(l,d.TEXTURE_MAG_FILTER,u.mag),d.texParameteri(l,d.TEXTURE_MIN_FILTER,u.min),d.texParameteri(l,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(l,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),0===i?(d.texParameteri(l,d.TEXTURE_COMPARE_FUNC,515),d.texParameteri(l,d.TEXTURE_COMPARE_MODE,d.NONE)):(d.texParameteri(l,d.TEXTURE_COMPARE_FUNC,i),d.texParameteri(l,d.TEXTURE_COMPARE_MODE,d.COMPARE_REF_TO_TEXTURE))},e.prototype._uploadCompressedDataToTextureDirectly=function(e,t,n,a,i,r,o){void 0===r&&(r=0),void 0===o&&(o=0);var s=this._gl,c=s.TEXTURE_2D;if(e.isCube&&(c=s.TEXTURE_CUBE_MAP_POSITIVE_X+r),e._useSRGBBuffer)switch(t){case 36492:t=s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT;break;case 37808:t=s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;break;case 33776:this._caps.s3tc_srgb?t=s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:e._useSRGBBuffer=!1;break;case 33779:this._caps.s3tc_srgb?t=s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:e._useSRGBBuffer=!1;break;default:e._useSRGBBuffer=!1}this._gl.compressedTexImage2D(c,o,t,n,a,0,i)},e.prototype._uploadDataToTextureDirectly=function(e,t,n,a,i,r){void 0===n&&(n=0),void 0===a&&(a=0),void 0===r&&(r=!1);var o=this._gl,s=this._getWebGLTextureType(e.type),c=this._getInternalFormat(e.format),d=void 0===i?this._getRGBABufferInternalSizedFormat(e.type,e.format,e._useSRGBBuffer):this._getInternalFormat(i,e._useSRGBBuffer);this._unpackFlipY(e.invertY);var l=o.TEXTURE_2D;e.isCube&&(l=o.TEXTURE_CUBE_MAP_POSITIVE_X+n);var u=Math.round(Math.log(e.width)*Math.LOG2E),f=Math.round(Math.log(e.height)*Math.LOG2E),p=r?e.width:Math.pow(2,Math.max(u-a,0)),m=r?e.height:Math.pow(2,Math.max(f-a,0));o.texImage2D(l,a,d,p,m,0,c,s,t)},e.prototype.updateTextureData=function(e,t,n,a,i,r,o,s,c){void 0===o&&(o=0),void 0===s&&(s=0),void 0===c&&(c=!1);var d=this._gl,l=this._getWebGLTextureType(e.type),u=this._getInternalFormat(e.format);this._unpackFlipY(e.invertY);var f=d.TEXTURE_2D;e.isCube&&(f=d.TEXTURE_CUBE_MAP_POSITIVE_X+o),this._bindTextureDirectly(f,e,!0),d.texSubImage2D(f,s,n,a,i,r,u,l,t),c&&this._gl.generateMipmap(f),this._bindTextureDirectly(f,null)},e.prototype._uploadArrayBufferViewToTexture=function(e,t,n,a){void 0===n&&(n=0),void 0===a&&(a=0);var i=this._gl,r=e.isCube?i.TEXTURE_CUBE_MAP:i.TEXTURE_2D;this._bindTextureDirectly(r,e,!0),this._uploadDataToTextureDirectly(e,t,n,a),this._bindTextureDirectly(r,null,!0)},e.prototype._prepareWebGLTextureContinuation=function(e,t,n,a,i){var r=this._gl;if(r){var o=this._getSamplingParameters(i,!n);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,o.mag),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,o.min),n||a||r.generateMipmap(r.TEXTURE_2D),this._bindTextureDirectly(r.TEXTURE_2D,null),t&&t._removePendingData(e),e.onLoadedObservable.notifyObservers(e),e.onLoadedObservable.clear()}},e.prototype._prepareWebGLTexture=function(t,n,a,i,r,o,s,c,d){var l=this;void 0===d&&(d=3);var u=this.getCaps().maxTextureSize,f=Math.min(u,this.needPOTTextures?e.GetExponentOfTwo(i.width,u):i.width),p=Math.min(u,this.needPOTTextures?e.GetExponentOfTwo(i.height,u):i.height),m=this._gl;m&&(t._hardwareTexture?(this._bindTextureDirectly(m.TEXTURE_2D,t,!0),this._unpackFlipY(void 0===r||!!r),t.baseWidth=i.width,t.baseHeight=i.height,t.width=f,t.height=p,t.isReady=!0,c(f,p,i,n,t,function(){l._prepareWebGLTextureContinuation(t,a,o,s,d)})||this._prepareWebGLTextureContinuation(t,a,o,s,d)):a&&a._removePendingData(t))},e.prototype._setupFramebufferDepthAttachments=function(e,t,n,a,i){void 0===i&&(i=1);var r=this._gl;if(e&&t)return this._createRenderBuffer(n,a,i,r.DEPTH_STENCIL,r.DEPTH24_STENCIL8,r.DEPTH_STENCIL_ATTACHMENT);if(t){var o=r.DEPTH_COMPONENT16;return this._webGLVersion>1&&(o=r.DEPTH_COMPONENT32F),this._createRenderBuffer(n,a,i,o,o,r.DEPTH_ATTACHMENT)}return e?this._createRenderBuffer(n,a,i,r.STENCIL_INDEX8,r.STENCIL_INDEX8,r.STENCIL_ATTACHMENT):null},e.prototype._createRenderBuffer=function(e,t,n,a,i,r,o){void 0===o&&(o=!0);var s=this._gl,c=s.createRenderbuffer();return s.bindRenderbuffer(s.RENDERBUFFER,c),n>1&&s.renderbufferStorageMultisample?s.renderbufferStorageMultisample(s.RENDERBUFFER,n,i,e,t):s.renderbufferStorage(s.RENDERBUFFER,a,e,t),s.framebufferRenderbuffer(s.FRAMEBUFFER,r,s.RENDERBUFFER,c),o&&s.bindRenderbuffer(s.RENDERBUFFER,null),c},e.prototype._releaseTexture=function(e){var t;this._deleteTexture(null===(t=e._hardwareTexture)||void 0===t?void 0:t.underlyingResource),this.unbindAllTextures();var n=this._internalTexturesCache.indexOf(e);-1!==n&&this._internalTexturesCache.splice(n,1),e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureLow&&e._lodTextureLow.dispose(),e._irradianceTexture&&e._irradianceTexture.dispose()},e.prototype._releaseRenderTargetWrapper=function(e){var t=this._renderTargetWrapperCache.indexOf(e);-1!==t&&this._renderTargetWrapperCache.splice(t,1)},e.prototype._deleteTexture=function(e){e&&this._gl.deleteTexture(e)},e.prototype._setProgram=function(e){this._currentProgram!==e&&(this._gl.useProgram(e),this._currentProgram=e)},e.prototype.bindSamplers=function(e){var t=e.getPipelineContext();this._setProgram(t.program);for(var n=e.getSamplers(),a=0;a<n.length;a++){var i=e.getUniform(n[a]);i&&(this._boundUniforms[a]=i)}this._currentEffect=null},e.prototype._activateCurrentTexture=function(){this._currentTextureChannel!==this._activeChannel&&(this._gl.activeTexture(this._gl.TEXTURE0+this._activeChannel),this._currentTextureChannel=this._activeChannel)},e.prototype._bindTextureDirectly=function(e,t,n,a){var i,r;void 0===n&&(n=!1),void 0===a&&(a=!1);var o=!1,s=t&&t._associatedChannel>-1;if(n&&s&&(this._activeChannel=t._associatedChannel),this._boundTexturesCache[this._activeChannel]!==t||a){if(this._activateCurrentTexture(),t&&t.isMultiview)throw console.error(e,t),"_bindTextureDirectly called with a multiview texture!";this._gl.bindTexture(e,null!==(r=null===(i=null==t?void 0:t._hardwareTexture)||void 0===i?void 0:i.underlyingResource)&&void 0!==r?r:null),this._boundTexturesCache[this._activeChannel]=t,t&&(t._associatedChannel=this._activeChannel)}else n&&(o=!0,this._activateCurrentTexture());return s&&!n&&this._bindSamplerUniformToChannel(t._associatedChannel,this._activeChannel),o},e.prototype._bindTexture=function(e,t,n){if(void 0!==e){t&&(t._associatedChannel=e),this._activeChannel=e;var a=t?this._getTextureTarget(t):this._gl.TEXTURE_2D;this._bindTextureDirectly(a,t)}},e.prototype.unbindAllTextures=function(){for(var e=0;e<this._maxSimultaneousTextures;e++)this._activeChannel=e,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))},e.prototype.setTexture=function(e,t,n,a){void 0!==e&&(t&&(this._boundUniforms[e]=t),this._setTexture(e,n))},e.prototype._bindSamplerUniformToChannel=function(e,t){var n=this._boundUniforms[e];n&&n._currentState!==t&&(this._gl.uniform1i(n,t),n._currentState=t)},e.prototype._getTextureWrapMode=function(e){switch(e){case 1:return this._gl.REPEAT;case 0:return this._gl.CLAMP_TO_EDGE;case 2:return this._gl.MIRRORED_REPEAT}return this._gl.REPEAT},e.prototype._setTexture=function(e,t,n,a,i){if(void 0===n&&(n=!1),void 0===a&&(a=!1),void 0===i&&(i=""),!t)return null!=this._boundTexturesCache[e]&&(this._activeChannel=e,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))),!1;if(t.video)this._activeChannel=e,t.update();else if(4===t.delayLoadState)return t.delayLoad(),!1;var r;r=a?t.depthStencilTexture:t.isReady()?t.getInternalTexture():t.isCube?this.emptyCubeTexture:t.is3D?this.emptyTexture3D:t.is2DArray?this.emptyTexture2DArray:this.emptyTexture,!n&&r&&(r._associatedChannel=e);var o=!0;this._boundTexturesCache[e]===r&&(n||this._bindSamplerUniformToChannel(r._associatedChannel,e),o=!1),this._activeChannel=e;var s=this._getTextureTarget(r);if(o&&this._bindTextureDirectly(s,r,n),r&&!r.isMultiview){if(r.isCube&&r._cachedCoordinatesMode!==t.coordinatesMode){r._cachedCoordinatesMode=t.coordinatesMode;var c=3!==t.coordinatesMode&&5!==t.coordinatesMode?1:0;t.wrapU=c,t.wrapV=c}r._cachedWrapU!==t.wrapU&&(r._cachedWrapU=t.wrapU,this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(t.wrapU),r)),r._cachedWrapV!==t.wrapV&&(r._cachedWrapV=t.wrapV,this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(t.wrapV),r)),r.is3D&&r._cachedWrapR!==t.wrapR&&(r._cachedWrapR=t.wrapR,this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(t.wrapR),r)),this._setAnisotropicLevel(s,r,t.anisotropicFilteringLevel)}return!0},e.prototype.setTextureArray=function(e,t,n,a){if(void 0!==e&&t){this._textureUnits&&this._textureUnits.length===n.length||(this._textureUnits=new Int32Array(n.length));for(var i=0;i<n.length;i++){var r=n[i].getInternalTexture();r?(this._textureUnits[i]=e+i,r._associatedChannel=e+i):this._textureUnits[i]=-1}this._gl.uniform1iv(t,this._textureUnits);for(var o=0;o<n.length;o++)this._setTexture(this._textureUnits[o],n[o],!0)}},e.prototype._setAnisotropicLevel=function(e,t,n){var a=this._caps.textureAnisotropicFilterExtension;11!==t.samplingMode&&3!==t.samplingMode&&2!==t.samplingMode&&(n=1),a&&t._cachedAnisotropicFilteringLevel!==n&&(this._setTextureParameterFloat(e,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(n,this._caps.maxAnisotropy),t),t._cachedAnisotropicFilteringLevel=n)},e.prototype._setTextureParameterFloat=function(e,t,n,a){this._bindTextureDirectly(e,a,!0,!0),this._gl.texParameterf(e,t,n)},e.prototype._setTextureParameterInteger=function(e,t,n,a){a&&this._bindTextureDirectly(e,a,!0,!0),this._gl.texParameteri(e,t,n)},e.prototype.unbindAllAttributes=function(){if(this._mustWipeVertexAttributes){this._mustWipeVertexAttributes=!1;for(var e=0;e<this._caps.maxVertexAttribs;e++)this.disableAttributeByIndex(e)}else{e=0;for(var t=this._vertexAttribArraysEnabled.length;e<t;e++)e>=this._caps.maxVertexAttribs||!this._vertexAttribArraysEnabled[e]||this.disableAttributeByIndex(e)}},e.prototype.releaseEffects=function(){for(var e in this._compiledEffects){var t=this._compiledEffects[e].getPipelineContext();this._deletePipelineContext(t)}this._compiledEffects={}},e.prototype.dispose=function(){var e;this.stopRenderLoop(),this.onBeforeTextureInitObservable&&this.onBeforeTextureInitObservable.clear(),this._emptyTexture&&(this._releaseTexture(this._emptyTexture),this._emptyTexture=null),this._emptyCubeTexture&&(this._releaseTexture(this._emptyCubeTexture),this._emptyCubeTexture=null),this._dummyFramebuffer&&this._gl.deleteFramebuffer(this._dummyFramebuffer),this.releaseEffects(),null===(e=this.releaseComputeEffects)||void 0===e||e.call(this),this.unbindAllAttributes(),this._boundUniforms=[],Xf()&&this._renderingCanvas&&(this._doNotHandleContextLost||(this._renderingCanvas.removeEventListener("webglcontextlost",this._onContextLost),this._renderingCanvas.removeEventListener("webglcontextrestored",this._onContextRestored)),window.removeEventListener("resize",this._checkForMobile)),this._workingCanvas=null,this._workingContext=null,this._currentBufferPointers=[],this._renderingCanvas=null,this._currentProgram=null,this._boundRenderFunction=null,Sp.ResetCache();for(var t=0,n=this._activeRequests;t<n.length;t++)n[t].abort();this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear()},e.prototype.attachContextLostEvent=function(e){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextlost",e,!1)},e.prototype.attachContextRestoredEvent=function(e){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextrestored",e,!1)},e.prototype.getError=function(){return this._gl.getError()},e.prototype._canRenderToFloatFramebuffer=function(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(1)},e.prototype._canRenderToHalfFloatFramebuffer=function(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(2)},e.prototype._canRenderToFramebuffer=function(e){for(var t=this._gl;t.getError()!==t.NO_ERROR;);var n=!0,a=t.createTexture();t.bindTexture(t.TEXTURE_2D,a),t.texImage2D(t.TEXTURE_2D,0,this._getRGBABufferInternalSizedFormat(e),1,1,0,t.RGBA,this._getWebGLTextureType(e),null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST);var i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,a,0);var r=t.checkFramebufferStatus(t.FRAMEBUFFER);if((n=(n=n&&r===t.FRAMEBUFFER_COMPLETE)&&t.getError()===t.NO_ERROR)&&(t.clear(t.COLOR_BUFFER_BIT),n=n&&t.getError()===t.NO_ERROR),n){t.bindFramebuffer(t.FRAMEBUFFER,null);var o=t.RGBA,s=t.UNSIGNED_BYTE,c=new Uint8Array(4);t.readPixels(0,0,1,1,o,s,c),n=n&&t.getError()===t.NO_ERROR}for(t.deleteTexture(a),t.deleteFramebuffer(i),t.bindFramebuffer(t.FRAMEBUFFER,null);!n&&t.getError()!==t.NO_ERROR;);return n},e.prototype._getWebGLTextureType=function(e){if(1===this._webGLVersion){switch(e){case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT_OES;case 0:return this._gl.UNSIGNED_BYTE;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5}return this._gl.UNSIGNED_BYTE}switch(e){case 3:return this._gl.BYTE;case 0:return this._gl.UNSIGNED_BYTE;case 4:return this._gl.SHORT;case 5:return this._gl.UNSIGNED_SHORT;case 6:return this._gl.INT;case 7:return this._gl.UNSIGNED_INT;case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5;case 11:return this._gl.UNSIGNED_INT_2_10_10_10_REV;case 12:return this._gl.UNSIGNED_INT_24_8;case 13:return this._gl.UNSIGNED_INT_10F_11F_11F_REV;case 14:return this._gl.UNSIGNED_INT_5_9_9_9_REV;case 15:return this._gl.FLOAT_32_UNSIGNED_INT_24_8_REV}return this._gl.UNSIGNED_BYTE},e.prototype._getInternalFormat=function(e,t){void 0===t&&(t=!1);var n=t?this._gl.SRGB8_ALPHA8:this._gl.RGBA;switch(e){case 0:n=this._gl.ALPHA;break;case 1:n=this._gl.LUMINANCE;break;case 2:n=this._gl.LUMINANCE_ALPHA;break;case 6:n=this._gl.RED;break;case 7:n=this._gl.RG;break;case 4:n=t?this._gl.SRGB:this._gl.RGB;break;case 5:n=t?this._gl.SRGB8_ALPHA8:this._gl.RGBA}if(this._webGLVersion>1)switch(e){case 8:n=this._gl.RED_INTEGER;break;case 9:n=this._gl.RG_INTEGER;break;case 10:n=this._gl.RGB_INTEGER;break;case 11:n=this._gl.RGBA_INTEGER}return n},e.prototype._getRGBABufferInternalSizedFormat=function(e,t,n){if(void 0===n&&(n=!1),1===this._webGLVersion){if(void 0!==t)switch(t){case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;case 4:return n?this._gl.SRGB:this._gl.RGB}return this._gl.RGBA}switch(e){case 3:switch(t){case 6:return this._gl.R8_SNORM;case 7:return this._gl.RG8_SNORM;case 4:return this._gl.RGB8_SNORM;case 8:return this._gl.R8I;case 9:return this._gl.RG8I;case 10:return this._gl.RGB8I;case 11:return this._gl.RGBA8I;default:return this._gl.RGBA8_SNORM}case 0:switch(t){case 6:return this._gl.R8;case 7:return this._gl.RG8;case 4:return n?this._gl.SRGB8:this._gl.RGB8;case 5:return n?this._gl.SRGB8_ALPHA8:this._gl.RGBA8;case 8:return this._gl.R8UI;case 9:return this._gl.RG8UI;case 10:return this._gl.RGB8UI;case 11:return this._gl.RGBA8UI;case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;default:return this._gl.RGBA8}case 4:switch(t){case 8:return this._gl.R16I;case 9:return this._gl.RG16I;case 10:return this._gl.RGB16I;default:return this._gl.RGBA16I}case 5:switch(t){case 8:return this._gl.R16UI;case 9:return this._gl.RG16UI;case 10:return this._gl.RGB16UI;default:return this._gl.RGBA16UI}case 6:switch(t){case 8:return this._gl.R32I;case 9:return this._gl.RG32I;case 10:return this._gl.RGB32I;default:return this._gl.RGBA32I}case 7:switch(t){case 8:return this._gl.R32UI;case 9:return this._gl.RG32UI;case 10:return this._gl.RGB32UI;default:return this._gl.RGBA32UI}case 1:switch(t){case 6:return this._gl.R32F;case 7:return this._gl.RG32F;case 4:return this._gl.RGB32F;default:return this._gl.RGBA32F}case 2:switch(t){case 6:return this._gl.R16F;case 7:return this._gl.RG16F;case 4:return this._gl.RGB16F;default:return this._gl.RGBA16F}case 10:return this._gl.RGB565;case 13:return this._gl.R11F_G11F_B10F;case 14:return this._gl.RGB9_E5;case 8:return this._gl.RGBA4;case 9:return this._gl.RGB5_A1;case 11:return 11===t?this._gl.RGB10_A2UI:this._gl.RGB10_A2}return n?this._gl.SRGB8_ALPHA8:this._gl.RGBA8},e.prototype._getRGBAMultiSampleBufferFormat=function(e){return 1===e?this._gl.RGBA32F:2===e?this._gl.RGBA16F:this._gl.RGBA8},e.prototype._loadFile=function(t,n,a,i,r,o){var s=this,c=e._FileToolsLoadFile(t,n,a,i,r,o);return this._activeRequests.push(c),c.onCompleteObservable.add(function(e){s._activeRequests.splice(s._activeRequests.indexOf(e),1)}),c},e._FileToolsLoadFile=function(e,t,n,a,i,r){throw _p("FileTools")},e.prototype.readPixels=function(e,t,n,a,i,r){void 0===i&&(i=!0),void 0===r&&(r=!0);var o=i?4:3,s=i?this._gl.RGBA:this._gl.RGB,c=new Uint8Array(a*n*o);return r&&this.flushFramebuffer(),this._gl.readPixels(e,t,n,a,s,this._gl.UNSIGNED_BYTE,c),Promise.resolve(c)},Object.defineProperty(e,"IsSupportedAsync",{get:function(){return Promise.resolve(this.isSupported())},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IsSupported",{get:function(){return this.isSupported()},enumerable:!1,configurable:!0}),e.isSupported=function(){if(null!==this._HasMajorPerformanceCaveat)return!this._HasMajorPerformanceCaveat;if(null===this._IsSupported)try{var e=this._CreateCanvas(1,1),t=e.getContext("webgl")||e.getContext("experimental-webgl");this._IsSupported=null!=t&&!!window.WebGLRenderingContext}catch(e){this._IsSupported=!1}return this._IsSupported},Object.defineProperty(e,"HasMajorPerformanceCaveat",{get:function(){if(null===this._HasMajorPerformanceCaveat)try{var e=this._CreateCanvas(1,1),t=e.getContext("webgl",{failIfMajorPerformanceCaveat:!0})||e.getContext("experimental-webgl",{failIfMajorPerformanceCaveat:!0});this._HasMajorPerformanceCaveat=!t}catch(e){this._HasMajorPerformanceCaveat=!1}return this._HasMajorPerformanceCaveat},enumerable:!1,configurable:!0}),e.CeilingPOT=function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},e.FloorPOT=function(e){return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)-(e>>1)},e.NearestPOT=function(t){var n=e.CeilingPOT(t),a=e.FloorPOT(t);return n-t>t-a?a:n},e.GetExponentOfTwo=function(t,n,a){var i;switch(void 0===a&&(a=2),a){case 1:i=e.FloorPOT(t);break;case 2:i=e.NearestPOT(t);break;default:i=e.CeilingPOT(t)}return Math.min(i,n)},e.QueueNewFrame=function(e,t){return Xf()?(t||(t=window),t.requestPostAnimationFrame?t.requestPostAnimationFrame(e):t.requestAnimationFrame?t.requestAnimationFrame(e):t.msRequestAnimationFrame?t.msRequestAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitRequestAnimationFrame(e):t.mozRequestAnimationFrame?t.mozRequestAnimationFrame(e):t.oRequestAnimationFrame?t.oRequestAnimationFrame(e):window.setTimeout(e,16)):"undefined"!=typeof requestAnimationFrame?requestAnimationFrame(e):setTimeout(e,16)},e.prototype.getHostDocument=function(){return this._renderingCanvas&&this._renderingCanvas.ownerDocument?this._renderingCanvas.ownerDocument:document},e.ExceptionList=[{key:"Chrome/63.0",capture:"63\\.0\\.3239\\.(\\d+)",captureConstraint:108,targets:["uniformBuffer"]},{key:"Firefox/58",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Firefox/59",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Chrome/72.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/73.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/74.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/71",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/72",capture:null,captureConstraint:null,targets:["vao"]}],e._TextureLoaders=[],e.CollisionsEpsilon=.001,e._IsSupported=null,e._HasMajorPerformanceCaveat=null,e}(),jp=function(e,t){return e?e.getClassName&&"Mesh"===e.getClassName()?null:e.getClassName&&"SubMesh"===e.getClassName()?e.clone(t):e.clone?e.clone():null:null},Vp=function(){function e(){}return e.DeepCopy=function(e,t,n,a){for(var i=function(e){var t=[];do{Object.getOwnPropertyNames(e).forEach(function(e){-1===t.indexOf(e)&&t.push(e)})}while(e=Object.getPrototypeOf(e));return t}(e),r=0,o=i;r<o.length;r++){var s=o[r];if(("_"!==s[0]||a&&-1!==a.indexOf(s))&&(p="Observable",!(-1!==(f=s).indexOf(p,f.length-p.length)||n&&-1!==n.indexOf(s)))){var c=e[s],d=typeof c;if("function"!==d)try{if("object"===d)if(c instanceof Array){if(t[s]=[],c.length>0)if("object"==typeof c[0])for(var l=0;l<c.length;l++){var u=jp(c[l],t);-1===t[s].indexOf(u)&&t[s].push(u)}else t[s]=c.slice(0)}else t[s]=jp(c,t);else t[s]=c}catch(e){ap.Warn(e.message)}}}var f,p},e}(),zp=function(){function e(){}return Object.defineProperty(e,"Now",{get:function(){return np.IsWindowObjectExist()&&window.performance&&window.performance.now?window.performance.now():Date.now()},enumerable:!1,configurable:!0}),e}(),Gp=function(){function e(){this._xhr="undefined"!=typeof _native&&_native.XMLHttpRequest?new _native.XMLHttpRequest:new XMLHttpRequest}return e.prototype._injectCustomRequestHeaders=function(){for(var t in e.CustomRequestHeaders){var n=e.CustomRequestHeaders[t];n&&this._xhr.setRequestHeader(t,n)}},Object.defineProperty(e.prototype,"onprogress",{get:function(){return this._xhr.onprogress},set:function(e){this._xhr.onprogress=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this._xhr.readyState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._xhr.status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"statusText",{get:function(){return this._xhr.statusText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"response",{get:function(){return this._xhr.response},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"responseURL",{get:function(){return this._xhr.responseURL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"responseText",{get:function(){return this._xhr.responseText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"responseType",{get:function(){return this._xhr.responseType},set:function(e){this._xhr.responseType=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeout",{get:function(){return this._xhr.timeout},set:function(e){this._xhr.timeout=e},enumerable:!1,configurable:!0}),e.prototype.addEventListener=function(e,t,n){this._xhr.addEventListener(e,t,n)},e.prototype.removeEventListener=function(e,t,n){this._xhr.removeEventListener(e,t,n)},e.prototype.abort=function(){this._xhr.abort()},e.prototype.send=function(t){e.CustomRequestHeaders&&this._injectCustomRequestHeaders(),this._xhr.send(t)},e.prototype.open=function(t,n){for(var a=0,i=e.CustomRequestModifiers;a<i.length;a++)(0,i[a])(this._xhr,n);return n=(n=n.replace("file:http:","http:")).replace("file:https:","https:"),this._xhr.open(t,n,!0)},e.prototype.setRequestHeader=function(e,t){this._xhr.setRequestHeader(e,t)},e.prototype.getResponseHeader=function(e){return this._xhr.getResponseHeader(e)},e.CustomRequestHeaders={},e.CustomRequestModifiers=new Array,e}(),Kp=function(){function e(){}return e.FilesToLoad={},e}(),Wp=function(){function e(){}return e.ExponentialBackoff=function(e,t){return void 0===e&&(e=3),void 0===t&&(t=500),function(n,a,i){return 0!==a.status||i>=e||-1!==n.indexOf("file:")?-1:Math.pow(2,i)*t}},e}(),qp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t._setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t}(Error),Qp=function(e){function t(n,a,i){var r=e.call(this,n)||this;return r.errorCode=a,r.innerError=i,r.name="RuntimeError",qp._setPrototypeOf(r,t.prototype),r}return Object(r.__extends)(t,e),t}(qp),Yp=function(){function e(){}return e.SetImmediate=function(e){Xf()&&window.setImmediate?window.setImmediate(e):setTimeout(e,1)},e}(),Jp=new RegExp(/^data:([^,]+\/[^,]+)?;base64,/i),Xp=function(e){function t(n,a){var i=e.call(this,n,4e3)||this;return i.name="LoadFileError",qp._setPrototypeOf(i,t.prototype),a instanceof Gp?i.request=a:i.file=a,i}return Object(r.__extends)(t,e),t}(Qp),Zp=function(e){function t(n,a){var i=e.call(this,n,4001)||this;return i.request=a,i.name="RequestFileError",qp._setPrototypeOf(i,t.prototype),i}return Object(r.__extends)(t,e),t}(Qp),$p=function(e){function t(n,a){var i=e.call(this,n,4002)||this;return i.file=a,i.name="ReadFileError",qp._setPrototypeOf(i,t.prototype),i}return Object(r.__extends)(t,e),t}(Qp),em={DefaultRetryStrategy:Wp.ExponentialBackoff(),BaseUrl:"",CorsBehavior:"anonymous",PreprocessUrl:function(e){return e}},tm=function(e){return e.replace(/#/gm,"%23")},nm=function(e,t){if((!e||0!==e.indexOf("data:"))&&em.CorsBehavior)if("string"==typeof em.CorsBehavior||em.CorsBehavior instanceof String)t.crossOrigin=em.CorsBehavior;else{var n=em.CorsBehavior(e);n&&(t.crossOrigin=n)}},am=function(e,t,n,a,i,o){var s,c;void 0===i&&(i="");var d=!1;e instanceof ArrayBuffer||ArrayBuffer.isView(e)?"undefined"!=typeof Blob?(c=URL.createObjectURL(new Blob([e],{type:i})),d=!0):c="data:".concat(i,";base64,")+function(e){for(var t,n,a,i,r,o,s,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d="",l=0,u=ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e);l<u.length;)i=(t=u[l++])>>2,r=(3&t)<<4|(n=l<u.length?u[l++]:Number.NaN)>>4,o=(15&n)<<2|(a=l<u.length?u[l++]:Number.NaN)>>6,s=63&a,isNaN(n)?o=s=64:isNaN(a)&&(s=64),d+=c.charAt(i)+c.charAt(r)+c.charAt(o)+c.charAt(s);return d}(e):e instanceof Blob?(c=URL.createObjectURL(e),d=!0):(c=tm(e),c=em.PreprocessUrl(e));var l=Op.LastCreatedEngine,u=function(t){if(n){var a=c||e.toString();n("Error while trying to load image: ".concat(0===a.indexOf("http")||a.length<=128?a:a.slice(0,128)+"..."),t)}};if("undefined"==typeof Image||null!==(s=null==l?void 0:l._features.forceBitmapOverHTMLImageElement)&&void 0!==s&&s)return rm(c,function(a){l.createImageBitmap(new Blob([a],{type:i}),Object(r.__assign)({premultiplyAlpha:"none"},o)).then(function(e){t(e),d&&URL.revokeObjectURL(c)}).catch(function(t){n&&n("Error while trying to load image: "+e,t)})},void 0,a||void 0,!0,function(e,t){u(t)}),null;var f=new Image;nm(c,f);var p=function(){f.removeEventListener("load",p),f.removeEventListener("error",m),t(f),d&&f.src&&URL.revokeObjectURL(f.src)},m=function(e){f.removeEventListener("load",p),f.removeEventListener("error",m),u(e),d&&f.src&&URL.revokeObjectURL(f.src)};f.addEventListener("load",p),f.addEventListener("error",m);var _=function(){f.src=c};if("blob:"!==c.substr(0,5)&&"data:"!==c.substr(0,5)&&a&&a.enableTexturesOffline)a.open(function(){a&&a.loadImage(c,f)},_);else{if(-1!==c.indexOf("file:")){var h=decodeURIComponent(c.substring(5).toLowerCase());if(Kp.FilesToLoad[h]){try{var b=void 0;try{b=URL.createObjectURL(Kp.FilesToLoad[h])}catch(e){b=URL.createObjectURL(Kp.FilesToLoad[h])}f.src=b,d=!0}catch(e){f.src=""}return f}}_()}return f},im=function(e,t,n,a,i){var r=new FileReader,o={onCompleteObservable:new Jf,abort:function(){return r.abort()}};return r.onloadend=function(){return o.onCompleteObservable.notifyObservers(o)},i&&(r.onerror=function(){i(new $p("Unable to read ".concat(e.name),e))}),r.onload=function(e){t(e.target.result)},n&&(r.onprogress=n),a?r.readAsArrayBuffer(e):r.readAsText(e),o},rm=function(e,t,n,a,i,r,o){if(e.name)return im(e,t,n,i,r?function(e){r(void 0,e)}:void 0);var s=e;if(-1!==s.indexOf("file:")){var c=decodeURIComponent(s.substring(5).toLowerCase());0===c.indexOf("./")&&(c=c.substring(2));var d=Kp.FilesToLoad[c];if(d)return im(d,t,n,i,r?function(e){return r(void 0,new Xp(e.message,e.file))}:void 0)}if(cm(s)){var l={onCompleteObservable:new Jf,abort:function(){return function(){}}};try{t(i?dm(s):fm(s))}catch(e){r?r(void 0,e):ap.Error(e.message||"Failed to parse the Data URL")}return Yp.SetImmediate(function(){l.onCompleteObservable.notifyObservers(l)}),l}return om(s,function(e,n){t(e,n?n.responseURL:void 0)},n,a,i,r?function(e){r(e.request,new Xp(e.message,e.request))}:void 0,o)},om=function(e,t,n,a,i,r,o){e=tm(e),e=em.PreprocessUrl(e);var s=em.BaseUrl+e,c=!1,d={onCompleteObservable:new Jf,abort:function(){return c=!0}},l=function(){var e,a=new Gp,l=null,u=function(){a&&(n&&a.removeEventListener("progress",n),e&&a.removeEventListener("readystatechange",e),a.removeEventListener("loadend",f))},f=function(){u(),d.onCompleteObservable.notifyObservers(d),d.onCompleteObservable.clear(),n=void 0,e=null,f=null,r=void 0,o=void 0,t=void 0};d.abort=function(){c=!0,f&&f(),a&&a.readyState!==(XMLHttpRequest.DONE||4)&&a.abort(),null!==l&&(clearTimeout(l),l=null),a=null};var p=function(e){var t=e.message||"Unknown error";r&&a?r(new Zp(t,a)):ap.Error(t)},m=function(d){if(a){if(a.open("GET",s),o)try{o(a)}catch(e){return void p(e)}i&&(a.responseType="arraybuffer"),n&&a.addEventListener("progress",n),f&&a.addEventListener("loadend",f),e=function(){if(!c&&a&&a.readyState===(XMLHttpRequest.DONE||4)){if(e&&a.removeEventListener("readystatechange",e),a.status>=200&&a.status<300||0===a.status&&(!Xf()||sm())){try{t&&t(i?a.response:a.responseText,a)}catch(e){p(e)}return}var n=em.DefaultRetryStrategy;if(n){var o=n(s,a,d);if(-1!==o)return u(),a=new Gp,void(l=setTimeout(function(){return m(d+1)},o))}var f=new Zp("Error status: "+a.status+" "+a.statusText+" - Unable to load "+s,a);r&&r(f)}},a.addEventListener("readystatechange",e),a.send()}};m(0)};if(a&&a.enableSceneOffline){var u=function(e){e&&e.status>400?r&&r(e):l()};a.open(function(){a&&a.loadFile(em.BaseUrl+e,function(e){!c&&t&&t(e),d.onCompleteObservable.notifyObservers(d)},n?function(e){!c&&n&&n(e)}:void 0,u,i)},u)}else l();return d},sm=function(){return"undefined"!=typeof location&&"file:"===location.protocol},cm=function(e){return Jp.test(e)};function dm(e){return function(e){for(var t=rp(e),n=t.length,a=new Uint8Array(new ArrayBuffer(n)),i=0;i<n;i++)a[i]=t.charCodeAt(i);return a.buffer}(e.split(",")[1])}var lm,um,fm=function(e){return rp(e.split(",")[1])};Bp._FileToolsLoadImage=am,Bp._FileToolsLoadFile=rm,vp._FileToolsLoadFile=rm,function(e,t,n,a,i,r,o,s,c,d){lm={DecodeBase64UrlToBinary:e,DecodeBase64UrlToString:t,DefaultRetryStrategy:n.DefaultRetryStrategy,BaseUrl:n.BaseUrl,CorsBehavior:n.CorsBehavior,PreprocessUrl:n.PreprocessUrl,IsBase64DataUrl:a,IsFileURL:i,LoadFile:r,LoadImage:o,ReadFile:s,RequestFile:c,SetCorsBehavior:d},Object.defineProperty(lm,"DefaultRetryStrategy",{get:function(){return n.DefaultRetryStrategy},set:function(e){n.DefaultRetryStrategy=e}}),Object.defineProperty(lm,"BaseUrl",{get:function(){return n.BaseUrl},set:function(e){n.BaseUrl=e}}),Object.defineProperty(lm,"PreprocessUrl",{get:function(){return n.PreprocessUrl},set:function(e){n.PreprocessUrl=e}}),Object.defineProperty(lm,"CorsBehavior",{get:function(){return n.CorsBehavior},set:function(e){n.CorsBehavior=e}})}(dm,fm,em,cm,sm,rm,am,im,om,nm),function(e){e[e.Pending=0]="Pending",e[e.Fulfilled=1]="Fulfilled",e[e.Rejected=2]="Rejected"}(um||(um={}));var pm=function(){this.count=0,this.target=0,this.results=[]},mm=function(){function e(e){var t=this;if(this._state=um.Pending,this._children=new Array,this._rejectWasConsumed=!1,e)try{e(function(e){t._resolve(e)},function(e){t._reject(e)})}catch(e){this._reject(e)}}return Object.defineProperty(e.prototype,"_result",{get:function(){return this._resultValue},set:function(e){this._resultValue=e,this._parent&&void 0===this._parent._result&&(this._parent._result=e)},enumerable:!1,configurable:!0}),e.prototype.catch=function(e){return this.then(void 0,e)},e.prototype.then=function(t,n){var a=this,i=new e;return i._onFulfilled=t,i._onRejected=n,this._children.push(i),i._parent=this,this._state!==um.Pending&&setTimeout(function(){a._state===um.Fulfilled||a._rejectWasConsumed?i._resolve(a._result):i._reject(a._reason)}),i},e.prototype._moveChildren=function(e){var t,n=this;if((t=this._children).push.apply(t,e.splice(0,e.length)),this._children.forEach(function(e){e._parent=n}),this._state===um.Fulfilled)for(var a=0,i=this._children;a<i.length;a++)i[a]._resolve(this._result);else if(this._state===um.Rejected)for(var r=0,o=this._children;r<o.length;r++)o[r]._reject(this._reason)},e.prototype._resolve=function(e){try{this._state=um.Fulfilled;var t=null;if(this._onFulfilled&&(t=this._onFulfilled(e)),null!=t)if(void 0!==t._state){var n=t;n._parent=this,n._moveChildren(this._children),e=n._result}else e=t;this._result=e;for(var a=0,i=this._children;a<i.length;a++)i[a]._resolve(e);this._children.length=0,delete this._onFulfilled,delete this._onRejected}catch(e){this._reject(e,!0)}},e.prototype._reject=function(e,t){if(void 0===t&&(t=!1),this._state=um.Rejected,this._reason=e,this._onRejected&&!t)try{this._onRejected(e),this._rejectWasConsumed=!0}catch(t){e=t}for(var n=0,a=this._children;n<a.length;n++){var i=a[n];this._rejectWasConsumed?i._resolve(null):i._reject(e)}this._children.length=0,delete this._onFulfilled,delete this._onRejected},e.resolve=function(t){var n=new e;return n._resolve(t),n},e._RegisterForFulfillment=function(e,t,n){e.then(function(e){return t.results[n]=e,t.count++,t.count===t.target&&t.rootPromise._resolve(t.results),null},function(e){t.rootPromise._state!==um.Rejected&&t.rootPromise._reject(e)})},e.all=function(t){var n=new e,a=new pm;if(a.target=t.length,a.rootPromise=n,t.length)for(var i=0;i<t.length;i++)e._RegisterForFulfillment(t[i],a,i);else n._resolve([]);return n},e.race=function(t){var n=new e;if(t.length)for(var a=0,i=t;a<i.length;a++)i[a].then(function(e){return n&&(n._resolve(e),n=null),null},function(e){n&&(n._reject(e),n=null)});return n},e}(),_m=function(){function e(){}return e.Apply=function(e){void 0===e&&(e=!1),(e||"undefined"==typeof Promise)&&(window.Promise=mm)},e}(),hm={},bm=function(){function e(){}return e.Instantiate=function(e){if(this.RegisteredExternalClasses&&this.RegisteredExternalClasses[e])return this.RegisteredExternalClasses[e];var t=hm[e];if(t)return t;ap.Warn(e+" not found, you may have missed an import.");for(var n=e.split("."),a=window||this,i=0,r=n.length;i<r;i++)a=a[n[i]];return"function"!=typeof a?null:a},e.RegisteredExternalClasses={},e}(),gm=function(){function e(){}return Object.defineProperty(e,"BaseUrl",{get:function(){return em.BaseUrl},set:function(e){em.BaseUrl=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DefaultRetryStrategy",{get:function(){return em.DefaultRetryStrategy},set:function(e){em.DefaultRetryStrategy=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"CorsBehavior",{get:function(){return em.CorsBehavior},set:function(e){em.CorsBehavior=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"UseFallbackTexture",{get:function(){return Op.UseFallbackTexture},set:function(e){Op.UseFallbackTexture=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"RegisteredExternalClasses",{get:function(){return bm.RegisteredExternalClasses},set:function(e){bm.RegisteredExternalClasses=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"fallbackTexture",{get:function(){return Op.FallbackTexture},set:function(e){Op.FallbackTexture=e},enumerable:!1,configurable:!0}),e.FetchToRef=function(e,t,n,a,i,r){var o=4*((Math.abs(e)*n%n|0)+(Math.abs(t)*a%a|0)*n);r.r=i[o]/255,r.g=i[o+1]/255,r.b=i[o+2]/255,r.a=i[o+3]/255},e.Mix=function(e,t,n){return e*(1-n)+t*n},e.Instantiate=function(e){return bm.Instantiate(e)},e.Slice=function(e,t,n){return Gf.Slice(e,t,n)},e.SliceToArray=function(e,t,n){return Gf.SliceToArray(e,t,n)},e.SetImmediate=function(e){Yp.SetImmediate(e)},e.IsExponentOfTwo=function(e){var t=1;do{t*=2}while(t<e);return t===e},e.FloatRound=function(t){return Math.fround?Math.fround(t):(e._TmpFloatArray[0]=t,e._TmpFloatArray[0])},e.GetFilename=function(e){var t=e.lastIndexOf("/");return t<0?e:e.substring(t+1)},e.GetFolderPath=function(e,t){void 0===t&&(t=!1);var n=e.lastIndexOf("/");return n<0?t?e:"":e.substring(0,n+1)},e.ToDegrees=function(e){return 180*e/Math.PI},e.ToRadians=function(e){return e*Math.PI/180},e.MakeArray=function(e,t){return!0===t||void 0!==e&&null!=e?Array.isArray(e)?e:[e]:null},e.GetPointerPrefix=function(e){var t="pointer";return Xf()&&!window.PointerEvent&&(t="mouse"),!e._badDesktopOS||e._badOS||document&&"ontouchend"in document||(t="mouse"),t},e.SetCorsBehavior=function(e,t){nm(e,t)},e.CleanUrl=function(e){return e.replace(/#/gm,"%23")},Object.defineProperty(e,"PreprocessUrl",{get:function(){return em.PreprocessUrl},set:function(e){em.PreprocessUrl=e},enumerable:!1,configurable:!0}),e.LoadImage=function(e,t,n,a,i,r){return am(e,t,n,a,i,r)},e.LoadFile=function(e,t,n,a,i,r){return rm(e,t,n,a,i,r)},e.LoadFileAsync=function(e,t){return void 0===t&&(t=!0),new Promise(function(n,a){rm(e,function(e){n(e)},void 0,void 0,t,function(e,t){a(t)})})},e.LoadScript=function(e,t,n,a){if(Xf()){var i=document.getElementsByTagName("head")[0],r=document.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("src",e),a&&(r.id=a),r.onload=function(){t&&t()},r.onerror=function(t){n&&n("Unable to load script '".concat(e,"'"),t)},i.appendChild(r)}},e.LoadScriptAsync=function(e){var t=this;return new Promise(function(n,a){t.LoadScript(e,function(){n()},function(e,t){a(t)})})},e.ReadFileAsDataURL=function(e,t,n){var a=new FileReader,i={onCompleteObservable:new Jf,abort:function(){return a.abort()}};return a.onloadend=function(){i.onCompleteObservable.notifyObservers(i)},a.onload=function(e){t(e.target.result)},a.onprogress=n,a.readAsDataURL(e),i},e.ReadFile=function(e,t,n,a,i){return im(e,t,n,a,i)},e.FileAsURL=function(e){var t=new Blob([e]);return(window.URL||window.webkitURL).createObjectURL(t)},e.Format=function(e,t){return void 0===t&&(t=2),e.toFixed(t)},e.DeepCopy=function(e,t,n,a){Vp.DeepCopy(e,t,n,a)},e.IsEmpty=function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},e.RegisterTopRootEvents=function(e,t){for(var n=0;n<t.length;n++){var a=t[n];e.addEventListener(a.name,a.handler,!1);try{window.parent&&window.parent.addEventListener(a.name,a.handler,!1)}catch(e){}}},e.UnregisterTopRootEvents=function(e,t){for(var n=0;n<t.length;n++){var a=t[n];e.removeEventListener(a.name,a.handler);try{e.parent&&e.parent.removeEventListener(a.name,a.handler)}catch(e){}}},e.DumpFramebuffer=function(t,n,a,i,o,s){return void 0===o&&(o="image/png"),Object(r.__awaiter)(this,void 0,void 0,function(){var c,d;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,a.readPixels(0,0,t,n)];case 1:return c=r.sent(),d=new Uint8Array(c.buffer),e.DumpData(t,n,d,i,o,s,!0),[2]}})})},e.DumpData=function(t,n,a,i,r,o,s,c,d){void 0===r&&(r="image/png"),void 0===s&&(s=!1),void 0===c&&(c=!1),e._ScreenshotCanvas||(e._ScreenshotCanvas=document.createElement("canvas")),e._ScreenshotCanvas.width=t,e._ScreenshotCanvas.height=n;var l=e._ScreenshotCanvas.getContext("2d");if(l){if(a instanceof Float32Array){for(var u=new Uint8Array(a.length),f=a.length;f--;){var p=a[f];u[f]=p<0?0:p>1?1:Math.round(255*p)}a=u}var m=l.createImageData(t,n);m.data.set(a),l.putImageData(m,0,0);var _=e._ScreenshotCanvas;if(s){var h=document.createElement("canvas");h.width=t,h.height=n;var b=h.getContext("2d");if(!b)return;b.translate(0,n),b.scale(1,-1),b.drawImage(e._ScreenshotCanvas,0,0),_=h}c?e.ToBlob(_,function(e){var t=new FileReader;t.onload=function(e){var t=e.target.result;i&&i(t)},t.readAsArrayBuffer(e)},r,d):e.EncodeScreenshotCanvasData(i,r,o,_,d)}},e.DumpDataAsync=function(t,n,a,i,r,o,s,c){return void 0===i&&(i="image/png"),void 0===o&&(o=!1),void 0===s&&(s=!1),new Promise(function(d){e.DumpData(t,n,a,function(e){return d(e)},i,r,o,s,c)})},e.ToBlob=function(e,t,n,a){void 0===n&&(n="image/png"),e.toBlob||(e.toBlob=function(e,t,n){var a=this;setTimeout(function(){for(var i=atob(a.toDataURL(t,n).split(",")[1]),r=i.length,o=new Uint8Array(r),s=0;s<r;s++)o[s]=i.charCodeAt(s);e(new Blob([o]))})}),e.toBlob(function(e){t(e)},n,a)},e.EncodeScreenshotCanvasData=function(t,n,a,i,r){void 0===n&&(n="image/png"),t?t((null!=i?i:e._ScreenshotCanvas).toDataURL(n,r)):this.ToBlob(null!=i?i:e._ScreenshotCanvas,function(t){if("download"in document.createElement("a")){if(!a){var n=new Date,i=(n.getFullYear()+"-"+(n.getMonth()+1)).slice(2)+"-"+n.getDate()+"_"+n.getHours()+"-"+("0"+n.getMinutes()).slice(-2);a="screenshot_"+i+".png"}e.Download(t,a)}else if(t){var r=URL.createObjectURL(t),o=window.open("");if(!o)return;var s=o.document.createElement("img");s.onload=function(){URL.revokeObjectURL(r)},s.src=r,o.document.body.appendChild(s)}},n,r)},e.Download=function(e,t){if(navigator&&navigator.msSaveBlob)navigator.msSaveBlob(e,t);else{var n=window.URL.createObjectURL(e),a=document.createElement("a");document.body.appendChild(a),a.style.display="none",a.href=n,a.download=t,a.addEventListener("click",function(){a.parentElement&&a.parentElement.removeChild(a)}),a.click(),window.URL.revokeObjectURL(n)}},e.BackCompatCameraNoPreventDefault=function(e){return"boolean"==typeof e[0]?e[0]:"boolean"==typeof e[1]&&e[1]},e.CreateScreenshot=function(e,t,n,a,i){throw void 0===i&&(i="image/png"),_p("ScreenshotTools")},e.CreateScreenshotAsync=function(e,t,n,a){throw void 0===a&&(a="image/png"),_p("ScreenshotTools")},e.CreateScreenshotUsingRenderTarget=function(e,t,n,a,i,r,o,s){throw void 0===i&&(i="image/png"),void 0===r&&(r=1),void 0===o&&(o=!1),_p("ScreenshotTools")},e.CreateScreenshotUsingRenderTargetAsync=function(e,t,n,a,i,r,o){throw void 0===a&&(a="image/png"),void 0===i&&(i=1),void 0===r&&(r=!1),_p("ScreenshotTools")},e.RandomId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},e.IsBase64=function(e){return cm(e)},e.DecodeBase64=function(e){return dm(e)},Object.defineProperty(e,"errorsCount",{get:function(){return ap.errorsCount},enumerable:!1,configurable:!0}),e.Log=function(e){ap.Log(e)},e.Warn=function(e){ap.Warn(e)},e.Error=function(e){ap.Error(e)},Object.defineProperty(e,"LogCache",{get:function(){return ap.LogCache},enumerable:!1,configurable:!0}),e.ClearLogCache=function(){ap.ClearLogCache()},Object.defineProperty(e,"LogLevels",{set:function(e){ap.LogLevels=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"PerformanceLogLevel",{set:function(t){return(t&e.PerformanceUserMarkLogLevel)===e.PerformanceUserMarkLogLevel?(e.StartPerformanceCounter=e._StartUserMark,void(e.EndPerformanceCounter=e._EndUserMark)):(t&e.PerformanceConsoleLogLevel)===e.PerformanceConsoleLogLevel?(e.StartPerformanceCounter=e._StartPerformanceConsole,void(e.EndPerformanceCounter=e._EndPerformanceConsole)):(e.StartPerformanceCounter=e._StartPerformanceCounterDisabled,void(e.EndPerformanceCounter=e._EndPerformanceCounterDisabled))},enumerable:!1,configurable:!0}),e._StartPerformanceCounterDisabled=function(e,t){},e._EndPerformanceCounterDisabled=function(e,t){},e._StartUserMark=function(t,n){if(void 0===n&&(n=!0),!e._Performance){if(!Xf())return;e._Performance=window.performance}n&&e._Performance.mark&&e._Performance.mark(t+"-Begin")},e._EndUserMark=function(t,n){void 0===n&&(n=!0),n&&e._Performance.mark&&(e._Performance.mark(t+"-End"),e._Performance.measure(t,t+"-Begin",t+"-End"))},e._StartPerformanceConsole=function(t,n){void 0===n&&(n=!0),n&&(e._StartUserMark(t,n),console.time&&console.time(t))},e._EndPerformanceConsole=function(t,n){void 0===n&&(n=!0),n&&(e._EndUserMark(t,n),console.timeEnd(t))},Object.defineProperty(e,"Now",{get:function(){return zp.Now},enumerable:!1,configurable:!0}),e.GetClassName=function(e,t){void 0===t&&(t=!1);var n=null;return!t&&e.getClassName?n=e.getClassName():(e instanceof Object&&(n=(t?e:Object.getPrototypeOf(e)).constructor.__bjsclassName__),n||(n=typeof e)),n},e.First=function(e,t){for(var n=0,a=e;n<a.length;n++){var i=a[n];if(t(i))return i}return null},e.getFullClassName=function(e,t){void 0===t&&(t=!1);var n=null,a=null;if(!t&&e.getClassName)n=e.getClassName();else{if(e instanceof Object){var i=t?e:Object.getPrototypeOf(e);n=i.constructor.__bjsclassName__,a=i.constructor.__bjsmoduleName__}n||(n=typeof e)}return n?(null!=a?a+".":"")+n:null},e.DelayAsync=function(e){return new Promise(function(t){setTimeout(function(){t()},e)})},e.IsSafari=function(){return!!Zf()&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},e.UseCustomRequestHeaders=!1,e.CustomRequestHeaders=Gp.CustomRequestHeaders,e._TmpFloatArray=new Float32Array(1),e.GetDOMTextContent=ep,e.GetAbsoluteUrl="object"==typeof document?function(e){var t=document.createElement("a");return t.href=e,t.href}:"function"==typeof URL&&"object"==typeof location?function(e){return new URL(e,location.origin).href}:function(){throw new Error("Unable to get absolute URL. Override BABYLON.Tools.GetAbsoluteUrl to a custom implementation for the current context.")},e.NoneLogLevel=ap.NoneLogLevel,e.MessageLogLevel=ap.MessageLogLevel,e.WarningLogLevel=ap.WarningLogLevel,e.ErrorLogLevel=ap.ErrorLogLevel,e.AllLogLevel=ap.AllLogLevel,e.IsWindowObjectExist=Xf,e.PerformanceNoneLogLevel=0,e.PerformanceUserMarkLogLevel=1,e.PerformanceConsoleLogLevel=2,e.StartPerformanceCounter=e._StartPerformanceCounterDisabled,e.EndPerformanceCounter=e._EndPerformanceCounterDisabled,e}();function vm(e,t,n,a){var i,r=1;1===a?i=new Float32Array(t*n*4):2===a?(i=new Uint16Array(t*n*4),r=15360):i=7===a?new Uint32Array(t*n*4):new Uint8Array(t*n*4);for(var o=0;o<t;o++)for(var s=0;s<n;s++){var c=3*(s*t+o),d=4*(s*t+o);i[d+0]=e[c+0],i[d+1]=e[c+1],i[d+2]=e[c+2],i[d+3]=r}return i}function ym(e){return function(t,n,a,i,r,o,s,c,d,l){void 0===d&&(d=null),void 0===l&&(l=0);var u=e?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D_ARRAY,f=e?Ip.Raw3D:Ip.Raw2DArray,p=new kp(this,f);p.baseWidth=n,p.baseHeight=a,p.baseDepth=i,p.width=n,p.height=a,p.depth=i,p.format=r,p.type=l,p.generateMipMaps=o,p.samplingMode=c,e?p.is3D=!0:p.is2DArray=!0,this._doNotHandleContextLost||(p._bufferView=t),e?this.updateRawTexture3D(p,t,r,s,d,l):this.updateRawTexture2DArray(p,t,r,s,d,l),this._bindTextureDirectly(u,p,!0);var m=this._getSamplingParameters(c,o);return this._gl.texParameteri(u,this._gl.TEXTURE_MAG_FILTER,m.mag),this._gl.texParameteri(u,this._gl.TEXTURE_MIN_FILTER,m.min),o&&this._gl.generateMipmap(u),this._bindTextureDirectly(u,null),this._internalTexturesCache.push(p),p}}function Sm(e){return function(t,n,a,i,r,o){void 0===r&&(r=null),void 0===o&&(o=0);var s=e?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D_ARRAY,c=this._getWebGLTextureType(o),d=this._getInternalFormat(a),l=this._getRGBABufferInternalSizedFormat(o,a);this._bindTextureDirectly(s,t,!0),this._unpackFlipY(void 0===i||!!i),this._doNotHandleContextLost||(t._bufferView=n,t.format=a,t.invertY=i,t._compression=r),t.width%4!=0&&this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,1),r&&n?this._gl.compressedTexImage3D(s,0,this.getCaps().s3tc[r],t.width,t.height,t.depth,0,n):this._gl.texImage3D(s,0,l,t.width,t.height,t.depth,0,d,c,n),t.generateMipMaps&&this._gl.generateMipmap(s),this._bindTextureDirectly(s,null),t.isReady=!0}}!function(){function e(e,t,n,a){void 0===a&&(a=0),this.iterations=e,this.index=a-1,this._done=!1,this._fn=t,this._successCallback=n}e.prototype.executeNext=function(){this._done||(this.index+1<this.iterations?(++this.index,this._fn(this)):this.breakLoop())},e.prototype.breakLoop=function(){this._done=!0,this._successCallback()},e.Run=function(t,n,a,i){void 0===i&&(i=0);var r=new e(t,n,a,i);return r.executeNext(),r},e.SyncAsyncForLoop=function(t,n,a,i,r,o){return void 0===o&&(o=0),e.Run(Math.ceil(t/n),function(e){r&&r()?e.breakLoop():setTimeout(function(){for(var i=0;i<n;++i){var o=e.index*n+i;if(o>=t)break;if(a(o),r&&r()){e.breakLoop();break}}e.executeNext()},o)},i)}}(),Op.FallbackTexture="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z",_m.Apply(),Bp.prototype.updateRawTexture=function(e,t,n,a,i,r){if(void 0===i&&(i=null),void 0===r&&(r=0),e){var o=this._getRGBABufferInternalSizedFormat(r,n),s=this._getInternalFormat(n),c=this._getWebGLTextureType(r);this._bindTextureDirectly(this._gl.TEXTURE_2D,e,!0),this._unpackFlipY(void 0===a||!!a),this._doNotHandleContextLost||(e._bufferView=t,e.format=n,e.type=r,e.invertY=a,e._compression=i),e.width%4!=0&&this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,1),i&&t?this._gl.compressedTexImage2D(this._gl.TEXTURE_2D,0,this.getCaps().s3tc[i],e.width,e.height,0,t):this._gl.texImage2D(this._gl.TEXTURE_2D,0,o,e.width,e.height,0,s,c,t),e.generateMipMaps&&this._gl.generateMipmap(this._gl.TEXTURE_2D),this._bindTextureDirectly(this._gl.TEXTURE_2D,null),e.isReady=!0}},Bp.prototype.createRawTexture=function(e,t,n,a,i,r,o,s,c,d){void 0===s&&(s=null),void 0===c&&(c=0),void 0===d&&(d=0);var l=new kp(this,Ip.Raw);l.baseWidth=t,l.baseHeight=n,l.width=t,l.height=n,l.format=a,l.generateMipMaps=i,l.samplingMode=o,l.invertY=r,l._compression=s,l.type=c,this._doNotHandleContextLost||(l._bufferView=e),this.updateRawTexture(l,e,a,r,s,c),this._bindTextureDirectly(this._gl.TEXTURE_2D,l,!0);var u=this._getSamplingParameters(o,i);return this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,u.mag),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,u.min),i&&this._gl.generateMipmap(this._gl.TEXTURE_2D),this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._internalTexturesCache.push(l),l},Bp.prototype.createRawCubeTexture=function(e,t,n,a,i,r,o,s){void 0===s&&(s=null);var c=this._gl,d=new kp(this,Ip.CubeRaw);d.isCube=!0,d.format=n,d.type=a,this._doNotHandleContextLost||(d._bufferViewArray=e);var l=this._getWebGLTextureType(a),u=this._getInternalFormat(n);u===c.RGB&&(u=c.RGBA),l!==c.FLOAT||this._caps.textureFloatLinearFiltering?l!==this._gl.HALF_FLOAT_OES||this._caps.textureHalfFloatLinearFiltering?l!==c.FLOAT||this._caps.textureFloatRender?l!==c.HALF_FLOAT||this._caps.colorBufferFloat||(i=!1,ap.Warn("Render to half float textures is not supported. Mipmap generation forced to false.")):(i=!1,ap.Warn("Render to float textures is not supported. Mipmap generation forced to false.")):(i=!1,o=1,ap.Warn("Half float texture filtering is not supported. Mipmap generation and sampling mode are forced to false and TEXTURE_NEAREST_SAMPLINGMODE, respectively.")):(i=!1,o=1,ap.Warn("Float texture filtering is not supported. Mipmap generation and sampling mode are forced to false and TEXTURE_NEAREST_SAMPLINGMODE, respectively."));var f=t,p=f;d.width=f,d.height=p,!this.needPOTTextures||gm.IsExponentOfTwo(d.width)&&gm.IsExponentOfTwo(d.height)||(i=!1),e&&this.updateRawCubeTexture(d,e,n,a,r,s),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,d,!0),e&&i&&this._gl.generateMipmap(this._gl.TEXTURE_CUBE_MAP);var m=this._getSamplingParameters(o,i);return c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_MAG_FILTER,m.mag),c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_MIN_FILTER,m.min),c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),this._bindTextureDirectly(c.TEXTURE_CUBE_MAP,null),d.generateMipMaps=i,d.samplingMode=o,d},Bp.prototype.updateRawCubeTexture=function(e,t,n,a,i,r,o){void 0===r&&(r=null),void 0===o&&(o=0),e._bufferViewArray=t,e.format=n,e.type=a,e.invertY=i,e._compression=r;var s=this._gl,c=this._getWebGLTextureType(a),d=this._getInternalFormat(n),l=this._getRGBABufferInternalSizedFormat(a),u=!1;d===s.RGB&&(d=s.RGBA,u=!0),this._bindTextureDirectly(s.TEXTURE_CUBE_MAP,e,!0),this._unpackFlipY(void 0===i||!!i),e.width%4!=0&&s.pixelStorei(s.UNPACK_ALIGNMENT,1);for(var f=0;f<6;f++){var p=t[f];r?s.compressedTexImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+f,o,this.getCaps().s3tc[r],e.width,e.height,0,p):(u&&(p=vm(p,e.width,e.height,a)),s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+f,o,l,e.width,e.height,0,d,c,p))}(!this.needPOTTextures||gm.IsExponentOfTwo(e.width)&&gm.IsExponentOfTwo(e.height))&&e.generateMipMaps&&0===o&&this._gl.generateMipmap(this._gl.TEXTURE_CUBE_MAP),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),e.isReady=!0},Bp.prototype.createRawCubeTextureFromUrl=function(e,t,n,a,i,r,o,s,c,d,l,u){var f=this;void 0===c&&(c=null),void 0===d&&(d=null),void 0===l&&(l=3),void 0===u&&(u=!1);var p=this._gl,m=this.createRawCubeTexture(null,n,a,i,!r,u,l,null);return null==t||t._addPendingData(m),m.url=e,this._internalTexturesCache.push(m),this._loadFile(e,function(e){!function(e){var n=m.width,r=o(e);if(r){if(s){var d=f._getWebGLTextureType(i),l=f._getInternalFormat(a),_=f._getRGBABufferInternalSizedFormat(i),h=!1;l===p.RGB&&(l=p.RGBA,h=!0),f._bindTextureDirectly(p.TEXTURE_CUBE_MAP,m,!0),f._unpackFlipY(!1);for(var b=s(r),g=0;g<b.length;g++)for(var v=n>>g,y=0;y<6;y++){var S=b[g][y];h&&(S=vm(S,v,v,i)),p.texImage2D(y,g,_,v,v,0,l,d,S)}f._bindTextureDirectly(p.TEXTURE_CUBE_MAP,null)}else f.updateRawCubeTexture(m,r,a,i,u);m.isReady=!0,null==t||t._removePendingData(m),c&&c()}}(e)},void 0,null==t?void 0:t.offlineProvider,!0,function(e,n){null==t||t._removePendingData(m),d&&e&&d(e.status+" "+e.statusText,n)}),m},Bp.prototype.createRawTexture2DArray=ym(!1),Bp.prototype.createRawTexture3D=ym(!0),Bp.prototype.updateRawTexture2DArray=Sm(!1),Bp.prototype.updateRawTexture3D=Sm(!0),Bp.prototype.setAlphaConstants=function(e,t,n,a){this._alphaState.setAlphaBlendConstants(e,t,n,a)},Bp.prototype.setAlphaMode=function(e,t){if(void 0===t&&(t=!1),this._alphaMode!==e){switch(e){case 0:this._alphaState.alphaBlend=!1;break;case 7:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 8:case 14:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 2:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 6:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 1:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 3:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ZERO,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 4:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_COLOR,this._gl.ZERO,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 5:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 9:this._alphaState.setAlphaBlendFunctionParameters(this._gl.CONSTANT_COLOR,this._gl.ONE_MINUS_CONSTANT_COLOR,this._gl.CONSTANT_ALPHA,this._gl.ONE_MINUS_CONSTANT_ALPHA),this._alphaState.alphaBlend=!0;break;case 10:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 11:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 12:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ZERO),this._alphaState.alphaBlend=!0;break;case 13:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE_MINUS_DST_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 15:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ONE,this._gl.ZERO),this._alphaState.alphaBlend=!0;break;case 16:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 17:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0}t||(this.depthCullingState.depthMask=0===e),this._alphaMode=e}},Bp.prototype.getAlphaMode=function(){return this._alphaMode},Bp.prototype.setAlphaEquation=function(e){if(this._alphaEquation!==e){switch(e){case 0:this._alphaState.setAlphaEquationParameters(32774,32774);break;case 1:this._alphaState.setAlphaEquationParameters(32778,32778);break;case 2:this._alphaState.setAlphaEquationParameters(32779,32779);break;case 3:this._alphaState.setAlphaEquationParameters(32776,32776);break;case 4:this._alphaState.setAlphaEquationParameters(32775,32775);break;case 5:this._alphaState.setAlphaEquationParameters(32775,32774)}this._alphaEquation=e}},Bp.prototype.getAlphaEquation=function(){return this._alphaEquation},Bp.prototype.updateDynamicIndexBuffer=function(e,t,n){var a;void 0===n&&(n=0),this._currentBoundBuffer[this._gl.ELEMENT_ARRAY_BUFFER]=null,this.bindIndexBuffer(e),a=t instanceof Uint16Array||t instanceof Uint32Array?t:e.is32Bits?new Uint32Array(t):new Uint16Array(t),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,a,this._gl.DYNAMIC_DRAW),this._resetIndexBufferBinding()},Bp.prototype.updateDynamicVertexBuffer=function(e,t,n,a){this.bindArrayBuffer(e),void 0===n&&(n=0);var i=t.byteLength||t.length;void 0===a||a>=i&&0===n?t instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,n,new Float32Array(t)):this._gl.bufferSubData(this._gl.ARRAY_BUFFER,n,t):t instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,new Float32Array(t).subarray(n,n+a)):(t=t instanceof ArrayBuffer?new Uint8Array(t,n,a):new Uint8Array(t.buffer,t.byteOffset+n,a),this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t)),this._resetVertexBufferBinding()},Bp.prototype.createDynamicTexture=function(e,t,n,a){var i=new kp(this,Ip.Dynamic);return i.baseWidth=e,i.baseHeight=t,n&&(e=this.needPOTTextures?Bp.GetExponentOfTwo(e,this._caps.maxTextureSize):e,t=this.needPOTTextures?Bp.GetExponentOfTwo(t,this._caps.maxTextureSize):t),i.width=e,i.height=t,i.isReady=!1,i.generateMipMaps=n,i.samplingMode=a,this.updateTextureSamplingMode(a,i),this._internalTexturesCache.push(i),i},Bp.prototype.updateDynamicTexture=function(e,t,n,a,i,r,o){if(void 0===a&&(a=!1),void 0===r&&(r=!1),void 0===o&&(o=!1),e){var s=this._gl,c=s.TEXTURE_2D,d=this._bindTextureDirectly(c,e,!0,r);this._unpackFlipY(void 0===n?e.invertY:n),a&&s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1);var l=this._getWebGLTextureType(e.type),u=this._getInternalFormat(i||e.format),f=this._getRGBABufferInternalSizedFormat(e.type,u);s.texImage2D(c,0,f,u,l,t),e.generateMipMaps&&s.generateMipmap(c),d||this._bindTextureDirectly(c,null),a&&s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),e.isReady=!0}};var Dm="u_FillColor",Im="a_VerticesData",xm=[Dm],Cm=[Im],Om=function(e){var t=e.transform,n=e.canvasSize,a=e.zIndex,i=Ff(Object(gc.e)().palette.neutralDark),r=function(e,t,n,a){var i=Object(o.useState)(),r=i[0],s=i[1],c=Object(o.useState)(),d=c[0],l=c[1],u=Object(o.useMemo)(function(){return new Float32Array(8)},[4]),f=Object(o.useContext)(pf).engine,p=mf("BorderRectangle","\n  attribute vec2 a_VerticesData;\n  void main(void) {\n      gl_Position = vec4(a_VerticesData.xy, 0., 1.);\n  }","\n  uniform vec4 u_FillColor;\n  void main(void) {\n      gl_FragColor = u_FillColor;\n  }",Cm,void 0,xm);return Object(o.useEffect)(function(){var e,t=new Float32Array(8);if(f&&p){var n=((e={}).a_VerticesData=new Wf(f,t,Im,!0,!1,2,!1),e);if(f.webGLVersion>=2){var a=f.recordVertexArrayObject(n,null,p.effect);return f.bindVertexArrayObject(a,null),l(a),s(n),function(){f.releaseVertexArrayObject(a),n.a_VerticesData.dispose()}}return f.bindBuffers(n,null,p.effect),s(n),function(){n.a_VerticesData.dispose()}}},[f,p,4]),[Object(o.useCallback)(function(e){u.set(e)},[u]),Object(o.useCallback)(function(){if(f&&p&&r&&u){var e=p.effect;f.enableEffect(e),r.a_VerticesData.update(u),d?f.bindVertexArrayObject(d,null):f.bindBuffers(r,null,p.effect),e.setFloat4.apply(e,function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)a[i]=r[o];return a}([Dm],a)),f.drawArraysType(t,0,4)}},[f,p,u,t,4,r,d,a])]}(0,Nf.MATERIAL_LineLoopDrawMode,0,i),s=r[0],c=r[1],d=Object(o.useMemo)(function(){return Vn(wn(-1,1),Cn(2/n.x,-2/n.y),Qn(t,.5))},[t,n]);return Df(d),Object(o.useLayoutEffect)(function(){var e=Bn(d).reduce(function(e,t){return e.push(t.x,t.y),e},[]);s(e)},[n,d,s]),yf(c,a),null},wm=function(e){var t=e.cropTransform,n=e.handlePos,a=e.cropHandlePhysicalPixelSize,i=e.zIndex,r=e.cssToPhysicalPixelRatio,o=e.canvasSize,c=e.visible,d=e.isFocused,l=Ff(Object(gc.e)().palette.neutralDark),u=3*(r=r||1),f=function(e,t,n,a){var i=Na(e),r=Rn(a),o=Nn(a),s=t,c=t,d=on(Fn(a)),l=on(Hn(a)),u=3*t+2;d<u&&(s=Math.round((d-2)/3),s=Math.max(s,n)),l<u&&(c=Math.round((l-2)/3),c=Math.max(c,n));var f=cn(Un(a,i),sn(ln(r,bn(n,s-n,i.x)),ln(o,bn(n,c-n,i.y)))),p=kn(a);return Cr({x:f.x,y:f.y,width:s,height:c,rotation:p})}(n,a,Math.round(3*r),t),p=Qn(f,2*u),m=Qn(f,Math.round(4*r));return s.a.createElement(s.a.Fragment,null,s.a.createElement(Lf,{zIndex:i,color:l,transform:p},s.a.createElement(Tf,{shadowSize:u,visible:c,cropTransform:t,handleTransform:f})),d&&s.a.createElement(Om,{canvasSize:o,transform:m,zIndex:i+1}))},Em="a_lineData",Am="u_lineAlpha",Lm=[Em],km=[Am],Mm=function(e){var t=e.linesCount,n=e.cropRect,a=e.alpha,i=e.canvasSize,r=Object(o.useContext)(pf).engine,s=mf("gridLines","\n  attribute vec3 a_lineData;\n\n  varying float distanceFromBeginningOfTheLine;\n  varying vec2 vPos;\n\n  void main(void) {\n      vPos =  a_lineData.xy;\n      distanceFromBeginningOfTheLine = a_lineData.z;\n      gl_Position = vec4(a_lineData.xy, 0., 1.);\n  }","\n  varying vec2 vPos;\n  varying float distanceFromBeginningOfTheLine;\n\n  uniform float u_lineAlpha;\n\n  void main(void)\n  {\n      float lineAlt = step(mod(distanceFromBeginningOfTheLine, 8.0 * 2.0), 8.0);\n      vec3 currentLineCurrentPixelColor = mix(vec3(1.0,1.0,1.0), vec3(0.8,0.8,0.8), lineAlt);\n      vec4 targetColorWithAlpha = vec4(currentLineCurrentPixelColor, u_lineAlpha * 0.75);\n      gl_FragColor = targetColorWithAlpha;\n  }",Lm,void 0,km),c=Object(o.useState)(),d=c[0],l=c[1],u=Object(o.useState)(),f=u[0],p=u[1],m=2*t,_=Object(o.useMemo)(function(){return e=n,t=i.x,a=i.y,{height:e.height/a*2,top:2*-e.top/a+1,width:e.width/t*2,left:e.left/t*2-1};var e,t,a},[n,i]),h=Object(o.useMemo)(function(){return new Float32Array(6*m)},[m]);return Object(o.useLayoutEffect)(function(){for(var e=_.width/(t+1),a=_.height/(t+1),i=0;i<t;i++){var r=6*i*2,o=e*(i+1),s=a*(i+1);h[r+0]=_.left+o,h[r+1]=_.top,h[r+2]=0,h[r+3]=_.left+o,h[r+4]=_.top-_.height,h[r+5]=n.height,h[r+6]=_.left,h[r+7]=_.top-s,h[r+8]=0,h[r+9]=_.left+_.width,h[r+10]=_.top-s,h[r+11]=n.width}},[_,n,t,h]),Object(o.useLayoutEffect)(function(){var e,t=void 0,n=void 0,a=new Float32Array(6*m);return r&&s&&((e={}).a_lineData=new Wf(r,a,Em,!0,!1,3,!1),t=e,r.webGLVersion>=2?(n=r.recordVertexArrayObject(t,null,s.effect),r.bindVertexArrayObject(n,null)):r.bindBuffers(t,null,s.effect),l(t),p(n)),function(){n&&(null==r||r.releaseVertexArrayObject(n)),t&&t.a_lineData.dispose()}},[r,s,t,m]),yf(Object(o.useCallback)(function(){r&&s&&d&&h&&(r.enableEffect(s.effect),d.a_lineData.update(h),f?r.bindVertexArrayObject(f,null):r.bindBuffers(d,null,s.effect),s.effect.setFloat(Am,a),r.drawArraysType(Nf.MATERIAL_LineListDrawMode,0,2*m))},[d,r,h,s,a,f,m]),Number.MAX_VALUE),function(e){void 0===e&&(e={height:0,width:0,top:0,left:0});var t=Object(o.useContext)(bf).renderList;Object(o.useLayoutEffect)(function(){t&&t.requestRender()},[t,e.height,e.width,e.top,e.left])}(n),null},Pm=Vt([vd,dd,id],function(e,t,n){return Vn(e||t,n)}),Tm={setCssToPhysicalPixelRatio:Ro,setCropHandleSizeCss:Ho},Um=Object(R.connect)(function(e){var t=e.transformTools,n=t.device.pixelRatio,a=t.view.viewportPixelSize,i=t.cropInteraction,r=i.mode,o=i.focusedHandleIndex,s=i.isKeyboardFocused,c=t.cropUiDisplay.handleSizeCss,d=t.pointer.movePos,l=t.image.loadedPixelSize;return{cropTransform:Pm(e.transformTools),canvasPixelSize:a,numCropGridLines:ku(e.transformTools),cropGridLinesVisibilityValue:Mu(e.transformTools),cropUiMode:r,cropHandlePhysicalPixelSize:Ba(c,n),cssToPhysicalPixelRatio:n,pointerPos:d,focusedHandle:o,isKeyboardFocused:s,visible:!!l}},Tm)(function(e){var t=e.cropHandlePhysicalPixelSize,n=e.canvasPixelSize,a=e.cropTransform,i=e.cropUiMode,r=e.numCropGridLines,c=e.cropGridLinesVisibilityValue,d=e.pointerPos,l=e.focusedHandle,u=e.isKeyboardFocused,f=e.visible,p=e.cssToPhysicalPixelRatio,m=Ff(Object(gc.e)().palette.neutralPrimary),_=i!==da.draggingView&&i!==da.selectingFirstCorner&&i!==da.selectingSecondCorner,h=s.a.createElement(s.a.Fragment,null),b=s.a.createElement(s.a.Fragment,null);if(i===da.selectingFirstCorner){var g={left:0,top:d.y,width:n.x,height:1};h=s.a.createElement(Lf,{zIndex:2,color:m,transform:Ea(g)});var v={left:d.x,top:0,width:1,height:n.y};b=s.a.createElement(Lf,{zIndex:2,color:m,transform:Ea(v)})}var y=Object(o.useMemo)(function(){return Aa(a)},[a]),S=function(e){var t=Object(o.useState)(!1),n=t[0],a=t[1],i=Object(o.useRef)(e);return i.current=e,Object(o.useLayoutEffect)(function(){if(e){var t=window.requestAnimationFrame(function(){setTimeout(function(){a(i.current)})});return function(){window.cancelAnimationFrame(t)}}},[e]),e&&n}(f);return S?s.a.createElement(s.a.Fragment,null,[ca.TopLeft,ca.TopCenter,ca.TopRight,ca.SideLeft,ca.SideRight,ca.BottomLeft,ca.BottomCenter,ca.BottomRight].map(function(e){var i="cropHandle"+e;return s.a.createElement(wm,{key:i,handlePos:e,isFocused:e===l&&u,cropHandlePhysicalPixelSize:t,cropTransform:a,canvasSize:n,zIndex:3,cssToPhysicalPixelRatio:p,visible:_})}),i!==da.selectingFirstCorner&&s.a.createElement(Om,{canvasSize:n,transform:a,zIndex:2}),h,b,s.a.createElement(Mm,{cropRect:y,linesCount:r,alpha:c,canvasSize:n})):null}),Fm=n(1686),Hm=n(414);Object(Cl.n)([{rawString:".spinner_cc592d97{height:100%;width:100%;opacity:.8;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:absolute;z-index:200}"}]);var Rm=function(){return Rm=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Rm.apply(this,arguments)},Nm=Object(o.memo)(function(e){var t=e.loading,n=e.styles,a=Object(gc.e)();return t?s.a.createElement(Fm.e,{className:"spinner_cc592d97",style:Rm({background:a.palette.white},n),size:Hm.e.large}):null});Nm.displayName="LoadingSpinner";var Bm=Object(R.connect)(function(e){return{loading:e.uiState.waitingForActiveEditorActivityToComplete}})(Nm),jm=Object(R.connect)(function(e){return{loading:!md(e.transformTools)}})(Nm),Vm=s.a.memo(function(e){var t=e.handleSizeCss,n=e.handleHitAreaSizeCss,a=e.setCropHandleSizeCss;return Object(o.useLayoutEffect)(function(){a({handleSizeCss:t,handleHitAreaSizeCss:n})},[a,t,n]),null}),zm={setCropHandleSizeCss:Ho},Gm=Object(R.connect)(void 0,zm)(Vm),Km=Vt([ad],function(e){var t=un(La(e));return{width:t.x,height:t.y}}),Wm=Vt([Km],function(e){return e.width}),qm=Vt([Km],function(e){return e.height}),Qm=Vt([ad,dd],function(e,t){return Aa(Vn(t,e))});function Ym(e,t){e&&("function"==typeof e?e(t):e.current=t)}function Jm(e,t,n){var a=t.getBoundingClientRect();return{x:Math.floor((e.x-a.left)*n),y:Math.floor((e.y-a.top)*n)}}function Xm(e,t,n){return e?sn(t,{x:e.offsetLeft*n,y:e.offsetTop*n}):t}function Zm(e){Object(o.useEffect)(function(){if(e){var t=function(e){return e.preventDefault(),!1};return e.addEventListener("contextmenu",t),function(){return e.removeEventListener("contextmenu",t)}}},[e])}Object(Cl.n)([{rawString:".ms-Fabric--isFocusVisible .cropUIRectangle_1b96a0c4:focus{visibility:visible;outline-width:1px;outline-style:solid;outline-offset:5px}.ms-Fabric--isFocusHidden .cropUIRectangle_1b96a0c4{outline:0}.cropUIRectangle_1b96a0c4{position:absolute;justify-self:center}"}]),Object(Cl.n)([{rawString:".cropRectCorner_aeba7ec3{position:absolute;-ms-touch-action:none;touch-action:none}.cropRectCorner_aeba7ec3:focus{outline:0}"}]);var $m=function(e,t,n,a,i,r,s){var c=Object(o.useRef)(0);Object(o.useEffect)(function(){if(t){var o=function(t){i(t)&&(t.altKey&&t.preventDefault(),t.stopPropagation(),r(t)?s(t):c.current<e?(c.current+=1,n(t)):a(t))},d=function(){c.current=0};return t.addEventListener("keydown",o),t.addEventListener("keyup",d),function(){t.removeEventListener("keydown",o),t.removeEventListener("keyup",d)}}},[t,a,n,c,e,i,r,s])};function e_(e,t,n){Object(o.useEffect)(function(){var a=function(a){if(t){var i=Jm({x:a.clientX,y:a.clientY},t,e);a.cancelable&&(a.preventDefault(),n&&n({mousePhysicalPixelPos:i,deltaY:a.deltaY,deltaMode:a.deltaMode,ctrlKey:a.ctrlKey}))}};return t&&t.addEventListener("wheel",a,{passive:!1}),function(){t&&t.removeEventListener("wheel",a)}},[t,n,e])}var t_={initiatingButtonId:0,heldButtonsFlags:1};function n_(e,t){return!!((e||0)&t.heldButtonsFlags)}function a_(e){return"touch"===e.pointerType||(t=t_,n_(e.buttons,t));var t}function i_(e,t,n,a,i,r,o){a({pointerPhysicalPixelPos:Jm({x:e.clientX,y:e.clientY},n,t),isPrimaryButtonDownOrTouchDown:i,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,isTouch:"touch"===r,pointerId:o,inputType:wu(e)})}var r_=function(){},o_=function(e,t,n,a,i,r){void 0===n&&(n=r_),void 0===a&&(a=r_),void 0===i&&(i=r_);var s=Object(o.useRef)(),c=Object(o.useRef)(new Set);Object(o.useEffect)(function(){if(e){var o=function(t){try{c.current.delete(t),e.releasePointerCapture(t)}catch(e){}},d=function(a){if(a.isPrimary||"touch"===a.pointerType){var i=a_(a);i&&(r=a.pointerId,e.setPointerCapture(r),c.current.add(r)),i_(a,t,e,n,i,a.pointerType,a.pointerId)}var r},l=function(n){(n.isPrimary||"touch"===n.pointerType)&&function(e,t,n,a,i,r,o,s){var c,d;d=function(){return i_(e,t,n,i,r,o,s)},(c=a).current&&window.cancelAnimationFrame(c.current),c.current=window.requestAnimationFrame(d)}(n,t,e,s,a,a_(n),n.pointerType,n.pointerId)},u=function(n,a){(n.isPrimary||"touch"===n.pointerType)&&(a||o(n.pointerId),i_(n,t,e,i,!1,n.pointerType,n.pointerId))},f=function(e){u(e,!1)},p=function(e){u(e,!0)};return e.addEventListener("pointerdown",d),e.addEventListener("pointermove",l),e.addEventListener("pointerup",f),e.addEventListener("lostpointercapture",p),function(){e.removeEventListener("pointerdown",d),e.removeEventListener("pointermove",l),e.removeEventListener("pointerup",f),e.removeEventListener("lostpointercapture",p),function(){for(var e=0,t=Array.from(c.current);e<t.length;e++){var n=t[e];o(n)}}(),null==r||r()}}},[n,a,i,r,e,t])};function s_(e,t,n,a,i,r){var s=Object(o.useMemo)(function(){return t?new Nl.a(t,{recognizers:[[Nl.a.Pinch],[Nl.a.Tap,{taps:2,event:"doubletap"}]],touchAction:"compute"}):null},[t]);Object(o.useEffect)(function(){if(t&&s){var o=function(a){n&&n({center:Jm(a.center,t,e),scale:a.scale})},c=function(n){a&&a({center:Jm(n.center,t,e),scale:n.scale})},d=function(n){i&&i({center:Jm(n.center,t,e),scale:n.scale})},l=function(n){r&&r({center:Jm(n.center,t,e),scale:n.scale})};return s.on("pinchstart",o),s.on("pinchmove",c),s.on("pinchend",d),s.on("doubletap",l),function(){s.off("pinchstart",o),s.off("pinchmove",c),s.off("pinchend",d),s.off("doubletap",l)}}},[t,n,a,i,r,e,s])}function c_(e,t,n,a,i,r,s,c,d,l,u,f,p,m,_,h,b,g){var v=Object(o.useCallback)(function(n){l&&e&&(n.pointerPhysicalPixelPos=Xm(e,n.pointerPhysicalPixelPos,t),l(n))},[e,l,t]),y=Object(o.useCallback)(function(n){u&&e&&(n.pointerPhysicalPixelPos=Xm(e,n.pointerPhysicalPixelPos,t),u(n))},[e,u,t]),S=Object(o.useCallback)(function(n){f&&e&&(n.pointerPhysicalPixelPos=Xm(e,n.pointerPhysicalPixelPos,t),f(n))},[e,f,t]),D=Object(o.useCallback)(function(n){p&&e&&(n.mousePhysicalPixelPos=Xm(e,n.mousePhysicalPixelPos,t),p(n),c({type:"Zoom",zoom:a}))},[p,e,t,c,a]),I=Object(o.useCallback)(function(n){m&&e&&(n.center=Xm(e,n.center,t),m(n))},[t,e,m]),x=Object(o.useCallback)(function(n){_&&e&&(n.center=Xm(e,n.center,t),_(n))},[t,e,_]),C=Object(o.useCallback)(function(n){h&&e&&(n.center=Xm(e,n.center,t),h(n),c({type:"CropImageDimension",cropDimension:Ds}))},[t,e,h,c]),O=Object(o.useCallback)(function(n){b&&e&&(n.center=Xm(e,n.center,t),b(n))},[t,e,b]),w=Object(o.useCallback)(function(e){var t=dr(e.key);s({direction:t,handlePosition:n,cropShiftingValue:1,inputType:"Keyboard"}),d_(n,i,r,c)},[s,n,c,i,r]),E=Object(o.useCallback)(function(e){var t=dr(e.key);s({direction:t,handlePosition:n,cropShiftingValue:10,inputType:"Keyboard"}),d_(n,i,r,c)},[s,n,c,i,r]),A=Object(o.useCallback)(function(e){var t=dr(e.key);s({direction:t,handlePosition:n,cropShiftingValue:50,inputType:"Keyboard"}),d_(n,i,r,c)},[s,n,c,i,r]);Object(o.useEffect)(function(){if(e){var t=function(e){e.stopPropagation(),"focus"===e.type&&(ur()?d({handlePosition:n,isKeyboardFocused:!0}):d({handlePosition:n,isKeyboardFocused:!1}))},a=function(e){"blur"===e.type&&d({handlePosition:ca.None,isKeyboardFocused:!1})};return e.addEventListener("focus",t),e.addEventListener("blur",a),function(){e.removeEventListener("focus",t),e.addEventListener("blur",a)}}},[e,n,s,d]),$m(10,e,w,E,pr,fr,A),o_(e,t,v,y,S,g),e_(t,e,D),Zm(e),s_(t,e,I,x,C,O)}function d_(e,t,n,a){e===ca.Center?a({type:"CropImageMove",cropTopLeftCornerFromImageOrigin:n}):a({type:"CropImageDimension",cropDimension:t})}var l_=Object(o.forwardRef)(function(e,t){var n=e.handlePosition,a=e.ariaLabel,i=e.style,r=e.cssToPhysicalPixelRatio,c=e.currentZoom,d=e.cropDimension,l=e.cropTopLeftCornerFromImageOrigin,u=e.shouldShowTooltip,f=e.handleCropRectAdjustment,p=e.setAriaAnnouncementScenario,m=e.setFocusedCropHandle,_=e.onPointerDown,h=e.onPointerMove,b=e.onPointerUp,g=e.onWheel,v=e.onTouchDown,y=e.onTouchMove,S=e.onTouchUp,D=e.onDoubleTap,I=e.onUnmount,x=Object(o.useContext)(Le).strings,C=Object(o.useState)(null),O=C[0],w=C[1];return Object(o.useEffect)(function(){Ym(t,O)},[t,O]),c_(O,r,n,c,d,l,f,p,m,_,h,b,g,v,y,S,D,I),s.a.createElement("div",{ref:w,"data-is-focusable":!0,"aria-label":a,title:u?x.crop_cornerTooltip:void 0,role:"button",className:"cropRectCorner_aeba7ec3",tabIndex:0,style:i,"data-test-id":"crop-corner-handle-"+n})});function u_(e,t){return nu(e,t.x.toString(),t.y.toString())}l_.displayName="CropRectCorner";var f_=function(){return f_=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},f_.apply(this,arguments)},p_=s.a.memo(function(e){var t=e.cropUIRectangle,n=e.cssToPhysicalPixelRatio,a=e.cursor,i=e.currentZoom,r=e.cropDimension,c=e.cropTopLeftCornerFromImageOrigin,d=e.shouldShowTooltip,l=e.isPointerOverCropHandle,u=e.handleCropRectAdjustment,f=e.setAriaAnnouncementScenario,p=e.setFocusedCropHandle,m=e.onPointerDown,_=e.onPointerMove,h=e.onPointerUp,b=e.onWheel,g=e.onTouchDown,v=e.onTouchMove,y=e.onTouchUp,S=e.onDoubleTap,D=e.onUnmount,I=Object(o.useContext)(Le).strings,x=Object(gc.e)(),C=function(e){var t=Object(o.useContext)(Le).strings;return Object(o.useMemo)(function(){return u_(t.crop_topLeftCornerAriaLabel,e)},[t,e])}(c),O=function(e,t){var n=Object(o.useContext)(Le).strings;return Object(o.useMemo)(function(){var a={x:e.x+t.width,y:e.y};return u_(n.crop_topRightCornerAriaLabel,a)},[n,e,t])}(c,r),w=function(e,t){var n=Object(o.useContext)(Le).strings;return Object(o.useMemo)(function(){var a={x:e.x,y:e.y+t.height};return u_(n.crop_bottomLeftCornerAriaLabel,a)},[n,e,t])}(c,r),E=function(e,t){var n=Object(o.useContext)(Le).strings;return Object(o.useMemo)(function(){var a={x:e.x+t.width,y:e.y+t.height};return u_(n.crop_bottomRightCornerAriaLabel,a)},[n,e,t])}(c,r),A=Object(o.useState)(null),L=A[0],k=A[1];c_(L,n,ca.Center,i,r,c,u,f,p,m,_,h,b,g,v,y,S,D);var M={handleCropRectAdjustment:u,setAriaAnnouncementScenario:f,setFocusedCropHandle:p,onPointerDown:m,onPointerMove:_,onPointerUp:h,onWheel:b,onUnmount:D,cssToPhysicalPixelRatio:n,currentZoom:i,cropDimension:r,cropTopLeftCornerFromImageOrigin:c,shouldShowTooltip:d},P={cursor:a,width:30,height:30};return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"cropUIRectangle_1b96a0c4",style:{width:t.width/n,height:t.height/n,top:t.top/n,marginLeft:t.left/n,marginRight:t.left/n,cursor:a,outlineColor:x.palette.neutralDark},"data-is-focusable":!0,"data-test-id":"cropUIRectangle",ref:k,"aria-label":I.crop_rectangleAriaLabel,title:d?l?I.crop_cornerTooltip:I.crop_rectangleTooltip:void 0,role:"img",tabIndex:0}),s.a.createElement(l_,f_({handlePosition:ca.TopLeft,ariaLabel:C,style:f_(f_({},P),{top:t.top/n,left:t.left/n})},M)),s.a.createElement(l_,f_({handlePosition:ca.TopRight,ariaLabel:O,style:f_(f_({},P),{top:t.top/n,left:(t.left+t.width)/n-30})},M)),s.a.createElement(l_,f_({handlePosition:ca.BottomLeft,ariaLabel:w,style:f_(f_({},P),{left:t.left/n,top:(t.top+t.height)/n-30})},M)),s.a.createElement(l_,f_({handlePosition:ca.BottomRight,ariaLabel:E,style:f_(f_({},P),{left:(t.left+t.width)/n-30,top:(t.top+t.height)/n-30})},M)))}),m_=Vt([bd,dd,yd],function(e,t,n){return Gi(e,t,n)}),__=Vt([rd,function(e){return e.cropInteraction.shouldConstrainInImage},dd,yd,gd,bd,m_,od,function(e){return e.view.allowDraggingView},ud],function(e,t,n,a,i,r,o,s,c,d){switch(e){case da.selectingFirstCorner:return Ii(t,Un(Tn(Vn(n,a)),r))?"crosshair":"not-allowed";case da.selectingSecondCorner:return"crosshair";case da.draggingView:return"grabbing";case da.disabled:return d===la.fitCropRectInView?"pointer":i?"grabbing":"grab";case da.usingNineSliceCropHandles:default:return function(e,t,n,a){switch(e){case ca.TopLeft:case ca.BottomRight:return"nwse-resize";case ca.BottomLeft:case ca.TopRight:return"nesw-resize";case ca.SideLeft:case ca.SideRight:return"ew-resize";case ca.TopCenter:case ca.BottomCenter:return"ns-resize";case ca.Center:default:return n||a?t?"grabbing":"grab":"default"}}(s,i,o,c)}}),h_=Vt([dd],function(e){return zn(e)}),b_=Vt([ad,pd],function(e,t){var n=Aa(t),a={x:n.left,y:n.top};return fn(cn(qn(e),a))}),g_=Vt([od],function(e){return Xa(e)}),v_={handleCropRectAdjustment:qo,setAriaAnnouncementScenario:Os,setFocusedCropHandle:Yo,onPointerMove:xo,onPointerDown:Ur,onPointerUp:Fr,onWheel:Co,onTouchDown:ko,onTouchMove:Mo,onTouchUp:Po,onDoubleTap:Fo,onUnmount:To},y_=Object(R.connect)(function(e){var t=e.transformTools.device.pixelRatio,n=__(e.transformTools),a=h_(e.transformTools),i=Km(e.transformTools);return{cropUIRectangle:Qm(e.transformTools),cssToPhysicalPixelRatio:t,cursor:n,currentZoom:a,cropDimension:i,cropTopLeftCornerFromImageOrigin:b_(e.transformTools),shouldShowTooltip:e.transformTools.cropInteraction.mode===da.none,isPointerOverCropHandle:g_(e.transformTools)}},v_)(p_),S_=function(e,t){var n=this;this.getTexture=function(e,t,a,i,r,o){if(void 0===i&&(i=!1),!(e instanceof HTMLImageElement)||e.complete&&e.currentSrc){var s=Bc(e),c=n._loadableTexturesMap.has(s)&&n._loadableTexturesMap.get(s);if(c)return c.refCount++,void(c.isLoaded?c.texture&&t({height:c.loadedHeight,width:c.loadedWidth,id:c.id,texture:c.texture}):c.onReadyCallbacksList.push(t));var d=n._loadableTexturesMap;d.set(s,{id:s,isLoaded:!1,onReadyCallbacksList:[t],refCount:1}),n._textureLoadFn(e,function(e,t,n){var a=d.get(s);a&&(a.loadedHeight=n,a.loadedWidth=t,a.isLoaded=!0,a.texture=e,a.onReadyCallbacksList.forEach(function(a){a&&a({id:s,height:n,width:t,texture:e})}))},function(e){r(e)},a,i,o)}else r({id:"ImageNotLoaded",message:"The image is not yet loaded"})},this.dispose=function(){n._loadableTexturesMap.forEach(function(e){e.texture&&n._textureUnloadFn(e.texture)}),n._loadableTexturesMap.clear()},this.releaseTexture=function(e,t){void 0===t&&(t=!1);var a=n._loadableTexturesMap.get(e);a&&(t||a.refCount<=1?(a.texture&&n._textureUnloadFn(a.texture),n._loadableTexturesMap.delete(e)):a.refCount--)},this.forceReleaseTexture=function(e){n.releaseTexture(e,!0)},this._textureLoadFn=e,this._textureUnloadFn=t,this._loadableTexturesMap=new Map};function D_(e){var t=e.getCaps().maxTextureSize;return Math.min(4096,"number"==typeof t&&t||2048)}function I_(e,t){if(t<=0)throw new RangeError("Invalid max Size");for(var n=[],a=0,i=0;i<e.height;){for(;a<e.width;)n.push({left:e.left+a,top:e.top+i,width:Math.min(e.width-a,t),height:Math.min(e.height-i,t)}),a+=t;a=0,i+=t}return n}function x_(e,t){return Bc(e)+(t.left+"_")+t.top+"_"+t.width+"_"+t.height}var C_=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})};function O_(e,t){var n=!1;return{promise:C_(this,void 0,void 0,function(){var a,i,r,o,s,c;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(d){switch(d.label){case 0:a=[],i=0,r=e,d.label=1;case 1:return i<r.length?(o=r[i],n?[3,3]:(c=(s=a).push,[4,t(o)])):[3,5];case 2:return c.apply(s,[d.sent()]),[3,4];case 3:return[3,5];case 4:return i++,[3,1];case 5:return[2,a]}})}),cancel:function(){n=!0}}}function w_(){var e=function(){},t=new Promise(function(t){return e=t});return window.requestAnimationFrame(e),t}function E_(e){return Rc(e)?e.main?E_(e.main):1:(Fc(e)||Hc(e))&&e.orientation||1}var A_=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},L_=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};var k_=function(){function e(e){this.cache={},this.engine=e}return e.prototype.getEffectWrapper=function(e,t,n,a,i,r){if(this.cache[e])return this.cache[e].effectWrapperPromise;var o=new Cp({engine:this.engine,vertexShader:t,fragmentShader:n,samplerNames:i,attributeNames:a,uniformNames:r,name:e}),s=new Promise(function(e,t){o.effect.onError=function(e,n){t(n)},o.effect.executeWhenCompiled(function(){return e(o)})});return this.cache[e]={effectWrapper:o,effectWrapperPromise:s},s},e}();function M_(e){return t=E_(e),n=cf.get(t).angle,90===Math.abs(n);var t,n}var P_=s.a.memo(function(e){var t=e.children,n=e.width,a=e.height,i=e.cssWidth,r=e.cssHeight,c=e.tabIndex,d=e.onPointerDown,l=e.onPointerMove,u=e.onPointerUp,f=e.onWheel,p=e.onTouchDown,m=e.onTouchMove,_=e.onTouchUp,h=e.onDoubleTap,b=e.onUnmount,g=e.cssToPhysicalPixelRatio,v=e.color,y=e.isAnimating,S=e.title,D=Object(o.useState)(null),I=D[0],x=D[1],C=function(e){var t=Object(o.useRef)(),n=Object(o.useRef)(),a=Object(o.useRef)();return Object(o.useLayoutEffect)(function(){if(e){var i=new Bp(e,!1,{alpha:!0,antialias:!1,stencil:!1,depth:!1}),r=new xp(i);i.setAlphaMode(Nf.ALPHA_COMBINE),i.setViewport({x:0,y:0,width:1,height:1}),t.current=i,n.current=r,a.current=new k_(i)}return function(){var e;null===(e=t.current)||void 0===e||e.dispose(),t.current=void 0,n.current=void 0,a.current=void 0}},[e]),[t.current,n.current,a.current]}(I),O=C[0],w=C[1],E=C[2];!function(e){var t=Object(o.useContext)(_e).logWarningEvent;Object(o.useEffect)(function(){if(e){var n=e.onContextLostObservable.add(function(){t({id:"WebGlContextLost",message:"WebGL context was lost on a WebGL canvas."})});return function(){e.onContextLostObservable.remove(n)}}},[e,t])}(O),o_(I,g,d,l,u,b),Zm(I),e_(g,I,f),s_(g,I,p,m,_,h);var A=function(e){var t=e?D_(e):void 0,n=Object(o.useMemo)(function(){if(e)return new S_(function(t,n,a,i,r,o){void 0===r&&(r=!0),void 0===o&&(o=Nf.TEXTURE_DEFAULT_ANISOTROPIC_FILTERING_LEVEL);var s=D_(e);r=!!Of(e)&&r;var c=function(){return a({id:"CreateTextureFailed",message:"loadTexture failed to create a texture"})};(function(e,t,n,a,i,r){return A_(this,void 0,void 0,function(){var o,s,c,d,l,u=this;return L_(this,function(f){switch(f.label){case 0:o={top:0,left:0,width:e.width,height:e.height},s=[],f.label=1;case 1:return f.trys.push([1,3,,4]),c=I_(o,i),d=function(i){return A_(u,void 0,void 0,function(){var o,s,c,d;return L_(this,function(l){switch(l.label){case 0:return[4,w_()];case 1:if(l.sent(),!(o=function(e,t){var n;return Hc(e)?e.renderCanvas(e.canvasMethods.getHTMLCanvas,{x:e.width,y:e.height},t,null!==(n=e.orientation)&&void 0!==n?n:1):t.width===e.width&&t.height===e.height&&0===t.left&&0===t.top?e:Fc(e)?function(e,t){if(!Vc(e.width,e.height,e.format,e.bytes))throw Error("Error: Could not extract subImage from invalid ImageBytes array");for(var n=e.format,a=jc(n),i=new Uint8Array(t.width*t.height*a),r=(e.width-t.width)*a,o=t.width*a,s=0,c=(t.top*e.width+t.left)*a,d=e.bytes;s<i.length;)i.set(d.subarray(c,c+o),s),s+=o,c+=o+r;return{bytes:i,format:n,width:t.width,height:t.height,id:x_(e,t)}}(e,t):function(e,t){var n=document.createElement("canvas");n.width=t.width,n.height=t.height,n.id=x_(e,t);var a=n.getContext("2d");if(a)return a.drawImage(e,t.left,t.top,t.width,t.height,0,0,t.width,t.height),n}(e,t)}(e,i)))throw new Error("Failed to create sub texture");return s=function(e,t,n,a){return Fc(e)?function(e,t,n,a){if(!function(e,t,n){return function(e,t,n){return Math.min(n/e,n/t)}(e,t,D_(n))<1}(e.width,e.height,n)){var i=e.format===Mc.RGB?Nf.TEXTUREFORMAT_RGB:Nf.TEXTUREFORMAT_RGBA;return n.createRawTexture(e.bytes,e.width,e.height,i,t,!1,Nf.TEXTURE_TRILINEAR_SAMPLINGMODE,null,Nf.TEXTURETYPE_UNSIGNED_BYTE)}a({id:"ImageTooBig",message:"The supplied image size of "+e.width+"x"+e.height+" exceeds max texture size of "+D_(n)})}(e,t,n,a):e instanceof HTMLImageElement?function(e,t,n,a){return n.createTexture(null,!t,!1,null,void 0,null,function(e){a({id:"CreateTextureFailed",message:"Babylon engine.createTexture failed with message: "+e})},e)}(e,t,n,a):e instanceof HTMLCanvasElement?function(e,t,n,a){var i,r=function(e){var t=e.width,n=e.height,a=document.createElement("canvas");a.width=t,a.height=n;var i=a.getContext("2d");if(i)return i.scale(1,-1),i.drawImage(e,0,0,t,n,0,0,e.width,-1*e.height),a}(e);if(r){var o=null!==(i=new Vf(r,{generateMipMaps:t,engine:n,samplingMode:Nf.TEXTURE_TRILINEAR_SAMPLINGMODE}).getInternalTexture())&&void 0!==i?i:void 0;return o||a({id:"CreateTextureFailed",message:"Failed to create HtmlElementTexture"}),o}a({id:"CreateTextureFailed",message:"Failed to flip canvas"})}(e,t,n,a):void 0}(o,t,n,r),s?((c=new Rf(null))._texture=s,c.wrapR=Nf.TEXTURE_CLAMP_ADDRESSMODE,c.wrapU=Nf.TEXTURE_CLAMP_ADDRESSMODE,c.wrapV=Nf.TEXTURE_CLAMP_ADDRESSMODE,c.anisotropicFilteringLevel=a,Hc(e)&&(d=e.canvasMethods.restoreHTMLCanvas)&&d(),[2,{texture:c,rect:i}]):[2]}})})},[4,O_(c,d).promise];case 2:return s=f.sent().filter(function(e){return!!e}),[3,4];case 3:return l=f.sent(),r({id:"CreateTextureFailed",message:(null==l?void 0:l.message)||"sub texture extraction failed."}),[3,4];case 4:return[2,{width:e.width,height:e.height,parts:s,orientation:E_(e)}]}})})})(t,r,e,o,s,a).then(function(e){e?M_(t)?n(e,e.height,e.width):n(e,e.width,e.height):c()}).catch(function(){c()})},function(e){e.parts.forEach(function(e){e.texture.dispose()})})},[e]);return function(e){var t=Object(o.useContext)(_e).logMaxTextureSizeEvent;Object(o.useEffect)(function(){e&&t({value:e})},[t,e])}(t),Object(o.useEffect)(function(){return function(){return null==n?void 0:n.dispose()}},[n]),n}(O),L=Object(o.useMemo)(function(){return{canvasContextIsValid:!0,canvas:I||void 0,textures:A,engine:O,effectRenderer:w,effectWrapperManager:E}},[I,A,O,w,E]),k=e.cursor||"default";yf(Object(o.useCallback)(function(){O&&v&&O.clear({r:v[0],g:v[1],b:v[2],a:v[3]},!0,!0)},[O,v]),-1);var M=Object(o.useContext)(bf).renderList;return Object(o.useLayoutEffect)(function(){I&&(I.width=n,I.height=a,M.renderNow())},[n,a,I,M]),s.a.createElement(pf.Provider,{value:L},s.a.createElement("canvas",{"data-test-id":y?"canvas-animating":"canvas-idle",tabIndex:c,"aria-hidden":void 0===c||c<0,ref:x,style:{cursor:k,width:i,height:r,touchAction:"none",display:"block",position:"absolute",outline:"none"},title:S}),t)}),T_={handlePointerMove:xo,handlePointerDown:Ur,handlePointerUp:Fr,handleMouseWheel:Co,handleTouchDown:ko,handleTouchMove:Mo,handleTouchUp:Po,handleDoubleTap:Fo,handleCleanup:To,handleFrameTick:So,abortCurrentMode:Ko,setAriaAnnouncementScenario:Os},U_=Object(R.connect)(function(e){var t=e.transformTools,n=t.animations,a=n.needsFrameTick,i=n.image.animatedMatrix,r=t.device.pixelRatio,o=t.view,s=o.viewportPixelSize,c=o.viewportCssSize,d=yd(e.transformTools),l=Sd(e.transformTools),u=i||d,f=h_(e.transformTools);return{imageTransformValues:u,imagePixelSize:l,canvasPixelSize:s,canvasCssSize:c,isPointerInImage:m_(e.transformTools),isPointerOverCropHandle:g_(e.transformTools),cursorStyle:__(e.transformTools),cssToPhysicalPixelRatio:r,needsFrameTick:a,currentZoom:f}},T_)(function(e){var t=e.handlePointerDown,n=e.handlePointerMove,a=e.handlePointerUp,i=e.handleMouseWheel,r=e.handleTouchDown,c=e.handleTouchMove,d=e.handleTouchUp,l=e.handleDoubleTap,u=e.handleCleanup,f=e.handleFrameTick,p=e.abortCurrentMode,m=e.setAriaAnnouncementScenario,_=e.cssToPhysicalPixelRatio,h=e.needsFrameTick,b=e.canvasPixelSize,g=e.canvasCssSize,v=e.isPointerInImage,y=e.isPointerOverCropHandle,S=e.cursorStyle,D=e.backgroundColor,I=e.currentZoom,x=e.children,C=e.animationSpeedMultiplier,O=Object(o.useContext)(Le).strings,w=Ff(Object(gc.e)().palette.neutralLighterAlt),E=Object(o.useCallback)(function(e){i(e),m({type:"Zoom",zoom:I})},[i,m,I]);return Object(o.useEffect)(function(){var e=0,t=null!=C?C:1;t<=0&&(console.warn("animationSpeedMultiplier ignored. Value must be > 0."),t=1);var n=function(){e=window.requestAnimationFrame(n),f((new Date).getTime()*t)};if(h)return e=window.requestAnimationFrame(n),function(){window.cancelAnimationFrame(e)}},[h,f,C]),Object(o.useEffect)(function(){var e=function(e){"Esc"!==e.key&&"Escape"!==e.key||p()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}},[p]),s.a.createElement(gf,null,s.a.createElement(P_,{width:b.x,height:b.y,color:D||w,cssWidth:g.width,cssHeight:g.height,title:y?O.crop_cornerTooltip:v?O.crop_rectangleTooltip:void 0,cursor:S,onPointerDown:t,onPointerMove:n,onPointerUp:a,onWheel:E,onTouchDown:r,onTouchMove:c,onTouchUp:d,onDoubleTap:l,onUnmount:u,cssToPhysicalPixelRatio:_,isAnimating:h},x))}),F_=Vt([yd,dd,vd,function(e){return e.animations.image.animatedMatrix}],function(e,t,n,a){return Vn(n||t,a||e)});function H_(e){var t=Rc(e)?e.main:e;if(t)return{x:t.width,y:t.height}}function R_(e,t){var n=!1,a=e?function(e){var t,n=H_(e);return n&&M_(e)&&(n={x:(t=n).y,y:t.x}),n}(e):void 0;return a&&(n=!t||_n(t,a)),n}var N_,B_=function(){return B_=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},B_.apply(this,arguments)},j_={onMainTextureLoaded:Io,onOverlayTextureLoaded:oo},V_=Object(R.connect)(function(e,t){var n=t.children;return{transform:F_(e.transformTools),children:n}},j_)((N_=Ef,Object(o.forwardRef)(function(e,t){var n,a;n=e.image,a=Object(o.useContext)(Hd),Object(o.useLayoutEffect)(function(){if(Rc(n)?n.main:n){var e=R_(n,a)?H.MainImage:H.Thumbnail;performance.clearMarks(e),performance.mark(e)}},[n,a]);var i=function(e){var t=Object(o.useContext)(_e).logPageLoadTimeEvent,n=Object(o.useRef)({x:0,y:0}),a=Object(o.useContext)(Hd);return Object(o.useCallback)(function(i){if(e&&e(i),n.current!==i.sizeInPixels){var r=!a||_n(i.sizeInPixels,a)?H.MainImage:H.Thumbnail,o=window.requestAnimationFrame(function(){setTimeout(function(){t({pageLoadTimeMs:he(r),component:r})})});return n.current=i.sizeInPixels,function(){window.cancelAnimationFrame(o)}}},[e,a,t])}(e.onMainTextureLoaded);return s.a.createElement(N_,B_({},e,{onMainTextureLoaded:i,ref:t}))}))),z_=function(){return z_=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},z_.apply(this,arguments)},G_={getEdits:function(){},resetEdits:function(){},setEdits:function(){}},K_={resetEdits:Hr,setEdits:Rr},W_=Object(R.connect)(function(e){return{imageMatrix:yd(e.transformTools),cropMatrix:e.transformTools.cropInteraction.uvToWorld,originalImageSize:e.transformTools.image.originalPixelSize,adjustments:e.colorAdjustments,filters:e.filters,autoEnhance:e.autoEnhance,aspectRatioConstraint:e.transformTools.cropInteraction.aspectRatioConstraint,shouldInvertOriginalAspectRatio:e.transformTools.cropInteraction.shouldInvertOriginalAspectRatio,markupContentItems:e.markup.markupContentItems}},K_)(function(e){var t=e.imageMatrix,n=e.cropMatrix,a=e.originalImageSize,i=e.adjustments,r=e.filters,s=e.autoEnhance,c=e.aspectRatioConstraint,d=e.shouldInvertOriginalAspectRatio,l=e.markupContentItems,u=e.resetEdits,f=e.setEdits,p=e.onEditsChanged,m=e.forwardedRef,_=Object(o.useMemo)(function(){return td(n,t,a,i,r,s,c,d,l)},[t,n,a,i,r,s,c,d,l]),h=Se();Object(o.useEffect)(function(){p&&p()},[_,p]);var b=Object(o.useCallback)(function(e){var t=Ne(e),n=t.isValid,a=t.message;n?f(e):h({id:"SetEditsIgnored",message:"ValidationError: "+a})},[f,h]);return Object(o.useImperativeHandle)(m,function(){return{getEdits:function(){return _},resetEdits:function(){return u(!1)},setEdits:b}},[_,u,b]),null}),q_=Object(o.forwardRef)(function(e,t){return s.a.createElement(W_,z_({},e,{forwardedRef:t}))}),Q_=function(){return Q_=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Q_.apply(this,arguments)},Y_={getUiState:function(){},resetUiState:function(){},setUiState:function(){}},J_={setUiState:uo,resetUiState:fo},X_=Object(R.connect)(function(e){return{uiState:e.uiState}},J_)(function(e){var t=e.uiState,n=e.resetUiState,a=e.setUiState,i=e.onUiStateChanged,r=e.forwardedRef,s=Object(o.useRef)(t);return Object(o.useEffect)(function(){s.current=t,i&&i()},[t,i]),Object(o.useImperativeHandle)(r,function(){return{getUiState:function(){return Q_({},s.current)},resetUiState:n,setUiState:a}},[n,a]),null}),Z_=Object(o.forwardRef)(function(e,t){return s.a.createElement(X_,Q_({},e,{forwardedRef:t}))}),$_=s.a.memo(function(e){var t=e.cropWidth,n=e.cropHeight,a=e.position,i=e.opacity,r=function(e,t){var n=Object(o.useContext)(Le).strings,a=e.toString(),i=t.toString();return{imageDimension:nu(n.editor_imageDimensionLabelFormatString,a,i),imageDimensionAriaLabel:nu(n.editor_imageDimensionAriaLabelFormatString,a,i)}}(t,n),c=r.imageDimension,d=r.imageDimensionAriaLabel;return s.a.createElement(su,{style:{top:a.y,left:a.x,transform:"translateX(-50%)",opacity:i},visible:i>0},s.a.createElement("span",{"aria-label":d},c))}),eh=Vt([uu],function(e){return{x:e.left+e.width/2,y:e.top+e.height+-36}}),th=Object(R.connect)(function(e){return{cropWidth:Wm(e.transformTools),cropHeight:qm(e.transformTools),position:eh(e.transformTools),opacity:mu(e.transformTools)}})($_);function nh(e,t,n){return t?{width:e.x/n+"px",height:e.y/n+"px"}:{width:"100%",height:"100%"}}var ah=function(){return ah=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ah.apply(this,arguments)},ih=s.a.memo(function(e){var t=e.setCanvasPixelSize,n=e.setCssToPhysicalPixelRatio,a=e.cssToPhysicalPixelRatio,i=e.canvasSize,r=e.activePivot,c=e.children,d=Object(o.useState)(null),l=d[0],u=d[1],f=a||window.devicePixelRatio||1;Object(o.useLayoutEffect)(function(){n(f)},[f,n]);var p=function(e,t,n){var a=n===window.devicePixelRatio,i=Object(o.useRef)(),r=!i.current||!a,s=Object(o.useCallback)(function(){if(e){var a=r?function(e,t){var n=e.getBoundingClientRect();return{x:Math.floor(n.width*t),y:Math.floor(n.height*t)}}(e,n):i.current;a&&t({pixelSize:a,cssSize:nh(a,r,n)})}},[i,t,n,e,r]),c=Object(o.useCallback)(function(e){i.current=ah({},e),s()},[i,s]);return function(e,t){var n=Object(o.useCallback)(function(n){if(e){var a=n.find(function(t){return t.target===e});if(a&&a.devicePixelContentBoxSize&&a.devicePixelContentBoxSize[0]){var i=a.devicePixelContentBoxSize[0].inlineSize,r=a.devicePixelContentBoxSize[0].blockSize;t({x:i,y:r})}}},[t,e]);Object(o.useEffect)(function(){try{if(window.ResizeObserver&&e){var t=new ResizeObserver(n);return t.observe(e,{box:"device-pixel-content-box"}),function(){t.disconnect()}}}catch(e){}},[e,n])}(e,c),s}(l,t,f);return Object(o.useLayoutEffect)(function(){p()},[i,r,p]),s.a.createElement("div",{style:{position:"relative",height:"100%",width:"100%"},ref:u},c)});ih.displayName="SetCanvasSize";var rh=function(){return rh=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},rh.apply(this,arguments)},oh={setCanvasPixelSize:Do,setCssToPhysicalPixelRatio:Ro},sh=Object(R.connect)(function(e){return{activePivot:e.uiState.activeEditorActivity}},oh)(function(e){return s.a.createElement(ih,rh({},e))}),ch=function(e){return s.a.createElement(sh,rh({},e))};ch.displayName="SetCanvasSizeConnect";var dh=s.a.memo(function(e){var t=e.activeEditorActivity,n=e.match,a=e.children;return(Array.isArray(n)?n.some(function(e){return e===t}):n===t)?s.a.createElement(s.a.Fragment,null,a):null}),lh=Object(R.connect)(function(e){return{activeEditorActivity:e.uiState.activeEditorActivity}},null)(dh),uh=function(){return uh=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},uh.apply(this,arguments)},fh={setAriaAnnouncement:Cs},ph=Object(R.connect)(function(e){var t=wd(uh(uh({},ba),{colorAdjustments:e.colorAdjustments,filters:e.filters,autoEnhance:e.autoEnhance,markup:e.markup})),n=e.uiState.isViewingOriginal,a=!e.transformTools.animations.transitionToViewingOriginal.isActive,i=e.transformTools.cropInteraction.mode===da.draggingView;return{visible:n&&t&&a&&!i}},fh)(function(e){var t=e.visible,n=e.gutterSize,a=void 0===n?32:n,i=e.setAriaAnnouncement,r=Object(o.useContext)(Le).strings,c={bottom:a+"px",left:"50%",transform:"translateX(-50%)"};return Object(o.useEffect)(function(){t&&i(r.editor_viewingOriginalAriaLive)},[t,i,r]),s.a.createElement(su,{visible:t,style:c},r.editor_viewingOriginal)});Object(Cl.n)([{rawString:".EditorCommandBarStack_e8ecbb5e{padding:0 12px;overflow:hidden;height:44px}.CommandBarBeginningStackItem_e8ecbb5e{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.CommandBarMiddleStackItem_e8ecbb5e{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.CommandBarEndStackItem_e8ecbb5e{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.CommandBarEndStackItem_e8ecbb5e>*{margin:0 4px}.MobileCommandBarStack_e8ecbb5e{padding:0 12px;overflow:hidden;height:56px}.MobileCommandBarEndStackItem_e8ecbb5e{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:0}"}]);var mh,_h="CommandBarBeginningStackItem_e8ecbb5e";!function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(mh||(mh={}));var hh=n(2125),bh=n(1524),gh=n(1556),vh=n(1533),yh=function(){return yh=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},yh.apply(this,arguments)};function Sh(e){return{root:{color:e.palette.themePrimary,fill:e.palette.themePrimary},rootHovered:{backgroundColor:e.palette.neutralLight},rootPressed:{backgroundColor:e.palette.neutralQuaternaryAlt},rootDisabled:{fill:e.palette.neutralTertiary},icon:{width:"16px",height:"16px"}}}function Dh(e){return{backgroundColor:e.palette.themeSecondary,color:e.palette.white,border:"none"}}var Ih={root:{fontSize:"18px",width:"18px",height:"18px",lineHeight:"18px"}},xh=n(1771).ReactReduxContext;function Ch(){if(!xh._currentValue)throw new Error("useStore must used within a Redux store. Ensure you have a ImageEditorContext defined.");return xh._currentValue.store}function Oh(){var e=Object(o.useContext)(xc).enableMarkup,t=Object(o.useContext)(_e).logMarkupSummaryEvent,n=Ch();return Object(o.useCallback)(function(){if(e){var a=n.getState().markup;t({strokeCount:(null==a?void 0:a.markupContentItems.length)||0})}},[e,t,n])}function wh(e){var t=Object(o.useContext)(_e).logCancelEvent,n=Oh();return Object(o.useCallback)(function(a){n(),t({inputType:Ou(a)}),e()},[t,e,n])}var Eh=Object(o.memo)(function(e){var t=e.onCancel,n=e.styles,a=e.iconProps,i=Object(gc.e)(),r=Object(o.useContext)(Le).strings,c=Object(o.useMemo)(function(){return Object(cc.g)(Sh(i),n)},[i,n]),d=wh(t);return s.a.createElement(s.a.Fragment,null,a?s.a.createElement(gh.e,{key:"Cancel",iconProps:a,styles:c,ariaLabel:r.toolbar_cancelAriaLabel,title:r.toolbar_cancelTooltip,role:"button",onClick:d}):s.a.createElement(vh.e,{key:"Cancel",text:"Cancel",styles:c,onClick:d,ariaLabel:r.toolbar_cancelAriaLabel,title:r.toolbar_cancelTooltip}))}),Ah=function(){return Ah=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ah.apply(this,arguments)},Lh=Object(o.memo)(function(e){var t=e.stackResponseMode,n=e.styles,a={color:Object(gc.e)().palette.neutralPrimaryAlt,lineHeight:"43px"};return s.a.createElement(s.a.Fragment,null,t>=mh.Medium&&s.a.createElement("div",{"aria-hidden":"true",style:Ah(Ah({},a),n)},"|"))}),kh=n(1537);function Mh(e,t,n){var a=Object(o.useContext)(_e).logEditResetEvent,i=Object(o.useContext)(zc).setImageOverlay;return Object(o.useCallback)(function(r){a({inputType:Ou(r)}),e(!0),i(null),t(n)},[a,e,i,t,n])}var Ph=n(541),Th=n(1677),Uh=n(1340),Fh=n(1834),Hh=function(){return Hh=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Hh.apply(this,arguments)},Rh=Object(o.memo)(function(e){var t=e.isVisible,n=e.dialogStrings,a=e.hostId,i=e.dialogType,r=void 0===i?Ph.e.close:i,c=e.styles,d=e.onConfirm,l=e.onCancel,u=Object(gc.e)(),f={type:r,title:n.contentTitle,closeButtonAriaLabel:n.closeButtonAriaLabel,subText:n.contentSubText,styles:null==c?void 0:c.dialogContent},p=Object(o.useMemo)(function(){var e={main:{backgroundColor:u.palette.neutralLighterAlt}};return Object(cc.g)(e,null==c?void 0:c.dialog)},[null==c?void 0:c.dialog,u]);return s.a.createElement(Th.e,{hidden:!t,onDismiss:l,dialogContentProps:f,modalProps:Hh({styles:p},a&&{layerProps:{hostId:a,styles:null==c?void 0:c.layer}})},s.a.createElement(Uh.e,{styles:null==c?void 0:c.dialogFooter},s.a.createElement(Fh.e,{"data-test-id":"reset-confirm",onClick:d,text:n.confirmText,ariaLabel:n.confirmAriaLabel,styles:null==c?void 0:c.confirmButton}),s.a.createElement(vh.e,{onClick:l,text:n.cancelText,ariaLabel:n.cancelAriaLabel,styles:null==c?void 0:c.cancelButton})))}),Nh=Object(o.memo)(function(e){var t=e.isVisible,n=e.hostId,a=e.dialogType,i=void 0===a?Ph.e.close:a,r=e.styles,c=e.onConfirm,d=e.onCancel,l=Object(o.useMemo)(function(){return Object(L.e)({dialog:{main:{minHeight:"160px"}}},r)},[r]),u=Object(o.useContext)(Le).strings,f={contentTitle:u.toolbar_resetConfirmDialogContentTitle,contentSubText:u.toolbar_resetConfirmDialogContentSubText,closeButtonAriaLabel:u.toolbar_resetConfirmDialogCloseButtonAriaLabel,confirmText:u.toolbar_resetConfirmDialogConfirmText,confirmAriaLabel:u.toolbar_resetConfirmDialogConfirmAriaLabel,cancelText:u.toolbar_resetConfirmDialogCancelText,cancelAriaLabel:u.toolbar_resetConfirmDialogCancelAriaLabel};return s.a.createElement(Rh,{isVisible:t,hostId:n,dialogType:i,dialogStrings:f,styles:l,onConfirm:c,onCancel:d})}),Bh=function(){return Bh=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Bh.apply(this,arguments)},jh=Object(o.memo)(function(e){var t=e.stackResponseMode,n=e.resetDisabled,a=e.isResetEditsConfirmationDialogVisible,i=e.toggleIsResetEditsConfirmationDialogVisible,r=e.resetEdits,c=e.setAriaAnnouncement,d=e.resetButtonStyles,l=e.confirmationDialogStyles,u=Object(gc.e)(),f=Object(o.useContext)(Le).strings,p=Object(o.useMemo)(function(){return Object(cc.g)(function(e){return{root:{color:e.palette.neutralPrimary,height:"32px"},rootDisabled:{color:e.palette.neutralTertiary},rootHovered:{color:e.palette.neutralPrimary,backgroundColor:e.palette.neutralLight},rootPressed:{color:e.palette.neutralPrimary,backgroundColor:e.palette.neutralQuaternaryAlt},icon:{color:e.palette.themePrimary}}}(u),d)},[u,d]),m=Mh(r,c,f.toolbar_imageResetFinishedAriaLive);return s.a.createElement(s.a.Fragment,null,s.a.createElement(kh.e,{key:"Reset",text:t>mh.Medium?f.toolbar_imageReset:void 0,styles:p,ariaLabel:f.toolbar_imageResetAriaLabel,title:f.toolbar_imageResetTooltip,iconProps:{iconName:"History"},onClick:function(){i()},disabled:n,role:"button","data-test-id":"reset",allowDisabledFocus:!0}),a&&s.a.createElement("span",{style:{margin:"0px"}},s.a.createElement(Nh,{onConfirm:function(e){m(e),i()},onCancel:function(){i()},isVisible:a,styles:l})))}),Vh={resetEdits:Hr,setAriaAnnouncement:Cs,toggleIsResetEditsConfirmationDialogVisible:_o},zh=Object(R.connect)(function(e){return{resetDisabled:Ed(Bh(Bh({},e.transformTools),{colorAdjustments:e.colorAdjustments,filters:e.filters,autoEnhance:e.autoEnhance,markup:e.markup})),isResetEditsConfirmationDialogVisible:e.uiState.isResetEditsConfirmationDialogVisible}},Vh)(jh);function Gh(e){return e}var Kh=Vt(Gh,function(e){return ar(e,-.05).uvToWorld}),Wh=Vt(Gh,function(e){return ar(e,$a).uvToWorld}),qh=Vt(function(e){return e},function(e){return e.cropInteraction.enableZoomToCrop&&Wn(e.cropInteraction.uvToWorld,Kh(e))||e.view.enableZoomToView&&Zi(e,zn(e.view.worldToView)).zoomIsMaximum}),Qh=Vt(function(e){return e},function(e){return e.cropInteraction.enableZoomToCrop&&Wn(e.cropInteraction.uvToWorld,Wh(e))||e.view.enableZoomToView&&e.view.viewFitting.mode===la.fitCropRectInView});function Yh(e,t){var n=Object(o.useRef)(e);return t||(n.current=e),n.current}var Jh=Object(o.memo)(function(e){var t=e.stackResponseMode,n=e.zoomInDisabled,a=e.zoomOutDisabled,i=e.freezeZoomInOutDisabled,r=e.currentZoom,c=e.setAriaAnnouncementScenario,d=e.handleZoomDeltaChange,l=e.styles,u=Object(gc.e)(),f=Object(o.useContext)(Le).strings,p=Object(o.useMemo)(function(){return Object(cc.g)(Sh(u),l)},[u,l]),m=Object(o.useCallback)(function(){d(-.05),c({type:"Zoom",zoom:r})},[r,c,d]),_=Object(o.useCallback)(function(){d($a),c({type:"Zoom",zoom:r})},[r,c,d]),h=Yh(n,i),b=Yh(a,i);return s.a.createElement(s.a.Fragment,null,t>mh.Small&&s.a.createElement(s.a.Fragment,null,s.a.createElement(gh.e,{key:"ZoomIn",iconProps:{iconName:"ZoomIn"},styles:p,ariaLabel:f.toolbar_zoomInAriaLabel,title:f.toolbar_zoomInTooltip,role:"button",onClick:m,disabled:h,"data-test-id":"zoom-in"}),s.a.createElement(gh.e,{key:"ZoomOut",iconProps:{iconName:"ZoomOut"},styles:p,ariaLabel:f.toolbar_zoomOutAriaLabel,title:f.toolbar_zoomOutTooltip,role:"button",onClick:_,disabled:b,"data-test-id":"zoom-out"})))}),Xh={handleZoomDeltaChange:Lo,setAriaAnnouncementScenario:Os},Zh=Object(R.connect)(function(e){var t=e.transformTools,n=!t.cropInteraction.enableZoomToCrop&&!t.view.enableZoomToView,a=t.rotationUi.rotationBarPointer.isDown;return{currentZoom:h_(t),zoomInDisabled:n||qh(t),zoomOutDisabled:n||Qh(t),freezeZoomInOutDisabled:a}},Xh)(Jh);function $h(e){var t=Object(o.useContext)(_e).logSaveEvent,n=Ch(),a=Oh(),i=Object(o.useCallback)(function(i){return function(r){var o,s=n.getState().filters;a(),t({saveType:i,filterName:null===(o=null==s?void 0:s.activeFilter)||void 0===o?void 0:o.name,filterIntensity:null==s?void 0:s.filterLevel,inputType:function(){if(r){var e=r;return void 0!==e.buttons?Ou(e):"Keyboard"}return""}()}),e(i)}},[t,e,n,a]);return{onSaveOriginal:Object(o.useMemo)(function(){return i(nd.SaveAsOriginal)},[i]),onSaveAsCopy:Object(o.useMemo)(function(){return i(nd.SaveAs)},[i])}}var eb,tb=n(97),nb=Object(o.memo)(function(e){var t=e.onSave,n=e.styles,a=Object(o.useContext)(Le).strings,i=Object(gc.e)(),r=$h(t),c=r.onSaveOriginal,d=r.onSaveAsCopy,l=Object(o.useMemo)(function(){return Object(cc.g)(function(e){return{root:yh(yh({},Dh(e)),{margin:"0px 4px"}),rootDisabled:{backgroundColor:e.palette.neutralQuaternaryAlt,color:e.palette.neutralTertiary},rootHovered:Dh(e),rootPressed:Dh(e),rootExpanded:Dh(e)}}(i),n)},[i,n]),u=Object(o.useContext)(Ad),f=!u.has(nd.SaveAsOriginal),p=!u.has(nd.SaveAs);return s.a.createElement(Fh.e,{text:a.toolbar_imageSave,title:a.toolbar_imageSaveTooltip,styles:l,menuTriggerKeyCode:tb.e.down,"data-test-id":"save_menu",menuProps:{items:[{key:"SaveOriginal",text:a.toolbar_imageSaveAsOriginal,ariaLabel:a.toolbar_imageSaveAsOriginalAriaLabel,title:a.toolbar_imageSaveAsOriginalTooltip,iconProps:{iconName:"Save"},onClick:c,disabled:f},{key:"SaveCopy",text:a.toolbar_imageSaveAsCopy,ariaLabel:a.toolbar_imageSaveAsCopyAriaLabel,title:a.toolbar_imageSaveAsCopyTooltip,iconProps:{iconName:"SaveAs"},onClick:d,disabled:p}]},disabled:f&&p,allowDisabledFocus:!0})}),ab=function(){return ab=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ab.apply(this,arguments)},ib=s.a.memo(function(e){var t=e.currentZoom,n=e.styles,a=Object(o.useContext)(Le),i=a.localizePercentage,r=a.strings,c=Object(gc.e)(),d={color:c.palette.neutralPrimaryAlt,lineHeight:"24px"},l=r;return s.a.createElement("div",{style:ab({},null==n?void 0:n.container)},s.a.createElement("span",{style:ab(ab({float:Object(Tl.e)(c)?"left":"right"},d),null==n?void 0:n.label),"aria-label":l.toolbar_zoomLevelAriaLabel},i(t)))}),rb=Object(R.connect)(function(e){return{currentZoom:h_(e.transformTools)}})(ib),ob=function(){return ob=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ob.apply(this,arguments)},sb=((eb={})[mh.Large]=315,eb[mh.Medium]=282,eb[mh.Small]=162,eb),cb=s.a.memo(function(e){var t=e.componentSize,n=e.customItems,a=e.onSave,i=e.onCancel,r=e.controlPivot,c=e.resetButtonStyles,d=e.confirmationDialogStyles,l=Object(o.useState)(null),u=l[0],f=l[1],p=Object(o.useState)(mh.Large),m=p[0],_=p[1],h=Object(gc.e)(),b=sb[m];return Object(o.useLayoutEffect)(function(){u&&(u.clientWidth>850?_(mh.Large):u.clientWidth>785?_(mh.Medium):_(mh.Small))},[u,t]),s.a.createElement("div",{ref:f},s.a.createElement(hh.e,{className:"EditorCommandBarStack_e8ecbb5e",horizontal:!0,styles:{root:{backgroundColor:h.palette.neutralLighter,borderBottom:h.palette.neutralQuaternary+" solid 1px"}}},s.a.createElement(hh.e.Item,{className:_h,styles:{root:{width:b}},grow:!r},s.a.createElement(nb,{onSave:a}),null==n?void 0:n.map(function(e){var t=e.key,n=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["key"]);return s.a.createElement(bh.e,ob({key:t},n))})),r&&s.a.createElement(hh.e.Item,{grow:!0,disableShrink:!0,className:"CommandBarMiddleStackItem_e8ecbb5e"},r),s.a.createElement(hh.e.Item,{className:"CommandBarEndStackItem_e8ecbb5e",styles:{root:{width:b}},grow:!r},s.a.createElement(zh,{stackResponseMode:m,resetButtonStyles:c,confirmationDialogStyles:d}),s.a.createElement(Lh,{stackResponseMode:m}),s.a.createElement(rb,{styles:{container:{width:"45px",padding:"0px 4px"}}}),s.a.createElement(Zh,{stackResponseMode:m}),s.a.createElement(Eh,{onCancel:i,iconProps:{iconName:"cancel"}}))))});function db(e){return{count:{},icon:{color:e.palette.themePrimary,svg:{width:"1em",height:"1em",fill:"currentcolor"},i:{height:"100%",display:"flex",alignItems:"center"},fontSize:"16px"},link:{height:"34px",lineHeight:"34px","&:hover":{backgroundColor:e.palette.neutralLight},"&:active":{backgroundColor:e.palette.neutralQuaternaryAlt}},linkContent:{height:"100%",display:"flex"},linkIsSelected:{height:"34px",lineHeight:"34px","&:hover":{backgroundColor:e.palette.neutralLight},color:e.palette.neutralPrimary},root:{"button:hover i":{color:e.palette.themeDarkAlt},display:"flex"},text:{marginInlineStart:"4px"}}}cb.displayName="EditorCommandBar";var lb=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},ub=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},fb=function(e){var t=function(){var e=this,t=Object(o.useContext)(zc),n=t.image,a=t.offscreenRenderer,i=function(e){var t=Se(),n=Object(o.useContext)(Hd);return Object(o.useCallback)(function(){return!R_(e,n)&&(t({id:"SaveFailed",message:"Full size image has not loaded."}),!0)},[t,e,n])}(n);return{getEditedImage:Object(o.useCallback)(function(t){return void 0===t&&(t=n),lb(e,void 0,void 0,function(){return ub(this,function(e){return i()?[2,null]:a?[2,a.getEditedImage(t)]:[2,null]})})},[i,n,a]),getEditedImageBytes:Object(o.useCallback)(function(t){return void 0===t&&(t=n),lb(e,void 0,void 0,function(){return ub(this,function(e){return i()?[2,null]:a?[2,a.getEditedImageBytes(t)]:[2,null]})})},[i,n,a])}}(),n=t.getEditedImage,a=t.getEditedImageBytes,i=Object(o.useRef)(G_),r=Object(o.useRef)(Y_);return Object(o.useImperativeHandle)(e,function(){return{getEdits:function(){return i.current.getEdits()},setEdits:function(e){return i.current.setEdits(e)},getEditedImage:n,getEditedImageBytes:a,resetEdits:function(){i.current.resetEdits()},getUiState:function(){return r.current.getUiState()},setUiState:function(e){return r.current.setUiState(e)},resetUiState:function(){return r.current.resetUiState()}}},[n,a]),{editOperationsRef:i,editUiStateRef:r}};Object(Cl.n)([{rawString:".dismissButton_23822781{margin-top:16px;margin-bottom:8px;border:none}"}]);var pb=Object(o.memo)(function(e){var t=e.styles,n=e.setShowAspectRatioOptions,a=Object(gc.e)(),i=Object(o.useContext)(Le).strings,r=Object(o.useCallback)(function(){n(!1)},[n]);return s.a.createElement(vh.e,{className:"dismissButton_23822781",text:i.footer_done,onClick:r,theme:a,styles:t})});pb.displayName="DesktopDismissAspectRatioOptionsButton";var mb={setShowAspectRatioOptions:no},_b=Object(R.connect)(null,mb)(pb);Object(Cl.n)([{rawString:".actionsStackContainer_7d1b69c4{position:absolute;bottom:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;width:100%}"}]);var hb=Object(o.memo)(function(e){var t=e.children,n=e.styles,a=void 0===n?{}:n;return s.a.createElement("div",{className:"actionsStackContainer_7d1b69c4",style:a.container},t)}),bb=null;function gb(e,t,n){var a=function(){if(!bb){var e=document.createElement("canvas");bb=e.getContext("2d")}return bb}(),i=0;if(a){a.font=t+"px "+n;var r=a.measureText(e);i=Math.ceil(r.width)}return i}var vb=function(){return vb=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},vb.apply(this,arguments)};function yb(e){return{backgroundColor:"transparent",color:e.palette.neutralPrimaryAlt,fill:e.palette.neutralPrimaryAlt,cursor:"default"}}function Sb(e){var t=yb(e);return{root:vb(vb({},t),{padding:"10px",width:"auto",height:"auto"}),rootPressed:vb(vb({},t),{color:e.palette.neutralTertiary,fill:e.palette.neutralTertiary}),rootHovered:vb({},t),rootDisabled:{backgroundColor:"transparent",i:{color:e.palette.neutralQuaternaryAlt}}}}var Db={root:{fontSize:"18px",width:"18px",height:"18px",lineHeight:"18px",margin:"0px"}},Ib={height:"16px",lineHeight:"16px",margin:"0px",fontWeight:"500"},xb=function(e){return{backgroundColor:e.palette.neutralPrimaryAlt,color:e.palette.white,cursor:"default"}},Cb=function(e,t){var n=function(e){var t=yb(e);return vb(vb({},t),{padding:"8px 0px",minWidth:"unset",width:"auto",height:"auto"})}(e);return{label:{fontWeight:"500",fontSize:t+"px",display:"inline-block",lineHeight:"100%",margin:Object(Tl.e)(e)?"0px 8px 0px 0px":"0px 0px 0px 8px"},root:n,rootPressed:vb(vb({},n),{color:e.palette.neutralTertiary,fill:e.palette.neutralTertiary}),rootHovered:vb({},n),rootDisabled:{backgroundColor:"transparent",i:{color:e.palette.neutralQuaternaryAlt}}}};function Ob(e){var t=yb(e),n=Object(Tl.e)(e);return{icon:{fontSize:"18px",width:"18px",height:"16px",margin:"4px 3px"},root:vb(vb({},t),{marginRight:n?"4px":"16px",marginLeft:n?"16px":"4px",marginBottom:"16px",marginTop:"16px",width:"auto",height:"auto",padding:"0px"}),rootPressed:vb(vb({},t),{color:e.palette.neutralTertiary,fill:e.palette.neutralTertiary}),rootHovered:vb({},t),rootDisabled:vb(vb({},t),{backgroundColor:"transparent",i:{color:e.palette.neutralQuaternaryAlt}})}}var wb=n(1443);Object(Cl.n)([{rawString:".tileContainer_73a5ba4a{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-width:80px;margin-top:8px}.tileContainer_73a5ba4a .tile_73a5ba4a{position:relative;background-color:transparent;border-radius:4px;width:100%;height:100%}.tileContainer_73a5ba4a .tile_73a5ba4a :active{border-radius:4px}.tileContainer_73a5ba4a .tileName_73a5ba4a{font-size:12px;pointer-events:auto}.ms-Fabric--isFocusHidden .tileContainer_73a5ba4a .tile_73a5ba4a button{outline:0}.ms-Fabric--isFocusVisible .tileContainer_73a5ba4a .tile_73a5ba4a button:focus{outline-color:inherit;outline-width:1px;outline-style:solid}"}]);var Eb,Ab=function(){return Ab=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ab.apply(this,arguments)},Lb=((Eb={}).Crop={top:80,left:24,right:24,bottom:149},Eb.Adjustment=Ab(Ab({},ua(0)),{top:56,bottom:206}),Eb.Filter=Ab(Ab({},ua(0)),{top:56,bottom:206}),Eb.Markup=Ab(Ab({},ua(0)),{top:56,bottom:73}),Eb),kb={container:{borderRadius:"4px",overflow:"hidden"},body:{display:"flex",flexDirection:"column"},footer:{margin:"8px 16px"}},Mb=Object(cc.g)(kb,{body:{position:"relative",justifyContent:"flex-end",alignItems:"center"}});function Pb(e,t){return{container:{marginTop:"0px"},background:{width:("Landscape"===e.orientation?124:107)+"px",height:("Landscape"===e.orientation?108:94)+"px",backgroundColor:t.palette.neutralLighterAlt,activeBackgroundOverride:{backgroundColor:t.palette.neutralQuaternary},disabledBackgroundOverride:{color:t.palette.neutralQuaternaryAlt,fill:t.palette.neutralQuaternaryAlt},cursor:"default"},icon:{fontSize:"26px",height:"26px",width:"26px",color:t.palette.black,fill:t.palette.black},name:{fontSize:"14px",marginTop:"16px",margin:"16px 8px 0px 8px",fontWeight:400,color:t.palette.black,wordBreak:"break-word",activeNameOverride:{color:t.palette.black,fontWeight:500},disabledNameOverride:{color:t.palette.neutralQuaternaryAlt}}}}function Tb(e,t){var n=Object(Tl.e)(t),a=Pb(e,t);return Ab(Ab({},a),{container:Ab(Ab({},a.container),{marginTop:"0px",width:("Landscape"===e.orientation?508:662)+"px"}),background:Ab(Ab({},a.background),{width:"100%",height:"64px"}),name:Ab(Ab({},a.name),{margin:n?"0px 11px 0px 0px":"0px 0px 0px 11px"})})}function Ub(e,t){var n=Pb(e,t);return{background:Ab(Ab({},n.background),{width:"89px",height:"216px",border:"2px solid "+t.palette.black,disabledBackgroundOverride:{color:t.palette.neutralQuaternaryAlt,border:"2px solid "+t.palette.neutralQuaternaryAlt},textAlign:"center"}),icon:Ab({},n.icon),name:Ab(Ab({},n.name),{marginTop:"7px",padding:"5px"})}}var Fb=function(e,t){return{activeSection:{height:"32px",backgroundColor:e.palette.black,borderRadius:"0"},container:{margin:"3px 0px 16px"},inactiveSection:{backgroundColor:"transparent"},line:{},lineContainer:{},root:{},slideBox:{height:"32px",borderRadius:"100px",backgroundColor:e.palette.black+"1A",padding:"0px 16px",margin:"0px",boxShadow:"inset 0px -2px 2px "+e.palette.white+"1A, inset 0px 2px 2px "+e.palette.white+"80","&:hover":{".ms-Slider-active":{backgroundColor:e.palette.black},".ms-Slider-inactive":{backgroundColor:"transparent"},".ms-Slider-thumb":{border:"4px solid "+e.palette.black},".ms-Slider-zeroTick":{backgroundColor:e.palette.black}},"&:active":{".ms-Slider-active":{backgroundColor:e.palette.black},".ms-Slider-inactive":{backgroundColor:"transparent"},".ms-Slider-thumb":{border:"4px solid "+e.palette.black},".ms-Slider-zeroTick":{backgroundColor:e.palette.black}}},thumb:{width:"32px",height:"32px",background:e.palette.white,border:"4px solid "+e.palette.black,boxSizing:"border-box",top:"calc(50% - 32px/2)",borderRadius:"24px"},titleLabel:{},valueLabel:{},zeroTick:{width:"32px",height:"32px",backgroundColor:e.palette.black,borderRadius:"24px",top:"calc(50% - 32px/2)",transform:zb(32,e),display:"block"}}},Hb={root:{fontSize:"24px",width:"24px",height:"24px"}};function Rb(e){return Ab(Ab({},kb),{adjustmentSlider:{getSliderStyles:Fb,getSliderHeaderStyles:function(){return{container:{fontSize:"16px",lineHeight:"24px",display:"grid"},labelValueHeader:{icon:Hb}}}},sectionHeader:{lineHeight:"24px",margin:"16px 0px 9px 16px",color:e.palette.neutralDark}})}function Nb(e){var t=function(e){return{backgroundColor:"transparent",color:e.palette.neutralPrimaryAlt,fill:e.palette.neutralPrimaryAlt,margin:"0px 12px",cursor:"default"}}(e);return{root:Ab(Ab({},t),{padding:"11px",width:"auto",height:"auto"}),rootHovered:t,rootPressed:Ab(Ab({},t),{color:e.palette.neutralSecondary,fill:e.palette.neutralSecondary})}}var Bb={root:{fontSize:"18px",width:"18px",height:"18px",lineHeight:"18px",margin:"0px"}},jb={root:{minWidth:"75px",marginBottom:"8px",marginTop:"8px",height:"40px",padding:"12px 20px",borderRadius:"100px",border:"none",fontSize:"16px"}},Vb={root:{fontSize:"16px"}};function zb(e,t){return Object(Tl.e)(t)?"translateX("+e/2+"px)":"translateX("+-e/2+"px)"}var Gb,Kb=function(e,t){var n=Fb(e);return Ab(Ab({},n),{container:{margin:"auto",position:"absolute",right:0,left:0,marginLeft:"auto",marginRight:"auto",width:"calc(100% - 128px)",zIndex:1,bottom:"8px"},slideBox:Object(cc.U)(n.slideBox,{padding:"0px",backgroundColor:""+e.palette.neutralLighter})})},Wb=function(e){return{container:{zIndex:1,position:"absolute",width:"calc(100% - 128px)",right:0,left:0,marginLeft:"auto",marginRight:"auto",bottom:"48px"},valueHeader:{width:"42px",height:"42px",borderRadius:"50%",backgroundColor:e.palette.white+"CC",textAlign:"center",border:"1px solid "+e.palette.black+"33",boxSizing:"border-box",fontSize:"16px",color:e.palette.neutralPrimaryAlt}}},qb=function(){return qb=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},qb.apply(this,arguments)},Qb=((Gb={}).Crop={top:80,left:24,right:24,bottom:149},Gb.Adjustment=qb(qb({},ua(0)),{top:56,bottom:170}),Gb.Filter=qb(qb({},ua(0)),{top:56,bottom:170}),Gb.Markup=qb(qb({},ua(0)),{top:56,bottom:73}),Gb),Yb=.8,Jb=function(){return Jb=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Jb.apply(this,arguments)};function Xb(e,t,n,a){return Jb(Jb(Jb(Jb({},a),e&&a.highlightBackgroundOverride),t&&a.activeBackgroundOverride),n&&a.disabledBackgroundOverride)}function Zb(e,t,n){return Jb(Jb(Jb({},n),e&&Jb(Jb({},$b),null==n?void 0:n.activeNameOverride)),t&&(null==n?void 0:n.disabledNameOverride))}var $b={fontWeight:"bold"};function eg(e){return{background:{width:"48px",height:"48px",activeBackgroundOverride:{backgroundColor:e.palette.neutralQuaternary},highlightBackgroundOverride:{backgroundColor:e.palette.themeLighter},outlineColor:e.palette.neutralDark},icon:{fontSize:"20px",width:"20px",height:"20px",color:e.palette.neutralPrimaryAlt,fill:e.palette.neutralPrimaryAlt},name:{marginTop:"6px",activeNameOverride:{color:e.palette.black},padding:"0 5px",textAlign:"center",wordBreak:"break-word",wordWrap:"break-word"}}}function tg(e){var t=eg(e);return Jb({},t)}function ng(e){var t=eg(e);return Jb(Jb({},t),{background:Jb(Jb({},t.background),{cursor:"default"}),name:Jb(Jb({},t.name),{activeNameOverride:{color:e.palette.black,fontWeight:500},padding:0,height:"36px",lineHeight:"12px",fontWeight:400})})}function ag(e){return{image:{borderRadius:"4px",marginTop:"0px",marginBottom:"0px"},background:{cursor:"default"},container:{marginTop:"8px",marginBottom:"0px",minWidth:"80px"},name:{activeNameOverride:{color:e.palette.black,fontWeight:500},marginTop:"6px",padding:0,fontWeight:400,textAlign:"center",height:"36px",lineHeight:"12px"},icon:{fontSize:"18px",width:"18px",height:"18px"}}}function ig(e){var t=ag(e);return Jb(Jb({},t),{image:Jb(Jb({},t.image),{width:"76px",height:"76px",marginTop:"0px"}),container:Jb(Jb({},t.container),{minWidth:"92px",marginTop:"8px"})})}var rg,og=function(){return og=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},og.apply(this,arguments)},sg=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)a[i]=r[o];return a};!function(e){e[e.BelowTile=0]="BelowTile",e[e.InsideTileBesideIcon=1]="InsideTileBesideIcon",e[e.InsideTileBelowIcon=2]="InsideTileBelowIcon"}(rg||(rg={}));var cg,dg=Object(o.forwardRef)(function(e,t){var n=e.name,a=e.ariaLabel,i=e.ariaSelected,r=e.namePosition,d=void 0===r?rg.BelowTile:r,l=e.iconName,u=e.tileClassNames,f=e.tileStyles,p=e.isHighlighted,m=e.isActive,_=e.isDisabled,h=void 0!==_&&_,b=e.role,g=void 0===b?"button":b,v=e.tabIndex,y=void 0===v?0:v,S=e.onClick,D=Object(o.useCallback)(function(e){S(n,e)},[n,S]),I=Object(o.useState)(null),x=I[0],C=I[1];Object(o.useLayoutEffect)(function(){x&&(x.tabIndex=y,x.setAttribute("role",g),x.setAttribute("aria-selected",String(i)))},[x,g,y,i]);var O=Object(o.useMemo)(function(){return s.a.createElement("span",{className:"tileName_73a5ba4a",style:Zb(m,h,f.name),"aria-hidden":"true",onClick:h?void 0:D},n)},[m,h,n,f.name,D]),w=Object(o.useMemo)(function(){var e={display:"flex",alignItems:"center",cursor:f.background.cursor,width:"100%",height:"100%",justifyContent:"center"};return d===rg.InsideTileBesideIcon?s.a.createElement("div",{style:e},s.a.createElement(Ml.e,{iconName:l,style:f.icon}),O):s.a.createElement("div",{style:og(og({},e),{flexDirection:"column"})},s.a.createElement(Ml.e,{iconName:l,style:f.icon}),d===rg.InsideTileBelowIcon&&O)},[l,f,O,d]);return Object(o.useImperativeHandle)(t,function(){return{focus:function(){return null==x?void 0:x.focus()}}},[x]),s.a.createElement("div",{className:"tileContainer_73a5ba4a",style:f.container},s.a.createElement(wb.e,{className:c.e.apply(void 0,sg(["tile_73a5ba4a"],u||[])),style:Xb(p,m,h,f.background),isFluentStyling:!0,background:w,ariaLabel:a,role:"presentation",linkRef:C,onClick:h?void 0:D}),d===rg.BelowTile&&O)});function lg(e,t){return function(n){var a=function(e){return new Map([[we.Original,{key:"original",text:e.aspectRatio_original,ariaLabel:e.aspectRatio_originalAriaLabel}],[we.Square,{key:"square",text:e.aspectRatio_square,ariaLabel:e.aspectRatio_squareAriaLabel}],[we.None,{key:"freeForm",text:e.aspectRatio_freeform,ariaLabel:e.aspectRatio_freeformAriaLabel}]])}(e);return a.has(n)?a.get(n):function(e,t,n,a){if(!wi.has(e))throw new Error(e+" does not exist in the aspects map");var i=wi.get(e),r=i.x,o=i.y,s=au(t,a,r,o);return{key:s,text:s,ariaLabel:au(n,a,r,o)}}(n,e.aspectRatio_ratioLabelFormatString,e.aspectRatio_ratioAriaLabelFormatString,t)}}var ug=((cg={})[we.None]="FreeformAspect-Havana",cg[we.Original]="OriginalAspect-Havana",cg[we.Square]="SquareAspect-Havana",cg[we.NineBySixteen]="NineBySixteenAspect-Havana",cg[we.SixteenByNine]="SixteenByNineAspect-Havana",cg[we.FourByFive]="FourByFiveAspect-Havana",cg[we.FiveByFour]="FiveByFourAspect-Havana",cg[we.ThreeByFour]="ThreeByFourAspect-Havana",cg[we.FourByThree]="FourByThreeAspect-Havana",cg[we.TwoByThree]="TwoByThreeAspect-Havana",cg[we.ThreeByTwo]="ThreeByTwoAspect-Havana",cg[we.OneByTwo]="OneByTwoAspect-Havana",cg[we.TwoByOne]="TwoByOneAspect-Havana",cg);function fg(e){return ug[e]}function pg(){return Object.values(we)}var mg=function(e){return function(t){return e===t}};function _g(e){return e===we.None?rg.InsideTileBesideIcon:rg.InsideTileBelowIcon}function hg(e,t,n){var a=Object(o.useContext)(_e).logFlipEvent,i=Object(o.useContext)(Le).strings;return Object(o.useCallback)(function(r){a({axis:t,inputType:Ou(r)}),e(),n("X"===t?i.flip_horizontalFinishedAriaLive:i.flip_verticalFinishedAriaLive)},[a,e,t,n,i])}var bg=function(e,t,n,a,i){var r=function(e,t,n){var a=Object(o.useContext)(_e).logRotateEvent,i=Object(o.useContext)(Le).strings;return[Object(o.useCallback)(function(r){a({angle:Pi(t,90),inputType:Ou(r)}),e(Ci.Clockwise),n(i.rotate_right90FinishedAriaLive)},[a,e,t,n,i]),Object(o.useCallback)(function(r){a({angle:Pi(t,-90),inputType:Ou(r)}),e(Ci.CounterClockwise),n(i.rotate_left90FinishedAriaLive)},[a,e,t,n,i])]}(t,e,i);return{handleRotateCropRectAndImageBy90ClockwiseWithTelemetry:r[0],handleRotateCropRectAndImageBy90CounterClockwiseWithTelemetry:r[1],handleMirrorXWithTelemetry:hg(n,"X",i),handleMirrorYWithTelemetry:hg(a,"Y",i)}};Object(Cl.n)([{rawString:".rotateAspectFlipBarContainer_94111356{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-item-align:center;align-self:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-left:12px;margin-right:12px;margin-bottom:8px;max-width:700px;width:calc(100% - 24px)}.rotateButtonsContainer_94111356{display:-webkit-box;display:-ms-flexbox;display:flex}.aspectRatioButtonContainer_94111356{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.aspectRatioButton_94111356{background-color:transparent;border:none}.mirrorButtonsContainer_94111356{display:-webkit-box;display:-ms-flexbox;display:flex}"}]);var gg=s.a.memo(function(e){var t=e.styles,n=e.icons,a=e.rotationAngle,i=e.aspectRatioConstraint,r=e.shouldFocusOnAspectRatioButton,c=void 0!==r&&r,d=e.rotateCropAndImageBy90,l=e.handleMirrorXClick,u=e.handleMirrorYClick,f=e.setShowAspectRatioOptions,p=e.setAriaAnnouncement,m=Object(o.useContext)(Le),_=m.localizeNumber,h=m.strings,b=Object(o.useRef)(null),g=Object(o.useState)(null),v=g[0],y=g[1],S=Object(o.useState)(null),D=S[0],I=S[1],x=Object(o.useState)(null),C=x[0],O=x[1],w=Object(gc.e)(),E=w.fonts.medium.fontFamily,A=bg(a,d,l,u,p),L=A.handleRotateCropRectAndImageBy90ClockwiseWithTelemetry,k=A.handleRotateCropRectAndImageBy90CounterClockwiseWithTelemetry,M=A.handleMirrorXWithTelemetry,P=A.handleMirrorYWithTelemetry,T=Object(o.useMemo)(function(){return lg(h,_)(i)},[i,h,_]),U=Object(o.useCallback)(function(){f(!0)},[f]);Object(o.useEffect)(function(){var e;c&&(null===(e=b.current)||void 0===e||e.focus())},[c]);var F=Object(o.useMemo)(function(){var e=14;if(C&&v&&D&&E){var t=C.clientWidth-(v.clientWidth+D.clientWidth+18+8);e=function(e,t,n,a){for(var i=14,r=gb(e,i,a);r>t;)r=gb(e,i-=.5,a);return i}(T.text,t,0,E)}return e},[C,v,D,E,T.text]),H=t&&t.icon,R=t&&t.iconButton,N=t&&t.aspectRatioButton?t.aspectRatioButton(w,F):R,B=t&&t.container;return s.a.createElement("div",{style:B,ref:O},s.a.createElement("div",{className:"rotateButtonsContainer_94111356",ref:y},s.a.createElement(gh.e,{iconProps:{iconName:n.rotate90CounterClockwise,styles:H},title:h.rotate_left90,ariaLabel:h.rotate_left90AriaLabel,onClick:k,styles:R}),s.a.createElement(gh.e,{iconProps:{iconName:n.rotate90Clockwise,styles:H},title:h.rotate_right90,ariaLabel:h.rotate_right90AriaLabel,onClick:L,styles:R})),s.a.createElement("div",{role:"list",className:"aspectRatioButtonContainer_94111356"},s.a.createElement(vh.e,{styles:N,className:"aspectRatioButton_94111356",text:T.text,ariaLabel:T.ariaLabel,iconProps:{iconName:fg(i),styles:H},title:h.aspectRatio_tooltip,onClick:U,"data-test-id":"aspect-ratio-button",componentRef:b,role:"listitem"})),s.a.createElement("div",{className:"mirrorButtonsContainer_94111356",ref:I},s.a.createElement(gh.e,{iconProps:{iconName:n.flipHorizontally,styles:H},title:h.flip_horizontal,ariaLabel:h.flip_horizontalAriaLabel,onClick:M,styles:R}),s.a.createElement(gh.e,{iconProps:{iconName:n.flipVertically,styles:H},title:h.flip_vertical,ariaLabel:h.flip_verticalAriaLabel,onClick:P,styles:R})))});gg.displayName="Rotate90AspectFlipBar";var vg=Vt([yd],function(e){return kn(e)}),yg=Vt([vg],function(e){return Mi(e)}),Sg={rotateCropAndImageBy90:Bo,handleMirrorXClick:Oo,handleMirrorYClick:wo,setShowAspectRatioOptions:no,setAriaAnnouncement:Cs},Dg=Object(R.connect)(function(e){return{aspectRatioConstraint:e.transformTools.cropInteraction.aspectRatioConstraint,rotationAngle:vg(e.transformTools)}},Sg)(gg);Object(Cl.n)([{rawString:".RotationBarRoot_d52148bd{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-preferred-size:100%;flex-basis:100%;-ms-touch-action:none;touch-action:none;overflow:hidden;cursor:w-resize}.ms-Fabric--isFocusHidden .RotationBarRoot_d52148bd{outline:0}.ms-Fabric--isFocusVisible .RotationBarRoot_d52148bd:focus{outline:auto}"}]),Object(Cl.n)([{rawString:".TicksManager_a7a3a373{position:absolute;-webkit-transform:translateX(-50%);transform:translateX(-50%);left:50%}"}]);var Ig=Object(o.memo)(function(e){var t=e.boundingSize,n=e.angle,a=e.styles,i=e.layout,r=e.children,c=a.root,d=a.tickRoot,l=a.zeroTick,u=i.numTicks,f=(l.width?l.width:d.width)+l.strokeWidth,p=2*u*(d.width+d.distanceBetween)+f,m=Math.min(c.maxWidth,t.width-2*c.sidePadding),_=Object(o.useMemo)(function(){var e=f/2+d.distanceBetween+d.width/2,t=d.distanceBetween+d.width;return Math.abs(n)<1?-e*n:-(e+(Math.abs(n)-1)*t)*Math.sign(n)},[n,d,f]);return s.a.createElement("div",{className:"TicksManager_a7a3a373"},s.a.createElement("svg",{width:p,height:c.height,viewBox:"0 0 "+p+" "+c.height},s.a.createElement("defs",null,s.a.createElement("linearGradient",{id:"fadeGradient"},s.a.createElement("stop",{offset:"0",stopColor:"black"}),s.a.createElement("stop",{offset:i.fadeDistance,stopColor:"white"}),s.a.createElement("stop",{offset:1-i.fadeDistance,stopColor:"white"}),s.a.createElement("stop",{offset:"1",stopColor:"black"})),s.a.createElement("mask",{id:"fade"},s.a.createElement("rect",{width:m,height:c.height,x:(p-m)/2,fill:"url(#fadeGradient)"})),s.a.createElement("mask",{id:"colorize"},s.a.createElement("rect",{width:m,height:c.height,x:(p-m)/2,fill:d.color}),s.a.createElement("rect",{width:Math.abs(_),height:c.height,x:p/2+f/2-(n>0?-_+f:0),fill:"white"}))),s.a.createElement("g",{mask:"url(#fade)",fill:d.activeColor,stroke:d.activeColor},s.a.createElement("g",{mask:"url(#colorize)"},s.a.createElement("g",{"data-testid":"ticksParent",transform:"translate("+_+",0)"},r)))))});Object(Cl.n)([{rawString:".CenterAnchorContainer_22a2596f{position:absolute;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}"}]);var xg=function(){return xg=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},xg.apply(this,arguments)},Cg=Object(o.memo)(function(e){var t=e.styles,n=t.centerAnchor,a=n.width,i=n.height,r=n.rx,o=n.ry,c=n.color,d=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(n,["width","height","rx","ry","color"]);return s.a.createElement("div",{className:"CenterAnchorContainer_22a2596f"},s.a.createElement("svg",{width:a||t.tickRoot.width,height:t.root.height,viewBox:"0 0 "+(a||t.tickRoot.width)+" "+t.root.height,fill:"none"},s.a.createElement("rect",xg({key:"centerAnchor"},d,{x:0,y:(t.root.height-i)/2,width:8,height:i,rx:r,ry:o,fill:c}))))}),Og=function(){return Og=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Og.apply(this,arguments)},wg=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n},Eg=Object(o.memo)(function(e){var t=e.styles,n=e.layout,a=t.root,i=t.tickRoot,r=t.majorTick,c=t.minorTick,d=t.zeroTick,l=n.numTicks,u=n.majorTickInterval,f=(d.width?d.width:i.width)+d.strokeWidth,p=Object(o.useCallback)(function(e){var t=d.strokeWidth,n=(d.width,d.height),i=d.rx,r=d.ry,o=wg(d,["strokeWidth","width","height","rx","ry"]);return s.a.createElement("rect",Og({key:"zeroTick"},o,{x:e+t/2,y:(a.height-n)/2,width:f-t,height:n,rx:i,ry:r,fill:"transparent",strokeWidth:t}))},[a,d,f]),m=Object(o.useCallback)(function(e,t){var n=r.height,o=r.rx,c=r.ry,d=wg(r,["height","rx","ry"]),l=i.width;return s.a.createElement("rect",Og({key:t,strokeWidth:0},d,{x:e,y:(a.height-n)/2,width:l,height:n,rx:o,ry:c}))},[r,a,i]),_=Object(o.useCallback)(function(e,t){var n=wg(c,[]),r=i.width;return s.a.createElement("circle",Og({key:t,strokeWidth:0},n,{r:r/2,cx:e+2,cy:a.height/2}))},[c,a,i]);return s.a.createElement(s.a.Fragment,null,Array(2*l+1).fill(0).map(function(e,t){var n=t*(i.distanceBetween+i.width);return t>l&&(n+=f-i.width),t===l?p(n):(l-t)%u==0?m(n,t):_(n,t)}))});function Ag(e){var t=Object(o.useContext)(Le).localizeNumber;return Object(o.useMemo)(function(){return t(V(Mi(e),1))},[e,t])}var Lg=function(){return Lg=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Lg.apply(this,arguments)},kg=s.a.memo(function(e){var t=e.boundingSize,n=e.angle,a=e.styles,i=e.layout,r=e.cssToPhysicalPixelRatio,c=e.shouldShowTooltip,d=e.handleRotationBarPointerDown,l=e.handleRotationBarPointerMove,u=e.handleRotationBarPointerUp,f=e.handleRotationAdjustment,p=e.handleCleanupRotationBarPointer,m=e.setIsKeyboardFocused,_=Object(o.useState)(null),h=_[0],b=_[1],g=Object(o.useContext)(Le).strings,v=a.root,y=v.sidePadding,S=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(v,["sidePadding"]),D=Ag(n),I=Object(o.useCallback)(function(e){var t=dr(e.key);f({direction:t,sliderShiftingValue:.1,inputType:"Keyboard"})},[f]),x=Object(o.useCallback)(function(e){var t=dr(e.key);f({direction:t,sliderShiftingValue:1,inputType:"Keyboard"})},[f]),C=Object(o.useCallback)(function(e){var t=dr(e.key);f({direction:t,sliderShiftingValue:5,inputType:"Keyboard"})},[f]);o_(h,r,d,l,u,p),$m(10,h,I,x,_r,mr,C);var O=Object(o.useCallback)(function(){m(ur())},[m]),w=Object(o.useCallback)(function(){m(!1)},[m]);return s.a.createElement("div",{className:"RotationBarRoot_d52148bd",style:Lg(Lg({},S),{padding:"0px "+y+"px"}),ref:b,"aria-label":g.rotate_sliderAriaLabel,title:c?g.rotate_sliderTooltip:void 0,tabIndex:0,role:"slider","aria-valuenow":parseInt(D),"aria-valuemin":-45,"aria-valuemax":45,"aria-valuetext":""+D+g.rotate_degree,onFocus:O,onBlur:w},s.a.createElement(Ig,{boundingSize:t,angle:n,styles:a,layout:i},s.a.createElement(Eg,{styles:a,layout:i})),s.a.createElement(Cg,{styles:a}))}),Mg=Vt([ld,fd],function(e,t){return{width:e.x/t,height:e.y/t}}),Pg={handleRotationBarPointerUp:jo,handleRotationBarPointerMove:Vo,handleRotationBarPointerDown:zo,handleRotationAdjustment:Qo,handleCleanupRotationBarPointer:Uo,setIsKeyboardFocused:Go},Tg=Object(R.connect)(function(e,t){var n=e.transformTools.device.pixelRatio;return{boundingSize:(null==t?void 0:t.boundingSize)||Mg(e.transformTools),angle:yg(e.transformTools),cssToPhysicalPixelRatio:n,shouldShowTooltip:!e.transformTools.rotationUi.rotationBarPointer.isDown}},Pg)(kg),Ug={numTicks:45,majorTickInterval:5,fadeDistance:.1};function Fg(e){return{tickRoot:{width:4,distanceBetween:8,color:e.palette.neutralSecondary,activeColor:e.palette.black},minorTick:{},majorTick:{height:12,rx:2,ry:2},zeroTick:{width:6,height:10,rx:4,ry:4,strokeWidth:2},centerAnchor:{width:8,height:24,rx:4,ry:4,color:e.palette.black},root:{maxWidth:700,sidePadding:10,height:32}}}Object(Cl.n)([{rawString:".RotationAngleDisplayContainer_8a0e54d3{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:100%;pointer-events:none}.RotationAngleDisplay_8a0e54d3{padding:0 5px;text-align:center;font-size:16px}.RotationAngleDegree_8a0e54d3{width:0}"}]);var Hg=s.a.memo(function(e){var t=e.rotationAngle,n=e.styles,a=void 0===n?{}:n,i=Object(o.useContext)(Le).strings,r=Ag(t);return s.a.createElement("div",{className:"RotationAngleDisplayContainer_8a0e54d3",style:a.container,"aria-label":""+r+i.rotate_degree},s.a.createElement("span",{className:"RotationAngleDisplay_8a0e54d3",style:a.angleDisplay},r),s.a.createElement("span",{className:"RotationAngleDegree_8a0e54d3",style:a.angleDegree},i.rotate_degree))});Hg.displayName="RotationAngleDisplay";var Rg=Object(R.connect)(function(e){return{rotationAngle:vg(e.transformTools)}})(Hg),Ng=Object(o.memo)(function(e){var t=e.styles,n=e.componentStyles,a=e.rotate90AspectFlipBarIcons,i=e.shouldFocusOnAspectRatioButton,r=Object(gc.e)();return s.a.createElement(hb,{styles:{container:null==t?void 0:t.transformToolsContainer}},s.a.createElement(Rg,{styles:n&&n.rotationAngleDisplay}),s.a.createElement("div",{style:n&&n.rotationBarRoot},s.a.createElement(Tg,{styles:Fg(r),layout:Ug})),s.a.createElement(Dg,{styles:n&&n.rotate90AspectFlipBar,icons:a,shouldFocusOnAspectRatioButton:i}))});Ng.displayName="TransformToolsActionStack",Object(Cl.n)([{rawString:".scrollBoxWrapper_dce3aece{overflow:scroll;-ms-overflow-style:none;overflow:-moz-scrollbars-none;scrollbar-width:none}.scrollBoxWrapper_dce3aece::-webkit-scrollbar{display:none}.scrollBox_dce3aece{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-ms-flex-wrap:nowrap;flex-wrap:nowrap}"}]);var Bg=function(){return Bg=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Bg.apply(this,arguments)},jg=Object(o.forwardRef)(function(e,t){var n=e.direction,a=e.initialScrollLeft,i=void 0===a?0:a,r=e.initialScrollTop,c=void 0===r?0:r,d=e.children,l=e.scrollBoxRef,u=e.scrollBoxStyles,f=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["direction","initialScrollLeft","initialScrollTop","children","scrollBoxRef","scrollBoxStyles"]),p=Object(o.useState)(null),m=p[0],_=p[1],h=Object(o.useState)(!1),b=h[0],g=h[1],v=Object(o.useRef)(),y=Object(o.useRef)(),S=Object(o.useRef)(),D=Object(o.useRef)(),I=Object(o.useMemo)(function(){return Bg(Bg({},"vertical"===n?{overflowX:"hidden"}:void 0),"horizontal"===n?{overflowY:"hidden"}:void 0)},[n]),x=Object(o.useMemo)(function(){return function(e){var t=e.direction;return"vertical"===t?{flexDirection:"column"}:"horizontal"===t?{flexDirection:"row"}:{flexWrap:"wrap"}}({direction:n})},[n]);Object(o.useEffect)(function(){Ym(t,m)},[t,m]),Object(o.useLayoutEffect)(function(){m&&(m.scrollTop=null!=c?c:0,m.scrollLeft=null!=i?i:0)},[i,c,m]),Object(o.useEffect)(function(){if(m){var e=function(e){g(!0),v.current=e.screenX,y.current=m.scrollLeft,S.current=e.screenY,D.current=m.scrollTop},t=function(e){if(e.preventDefault(),e.stopPropagation(),void 0!==v.current&&void 0!==y.current){var t=v.current-e.screenX;m.scrollLeft=y.current+t}if(void 0!==S.current&&void 0!==D.current){var n=S.current-e.screenY;m.scrollTop=D.current+n}},n=function(){b&&void 0!==v.current&&(v.current=void 0,y.current=void 0),b&&void 0!==S&&(S.current=void 0,D.current=void 0),g(!1)};if(!m.ontouchstart)return m.addEventListener("mousedown",e),m.addEventListener("mousemove",t),m.addEventListener("mouseup",n),m.addEventListener("mouseleave",n),function(){m.removeEventListener("mousedown",e),m.removeEventListener("mousemove",t),m.removeEventListener("mouseup",n),m.removeEventListener("mouseleave",n)}}},[v,b,y,S,D,m]);var C=Array.isArray(d)?d:[null!=d?d:null];return s.a.createElement("div",Bg({className:"scrollBoxWrapper_dce3aece",style:I,ref:_},f),s.a.createElement("div",{className:"scrollBox_dce3aece",style:Bg(Bg({pointerEvents:b?"none":void 0},x),u),ref:l},C.map(function(e,t){return s.a.createElement("div",{key:"scroll-box-item-"+t},e)})))});jg.displayName="ScrollContainer";var Vg=function(){return Vg=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Vg.apply(this,arguments)},zg=function(e){var t=e.children,n=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["children"]),a=Object(o.useState)(null),i=a[0],r=a[1],c=Object(o.useState)(),d=c[0],l=c[1],u=Object(o.useRef)(!0),f=Object(o.useMemo)(function(){return s.a.Children.toArray(t).map(function(){return Object(o.createRef)()})},[t]);return Object(o.useLayoutEffect)(function(){if(0!==f.length){var e=f[0].current,t=f.slice(-1)[0].current,n=function(e){if(e&&i){var t=(null==e?void 0:e.getBoundingClientRect()).width;return(i.clientWidth-t)/2}};l({left:n(e),right:n(t)})}},[f,i]),Object(o.useLayoutEffect)(function(){var e,n;if(0!==f.length&&d&&void 0!==d.left&&void 0!==d.right){var a=s.a.Children.toArray(t).findIndex(function(e){return s.a.isValidElement(e)&&e.props.isActive});null===(n=null===(e=f[a])||void 0===e?void 0:e.current)||void 0===n||n.scrollIntoView({inline:"center",behavior:u.current?"auto":"smooth"}),u.current=!1}},[t,f,d]),s.a.createElement("div",{ref:r,style:{overflow:"hidden"}},s.a.createElement(jg,Vg({},n,{scrollBoxStyles:{paddingLeft:null==d?void 0:d.left,paddingRight:null==d?void 0:d.right}}),s.a.Children.toArray(t).map(function(e,t){return s.a.createElement("div",{ref:f[t],key:t},e)})))};Object(Cl.n)([{rawString:".scrollBoxContainer_28f2b9ed{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}"}]);var Gg=function(){return Gg=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Gg.apply(this,arguments)},Kg={margin:"0px 32px"};function Wg(e,t){return{root:Gg({position:"absolute",zIndex:3,height:"100%",width:32,i:{color:e.palette.neutralPrimary}},"start"===t?{left:"-32px"}:{right:"-32px"}),rootHovered:{backgroundColor:"transparent",i:{color:e.palette.neutralPrimaryAlt}},rootPressed:{backgroundColor:"transparent",i:{color:e.palette.neutralSecondary}}}}function qg(e,t,n){Object(o.useEffect)(function(){var a=n||window.ResizeObserver;if(a&&e){var i=new a(t);return i.observe(e),function(){i.disconnect()}}},[n,e,t])}var Qg=function(){return Qg=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Qg.apply(this,arguments)},Yg=function(e){var t=Object(gc.e)(),n=Object(o.useRef)(null),a=Object(o.useState)(null),i=a[0],r=a[1],c=Object(o.useState)(null),d=c[0],l=c[1],u=function(e,t,n){var a=Object(o.useState)(!1),i=a[0],r=a[1],s=Object(o.useState)(!1),c=s[0],d=s[1],l=Object(o.useCallback)(function(){if(e&&t){var n=e.getBoundingClientRect(),a=t.getBoundingClientRect();return{x:n.left-a.left,y:n.top-a.top,width:n.width,height:n.height}}},[e,t]),u=Object(o.useCallback)(function(){var e=l();e&&t&&r(e.x<0&&e.width!==t.clientWidth)},[t,l]),f=Object(o.useCallback)(function(){var e=l();e&&t&&d(e.x+e.width>t.clientWidth&&e.width!==t.clientWidth)},[t,l]),p=Object(o.useCallback)(function(){u(),f()},[u,f]);Object(o.useEffect)(function(){p()},[e,t,p]);var m=Object(o.useCallback)(function(e){var a=l();t&&a&&n&&(n.scrollTo?n.scrollTo({left:e*t.clientWidth-a.x}):n.scrollLeft=e*t.clientWidth-a.x,p())},[t,n,p,l]);return qg(t,p),{showPanLeft:i,showPanRight:c,onPanLeftClick:Object(o.useCallback)(function(){return m(-1)},[m]),onPanRightClick:Object(o.useCallback)(function(){return m(1)},[m]),onScroll:Object(o.useCallback)(function(){return p()},[p])}}(d,i,n.current),f=u.showPanLeft,p=u.showPanRight,m=u.onPanLeftClick,_=u.onPanRightClick,h=u.onScroll;return s.a.createElement("div",{className:"scrollBoxContainer_28f2b9ed",style:Kg,ref:r},f&&s.a.createElement(gh.e,{iconProps:{iconName:"ChevronLeft"},styles:Wg(t,"start"),onClick:m,tabIndex:-1}),s.a.createElement(jg,Qg({},e,{direction:"horizontal",scrollBoxRef:l,onScroll:h,ref:n})),p&&s.a.createElement(gh.e,{iconProps:{iconName:"ChevronRight"},styles:Wg(t,"end"),onClick:_,tabIndex:-1}))};function Jg(e,t,n,a){void 0===n&&(n=0),void 0===a&&(a="center");var i=Object(o.useState)(e.indexOf(t)),r=i[0],s=i[1],c=Object(o.useCallback)(function(t){var i=0,o=n>0?Math.ceil(e.length/n):1,c=n>0?Math.ceil((r+1)/n):1,d=e.length-n*(o-1),l=Math.floor((n-d)/2);switch(t.key){case"ArrowLeft":i=-1;break;case"ArrowRight":i=1;break;case"ArrowDown":"center"===a&&c===o-1&&d<n?(i=n-l,n>0&&r%n<l&&(i+=l-r%n)):i=n;break;case"ArrowUp":i="center"===a&&c===o&&d<n?-n+l:-n;break;default:i=0}i&&(t.preventDefault(),s(Za(r+i,0,e.length-1)))},[r,e,n,a]);return{keyboardFocusedIndex:r,setKeyboardFocusedIndex:s,onKeyDown:c}}function Xg(e,t,n){var a=Object(o.useContext)(_e).logAspectRatioEvent,i=Object(o.useContext)(Le).strings;return Object(o.useCallback)(function(r,o){a({aspectRatio:o,inputType:Ou(r)}),e(o),t(nu(i.aspectRatio_changedAriaLive,n(o).ariaLabel))},[a,e,t,i,n])}var Zg,$g=function(){return $g=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},$g.apply(this,arguments)};function e0(e,t,n,a,i,r,o,c,d,l,u,f){return e.map(function(e,p){var m=n(e),_=m.key,h=m.text,b=m.ariaLabel,g=!!r&&r(e);return s.a.createElement(dg,$g({key:_,name:h,iconName:a(e),tileStyles:"function"==typeof t?t(e):t,isHighlighted:!!o&&o(e),onClick:function(t,n){return i(e,n,p)},ariaSelected:g,ref:function(e){d&&d.current&&(d.current[p]=e)},tabIndex:c?c(e):void 0,namePosition:"function"==typeof u?u(e):u,tileClassNames:f&&(g?f.activeClassNames:f.inactiveClassNames)},{ariaLabel:b,role:l,isActive:g}))})}!function(e){e[e.Default=0]="Default",e[e.AutoCenterSelected=1]="AutoCenterSelected",e[e.ChevronPanning=2]="ChevronPanning"}(Zg||(Zg={}));var t0=function(){return t0=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},t0.apply(this,arguments)},n0=Object(o.memo)(function(e){var t=e.activeAspectRatio,n=e.setAspectRatioConstraint,a=e.setAriaAnnouncement,i=e.scrollContainerType,r=e.aspectRatioTilesStyles,c=e.tileClassNames,d=Object(o.useContext)(Le),l=d.localizeNumber,u=d.strings,f=Object(o.useMemo)(function(){return pg()},[]),p=Object(o.useRef)(new Array(f.length)),m=Jg(f,t),_=m.keyboardFocusedIndex,h=m.setKeyboardFocusedIndex,b=m.onKeyDown,g=Xg(n,a,lg(u,l)),v=Object(o.useCallback)(function(e,t,n){g(t,e),h(n)},[h,g]),y=e0(f,r,lg(u,l),fg,v,mg(t),void 0,function(e){return function(t){return e===t?0:-1}}(f[_]),p,"option",void 0,c);Object(o.useEffect)(function(){window.requestAnimationFrame(function(){var e=p.current[_];e&&e.focus()})},[_,p]);var S={role:"listbox",title:u.aspectRatio_listTitle};switch(i){case Zg.AutoCenterSelected:return s.a.createElement(zg,t0({},S,{direction:"horizontal"}),y);case Zg.ChevronPanning:return s.a.createElement(Yg,t0({},S,{style:{outline:"none"},onKeyDown:b}),y);case Zg.Default:default:return s.a.createElement(jg,t0({},S,{direction:"horizontal"}),y)}});n0.displayName="AspectRatioActionsBar";var a0=function(){return a0=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a0.apply(this,arguments)},i0={container:{position:"relative",bottom:"8px"}},r0={container:a0(a0({},i0.container),{height:"16px",bottom:"5px"})},o0={container:{marginBottom:"8px",alignItems:"center"}},s0={display:"flex",flexGrow:1,alignSelf:"center",justifyContent:"center",margin:"0px 12px 8px 12px",maxWidth:"700px",width:"calc(100% - 24px)"},c0=function(){return c0=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},c0.apply(this,arguments)},d0=Object(o.memo)(function(e){var t=e.visible,n=e.showAspectRatioOptions,a=e.activeAspectRatio,i=e.buttonStyles,r=e.tileClassNames,c=e.aspectRatioTileStyles,d=e.setAspectRatioConstraint,l=e.setAriaAnnouncement,u=Object(gc.e)(),f=function(e){return{root:{backgroundColor:"transparent",color:e.palette.neutralPrimary,fill:e.palette.neutralPrimary,width:"fit-content",display:"flex",alignSelf:"center",margin:"0px 4px",span:{fontWeight:400},i:{color:e.palette.neutralPrimary,fill:e.palette.neutralPrimary}},rootHovered:{backgroundColor:e.palette.neutralLight},rootPressed:{backgroundColor:e.palette.neutralQuaternaryAlt},rootDisabled:{backgroundColor:"transparent",color:e.palette.neutralTertiary,i:{color:e.palette.neutralTertiary,fill:e.palette.neutralTertiary}}}}(u),p=Object(o.useState)(!1),m=p[0],_=p[1];return Object(o.useEffect)(function(){ur()&&document.activeElement&&n&&_(!0)},[n]),t?s.a.createElement(hb,{styles:o0},!n&&s.a.createElement(Ng,{componentStyles:{rotationAngleDisplay:i0,rotationBarRoot:{display:"flex",justifyContent:"center",marginBottom:"16px"},rotate90AspectFlipBar:{iconButton:f,icon:Ih,container:s0}},rotate90AspectFlipBarIcons:{rotate90CounterClockwise:"Rotate90CounterClockwise",rotate90Clockwise:"Rotate90Clockwise",flipHorizontally:"Switch",flipVertically:"Sort"},shouldFocusOnAspectRatioButton:m}),n&&s.a.createElement("div",{style:{width:"fit-content",maxWidth:"100%",display:"flex",flexDirection:"column"}},s.a.createElement(n0,c0({scrollContainerType:Zg.ChevronPanning,aspectRatioTilesStyles:c0(c0({},tg(u)),c)},{activeAspectRatio:a,setAspectRatioConstraint:d,setAriaAnnouncement:l,tileClassNames:r})),s.a.createElement(_b,{styles:Object(cc.g)(f,i)}))):null}),l0=Vt([ld,fd,function(e){return e.view.viewFitting.marginCssPixels}],function(e,t,n){return fa(e,t,n)}),u0=Vt([l0,dd,ad,md,ud],function(e,t,n,a,i){return a&&(i===la.fitCropRectInView||!function(e,t,n){var a=va(Aa(Vn(t,n)));return a.top+a.height>e.top+e.height}(e,t,n))}),f0={setAspectRatioConstraint:Wo,setAriaAnnouncement:Cs},p0=Object(R.connect)(function(e){var t=e.transformTools.cropInteraction.aspectRatioConstraint,n=e.uiState.showAspectRatioOptions;return{visible:u0(e.transformTools),showAspectRatioOptions:n,activeAspectRatio:t}},f0)(d0);function m0(e,t,n){t.forEach(function(t){t.code!==e.code&&t.keyCode!==e.keyCode||t.handler(n)})}Object(Cl.n)([{rawString:".ms-Fabric--isFocusVisible .nonCropUI_19f27296:focus{visibility:visible;outline-width:3px;outline-style:solid;outline-offset:-3px}.ms-Fabric--isFocusHidden .nonCropUI_19f27296{outline:0}.nonCropUI_19f27296{position:absolute;width:100%;height:100%;top:0}"}]);var _0=s.a.memo(function(e){var t,n,a=e.cursor,i=e.cssToPhysicalPixelRatio,r=e.hasNonCropEdits,c=e.onPointerDown,d=e.onPointerMove,l=e.onPointerUp,u=e.onWheel,f=e.onTouchDown,p=e.onTouchMove,m=e.onTouchUp,_=e.onDoubleTap,h=e.onUnmount,b=e.setIsViewingOriginal,g=e.panView,v=e.panViewTopLeftCornerFromCropOrigin,y=e.setAriaAnnouncementScenario,S=Object(o.useContext)(Le).strings,D=Object(o.useState)(null),I=D[0],x=D[1],C=Object(gc.e)(),O=Object(o.useCallback)(function(e){e.isPrimaryButtonDownOrTouchDown&&d(e)},[d]);o_(I,i,c,O,l,h),s_(i,I,f,p,m,_),e_(i,I,u),Zm(I),t=I,n=Object(o.useMemo)(function(){return[{code:"Space",keyCode:32,handler:b}]},[b]),Object(o.useEffect)(function(){if(t){var e=function(e){m0(e,n,!0)},a=function(e){m0(e,n,!1)};return t.addEventListener("keydown",e),t.addEventListener("keyup",a),function(){t.removeEventListener("keydown",e),t.removeEventListener("keyup",a)}}},[t,n]),function(e,t,n,a){var i=Object(o.useCallback)(function(e){var i=dr(e.key);t({direction:i,adjustmentCanvasShiftingValue:1}),a({type:"PanView",panViewTopLeftCornerFromCropOrigin:n})},[t,a,n]),r=Object(o.useCallback)(function(e){var i=dr(e.key);t({direction:i,adjustmentCanvasShiftingValue:10}),a({type:"PanView",panViewTopLeftCornerFromCropOrigin:n})},[t,a,n]),s=Object(o.useCallback)(function(e){var i=dr(e.key);t({direction:i,adjustmentCanvasShiftingValue:50}),a({type:"PanView",panViewTopLeftCornerFromCropOrigin:n})},[t,a,n]);$m(10,e,i,r,pr,fr,s)}(I,g,v,y);var w=r?S.nonCrop_imageAriaLabelWithEdits:S.nonCrop_imageAriaLabelWithoutEdits;return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{ref:x,className:"nonCropUI_19f27296",style:{cursor:a,outlineColor:C.palette.neutralDark},"data-is-focusable":!0,title:r?S.nonCrop_imageTooltip:void 0,"aria-label":w,role:"img",tabIndex:0,"data-test-id":"nonCrop_canvas"}))}),h0=Vt([dd,ad],function(e,t){return fn(ln(qn(Vn(e,t)),-1))}),b0=function(){return b0=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},b0.apply(this,arguments)},g0={onPointerMove:xo,onPointerDown:Ur,onPointerUp:Fr,onWheel:Co,onTouchDown:ko,onTouchMove:Mo,onTouchUp:Po,onDoubleTap:Fo,onUnmount:To,setIsViewingOriginal:lo,panView:Jo,setAriaAnnouncementScenario:Os},v0=Object(R.connect)(function(e){return{cssToPhysicalPixelRatio:e.transformTools.device.pixelRatio,cursor:__(e.transformTools),hasNonCropEdits:wd(b0(b0({},ba),{colorAdjustments:e.colorAdjustments,filters:e.filters,autoEnhance:e.autoEnhance,markup:e.markup})),panViewTopLeftCornerFromCropOrigin:h0(e.transformTools)}},g0)(_0);Object(Cl.n)([{rawString:".layout_desktop_46fde051{width:100%;height:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.content_container_46fde051{display:grid;width:100%;height:calc(100% - 44px);grid-template-columns:1fr auto auto;grid-template-rows:1fr}.canvas_container_46fde051{position:relative}"}]);var y0=s.a.memo(function(e){var t=e.cssPixelMarginByActivity,n=e.activeEditorActivity,a=e.setViewFittingMarginCssPixels;return Object(o.useLayoutEffect)(function(){a({marginCssPixels:t[n]||ua(0),shouldAnimate:!0})},[a,n,t]),null}),S0={setViewFittingMarginCssPixels:No},D0=Object(R.connect)(function(e){return{activeEditorActivity:e.uiState.activeEditorActivity}},S0)(y0),I0=function(){function e(e,t){this._levelUniformName=e,this._mapNormalizedToShaderValue=t,this._level=0}return e.prototype.onBeforeBabylonRender=function(e){e.setFloat(this._levelUniformName,this._mapNormalizedToShaderValue(this._level))},e.prototype.setLevel=function(e){this._level=e},e.prototype.getLevel=function(){return this._level},e}(),x0=function(){function e(e,t,n){this._name=e,this._defineIdentifierName=t,this._shaderInputProvider=n}return e.prototype.getName=function(){return this._name},e.prototype.getUniformNames=function(e){return[]},e.prototype.getFunctions=function(){return[]},e.prototype.getHeaderCode=function(e){return"\n#define "+this._defineIdentifierName},e.prototype.getShaderFunctionBody=function(e){return""},e.prototype.onBeforeBabylonRender=function(e,t){this._shaderInputProvider.onBeforeBabylonRender(e,t)},e}(),C0=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),O0=function(e){function t(t,n,a){var i=e.call(this,t,n,a)||this;return i.name=t,i.defineIdentifierName=n,i.shaderInputProvider=a,i}return C0(t,e),t.prototype.getLevel=function(){return this.shaderInputProvider.getLevel()},t.prototype.setLevel=function(e){return this.shaderInputProvider.setLevel(e)},t}(x0),w0=function(e,t){var n=e.levelUniformName,a=e.mapNormalizedToShaderValue,i=e.defName,r=Object(o.useMemo)(function(){return new I0(n,a)},[n,a]),s=Object(o.useMemo)(function(){return new O0(e.defName,i,r)},[i,r,e]);r.setLevel(Za(t,0,1)),Sf(t),Pf(s)},E0=[.04,1,4],A0={defName:"BRIGHTNESS",levelUniformName:"uBrightnessLevel",mapNormalizedToShaderValue:function(e){return ri(E0,e)}},L0=function(){return A0},k0=Object(R.connect)(function(e){return{level:e.colorAdjustments.brightness}})(function(e){var t=e.level,n=L0();return w0(n,t),null}),M0=function(){function e(){this._devicePixelRatio=1,this._checkerboardSize=15,this._lightCheckerColor=1,this._darkCheckerColor=.95}return e.prototype.setDevicePixelRatio=function(e){this._devicePixelRatio=e},e.prototype.setCheckerboardSize=function(e){e&&(this._checkerboardSize=e)},e.prototype.setLightCheckerColor=function(e){e&&(this._lightCheckerColor=e)},e.prototype.setDarkCheckerColor=function(e){e&&(this._darkCheckerColor=e)},e.prototype.getName=function(){return"CheckerboardShader"},e.prototype.getUniformNames=function(e){return[e("uCheckerboardSize@"),e("uLightCheckerColor@"),e("uDarkCheckerColor@")]},e.prototype.getFunctions=function(e){return[]},e.prototype.getHeaderCode=function(e){return e("\n        //Checkerboard effect---\n        uniform float uCheckerboardSize@;\n        uniform float uLightCheckerColor@;\n        uniform float uDarkCheckerColor@;\n        ")},e.prototype.getShaderFunctionBody=function(e){return e("\n            //Checkerboard effect---\n            float total = step(uCheckerboardSize@, mod(uScreenPixelPos.x, uCheckerboardSize@ * 2.0)) + step(uCheckerboardSize@, mod(uScreenPixelPos.y, uCheckerboardSize@ * 2.0));\n            float baseCheckerboardColor = mix(uDarkCheckerColor@,uLightCheckerColor@,sign(mod(total, 2.0 )));\n            vec4 checkerBlendedColor = mix(vec4(baseCheckerboardColor,baseCheckerboardColor,baseCheckerboardColor,1.0),gl_FragColor, gl_FragColor.a);\n\n            // Checkerboard is hidden when there's a colorOverride. For example, the default transparent placeholder image should be shown without a checkerboard effect.\n            vec4 checkerboardColor = mix(checkerBlendedColor,uColorOverride,uColorOverrideLevel);\n            gl_FragColor = mix(checkerboardColor, gl_FragColor, uIsRenderingForExport);\n        ")},e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t("uCheckerboardSize@"),this._checkerboardSize*this._devicePixelRatio),e.setFloat(t("uLightCheckerColor@"),this._lightCheckerColor),e.setFloat(t("uDarkCheckerColor@"),this._darkCheckerColor)},e}(),P0=Object(R.connect)(function(e){return{devicePixelRatio:e.transformTools.device.pixelRatio}})(function(e){var t=e.devicePixelRatio,n=e.checkerboardSize,a=e.lightCheckerColor,i=e.darkCheckerColor,r=Object(o.useMemo)(function(){return new M0},[]);return r.setDevicePixelRatio(t),Sf(t),r.setCheckerboardSize(n),Sf(n),r.setLightCheckerColor(a),Sf(a),r.setDarkCheckerColor(i),Sf(i),Pf(r),null}),T0=function(){function e(e,t,n){this._negativeVectorUniformName=e,this._neutralVectorUniformName=t,this._positiveVectorUniformName=n,this._negativeVector=[0,0,0,0],this._neutralVector=[0,0,0,0],this._positiveVector=[0,0,0,0]}return e.prototype.onBeforeBabylonRender=function(e){e.setVector4(this._negativeVectorUniformName,sf(this._negativeVector)),e.setVector4(this._neutralVectorUniformName,sf(this._neutralVector)),e.setVector4(this._positiveVectorUniformName,sf(this._positiveVector))},e.prototype.setData=function(e,t,n){this._negativeVector=e,this._neutralVector=t,this._positiveVector=n},e}();function U0(e,t){return{r:e.r-t.r,g:e.g-t.g,b:e.b-t.b,a:e.a-t.a}}var F0=B0(0);function H0(e,t,n,a){e=Za(e,0,360),t=Za(t,-100,100),n=Za(n,-100,100),a=Za(a,-100,100);var i,r=function(e,t){var n=e,a=R0(t);return(a*=.5)<0&&(a*=-1,n=(e+180)%360),[n,a]}(e,t),o=r[0],s=r[1],c=function(e){return 50+.25*R0(e)}(a),d=function(e,t,n){var a,i,r,o=Za(e,0,359),s=Za(t/100,0,1),c=Za(n/100,0,1);if(0===s)a=c,i=c,r=c;else{o/=60;var d=Math.floor(o),l=o-d,u=c*(1-s),f=c*(1-s*l),p=c*(1-s*(1-l));switch(d){case 0:a=c,i=p,r=u;break;case 1:a=f,i=c,r=u;break;case 2:a=u,i=c,r=p;break;case 3:a=u,i=f,r=c;break;case 4:a=p,i=u,r=c;break;default:a=c,i=u,r=f}}return{r:a,g:i,b:r,a:1}}(o,s,c);return(d={r:2*(i=d).r,g:2*i.g,b:2*i.b,a:2*i.a}).a=function(e){return 1+.01*e}(n),d}function R0(e){return Math.sign(e)*e*e/100}function N0(e,t){var n,a;return a=t,{r:(n=H0(e.hue,e.density,e.saturation,e.value)).r*a.r,g:n.g*a.g,b:n.b*a.b,a:n.a*a.a}}function B0(e){return{hue:30,density:0,saturation:0,value:e}}function j0(e){return[e.r,e.g,e.b,e.a]}var V0=function(){return V0=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},V0.apply(this,arguments)},z0=[-65,0,100],G0={negativeVectorUniformName:"vCameraColorCurveNegative",neutralVectorUniformName:"vCameraColorCurveNeutral",positiveVectorUniformName:"vCameraColorCurvePositive"},K0=V0(V0({defName:"COLORCURVES"},G0),{createColorCurveVectors:function(e,t,n){return a=bn(-100,100,e),i=ri(z0,t),r=bn(-100,100,n),o=H0(30,0,0,a),s=N0(B0(i),o),c=N0(F0,o),d=N0(B0(r),o),l=U0(s,c),u=c,{negativeVector:j0(U0(c,d)),neutralVector:j0(u),positiveVector:j0(l)};var a,i,r,o,s,c,d,l,u},getUniformNames:function(){return Object.values(G0)}}),W0=function(){return K0},q0=s.a.memo(function(e){var t,n=e.exposureNormalizedSliderLevel,a=e.highlightsNormalizedSliderLevel,i=e.shadowsNormalizedSliderLevel,r=W0(),s=(t=r,Object(o.useMemo)(function(){var e=new T0(t.negativeVectorUniformName,t.neutralVectorUniformName,t.positiveVectorUniformName);return[e,new x0(t.defName,t.defName,e)]},[t])),c=s[0],d=s[1],l=r.createColorCurveVectors(n,a,i),u=l.negativeVector,f=l.neutralVector,p=l.positiveVector;return c.setData(u,f,p),Sf(n,a,i),Pf(d),null}),Q0=Object(R.connect)(function(e){return{exposureNormalizedSliderLevel:e.colorAdjustments.exposure,highlightsNormalizedSliderLevel:e.colorAdjustments.highlights,shadowsNormalizedSliderLevel:e.colorAdjustments.shadows}})(q0),Y0={defName:"CONTRAST",highLevelValuesUniformName:"uContrastHighValues",lowLevelValuesUniformName:"uContrastLowValues",mapNormalizedToShaderValue:vn(-1,1),getContrastValues:function(e){return{lowLevelValues:{x:2*e,y:1-e,z:0},highLevelValues:{x:2*-e,y:1+3*e,z:-e}}}},J0=function(){return Y0},X0=s.a.memo(function(e){var t=e.level,n=J0(),a=Object(o.useMemo)(function(){var e=J0(),t=new Z0(e.lowLevelValuesUniformName,e.highLevelValuesUniformName);return[t,new x0(e.defName,e.defName,t)]},[]),i=a[0],r=a[1],s=n.getContrastValues(n.mapNormalizedToShaderValue(t)),c=s.highLevelValues,d=s.lowLevelValues;return i.setLevels(c,d),Sf(t),Pf(r),null}),Z0=function(){function e(e,t){this._lowLevelValuesUniformName=e,this._highLevelValuesUniformName=t,this._lowLevelValues={x:0,y:0,z:0},this._highLevelValues={x:0,y:0,z:0}}return e.prototype.onBeforeBabylonRender=function(e){e.setVector3(this._lowLevelValuesUniformName,this._lowLevelValues),e.setVector3(this._highLevelValuesUniformName,this._highLevelValues)},e.prototype.setLevels=function(e,t){this._lowLevelValues=e,this._highLevelValues=t},e}(),$0=Object(R.connect)(function(e){return{level:e.colorAdjustments.contrast}})(X0),e1=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)a[i]=r[o];return a},t1=function(){function e(){this._transform=[1,0,0,0,1,0],this._level=1,this._outsideVisibility=.3}return e.prototype.setTransform=function(e){this._transform=e},e.prototype.setLevel=function(e){this._level=e},e.prototype.setOutsideLightness=function(e){this._outsideVisibility=e},e.prototype.getName=function(){return"CropMaskShader"},e.prototype.getUniformNames=function(e){return[e("uCropTransform@"),e("uCropTransformInverse@"),e("uLevel@"),e("uOutsideVisibility@")]},e.prototype.getFunctions=function(e){return[]},e.prototype.getHeaderCode=function(e){return e("\n        //CropMask effect---\n        uniform mat3 uCropTransform@;\n        uniform mat3 uCropTransformInverse@;\n        uniform float uLevel@;\n        uniform float uOutsideVisibility@;\n        ")},e.prototype.getShaderFunctionBody=function(e){return e("\n            //CropMask effect---\n            vec3 normalizedPos@ = vec3(uScreenPixelPos.x,uScreenPixelPos.y,1.0) * uCropTransformInverse@;\n\n            float isOutsideCropRegion = 1. - step(0.0, normalizedPos@.x) * step(0.0, normalizedPos@.y) * step(0.0, 1.0 - normalizedPos@.x) * step(0.0, 1.0 - normalizedPos@.y);\n            float applyCropMask = mix(isOutsideCropRegion, 0., uIsRenderingForExport);\n\n            finalAlphaMultiply = mix(finalAlphaMultiply, uOutsideVisibility@, applyCropMask);\n        ")},e.prototype.onBeforeBabylonRender=function(e,t){e.setMatrix3x3(t("uCropTransform@"),new Float32Array(e1(this._transform,[0,0,1]))),e.setMatrix3x3(t("uCropTransformInverse@"),new Float32Array(e1(Tn(this._transform),[0,0,1]))),e.setFloat(t("uLevel@"),this._level),e.setFloat(t("uOutsideVisibility@"),this._outsideVisibility)},e}(),n1=Vt([function(e){return Xn(e.animations.outsideCropVisibility,e.animations.currentTime,100)},function(e){return Xn(e.animations.dismissOutsideCropVisibility,e.animations.currentTime,400)},gd,rd,function(e){return e.activeEditorActivity}],function(e,t,n,a,i){return function(e,t,n,a,i){if(i!==oi||a===da.disabled)return 0;if((a===da.none||a===da.draggingView)&&1===t)return.2;var r=e||ii(a);return bn(r?.2:.5,r?.5:.2,t)*function(e,t){return ii(t)?ri([1,1,1,1,.4],e):1}(n,a)}(n,e,t,a,i)}),a1=function(){return a1=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a1.apply(this,arguments)},i1=Object(R.connect)(function(e){var t=e.transformTools.cropInteraction.mode;return{transform:Pm(e.transformTools),level:t===da.selectingFirstCorner?0:1,outsideVisibilityValue:n1(a1(a1({},e.transformTools),e.uiState))}})(function(e){var t=e.transform,n=e.level,a=e.outsideVisibilityValue,i=Object(o.useMemo)(function(){return new t1},[]);return i.setTransform(t),i.setLevel(n),i.setOutsideLightness(a),Df(t),Sf(n),Pf(i),null}),r1=Object(o.createContext)({textures:{},urlsById:{},loadUrls:function(){}}),o1="level@",s1="lookup2D@",c1="uBlueSlicesIn2DLayout@",d1="uTexSize@",l1="LutShader",u1=function(){function e(){this._level=0,this._configuration={numRedSamplesPerSlice:0,numGreenSamplesPerSlice:0,numBlueSlicesPerRowIn2DLayout:0,numBlueSlicesPerColumnIn2DLayout:0}}return e.prototype.setLevel=function(e){this._level=e},e.prototype.getLevel=function(){return this._level},e.prototype.setTexture=function(e){this._texture=e},e.prototype.getTexture=function(){return this._texture},e.prototype.setConfiguration=function(e){this._configuration=e},e.prototype.getConfiguration=function(){return this._configuration},e.prototype.getBlueSlicesIn2DLayout=function(){return{x:this._configuration.numBlueSlicesPerRowIn2DLayout,y:this._configuration.numBlueSlicesPerColumnIn2DLayout}},e.prototype.calculateTextureSize=function(){return e=this.getBlueSlicesIn2DLayout(),t={x:this._configuration.numRedSamplesPerSlice,y:this._configuration.numGreenSamplesPerSlice},{x:e.x*t.x,y:e.y*t.y};var e,t},e.prototype.getUniformNames=function(e){return[e(o1),e(c1),e(d1)]},e.prototype.getSamplerNames=function(e){return[e(s1)]},e.prototype.getName=function(){return l1},e.prototype.getFunctions=function(e){return["\nvec4 getColorInLookupTable(in vec4 color, in sampler2D lookupTable, in vec2 blueSlicesIn2DLayout, in vec2 texSize) {\n    color = clamp(color, 0., 1.);\n\n    mediump float unboundBlueSlice = color.b * (blueSlicesIn2DLayout.x * blueSlicesIn2DLayout.y - 1.);\n\n    // Find the nearest lower bound quad location\n    mediump vec2 lowerBoundBlueSlice;\n    lowerBoundBlueSlice.y = floor(floor(unboundBlueSlice) / blueSlicesIn2DLayout.x);\n    lowerBoundBlueSlice.x = floor(unboundBlueSlice) - (lowerBoundBlueSlice.y * blueSlicesIn2DLayout.x);\n\n    // Find the nearest upper bound quad location\n    mediump vec2 upperBoundBlueSlice;\n    upperBoundBlueSlice.y = floor(ceil(unboundBlueSlice) / blueSlicesIn2DLayout.x);\n    upperBoundBlueSlice.x = ceil(unboundBlueSlice) - (upperBoundBlueSlice.y * blueSlicesIn2DLayout.x);\n\n    // Within the slices, find the position of the rg values in UV space\n    highp vec2 texPos1 = (lowerBoundBlueSlice / blueSlicesIn2DLayout) + vec2(0.5, 0.5) / texSize + (((vec2(1., 1.) / blueSlicesIn2DLayout) - vec2(1., 1.) / texSize) * color.rg);\n    highp vec2 texPos2 = (upperBoundBlueSlice / blueSlicesIn2DLayout) + vec2(0.5, 0.5) / texSize + (((vec2(1., 1.) / blueSlicesIn2DLayout) - vec2(1., 1.) / texSize) * color.rg);\n\n    // Get the two colors that we will interpolate in the LUT texture\n    lowp vec4 newColor1 = texture2D(lookupTable, texPos1);\n    lowp vec4 newColor2 = texture2D(lookupTable, texPos2);\n\n    // Interpolate between the two depending on our blue channel\n    lowp vec4 newColor = mix(newColor1, newColor2, fract(unboundBlueSlice));\n    return newColor;\n}"]},e.prototype.getHeaderCode=function(e){return e("\n//look up table effect---\n        uniform float level@;\n        uniform sampler2D lookup2D@;\n        uniform vec2 uBlueSlicesIn2DLayout@;\n        uniform vec2 uTexSize@;\n        ")},e.prototype.getShaderFunctionBody=function(e){return e("\n//look up table effect---\n        vec4 tempColor@ = getColorInLookupTable(gl_FragColor, lookup2D@, uBlueSlicesIn2DLayout@, uTexSize@);\n        gl_FragColor.rgb = mix(gl_FragColor.rgb,tempColor@.rgb, level@);\n        ")},e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t(o1),this._level),this._texture&&e.setTexture(t(s1),this._texture),e.setVector2(t(c1),this.getBlueSlicesIn2DLayout()),e.setVector2(t(d1),this.calculateTextureSize())},e}(),f1=Vt([function(e){return e.animations.transitionToViewingOriginal.isActive},function(e){return e.isViewingOriginal},rd],function(e,t,n){return t&&!e&&n!==da.draggingView}),p1=function(){return p1=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},p1.apply(this,arguments)},m1=Object(R.connect)(function(e){var t=e.filters.activeFilter;return{level:e.filters.filterLevel,activeFilter:t,disabled:f1(p1(p1({},e.transformTools),e.uiState))}})(function(e){var t=e.level,n=e.activeFilter,a=e.disabled,i=Object(o.useContext)(r1),r=i.textures,s=i.urlsById,c=i.loadUrls,d=Object(o.useMemo)(function(){return new u1},[]),l=qc(n);0===Object.keys(s).length&&l&&t>0&&c();var u=s[n.lutUrlId],f=l&&u?r[u]:void 0,p=f?f.parts[0].texture:void 0,m=p&&!a?t:0;return d.setLevel(m),l&&n.config&&d.setConfiguration(n.config),d.setTexture(p),Sf(m,n,p),Pf(d),null}),_1={defName:"MASTER",levelUniformName:"uMasterLevel",mapNormalizedToShaderValue:function(e){return e}},h1=function(){return _1},b1=function(){return b1=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},b1.apply(this,arguments)},g1=Object(R.connect)(function(e){return{level:f1(b1(b1({},e.transformTools),e.uiState))?0:1}})(function(e){var t=e.level,n=h1();return w0(n,t),null}),v1={defName:"SATURATION",levelUniformName:"uSaturationLevel",mapNormalizedToShaderValue:vn(-1,1)},y1=function(){return v1},S1=s.a.memo(function(e){var t=e.saturationNormalizedSliderLevel,n=y1();return w0(n,t),null}),D1=Object(R.connect)(function(e){return{saturationNormalizedSliderLevel:e.colorAdjustments.saturation}})(S1),I1=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)a[i]=r[o];return a},x1=h1(),C1="VignetteShader",O1=function(){function e(){this._transform=[1,0,0,0,1,0],this._level=0}return e.prototype.setTransform=function(e){this._transform=e},e.prototype.getTransform=function(){return this._transform},e.prototype.setLevel=function(e){this._level=e},e.prototype.getName=function(){return C1},e.prototype.getUniformNames=function(e){return[e("uCropTransform@"),e("uCropTransformInverse@"),e("uLevel@")]},e.prototype.getFunctions=function(e){return[]},e.prototype.getHeaderCode=function(e){return e("\n          //Vignette effect---\n          uniform mat3 uCropTransform@;\n          uniform mat3 uCropTransformInverse@;\n          uniform float uLevel@;\n        ")},e.prototype.getShaderFunctionBody=function(e){return e("\n        //Vignette effect---\n        vec3 normalizedPos@ = vec3(uScreenPixelPos.x, uScreenPixelPos.y,1.0) * uCropTransformInverse@;\n\n        float shouldMix@ = step(0.0, normalizedPos@.x) * step(0.0, normalizedPos@.y) * step(0.0, 1.0 - normalizedPos@.x) * step(0.0, 1.0 - normalizedPos@.y);\n        float dist@ = distance(normalizedPos@.xy, vec2(0.5));\n        float vignetteSize@ = 0.5;\n        float gradient@ = smoothstep(0.8, vignetteSize@ * 0.799, dist@ * (abs(uLevel@ * 0.525) + vignetteSize@));\n        float shouldApplyAdjustments@ = mix("+x1.levelUniformName+", 1., uIsRenderingForExport);\n        vec3 color@ = gl_FragColor.rgb;\n\n        // white\n        if(uLevel@ < 0.) {\n          color@ = mix(vec3(1.), gl_FragColor.rgb, gradient@);\n        }\n\n        // black\n        if(uLevel@ > 0.) {\n          color@ = mix(vec3(0.), gl_FragColor.rgb, gradient@);\n        }\n\n        gl_FragColor.rgb = mix(gl_FragColor.rgb, color@, shouldMix@ * shouldApplyAdjustments@);\n      ")},e.prototype.onBeforeBabylonRender=function(e,t){e.setMatrix3x3(t("uCropTransform@"),new Float32Array(I1(this._transform,[0,0,1]))),e.setMatrix3x3(t("uCropTransformInverse@"),new Float32Array(I1(Tn(this._transform),[0,0,1]))),e.setFloat(t("uLevel@"),this._level)},e}(),w1={mapNormalizedToShaderValue:vn(-.7,.7)},E1=Object(R.connect)(function(e){return{transform:Pm(e.transformTools),level:e.colorAdjustments.vignette}})(function(e){var t=e.transform,n=e.level,a=Object(o.useMemo)(function(){return new O1},[]),i=w1.mapNormalizedToShaderValue;return a.setTransform(t),a.setLevel(i(n)),Df(t),Sf(n),Pf(a),null}),A1=.003256,L1=6502.078125,k1=[3.2404542,-1.5371385,-.4985314,-.969266,1.8760108,.041556,.0556434,-.2040259,1.0572252],M1=function(e,t,n){return{r:k1[0]*e+k1[1]*t+k1[2]*n,g:k1[3]*e+k1[4]*t+k1[5]*n,b:k1[6]*e+k1[7]*t+k1[8]*n}},P1=[{u:.18006,v:.26352,slope:-.24341,recipTemp:0},{u:.18066,v:.26589,slope:-.25479,recipTemp:1e-5},{u:.18133,v:.26846,slope:-.26876,recipTemp:2e-5},{u:.18208,v:.27119,slope:-.28539,recipTemp:1/33333},{u:.18293,v:.27407,slope:-.3047,recipTemp:4e-5},{u:.18388,v:.27709,slope:-.32675,recipTemp:5e-5},{u:.18494,v:.28021,slope:-.35156,recipTemp:1/16667},{u:.18611,v:.28342,slope:-.37915,recipTemp:1/14286},{u:.1874,v:.28668,slope:-.40955,recipTemp:8e-5},{u:.1888,v:.28997,slope:-.44278,recipTemp:1/11111},{u:.19032,v:.29326,slope:-.47888,recipTemp:1e-4},{u:.19462,v:.30141,slope:-.58204,recipTemp:1/8e3},{u:.19962,v:.30921,slope:-.70471,recipTemp:1/6667},{u:.20525,v:.31647,slope:-.84901,recipTemp:1/5714},{u:.21142,v:.32312,slope:-1.0182,recipTemp:2e-4},{u:.21807,v:.32909,slope:-1.2168,recipTemp:1/4444},{u:.22511,v:.33439,slope:-1.4512,recipTemp:1/4e3},{u:.23247,v:.33904,slope:-1.7298,recipTemp:1/3636},{u:.2401,v:.34308,slope:-2.0637,recipTemp:1/3333},{u:.24792,v:.34655,slope:-2.4681,recipTemp:1/3077},{u:.25591,v:.34951,slope:-2.9641,recipTemp:1/2857},{u:.264,v:.352,slope:-3.5814,recipTemp:1/2677},{u:.27218,v:.35407,slope:-4.3633,recipTemp:4e-4},{u:.28039,v:.35577,slope:-5.3762,recipTemp:1/2353},{u:.28863,v:.35714,slope:-6.7262,recipTemp:1/2222},{u:.29685,v:.35823,slope:-8.5955,recipTemp:1/2105},{u:.30505,v:.35907,slope:-11.324,recipTemp:5e-4},{u:.3132,v:.35968,slope:-15.628,recipTemp:1/1905},{u:.32129,v:.36011,slope:-23.325,recipTemp:1/1818},{u:.32931,v:.36038,slope:-40.77,recipTemp:1/1739},{u:.33724,v:.36051,slope:-116.45,recipTemp:1/1667}],T1=function(e,t){var n=function(e,t){for(var n=1/e,a=1;a<P1.length&&!(n<P1[a].recipTemp);a++);a===P1.length&&a--;var i=P1[a-1],r=P1[a],o=gn(i.recipTemp,r.recipTemp,n),s=bn(i.slope/Math.sqrt(1+i.slope*i.slope),r.slope/Math.sqrt(1+r.slope*r.slope),o),c=bn(i.u,r.u,o),d=bn(i.v,r.v,o),l=t/Math.sqrt(1+s*s),u=c+l,f=d+s*l;if(f>-.1*u+.4){var p=(-.1*u+.4-f)/(-.1*(u-c)+d-f);u=bn(u,c,p),f=bn(f,d,p)}return{y:1,u:u,v:f}}(e,t);return function(e,t,n){var a=0,i=0;return e>=1e-7&&(a=6*t*e/(4*n),i=e*(6*(4-t)-60*n)/(12*n)),[a,e,i]}(n.y,n.u,n.v)},U1={defName:"WHITE_BALANCE",mapSliderValueToTint:function(e){return e=bn(-1,1,e),[A1,1.25*e/100+A1]},whiteBalanceGainUniformName:"uWhiteBalanceGain",mapSliderValueToKelvinTemperature:function(e){var t=L1;return(e=bn(-1,1,e))>0?t=bn(L1,1e4,e):e<0&&(t=bn(L1,4e3,-e)),[t,6502.078125]},mapTemperatureAndTintToRBGains:function(e,t,n,a){var i=Za(e,1667,Number.MAX_VALUE),r=T1(i,n),o=T1(t,a),s=M1.apply(void 0,r),c=M1.apply(void 0,o);return[c.r/c.g/(s.r/s.g),c.b/c.g/(s.b/s.g)]}},F1=function(){return U1},H1=function(){function e(e){this._whiteBalanceGainUniformName=e,this._whiteBalanceGainVector={r:1,g:1,b:1}}return e.prototype.onBeforeBabylonRender=function(e){e.setColor3(this._whiteBalanceGainUniformName,this._whiteBalanceGainVector)},e.prototype.setGains=function(e,t){this._whiteBalanceGainVector={r:e,g:1,b:t}},e}(),R1=s.a.memo(function(e){var t=e.tintLevel,n=e.temperatureLevel,a=F1(),i=a.mapSliderValueToTint,r=a.mapSliderValueToKelvinTemperature,s=a.mapTemperatureAndTintToRBGains,c=a.whiteBalanceGainUniformName,d=a.defName,l=r(n),u=l[0],f=l[1],p=i(t),m=s(u,f,p[0],p[1]),_=m[0],h=m[1],b=function(e,t){return Object(o.useMemo)(function(){var n=new H1(e);return[n,new x0(t,t,n)]},[e,t])}(c,d),g=b[0],v=b[1];return g.setGains(_,h),Sf(t,n),Pf(v),null}),N1=Object(R.connect)(function(e){return{tintLevel:e.colorAdjustments.tint,temperatureLevel:e.colorAdjustments.temperature}})(R1),B1="uZoomLevel@",j1=function(){function e(){this._zoomLevel=1}return e.prototype.setZoomLevel=function(e){this._zoomLevel=e},e.prototype.getName=function(){return"ZoomToPixelsShader"},e.prototype.getUniformNames=function(e){return[e(B1)]},e.prototype.getFunctions=function(){return[]},e.prototype.getHeaderCode=function(e){return e(" //ZoomToPixels effect---\n    uniform float uZoomLevel@;")},e.prototype.getShaderFunctionBody=function(e){return e("//ZoomToPixels effect---\n        if(uZoomLevel@ > 1.0 && uIsRenderingForExport == 0.){\n            vec2 screenTranslationInPixels@ = (vec3(0.0,0.0,1.0) * uTransform).xy;\n            vec2 zoomVec2@ = vec2(uZoomLevel@);\n            vec2 pixelPosOffset@ = mod(screenTranslationInPixels@, zoomVec2@);\n            vec2 pixelPosRounded@ = floor((uScreenPixelPos- pixelPosOffset@)/zoomVec2@ )*uZoomLevel@ + 0.5*zoomVec2@;\n            vec3 uv@ = vec3(pixelPosRounded@.x + pixelPosOffset@.x, pixelPosRounded@.y + pixelPosOffset@.y,1.0) * uTransformInverse;\n            gl_FragColor = getTextureColor(uv@.xy);\n\n            // Texture may not be set so use the color override to show that instead (these are set in ShadersBase.ts)\n            gl_FragColor = mix(gl_FragColor,uColorOverride,uColorOverrideLevel);\n\n            //modify the uv so that subsequent effect code will use this uv value when sampling textures.\n            uv.xy = uv@.xy;\n        }\n        ")},e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t(B1),this._zoomLevel)},e}(),V1=s.a.memo(function(e){var t=e.zoomLevel,n=Object(o.useMemo)(function(){return new j1},[]);return n.setZoomLevel(t),Sf(t),Pf(n),null});V1.displayName="ZoomToPixelsEffect";var z1=Object(R.connect)(function(e){return{zoomLevel:h_(e.transformTools)}})(V1),G1=Object(o.createContext)({enableAdjustments:!1,enableFilters:!1,enableAutoEnhance:!1,enableMarkup:!1}),K1=F1(),W1=L0(),q1=y1(),Q1=J0(),Y1=W0(),J1=h1(),X1=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)a[i]=r[o];return a}([K1.whiteBalanceGainUniformName,W1.levelUniformName,q1.levelUniformName,Q1.highLevelValuesUniformName,Q1.lowLevelValuesUniformName,J1.levelUniformName],Y1.getUniformNames()),Z1="\n#ifdef "+K1.defName+"\n  uniform vec3 "+K1.whiteBalanceGainUniformName+";\n#endif\n#ifdef "+W1.defName+"\n  uniform float "+W1.levelUniformName+";\n#endif\n#ifdef "+q1.defName+"\n  uniform float "+q1.levelUniformName+";\n  const float SATURATION_RED_K = 9437.0 / 32768.0;\n  const float SATURATION_GREEN_K = 1.0 - SATURATION_RED_K;\n#endif\n#ifdef "+Q1.defName+"\n  uniform vec3 "+Q1.lowLevelValuesUniformName+";\n  uniform vec3 "+Q1.highLevelValuesUniformName+";\n\n  float TransformChannelContrast(in float channelLevel, in vec3 low, in vec3 high) {\n    vec3 levels = mix(low, high, step(channelLevel, 0.5));\n    return ((levels.x * channelLevel + levels.y) * channelLevel) + levels.z;\n  }\n#endif\n#ifdef "+Y1.defName+"\n  uniform vec4 "+Y1.negativeVectorUniformName+";\n  uniform vec4 "+Y1.neutralVectorUniformName+";\n  uniform vec4 "+Y1.positiveVectorUniformName+";\n#endif\n#ifdef "+J1.defName+"\n  uniform float "+J1.levelUniformName+";\n#endif\n\n  struct Adjustments {\n    vec3 whiteBalanceGain;\n    float brightness;\n    float saturation;\n    vec3 contrastLowLevels;\n    vec3 contrastHighLevels;\n    vec4 colorCurvesNeutralVector;\n    vec4 colorCurvesPositiveVector;\n    vec4 colorCurvesNegativeVector;\n  };\n\n  \n#ifndef RGB2HSV\n#define RGB2HSV\nvec3 rgb2hsv( in vec3 c )\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n#endif\n\n  \n#ifndef HSV2RGB\n#define HSV2RGB\nvec3  hsv2rgb( in vec3 c )\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n#endif\n\n  "+Fu+"\n  \n#ifndef GETLUMINANCE\n#define GETLUMINANCE\n\nconst vec3 LuminanceEncodeApprox = vec3(0.2126, 0.7152, 0.0722);\nfloat getLuminance(vec3 color)\n{\n    return clamp(dot(color, LuminanceEncodeApprox), 0., 1.);\n}\n#endif\n\n\n  vec4 ApplyAdjustments(in Adjustments adj, in vec4 c) {\n    vec4 result = c.rgba;\n\n    #ifdef "+K1.defName+"\n      // Apply White Balance (Gamma Space)\n      result.rgb *= adj.whiteBalanceGain.rgb;\n    #endif\n\n    result.rgb = toLinearSpace(result.rgb);\n\n    #ifdef "+W1.defName+"\n      // Apply Brightness (Linear Space)\n      result.rgb *= adj.brightness;\n    #endif\n\n    #ifdef "+q1.defName+"\n      // Apply Saturation (Linear Space)\n      float saturatedR = result.r + (result.r - result.g) * SATURATION_GREEN_K * adj.saturation;\n      float saturatedG = result.g + (result.g - result.r) * SATURATION_RED_K   * adj.saturation;\n      float saturatedB = result.b + (result.b - SATURATION_RED_K * result.r - SATURATION_GREEN_K * result.g) * adj.saturation;\n      result.rgb = clamp(vec3(saturatedR, saturatedG, saturatedB), vec3(0.0), vec3(1.0));\n    #endif\n\n    result.rgb = toGammaSpace(result.rgb);\n\n    #ifdef "+Y1.defName+"\n      // Apply Color Curves (Gamma Space)\n      // https://github.com/BabylonJS/Babylon.js/blob/6adcf34c72f322949fe04b9ccbe3fc5faf7206a1/src/Shaders/ShadersInclude/imageProcessingFunctions.fx\n      float luma = getLuminance(result.rgb);\n      vec2 curveMix = clamp(vec2(luma * 3.0 - 1.5, luma * -3.0 + 1.5), vec2(0.0), vec2(1.0));\n      vec4 colorCurve = adj.colorCurvesNeutralVector + curveMix.x * adj.colorCurvesPositiveVector - curveMix.y * adj.colorCurvesNegativeVector;\n      result.rgb *= colorCurve.rgb;\n      result.rgb = mix(vec3(luma), result.rgb, colorCurve.a);\n    #endif\n\n    result = clamp(result, 0.0, 1.0);\n\n    #ifdef "+Q1.defName+"\n      // Apply Contrast (Gamma Space)\n      // Assumption: Value is clamped. Otherwise high contrast levels cause strange colors with high brightness/exposure\n      result.r = TransformChannelContrast(result.r, adj.contrastLowLevels, adj.contrastHighLevels);\n      result.g = TransformChannelContrast(result.g, adj.contrastLowLevels, adj.contrastHighLevels);\n      result.b = TransformChannelContrast(result.b, adj.contrastLowLevels, adj.contrastHighLevels);\n    #endif\n\n    result = clamp(result, 0.0, 1.0);\n    return result;\n  }\n",$1="\n  Adjustments adj;\n\n  #ifdef "+K1.defName+"\n    adj.whiteBalanceGain = "+K1.whiteBalanceGainUniformName+";\n  #endif\n\n  #ifdef "+W1.defName+"\n    adj.brightness = "+W1.levelUniformName+";\n  #endif\n\n  #ifdef "+q1.defName+"\n    adj.saturation = "+q1.levelUniformName+";\n  #endif\n\n  #ifdef "+Q1.defName+"\n    adj.contrastLowLevels = "+Q1.lowLevelValuesUniformName+";\n    adj.contrastHighLevels = "+Q1.highLevelValuesUniformName+";\n  #endif\n\n  #ifdef "+Y1.defName+"\n    adj.colorCurvesNeutralVector = "+Y1.neutralVectorUniformName+";\n    adj.colorCurvesPositiveVector = "+Y1.positiveVectorUniformName+";\n    adj.colorCurvesNegativeVector = "+Y1.negativeVectorUniformName+";\n  #endif\n\n  #ifdef "+J1.defName+"\n    float shouldApplyAdjustments = mix("+J1.levelUniformName+", 1., uIsRenderingForExport);\n    gl_FragColor = mix(gl_FragColor, ApplyAdjustments(adj, gl_FragColor), shouldApplyAdjustments);\n  #else\n    gl_FragColor = ApplyAdjustments(adj, gl_FragColor);\n  #endif\n",ev=function(){function e(){}return e.prototype.getName=function(){return"AdjustmentsShader"},e.prototype.getUniformNames=function(e){return X1},e.prototype.getFunctions=function(){return[]},e.prototype.getHeaderCode=function(e){return Z1},e.prototype.getShaderFunctionBody=function(e){return $1},e.prototype.onBeforeBabylonRender=function(e,t){},e}(),tv=function(e){var t=e.children;return Pf(Object(o.useMemo)(function(){return new ev},[])),s.a.createElement(s.a.Fragment,null,t)},nv=function(){function e(){this.enabledAsFloat=0}return e.prototype.setEnabled=function(e){this.enabledAsFloat=e?1:0},e.prototype.getName=function(){return"FakeMipMapEffectShader"},e.prototype.getUniformNames=function(e){return[]},e.prototype.getFunctions=function(){return[]},e.prototype.getHeaderCode=function(e){return e(" //FakeMipMapEffectShader---\n    #define ENABLE_FAKE_MIP_MAPS_EFFECT")},e.prototype.getShaderFunctionBody=function(e){return""},e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t(Yu),this.enabledAsFloat)},e}(),av=s.a.memo(function(e){var t=e.zoomLevel,n=Object(o.useMemo)(function(){return new nv},[]);Pf(n);var a=Object(o.useContext)(Pu).shouldUseFakeMipMaps&&t<.3333333333333333;return n.setEnabled(a),Sf(a),null});av.displayName="FakeMipMapsEffect";var iv=Object(R.connect)(function(e){return{zoomLevel:h_(e.transformTools)}})(av),rv=s.a.memo(function(){var e=Object(o.useContext)(G1),t=e.enableAdjustments,n=e.enableFilters;return s.a.createElement(s.a.Fragment,null,s.a.createElement(z1,null),s.a.createElement(iv,null),n&&s.a.createElement(m1,null),t&&s.a.createElement(s.a.Fragment,null,s.a.createElement(tv,null,s.a.createElement(N1,null),s.a.createElement(k0,null),s.a.createElement($0,null),s.a.createElement(Q0,null),s.a.createElement(D1,null),s.a.createElement(g1,null)),s.a.createElement(E1,null)),s.a.createElement(P0,null),s.a.createElement(i1,null))});function ov(){return n.e(0).then(n.bind(null,4331))}var sv=function(e){return function(e,t,n,a){return new(n||(n=Promise))(function(e,t){function i(e){try{o(a.next(e))}catch(e){t(e)}}function r(e){try{o(a.throw(e))}catch(e){t(e)}}function o(t){var a;t.done?e(t.value):(a=t.value,a instanceof n?a:new n(function(e){e(a)})).then(i,r)}o((a=a.apply(undefined,[])).next())})}(0,0,void 0,function(){return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(t){return[2,new Promise(function(t,n){var a=new Image;a.onload=function(){t(a)},a.onerror=function(e){n(e)},a.decoding=a.decoding||"auto",a.crossOrigin="Anonymous",a.src=e})]})})},cv=function(){return cv=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},cv.apply(this,arguments)},dv=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},lv=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},uv=Object(o.memo)(function(e){var t=e.filters,n=e.children,a=function(e,t){var n=Object(o.useContext)(G1).enableFilters,a=Se(),i=Object(o.useState)({}),r=i[0],s=i[1],c=Object(o.useCallback)(function(){ov().then(function(e){var t=e.defaultLutUrlDictionary;s(t)}).catch(function(e){return a({id:"CodeSplitFailed",message:"Failed to load LUT data URLs"})})},[a]),d=function(e,t,n,a){var i=this,r=Object(o.useState)({}),s=r[0],c=r[1],d=Se(),l=Object(o.useCallback)(function(e){return dv(i,void 0,void 0,function(){var n;return lv(this,function(a){switch(a.label){case 0:return[4,sv(e)];case 1:return n=a.sent(),[2,new Promise(function(a,i){t&&t.getTexture(n,function(t){a(cv(cv({},t),{url:e}))},_f.lut,!1,function(e){d(e),i()},1)})]}})})},[d,t]),u=Object(o.useCallback)(function(e){return null==t?void 0:t.releaseTexture(e)},[t]);return Object(o.useEffect)(function(){if(e&&n.length>0){var t=!0,r=[],o=O_(n,function(e){return dv(i,void 0,void 0,function(){var n;return lv(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),qc(e)&&a[e.lutUrlId]?[4,l(a[e.lutUrlId])]:[3,2];case 1:if(n=i.sent(),t)return r.push(n.id),[2,n];u(n.id),i.label=2;case 2:return[3,4];case 3:return i.sent(),[3,4];case 4:return[2]}})})}),s=o.promise,d=o.cancel;return s.then(function(e){if(t){var n={};e.forEach(function(e){return e&&(n[e.url]=e.texture)}),c(n)}},function(){}),function(){d(),t=!1,r.forEach(function(e){return u(e)}),r=[],c({})}}},[n,e,l,u,a]),s}(n,e,t,r);return Object(o.useMemo)(function(){return{textures:d,urlsById:r,loadUrls:c}},[d,r,c])}(Object(o.useContext)(pf).textures,t);return s.a.createElement(r1.Provider,{value:a},n)}),fv=Object(R.connect)(function(e){return{filters:e.filters.availableFilters}})(uv),pv=function(e){return e.toFixed(0)},mv=function(){return mv=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},mv.apply(this,arguments)};function _v(e){return Math.round(bn(0,100,e))}var hv=Object(o.memo)(function(e){var t,n=e.filterLevel,a=e.setFilterLevel,i=e.layout,r=e.headerName,c=e.ariaLabel,d=e.style,l=e.hideSliderValueAfterInactivity,u=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["filterLevel","setFilterLevel","layout","headerName","ariaLabel","style","hideSliderValueAfterInactivity"]),f=Object(gc.e)(),p=100,m=pv,_=Object(o.useContext)(Le).localizeNumber,h=Object(o.useState)(!1),b=h[0],g=h[1],v=Object(o.useCallback)(function(e){var t=gn(0,p,e);a(t),g(!0)},[0,p,a]),y=Object(o.useMemo)(function(){return _v(n)},[n]),S=Object(o.useMemo)(function(){var e=Ll(f);return Object(cc.g)(e,(null==d?void 0:d.getSliderStyles)&&(null==d?void 0:d.getSliderStyles(f,y)))},[d,f,y]),D={value:y,valueFormatter:m,maxValue:p,minValue:0,label:r,shouldShow:!l||b};return s.a.createElement("div",{style:null==d?void 0:d.container},s.a.createElement(Hl,{headerProps:D,layout:i,styles:null===(t=null==d?void 0:d.getSliderHeaderStyles)||void 0===t?void 0:t.call(d,f)}),s.a.createElement("div",{style:null==d?void 0:d.sliderWrapper},s.a.createElement(Al.e,mv({},u,{min:0,max:p,step:1,value:y,styles:S,showValue:!1,originFromZero:!0,onChange:v,ariaLabel:c,ariaValueText:_,onChanged:function(){g(!1)}}))))});Object(Cl.n)([{rawString:".imageTileContainer_29808faa{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:8px;width:-webkit-min-content;width:-moz-min-content;width:min-content}.imageTileContainer_29808faa .tile_29808faa{position:relative;background-color:transparent;background-size:cover;background-repeat:no-repeat;background-position:center;height:93px;width:93px;border-radius:3px;margin:8px 0}.imageTileContainer_29808faa .tile_29808faa .background_29808faa{position:absolute;top:0;height:100%;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;opacity:0;font-size:23px;border-radius:3px}.imageTileContainer_29808faa .tileName_29808faa{font-size:12px;line-height:14px;text-align:center;word-break:break-word;word-wrap:break-word;pointer-events:auto}.tileIcon_29808faa{fill:#fff;font-size:24px;width:24px;height:24px}.ms-Fabric--isFocusHidden .imageTileContainer_29808faa .ms-Tile-link{outline:0;height:100%}.ms-Fabric--isFocusVisible .imageTileContainer_29808faa .ms-Tile-link:focus{outline-color:inherit;outline-width:1px;outline-style:solid}"}]);var bv=function(){return bv=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},bv.apply(this,arguments)};function gv(e){return{width:"100%",height:"100%",backgroundColor:e.palette.neutralQuaternary,color:e.palette.black,activeBackgroundOverride:{opacity:1}}}function vv(e,t,n,a){return bv(bv(bv(bv({},a),e&&(null==a?void 0:a.highlightImageOverride)),t&&(null==a?void 0:a.activeImageOverride)),n&&(null==a?void 0:a.disabledImageOverride))}var yv=n(1683),Sv=n(307),Dv=function(){return Dv=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Dv.apply(this,arguments)},Iv=Object(o.forwardRef)(function(e,t){var n=e.image,a=e.imageTileStyles,i=e.name,r=e.ariaLabel,c=e.ariaSelected,d=e.isHighlighted,l=e.isActive,u=e.isDisabled,f=void 0!==u&&u,p=e.role,m=void 0===p?"button":p,_=e.tabIndex,h=void 0===_?0:_,b=e.containerRef,g=e.onClick,v=e.onKeyDown,y=Object(gc.e)(),S=Object(o.useState)(null),D=S[0],I=S[1],x=Object(o.useCallback)(function(e){g(i,e)},[i,g]);Object(o.useLayoutEffect)(function(){D&&(D.tabIndex=h,D.setAttribute("role",m),D.setAttribute("aria-selected",String(c)))},[c,D,m,h]),Object(o.useImperativeHandle)(t,function(){return{focus:function(){return null==D?void 0:D.focus()}}},[D]);var C=Object(o.useMemo)(function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"background_29808faa",style:Xb(d,l,f,Dv(Dv({},gv(y)),null==a?void 0:a.background))},s.a.createElement(Du.e,{iconName:"ActiveFilterCheckmark-Havana",className:"tileIcon_29808faa",style:null==a?void 0:a.icon})),!n&&s.a.createElement(yv.e,{theme:y,shimmerElements:[{type:Sv.e.line,width:93,height:93}]}))},[n,a,l,f,d,y]),O=Object(o.useMemo)(function(){return s.a.createElement("span",{className:"tileName_29808faa",style:Zb(l,f,null==a?void 0:a.name),"aria-hidden":"true",onClick:f?void 0:x},i)},[null==a?void 0:a.name,l,f,i,x]);return s.a.createElement("div",{className:"imageTileContainer_29808faa",style:null==a?void 0:a.container,ref:b,"data-test-id":n?"image-tile-image-loaded":"image-tile-image-loading"},s.a.createElement(wb.e,{style:Dv(Dv({backgroundImage:l?"":"url("+n+")"},vv(d,l,f,null==a?void 0:a.image)),{outlineColor:y.palette.neutralDark}),className:"tile_29808faa",background:C,ariaLabel:r,role:"presentation",linkRef:I,onKeyDown:v,"data-test-id":"imageTile-"+r,onClick:f?void 0:x}),O)}),xv=function(){return xv=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},xv.apply(this,arguments)};function Cv(e,t,n,a,i,r,c,d,l,u){var f=Object(o.useContext)(Le).strings;return Object(o.useCallback)(function(o,p){var m,_=n.find(function(e){return o.name===e.name});return s.a.createElement(Iv,{key:o.name,image:null!==(m=null==_?void 0:_.src)&&void 0!==m?m:"",onClick:function(){i(o,p)},isActive:e.name===o.name,isHighlighted:!1,name:f[o.locStringKey],ariaLabel:f[o.ariaLabelLocStringKey],ariaSelected:e.name===o.name,imageTileStyles:xv(xv({},r),{image:xv({width:a,height:a},null==r?void 0:r.image),container:null==r?void 0:r.container}),tabIndex:(null==c?void 0:c.name)===o.name?0:-1,onKeyDown:d,containerRef:t[p],ref:function(e){l&&l.current&&(l.current[p]=e)},role:null!=u?u:"listitem"})},[n,e.name,f,r,a,null==c?void 0:c.name,d,t,u,i,l])}var Ov=function(e,t,n){var a=void 0,i=e.getEffects().find(function(e){return e.getName()===n});return i&&(a=i.getLevel(),i.setLevel(t)),function(){i&&i.setLevel(null!=a?a:0)}},wv=function(e,t){return Ov(e,t,ef)},Ev=function(){return Ev=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ev.apply(this,arguments)},Av=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},Lv=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};function kv(e,t,n,a,i,r){var s=this,c=Object(o.useState)([]),d=c[0],l=c[1],u=Object(o.useContext)(zc),f=u.image,p=u.offscreenRenderer,m=Se();return Object(o.useEffect)(function(){var o=!1,c=O_(e,function(e){return Av(s,void 0,void 0,function(){var s,c,d,l;return Lv(this,function(u){switch(u.label){case 0:return s=void 0,c=function(e){return Rc(e)?Tc(Tc({},e),{overlay:null}):Tc(Tc({},{main:null,blend:null,overlay:null}),{main:e})}(f),p&&c?(d=function(t,n){return function(e,t,n,a,i,r,o){var s=function(e,t){return Ov(e,t,$u)}(e,a),c=function(e,t,n,a,i,r){var o=void 0,s=void 0,c=void 0,d=e.getEffects().find(function(e){return e.getName()===l1});try{d&&(o=d.getLevel(),s=d.getTexture(),c=d.getConfiguration(),function(e,t,n,a,i){if(qc(a)&&i){var r=t[n[a.lutUrlId]];if(!r||1!==r.parts.length)throw new Error("support is only available for filters from list of default filters");e.setTexture(r.parts[0].texture),e.setConfiguration(a.config),e.setLevel(i)}else e.setLevel(0)}(d,i,r,t,n))}catch(e){a({id:"FilterTextureNotFound",message:"Failed to apply the default filter during offscreen render: "+e+" "})}return function(){d&&c&&(d.setLevel(null!=o?o:0),d.setTexture(s),d.setConfiguration(c))}}(e,t,n,r,o.lutTextures,o.lutUrlsById),d=wv(e,i);return function(){s(),c(),d()}}(t,e,1,0,0,m,n)},[4,w_()]):[3,4];case 1:return u.sent(),o?[3,4]:[4,p.getEditedImage(c,Ev({},(_=Or(t),h=Aa(n),b={width:Math.floor(i*a),height:Math.floor(r*a)},g=b.width/h.width,v=b.height/h.height,y=Math.max(g,v),S={left:0,top:0,width:b.width,height:b.height},{imageTransform:{width:_.width*y,height:_.height*y,x:S.width-(S.width/2+y*h.width/2)-h.left*y+_.x*y,y:S.height-(S.height/2+y*h.height/2)-h.top*y+_.y*y,rotation:_.rotation},cropRectangle:S})),d)];case 2:return l=u.sent(),[4,w_()];case 3:u.sent(),s=null==l?void 0:l.toDataURL(),u.label=4;case 4:return[2,{name:e.name,src:s}]}var _,h,b,g,v,y,S})})}),d=c.promise,u=c.cancel;return Av(s,void 0,void 0,function(){var e;return Lv(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,d];case 1:return e=t.sent(),o||l(e),[3,3];case 2:return t.sent(),l([]),[3,3];case 3:return[2]}})}),function(){u(),o=!0}},[e,n,a,m,r,f,t,p,i]),d}function Mv(e){var t=Object(o.useContext)(Le).strings;return function(n,a){e("Original"!==n.name?nu(t.filter_changedAriaLiveWithIntensity,t[n.ariaLabelLocStringKey],a):nu(t.filter_changedAriaLive,t[n.ariaLabelLocStringKey]))}}Object(Cl.n)([{rawString:".bodyContainer_8740aa0f{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:24px 0}.bodyContainer_8740aa0f .rowContainer_8740aa0f{width:100%}.bodyContainer_8740aa0f .row_8740aa0f{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.bodyContainer_8740aa0f .lastRowWithFewerItems_8740aa0f{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}"}]);var Pv=Object(o.memo)(function(e){var t=e.availableFilters,n=e.activeFilter,a=e.filterLevelsByName,i=e.setActiveFilterAndLevel,r=e.setAriaAnnouncement,c=e.size,d=e.styles,l=e.header,u=e.footer,f=e.imageTransformValues,p=e.cropTransformValues,m=e.cssToPhysicalPixelRatio,_=e.children,h=Object(o.useState)(t.length),b=h[0],g=h[1],v=Object(o.useMemo)(function(){return t.map(function(){return Object(o.createRef)()})},[t]),y=Object(o.useRef)(new Array(t.length)),S=Mv(r),D=Jg(t,n,b),I=D.keyboardFocusedIndex,x=D.setKeyboardFocusedIndex,C=D.onKeyDown,O=Object(o.useContext)(Le).strings,w=O,E=Object(o.useCallback)(function(e){i({activeFilter:n,filterLevel:e})},[n,i]),A=Object(o.useCallback)(function(e,t){i({activeFilter:e,filterLevel:a[e.name]}),S(e,_v(a[e.name]).toString()),x(t)},[i,a,S,x]);Object(o.useLayoutEffect)(function(){for(var e,t,n,a=0;a<v.length;a++){var i=null===(t=null===(e=v[a])||void 0===e?void 0:e.current)||void 0===t?void 0:t.getBoundingClientRect();if(n&&i&&n.top<i.top)return void g(a);n=i}g(v.length)},[v]),Object(o.useLayoutEffect)(function(){var e;y.current&&(null===(e=y.current[I])||void 0===e||e.focus())},[I]);var L=kv(t,f,p,m,93,93),k=Cv(n,v,L,93,A,null==d?void 0:d.imageTile,t[I],C,y,"option"),M=t.map(k).map(function(e,n){return s.a.createElement("div",{ref:v[n],key:t[n].name,style:null==d?void 0:d.filterTile},e)}).reduce(function(e,t){return b&&e[e.length-1].length&&e[e.length-1].length===b&&e.push([]),e[e.length-1].push(t),e},[[]]).map(function(e,t,i){var r=i.length-1===t&&e.length!==i[0].length;return s.a.createElement("div",{key:t,className:"rowContainer_8740aa0f"},s.a.createElement("div",{className:"row_8740aa0f "+(r?"lastRowWithFewerItems_8740aa0f":""),style:null==d?void 0:d.row},e),function(e){return qc(n)&&!!e.find(function(e){return e.props.children.props.isActive})}(e)&&s.a.createElement(hv,{key:n.name,style:null==d?void 0:d.slider,filterLevel:a[n.name],setFilterLevel:E,layout:"Labeled",headerName:w.filter_intensitySliderHeader,ariaLabel:nu(w.filter_intensitySliderAriaLabelFormatString,w[n.ariaLabelLocStringKey])}))});return s.a.createElement(wl,{size:c,styles:d,header:l,footer:u},_,s.a.createElement("section",{"aria-label":O.filter_filtersAriaLandmark},s.a.createElement("div",{className:"bodyContainer_8740aa0f",style:null==d?void 0:d.bodyContainer,role:"listbox",title:w.filter_listTitle},M)))}),Tv={setActiveFilterAndLevel:jr,setAriaAnnouncement:Cs},Uv=Object(R.connect)(function(e){var t=e.filters;return{availableFilters:t.availableFilters,activeFilter:t.activeFilter,filterLevelsByName:e.uiState.filterLevelsByName,cropTransformValues:e.transformTools.cropInteraction.uvToWorld,imageTransformValues:e.transformTools.image._preciseUvToWorld,cssToPhysicalPixelRatio:e.transformTools.device.pixelRatio}},Tv)(Pv);Object(Cl.n)([{rawString:".right_pane_0897155f{width:390px;overflow-y:auto}"}]);var Fv=function(){return Fv=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Fv.apply(this,arguments)},Hv=Object(o.memo)(function(e){var t=e.theme,n=e.styles,a=e.className,i=e.children,r={backgroundColor:t.palette.neutralLighterAlt,borderLeft:t.palette.neutralQuaternary+" 1px solid"},o=Fv(Fv({},r),n);return s.a.createElement("div",{className:"right_pane_0897155f "+a,style:o},i)}),Rv={flexBasis:"100%",margin:"10px 0px",padding:"0px 16px"};function Nv(e){if(e)switch(e.type){case nc.DuoDouble:return{footer:{margin:"8px 16px"},bodyContainer:{margin:"16px -16px",padding:"0px",rowGap:"16px"},row:{justifyContent:"center",columnGap:("Landscape"===(t=e.orientation)?32:22.25)+"px"},slider:{container:{width:("Landscape"===t?464:663)+"px",margin:"auto"},getSliderStyles:Fb,getSliderHeaderStyles:function(){return{container:{fontSize:"16px",lineHeight:"24px",display:"grid",marginTop:"13px"}}}},imageTile:{container:{marginBottom:"0px"},image:{margin:"0px"},background:{cursor:"default"},name:{marginTop:"8px",fontSize:"12px",height:"36px",lineHeight:"12px",fontWeight:400,activeNameOverride:{fontWeight:500}}}};case nc.Desktop:return{filterTile:{margin:"0 8px"},slider:{container:Rv},imageTile:{container:{width:"93px"}}}}var t}Object(Cl.n)([{rawString:".autoEnhanceContainer_73d266df{margin:30px 16px 0 16px}.autoEnhanceButton_73d266df{width:100%}"}]);var Bv={root:{height:"48px",border:"none"},rootHovered:{border:"none"},rootPressed:{border:"none"},textContainer:{flexGrow:0},label:{fontSize:"18px",lineHeight:"20px",fontWeight:"400"}};function jv(e,t){if(t)return Bv;var n={root:{color:e.palette.black,backgroundColor:e.palette.neutralQuaternaryAlt},rootHovered:{color:e.palette.black,backgroundColor:e.palette.neutralQuaternaryAlt,opacity:.9},rootPressed:{color:e.palette.neutralSecondary,backgroundColor:e.palette.neutralLighter},rootDisabled:{color:e.palette.neutralTertiary,backgroundColor:e.palette.neutralLighter}};return Object(cc.g)(Bv,n)}var Vv=function(){return Vv=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Vv.apply(this,arguments)},zv=Object(o.memo)(function(e){var t,n=e.value,a=e.autoEnhanceStatus,i=e.styles,r=e.setValue,c=e.setAutoEnhanceStatus,d=e.setAriaAnnouncement,l=e.onRequestAutoEnhance,u=Object(o.useContext)(Le),f=u.strings,p=u.localizeNumber,m=Object(o.useContext)(_e).logAutoEnhanceRequestedEvent,_=f,h=Object(o.useState)(!1),b=h[0],g=h[1],v=function(e,t){var n=Object(gc.e)();return Object(o.useMemo)(function(){return"on"===e?Vv(Vv({},jv(n,!0)),null==t?void 0:t.autoEnhanceAppliedButton):Vv(Vv({},jv(n,!1)),null==t?void 0:t.autoEnhanceNotAppliedButton)},[e,t,n])}(a,i),y=Rc(t=Object(o.useContext)(zc).image)&&!!t.blend,S=!y&&"requested"===a,D=Object(o.useMemo)(function(){return bn(0,100,n)},[n]);!function(e,t,n,a,i){var r=Object(o.useContext)(Le),s=r.strings,c=r.localizeNumber,d=s,l=Object(o.useRef)(n);l.current=n,Object(o.useLayoutEffect)(function(){e&&t&&(a("on"),i(nu(d.autoEnhance_appliedAriaLive,c(l.current))))},[e,d.autoEnhance_appliedAriaLive,c,i,a,t])}(y&&"requested"===a,b,D,c,d);var I=Object(o.useCallback)(function(e){if(y){var t="on"===a;c(t?"off":"on"),d(t?_.autoEnhance_removedAriaLive:nu(_.autoEnhance_appliedAriaLive,p(D)))}else m({inputType:Ou(e)}),g(!0),c("requested"),d(_.autoEnhance_generatingAriaLive),null==l||l()},[y,a,c,d,_,p,D,m,l]);return s.a.createElement("div",{className:"autoEnhanceContainer_73d266df",style:null==i?void 0:i.bodyContainer},s.a.createElement(Fh.e,{text:_.autoEnhance_name,className:"autoEnhanceButton_73d266df",styles:v,iconProps:{iconName:"AutoEnhanceOn",styles:null==i?void 0:i.icon},disabled:S,allowDisabledFocus:!0,onClick:I}),"on"===a&&s.a.createElement(hv,{key:"autoEnhance",style:null==i?void 0:i.slider,filterLevel:n,setFilterLevel:r,layout:"Labeled",disabled:S,headerName:_.autoEnhance_intensitySliderHeader,ariaLabel:_.autoEnhance_intensitySliderAriaLabel}))}),Gv={setValue:Js,setAutoEnhanceStatus:Xs,setAriaAnnouncement:Cs},Kv=Object(R.connect)(function(e){var t=e.autoEnhance;return{value:t.autoEnhanceLevel,autoEnhanceStatus:t.autoEnhanceStatus}},Gv)(zv);function Wv(e,t){var n=e[t];if(!n)throw new Error("Could not find ink brush with id "+t);return{inkBrush:n,id:t}}function qv(e){return e.toString(16).padStart(2,"0")}function Qv(e){return[{localizedName:e.markup_colorDarkYellow,hexColor:qr},{localizedName:e.markup_colorLightOrange,hexColor:"#fbae17"},{localizedName:e.markup_colorOrange,hexColor:"#f36323"},{localizedName:e.markup_colorRed,hexColor:"#e3182d"},{localizedName:e.markup_colorDarkPurple,hexColor:"#5b318d"},{localizedName:e.markup_colorPurple,hexColor:"#914bb8"},{localizedName:e.markup_colorMagenta,hexColor:"#cf1278"},{localizedName:e.markup_colorDarkRed,hexColor:"#c10051"},{localizedName:e.markup_colorLightBlue,hexColor:"#3eccfd"},{localizedName:e.markup_colorBlue,hexColor:Qr},{localizedName:e.markup_colorDarkBlue,hexColor:"#0051ba"},{localizedName:e.markup_colorLightGreen,hexColor:"#7ec400"},{localizedName:e.markup_colorGreen,hexColor:"#00b44b"},{localizedName:e.markup_colorLightGray,hexColor:"#ebebeb"},{localizedName:e.markup_colorGray,hexColor:"#b6b6b6"},{localizedName:e.markup_colorBlack,hexColor:Yr}]}function Yv(e){return Qv(e).map(function(e,t){var n=++t;return{index:n,id:n.toString(),label:e.localizedName,color:e.hexColor}})}function Jv(e,t){var n=t.cssThicknesses,a=n.indexOf(e),i=Math.round(n.length/2);return-1===a?i:a}function Xv(e){return function(t){var n;return e.minSliderValue+t*(null!==(n=e.step)&&void 0!==n?n:1)}}var Zv=function(){return Zv=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Zv.apply(this,arguments)},$v=Object(o.memo)(function(e){var t=e.addInkContent,n=e.setAriaAnnouncement,a=e.inkBrush,i=Object(o.useContext)(xc),r=i.InkCanvasInteraction,c=i.localizationStrings,d=i.inkConfigurations,l=Object(o.useCallback)(function(e){t(e);var i=function(e,t,n,a){var i,r=function(e,t){var n=Qv(e).find(function(e){return e.hexColor.toLowerCase()===t.toLowerCase()});if(!n)throw new Error("No matching color option for hex value "+t);return n.localizedName}(e,"#"+qv((i=t.drawingAttributes.color).r)+qv(i.g)+qv(i.b)),o=function(e,t){switch(t){case kr.Pen:return e.markup_inkToolbarPenAriaLabel;case kr.Highlighter:return e.markup_inkToolbarHighlighterAriaLabel;default:throw new ec(t)}}(e,n.inkType),s=Jv(t.drawingAttributes.height,a),c=Xv(a)(s).toString();return nu(e.markup_addedInkStrokeAriaLive,o,r,c)}(c,e,a,d[a.inkType]);n(i)},[t,a,d,c,n]);return s.a.createElement(r,Zv({},e,{addInkContent:l}))}),e3={addInkContent:zs,setAriaAnnouncement:Cs},t3=Object(R.connect)(function(e){return{cssToPhysicalPixelRatio:e.transformTools.device.pixelRatio,imageViewTransform:F_(e.transformTools)}},e3)($v),n3=n(136),a3=n(1663),i3=n(326);Object(Cl.n)([{rawString:".toolbar_2bbb1096{border-radius:8px 8px 0 0;padding:0 16px;-webkit-box-shadow:0 4px 8px rgba(0,0,0,.14),0 0 2px rgba(0,0,0,.12);box-shadow:0 4px 8px rgba(0,0,0,.14),0 0 2px rgba(0,0,0,.12);display:-webkit-box;display:-ms-flexbox;display:flex;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;pointer-events:auto;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;z-index:100;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.toolbar_2bbb1096 .focusZone_2bbb1096{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.inkToolbarTooltip_2bbb1096{border:none;border-radius:4px;padding:6px}.toolbarButton_2bbb1096 .toolbarIcon_2bbb1096{-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-radius:4px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;position:relative;-webkit-transition:-webkit-transition .15s ease-in-out;transition:-webkit-transition .15s ease-in-out;transition:transition .15s ease-in-out;transition:transition .15s ease-in-out,-webkit-transition .15s ease-in-out}"}]);var r3=n(1591),o3=n(697),s3={Left:n3.e.rightCenter,Right:n3.e.leftCenter,Bottom:n3.e.topCenter},c3=Object(o.memo)(function(e){var t=e.iconComponent,n=e.onClick,a=e.onFocus,i=e.tooltipContent,r=e.ariaLabel,d=e.ariaDescription,l=e.isToolActive,u=e.buttonId,f=e.disabled,p=e.inkToolbarToolsStyles,m=e.inkToolbarButtonStyles,_=e.arrowModeIconProps,h=Object(gc.e)(),b=Object(o.useContext)(xc),g=b.inkToolbarStyles,v=(0,b.getInkToolbarPosition)(g),y=function(e,t){var n,a,i,r,o={toolbarButton:{},activeToolbarIcon:{backgroundColor:e.palette.neutralTertiaryAlt},toolbarIcon:{width:sc,height:sc,"&:hover":(n={backgroundColor:e.palette.neutralTertiaryAlt},n[".inkTool"]={top:"-4px"},n),"&:active":(a={backgroundColor:e.palette.neutralTertiaryAlt},a[".inkTool"]={top:"-4px"},a)},toolbarIconDisabled:{"&:hover":{backgroundColor:"transparent"},"&:active":{backgroundColor:"transparent"}},activeSVGIcon:(i={},i[".inkTool"]={top:"-4px"},i),SVGIcon:(r={},r[".inkTool"]={top:"5px",position:"absolute",transition:"top 0.05s ease-in-out"},r),toolbarTooltip:{boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)"}};return Object(cc.g)(o,t)}(h,p),S=y.toolbarButton,D=y.activeToolbarIcon,I=y.toolbarIcon,x=y.activeSVGIcon,C=y.SVGIcon,O=y.toolbarIconDisabled,w=y.toolbarTooltip,E=Object(cc.U)(S),A=Object(cc.U)(w),L=Object(cc.U)(I,l&&D,C,l&&x,"toolbarIcon_2bbb1096",f&&O),k=Object(ic.e)("tooltip"),M={gapSpace:15,beakWidth:12,styles:{beak:{background:h.palette.neutralLight},beakCurtain:{background:h.palette.neutralLight},calloutMain:{background:h.palette.neutralLight}}},P=Object(o.useMemo)(function(){return Object(cc.g)({root:{backgroundColor:"inherit",border:"none",height:"56px",margin:"0",minWidth:"48px",overflow:"hidden",padding:"0",width:"48px",alignSelf:"center"},rootHovered:{backgroundColor:"inherit"},rootPressed:{backgroundColor:"inherit"},rootDisabled:{backgroundColor:"inherit"}},m)},[m]),T=s.a.createElement(vh.e,{id:u,styles:P,className:Object(c.e)(E,"toolbarButton_2bbb1096"),onClick:n,onFocus:a,role:"option","aria-checked":l,ariaLabel:r,ariaDescription:d,disabled:f,iconProps:_},s.a.createElement("span",{"aria-hidden":!0,className:L,role:"presentation"},t));return f||!i?T:s.a.createElement(r3.e,{content:i,id:k,directionalHint:s3[v],calloutProps:M,delay:o3.e.long,className:Object(c.e)(A,"inkToolbarTooltip_2bbb1096"),tooltipProps:{styles:{subText:{fontWeight:600,textAlign:"center"}}}},T)}),d3=function(){return d3=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},d3.apply(this,arguments)},l3=Object(o.memo)(function(e){var t=e.inkToolbarToolsStyles,n=e.getIcon,a=e.activeMarkupToolType,i=e.setActiveMarkupToolType,r=e.onClick,c=e.inkToolbarButtonStyles,d=e.showTooltip,l=e.iconSize,u=Object(o.useContext)(xc).localizationStrings,f=Object(o.useCallback)(function(){i("Eraser"),null==r||r()},[r,i]),p="Eraser"===a;return s.a.createElement(c3,{inkToolbarToolsStyles:t,iconComponent:n({isActive:p,styles:d3({},l)}),onClick:f,onFocus:f,tooltipContent:d?u.markup_inkToolbarEraserTooltip:void 0,ariaLabel:u.markup_inkToolbarEraserAriaLabel,ariaDescription:u.markup_inkToolbarEraserAriaDescription,isToolActive:p,inkToolbarButtonStyles:c})}),u3=function(){return u3=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},u3.apply(this,arguments)},f3=Object(o.memo)(function(e){var t=e.inkBrush,n=e.buttonId,a=e.locStrings,i=e.isToolActive,r=e.getIcon,o=e.inkToolbarToolsStyles,c=e.inkToolbarButtonStyles,d=e.iconSize,l=e.onClick,u=e.onFocus,f=e.getDisplayThickness,p=e.getTooltipContent,m=e.getAriaLabel;return s.a.createElement(c3,{iconComponent:r({styles:u3({},d),inkBrushColor:t.htmlColor,isActive:i}),onClick:l,onFocus:u,tooltipContent:null==p?void 0:p(a,a.markup_inkToolbarHighlighterTooltip,t.htmlColor,f(t.thicknessInCssPixels,t.inkType),i),ariaLabel:m(a,a.markup_inkToolbarHighlighterAriaLabel,t.htmlColor,f(t.thicknessInCssPixels,t.inkType)),ariaDescription:a.markup_inkToolbarHighlighterAriaDescription,isToolActive:i,buttonId:n,inkToolbarToolsStyles:o,inkToolbarButtonStyles:c})}),p3=function(){return p3=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},p3.apply(this,arguments)},m3={width:8,height:9},_3={width:8,height:11};function h3(e){var t=function(e){return{fontSize:"0px",position:"absolute",zIndex:1,margin:"2px",color:e.palette.neutralDark,fill:e.palette.neutralDark}}(e);return{singleArrow:{root:p3(p3(p3({},t),m3),{top:8,right:4})},doubleArrow:{root:p3(p3(p3({},t),_3),{top:8,right:4})}}}var b3=function(e){return void 0!==e&&e!==Lr.NoArrow};function g3(e,t){switch(e){case Lr.NoArrow:return"";case Lr.SingleArrow:return t.markup_inkToolbarSingleArrowTip;case Lr.DoubleArrow:return t.markup_inkToolbarDoubleArrowTips;default:throw new ec(e)}}var v3=function(){return v3=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},v3.apply(this,arguments)},y3=Object(o.memo)(function(e){var t=e.inkBrush,n=e.buttonId,a=e.locStrings,i=e.isToolActive,r=e.getIcon,c=e.iconSize,d=e.inkToolbarToolsStyles,l=e.inkToolbarButtonStyles,u=e.onClick,f=e.onFocus,p=e.getDisplayThickness,m=e.getTooltipContent,_=e.getAriaLabel,h=e.inkToolbarArrowIconStyle,b=function(e,t){var n=Object(gc.e)();return{iconName:Object(o.useMemo)(function(){return b3(e)?function(e){switch(e){case Lr.SingleArrow:return"SmallSingleArrow-Havana";case Lr.DoubleArrow:return"SmallArrowMaximize-Havana";default:throw new ec(e)}}(e):void 0},[e]),styles:Object(o.useMemo)(function(){if(b3(e))return e===Lr.SingleArrow?Object(cc.T)(h3(n).singleArrow,null==t?void 0:t.singleArrow):Object(cc.T)(h3(n).doubleArrow,null==t?void 0:t.doubleArrow)},[e,t,n])}}(t.arrowMode,h);return s.a.createElement(c3,{iconComponent:r({styles:v3({},c),inkBrushColor:t.htmlColor,isActive:i}),onClick:u,onFocus:f,tooltipContent:null==m?void 0:m(a,a.markup_inkToolbarPenTooltip,t.htmlColor,p(t.thicknessInCssPixels,t.inkType),i,t.arrowMode&&g3(t.arrowMode,a)),ariaLabel:_(a,a.markup_inkToolbarPenAriaLabel,t.htmlColor,p(t.thicknessInCssPixels,t.inkType),t.arrowMode&&g3(t.arrowMode,a)),ariaDescription:a.markup_inkToolbarPenAriaDescription,isToolActive:i,buttonId:n,inkToolbarToolsStyles:d,inkToolbarButtonStyles:l,arrowModeIconProps:b})}),S3=function(){return S3=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},S3.apply(this,arguments)},D3=Object(o.memo)(function(e){var t=e.inkBrush,n=e.inkBrushId,a=e.locStrings,i=e.isToolActive,r=e.brushMarkupToolType,c=e.iconSize,d=e.inkToolbarToolsStyles,l=e.inkToolbarButtonStyles,u=e.getIcon,f=e.getDisplayThickness,p=e.getTooltipContent,m=e.getAriaLabel,_=e.setActiveMarkupInkBrushId,h=e.setActiveMarkupToolType,b=e.onClick,g=e.inkToolbarArrowIconStyle,v=Object(ic.e)(n),y=Object(o.useCallback)(function(){_(n),h(r)},[_,n,h,r]),S=Object(o.useCallback)(function(){i||y(),null==b||b(v,i)},[i,b,v,y]),D=Object(o.useCallback)(function(){ur()&&y()},[y]);return s.a.createElement(I3,{inkBrush:t,buttonId:v,locStrings:a,isToolActive:i,onClick:S,onFocus:D,getDisplayThickness:f,getAriaLabel:m,getTooltipContent:p,inkToolbarToolsStyles:d,inkToolbarButtonStyles:l,iconSize:c,getIcon:u,inkToolbarArrowIconStyle:g})}),I3=function(e){switch(e.inkBrush.inkType){case kr.Pen:return s.a.createElement(y3,S3({},e));case kr.Highlighter:return s.a.createElement(f3,S3({},e));default:throw new ec(e.inkBrush.inkType)}},x3=Object(o.memo)(function(e){var t=e.brushInkPropertiesLabel,n=e.changeInkPropertiesLabel;return s.a.createElement(s.a.Fragment,null,s.a.createElement("span",null,t),s.a.createElement("br",null),s.a.createElement("span",null,n))}),C3=Object(o.memo)(function(e){var t=e.inkBrushes,n=e.activeInkBrushId,a=e.activeMarkupToolType,i=e.inkBrushConfigurations,r=e.showTooltip,c=void 0===r||r,d=e.iconSize,l=e.inkToolbarToolsStyles,u=e.inkToolbarButtonStyles,f=e.setActiveMarkupInkBrushId,p=e.setActiveMarkupToolType,m=e.setInkBrush,_=e.onBrushClick,h=e.inkToolbarArrowIconStyle,b=Object(o.useContext)(xc),g=b.localizationStrings,v=b.inkConfigurations,y=Object(o.useCallback)(function(e,t){var n=v[t],a=Jv(e,n);return Xv(n)(a)},[v]),S=function(e,t){return n===e&&a===t};return s.a.createElement(s.a.Fragment,null,Object.entries(t).map(function(e){var t=e[0],n=e[1],a=tc(n.inkType),r=i.brushes.find(function(e){return e.inkBrushId===t});if(!r)throw new Error("inkBrushConfig not found for "+t);return s.a.createElement(D3,{inkBrush:n,inkBrushId:t,locStrings:g,inkConfiguration:v[n.inkType],brushMarkupToolType:a,isToolActive:S(t,a),getDisplayThickness:y,getTooltipContent:c?w3:void 0,getAriaLabel:O3,setActiveMarkupInkBrushId:f,setActiveMarkupToolType:p,setInkBrush:m,key:t,inkToolbarToolsStyles:l,inkToolbarButtonStyles:u,iconSize:d,getIcon:r.getIcon,onClick:_,inkToolbarArrowIconStyle:h})}))});function O3(e,t,n,a,i){for(var r="",o=0,s=Yv(e);o<s.length;o++){var c=s[o],d=c.label;c.color===n&&d&&(r=d)}if(""===r)throw new Error("Unrecognized color");return nu(e.markup_inkToolbarBrushFormatString,t,r,e.markup_inkToolbarThickness,a.toString(),i||"")}function w3(e,t,n,a,i,r){var o=O3(e,t,n,a,r),c=e.markup_inkToolbarTooltipChangeInkProperties;return i?s.a.createElement(x3,{brushInkPropertiesLabel:o,changeInkPropertiesLabel:c}):o}var E3,A3=function(){return A3=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},A3.apply(this,arguments)},L3=Object(o.memo)(function(e){var t,n,a,i=e.confirmationDialogHostId,r=e.confirmationDialogType,c=e.enableClearAllInk,d=e.showTooltip,l=e.styles,u=e.isClearAllInkConfirmationDialogVisible,f=e.toggleIsClearAllInkConfirmationDialogVisible,p=e.clearAllInkContent,m=e.setAriaAnnouncement,_=e.getIcon,h=Object(o.useContext)(xc).localizationStrings,b=(t=Object(gc.e)(),n=null==l?void 0:l.inkToolbarTools,a={toolbarButton:{},activeToolbarIcon:{backgroundColor:t.palette.neutralQuaternaryAlt},toolbarIcon:{width:sc,height:sc,"&:active":{backgroundColor:t.palette.neutralQuaternaryAlt},"&:hover":{backgroundColor:t.palette.neutralLight}},toolbarIconDisabled:{"&:hover":{backgroundColor:"transparent"},"&:active":{backgroundColor:"transparent"}},activeSVGIcon:{},SVGIcon:{},toolbarTooltip:{boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)"}},Object(cc.g)(a,n)),g={contentTitle:h.markup_clearAllInkDialogTitle,contentSubText:h.markup_clearAllInkDialogSubText,closeButtonAriaLabel:h.markup_clearAllInkDialogCloseButtonAriaLabel,confirmText:h.markup_clearAllInkDialogConfirmButtonText,confirmAriaLabel:h.markup_clearAllInkDialogConfirmButtonAriaLabel,cancelText:h.markup_clearAllInkDialogCancelButtonText,cancelAriaLabel:h.markup_clearAllInkDialogCancelButtonAriaLabel};return s.a.createElement(s.a.Fragment,null,s.a.createElement(c3,{inkToolbarToolsStyles:b,inkToolbarButtonStyles:null==l?void 0:l.inkToolbarButton,iconComponent:_(A3({enabled:c},null==l?void 0:l.clearAllInkIcon)),onClick:function(){f()},tooltipContent:d?h.markup_inkToolbarClearAllInkTooltip:void 0,ariaLabel:h.markup_inkToolbarClearAllInkAriaLabel,isToolActive:!1,disabled:!c}),c&&s.a.createElement(Rh,{onConfirm:function(){p(),m(h.markup_clearedAllInkStrokesAriaLive),f()},onCancel:function(){f()},isVisible:u,hostId:i,dialogType:r,styles:null==l?void 0:l.confirmationDialog,dialogStrings:g}))}),k3={toggleIsClearAllInkConfirmationDialogVisible:Vs},M3=Object(R.connect)(function(e){return{isClearAllInkConfirmationDialogVisible:e.markup.isClearAllInkConfirmationDialogVisible}},k3)(L3),P3=n(1676),T3=n(248);function U3(e,t,n){var a=t||{width:0,height:0},i=Object(o.useState)(a),r=i[0],s=i[1],c=Object(o.useCallback)(function(e){var t=e[0].contentRect,n=t.width,a=t.height;s({width:n,height:a})},[s]);return Object(o.useLayoutEffect)(function(){if(e){var t=e.offsetWidth,n=e.offsetHeight;s({width:t,height:n})}},[e]),qg(e,c,n),r}function F3(e,t,n,a,i){return e+","+(i+n/2)+" "+e+","+(i-n/2)+" "+t+","+(i-a/2)+" "+t+","+(i+a/2)}n(1029),n(1324),n(2231),n(1600),n(865),function(e){e[e.Unshaded=0]="Unshaded",e[e.Shade1=1]="Shade1",e[e.Shade2=2]="Shade2",e[e.Shade3=3]="Shade3",e[e.Shade4=4]="Shade4",e[e.Shade5=5]="Shade5",e[e.Shade6=6]="Shade6",e[e.Shade7=7]="Shade7",e[e.Shade8=8]="Shade8"}(E3||(E3={}));var H3={width:336,height:30},R3=Object(o.memo)(function(e){var t=e.previewSize,n=e.thickness,a=e.flipHorizontally,i=void 0!==a&&a,r=n*(i?2:.6),o=n*(i?.6:2),c=t.width,d=Math.floor(t.height/2);return s.a.createElement("polygon",{points:F3(0,c,r,o,d),strokeWidth:"1"})}),N3=Object(o.memo)(function(e){var t=e.previewSize,n=e.thickness,a=e.flipHorizontally,i=void 0!==a&&a,r=e.opacity,o=void 0===r?1:r,c=e.yScale,d=void 0===c?1:c,l=e.hidePathStroke,u=n*(i?2.25:.25),f=n*(i?.25:2.25),p=void 0===l||l?"transparent":void 0,m=u*d,_=f*d,h=u/2,b=t.width-f/2,g=Math.floor(t.height/2);return s.a.createElement(s.a.Fragment,null,s.a.createElement("polygon",{key:"trapezoid "+o+","+d,points:F3(h,b,m,_,g),strokeWidth:"1",opacity:o}),s.a.createElement("path",{key:"trapezoidLeft "+o+","+d,d:"M "+(h+1)+","+(g+m/2)+" a1,1 0 0,1 0, "+-m,stroke:p,strokeWidth:"1",opacity:o}),s.a.createElement("path",{key:"trapezoidRight "+o+","+d,d:"M "+(b-1)+","+(g+_/2)+" a1,1 0 0,0 0, "+-_,stroke:p,strokeWidth:"1",opacity:o}))});Object(Cl.n)([{rawString:".strokePreviewContainer_694e746e{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.strokePreviewContainer_694e746e .disabled_694e746e{opacity:.4}"}]);var B3=function(){return B3=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},B3.apply(this,arguments)},j3=Object(o.memo)(function(e){var t,n=e.thickness,a=e.inkBrushHtmlColor,i=e.inkBrushInkType,r=e.flipHorizontally,c=void 0!==r&&r,d=e.disabled,l=void 0!==d&&d,u=Object(gc.e)(),f=Object(o.useState)(null),p=f[0],m=f[1],_=U3(p).width,h=Object(o.useMemo)(function(){return B3(B3({},H3),{width:_})},[_]),b=Object(o.useMemo)(function(){return function(e,t){var n=Object(iu.e)(e.palette.white),a=Object(iu.e)(t);return!(!n||!a)&&function(e,t){function n(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}var a=.2126*n(e.r/T3.t)+.7152*n(e.g/T3.t)+.0722*n(e.b/T3.t);a+=.05;var i=.2126*n(t.r/T3.t)+.7152*n(t.g/T3.t)+.0722*n(t.b/T3.t);return a/(i+=.05)>1?a/i:i/a}(n,a)<1.3}(u,a)},[u,a]),g=Object(o.useMemo)(function(){var e={previewSize:h,thickness:n,flipHorizontally:c};switch(i){case kr.Highlighter:return s.a.createElement(R3,B3({},e));case kr.Pen:return s.a.createElement(N3,B3({},e,{hidePathStroke:!b}));default:throw new ec(i)}},[h,n,c,i,b]),v=Object(o.useMemo)(function(){var e;return b?null===(e=null==u?void 0:u.palette)||void 0===e?void 0:e.neutralSecondary:void 0},[b,null===(t=null==u?void 0:u.palette)||void 0===t?void 0:t.neutralSecondary]);return s.a.createElement("div",{ref:m,className:"strokePreviewContainer_694e746e"},s.a.createElement("svg",{className:l?"disabled_694e746e":void 0,height:h.height,width:h.width,fill:a,style:{stroke:v}},g))}),V3=n(2049),z3=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onClick=function(){var e=t.props,n=e.onClick,a=e.disabled,i=e.item;n&&!a&&n(i)},t._onMouseEnter=function(e){var n=t.props,a=n.onHover,i=n.disabled,r=n.item,o=n.onMouseEnter;o&&o(e)||!a||i||a(r)},t._onMouseMove=function(e){var n=t.props,a=n.onHover,i=n.disabled,r=n.item,o=n.onMouseMove;o&&o(e)||!a||i||a(r)},t._onMouseLeave=function(e){var n=t.props,a=n.onHover,i=n.disabled,r=n.onMouseLeave;r&&r(e)||!a||i||a()},t._onFocus=function(){var e=t.props,n=e.onFocus,a=e.disabled,i=e.item;n&&!a&&n(i)},t}return Object(I.a)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.item,a=t.id,i=t.className,r=t.role,s=t.selected,d=t.disabled,l=t.onRenderItem,u=t.cellDisabledStyle,f=t.cellIsSelectedStyle,p=t.index,m=t.label,_=t.getClassNames;return o.createElement(V3.e,{id:a,"data-index":p,"data-is-focusable":!0,disabled:d,className:Object(c.e)(i,(e={},e[""+f]=s,e[""+u]=d,e)),onClick:this._onClick,onMouseEnter:this._onMouseEnter,onMouseMove:this._onMouseMove,onMouseLeave:this._onMouseLeave,onFocus:this._onFocus,role:r,"aria-selected":s,ariaLabel:m,title:m,getClassNames:_},l(n))},t.defaultProps={disabled:!1},t}(o.Component),G3=n(1513),K3=n(233),W3=n(1031),q3=n(953),Q3=n(95),Y3=Object(Su.e)(),J3=function(e){function t(t){var n=e.call(this,t)||this;return Object(q3.e)(n),n._id=t.id||Object(A.e)(),n}return Object(I.a)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.items,a=t.columnCount,i=t.onRenderItem,r=t.ariaPosInSet,s=void 0===r?t.positionInSet:r,c=t.ariaSetSize,d=void 0===c?t.setSize:c,l=t.styles,u=t.doNotContainWithinFocusZone,f=Object(Q3.s)(this.props,Q3.c,u?[]:["onBlur"]),p=Y3(l,{theme:this.props.theme}),m=Object(W3.i)(n,a),_=o.createElement("table",Object(I.e)({"aria-posinset":s,"aria-setsize":d,id:this._id,role:"grid"},f,{className:p.root}),o.createElement("tbody",null,m.map(function(t,n){return o.createElement("tr",{role:"row",key:e._id+"-"+n+"-row"},t.map(function(t,n){return o.createElement("td",{role:"presentation",key:e._id+"-"+n+"-cell",className:p.tableCell},i(t,n))}))})));return u?_:o.createElement(a3.e,{isCircularNavigation:this.props.shouldFocusCircularNavigate,className:p.focusedContainer,onBlur:this.props.onBlur},_)},t}(o.Component),X3=Object(G3.e)(J3,function(e){return{root:{padding:2,outline:"none"},tableCell:{padding:0}}}),Z3=n(98),$3=n(1273),e2=Object(Z3.t)(function(e,t,n,a,i,r,o,s,c){var d=Object($3.e)(e);return Object(cc.T)({root:["ms-Button",d.root,n,t,o&&["is-checked",d.rootChecked],r&&["is-disabled",d.rootDisabled],!r&&!o&&{selectors:{":hover":d.rootHovered,":focus":d.rootFocused,":active":d.rootPressed}},r&&o&&[d.rootCheckedDisabled],!r&&o&&{selectors:{":hover":d.rootCheckedHovered,":active":d.rootCheckedPressed}}],flexContainer:["ms-Button-flexContainer",d.flexContainer]})}),t2=Object(Su.e)(),n2=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(I.a)(t,e),t}(z3),a2=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderColorOption=function(e){return o.createElement("svg",{className:t._classNames.svg,viewBox:"0 0 20 20",fill:Object(iu.e)(e.color).str},t.props.circle?o.createElement("circle",{cx:"50%",cy:"50%",r:"50%"}):o.createElement("rect",{width:"100%",height:"100%"}))},t}return Object(I.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.item,n=e.idPrefix,a=void 0===n?this.props.id:n,i=e.selected,r=e.disabled,s=e.styles,c=e.theme,d=e.circle,l=e.color,u=e.onClick,f=e.onHover,p=e.onFocus,m=e.onMouseEnter,_=e.onMouseMove,h=e.onMouseLeave,b=e.onWheel,g=e.onKeyDown,v=e.height,y=e.width,S=e.borderWidth;return this._classNames=t2(s,{theme:c,disabled:r,selected:i,circle:d,isWhite:this._isWhiteCell(l),height:v,width:y,borderWidth:S}),o.createElement(n2,{item:t,id:a+"-"+t.id+"-"+t.index,key:t.id,disabled:r,role:"gridcell",onRenderItem:this._onRenderColorOption,selected:i,onClick:u,onHover:f,onFocus:p,label:t.label,className:this._classNames.colorCell,getClassNames:e2,index:t.index,onMouseEnter:m,onMouseMove:_,onMouseLeave:h,onWheel:b,onKeyDown:g})},t.prototype._isWhiteCell=function(e){return"ffffff"===Object(iu.e)(e).hex},t.defaultProps={circle:!0,disabled:!1,selected:!1},t}(o.PureComponent),i2=n(530),r2={left:-2,top:-2,bottom:-2,right:-2,border:"none",outlineColor:"ButtonText"},o2=Object(G3.e)(a2,function(e){var t,n,a,i,r,o=e.theme,s=e.disabled,c=e.selected,d=e.circle,l=e.isWhite,u=e.height,f=void 0===u?20:u,p=e.width,m=void 0===p?20:p,_=e.borderWidth,h=o.semanticColors,b=o.palette,g=b.neutralLighter,v=b.neutralLight,y=b.neutralSecondary,S=b.neutralTertiary,D=_||(m<24?2:4);return{colorCell:[Object(cc.D)(o,{inset:-1,position:"relative",highContrastStyle:r2}),{backgroundColor:h.bodyBackground,padding:0,position:"relative",boxSizing:"border-box",display:"inline-block",cursor:"pointer",userSelect:"none",borderRadius:0,border:"none",height:f,width:m},!d&&{selectors:(t={},t["."+i2.e+" &:focus::after"]={outlineOffset:D-1+"px"},t)},d&&{borderRadius:"50%",selectors:(n={},n["."+i2.e+" &:focus::after"]={outline:"none",borderColor:h.focusBorder,borderRadius:"50%",left:-D,right:-D,top:-D,bottom:-D,selectors:(a={},a[cc.r]={outline:"1px solid ButtonText"},a)},n)},c&&{padding:2,border:D+"px solid "+v,selectors:(i={},i["&:hover::before"]={content:'""',height:f,width:m,position:"absolute",top:-D,left:-D,borderRadius:d?"50%":"default",boxShadow:"inset 0 0 0 1px "+y},i)},!c&&{selectors:(r={},r["&:hover, &:active, &:focus"]={backgroundColor:h.bodyBackground,padding:2,border:D+"px solid "+g},r["&:focus"]={borderColor:h.bodyBackground,padding:0,selectors:{":hover":{borderColor:o.palette.neutralLight,padding:2}}},r)},s&&{color:h.disabledBodyText,pointerEvents:"none",opacity:.3},l&&!c&&{backgroundColor:S,padding:1}],svg:[{width:"100%",height:"100%"},d&&{borderRadius:"50%"}]}},void 0,{scope:"ColorPickerGridCell"},!0),s2=Object(Su.e)(),c2=function(e){function t(t){var n,a=e.call(this,t)||this;return a.navigationIdleDelay=250,a._getItemsWithIndex=Object(Z3.t)(function(e){return e.map(function(e,t){return Object(I.e)(Object(I.e)({},e),{index:t})})}),a._onRenderItem=function(e,t){var n=a.props.onRenderColorCell;return(void 0===n?a._renderOption:n)(e,a._renderOption)},a._onSwatchColorPickerBlur=function(){a.props.onCellFocused&&(a._cellFocused=!1,a.props.onCellFocused())},a._renderOption=function(e){var t=a.props,n=a._id;return o.createElement(o2,{item:e,idPrefix:n,color:e.color,styles:t.getColorGridCellStyles,disabled:t.disabled,onClick:a._onCellClick,onHover:a._onGridCellHovered,onFocus:a._onGridCellFocused,selected:void 0!==a.state.selectedIndex&&a.state.selectedIndex===e.index,circle:"circle"===t.cellShape,label:e.label,onMouseEnter:a._onMouseEnter,onMouseMove:a._onMouseMove,onMouseLeave:a._onMouseLeave,onWheel:a._onWheel,onKeyDown:a._onKeyDown,height:t.cellHeight,width:t.cellWidth,borderWidth:t.cellBorderWidth})},a._onMouseEnter=function(e){return a.props.focusOnHover?(a.isNavigationIdle&&!a.props.disabled&&e.currentTarget.focus(),!0):!a.isNavigationIdle||!!a.props.disabled},a._onMouseMove=function(e){if(!a.props.focusOnHover)return!a.isNavigationIdle||!!a.props.disabled;var t=e.currentTarget;return!a.isNavigationIdle||document&&t===document.activeElement||t.focus(),!0},a._onMouseLeave=function(e){var t=a.props.mouseLeaveParentSelector;if(a.props.focusOnHover&&t&&a.isNavigationIdle&&!a.props.disabled)for(var n=document.querySelectorAll(t),i=0;i<n.length;i+=1)if(n[i].contains(e.currentTarget)){if(n[i].setActive)try{n[i].setActive()}catch(e){}else n[i].focus();break}},a._onWheel=function(){a._setNavigationTimeout()},a._onKeyDown=function(e){e.which!==tb.e.up&&e.which!==tb.e.down&&e.which!==tb.e.left&&e.which!==tb.e.right||a._setNavigationTimeout()},a._setNavigationTimeout=function(){a.isNavigationIdle||void 0===a.navigationIdleTimeoutId?a.isNavigationIdle=!1:(a.async.clearTimeout(a.navigationIdleTimeoutId),a.navigationIdleTimeoutId=void 0),a.navigationIdleTimeoutId=a.async.setTimeout(function(){a.isNavigationIdle=!0},a.navigationIdleDelay)},a._onGridCellHovered=function(e){var t=a.props.onCellHovered;if(t)return e?t(e.id,e.color):t()},a._onGridCellFocused=function(e){var t=a.props.onCellFocused;if(t)return e?(a._cellFocused=!0,t(e.id,e.color)):(a._cellFocused=!1,t())},a._onCellClick=function(e){if(!a.props.disabled){var t=e.index;t>=0&&t!==a.state.selectedIndex&&(a.props.onCellFocused&&a._cellFocused&&(a._cellFocused=!1,a.props.onCellFocused()),a.props.onColorChanged&&a.props.onColorChanged(e.id,e.color),!0!==a.props.isControlled&&a.setState({selectedIndex:t}))}},a._id=t.id||Object(A.e)("swatchColorPicker"),a.isNavigationIdle=!0,a.async=new K3.e(a),t.selectedId&&(n=d2(t.colorCells,t.selectedId)),a.state={selectedIndex:n},a}return Object(I.a)(t,e),t.getDerivedStateFromProps=function(e,t){var n=e.selectedId?d2(e.colorCells,e.selectedId):void 0;return!e.isControlled&&void 0===n||n===t.selectedIndex?null:{selectedIndex:n}},t.prototype.componentWillUnmount=function(){this.props.onCellFocused&&this._cellFocused&&(this._cellFocused=!1,this.props.onCellFocused()),this.async.dispose()},t.prototype.render=function(){var e=this.props,t=e.colorCells,n=e.columnCount,a=e.ariaPosInSet,i=void 0===a?this.props.positionInSet:a,r=e.ariaSetSize,s=void 0===r?this.props.setSize:r,c=e.shouldFocusCircularNavigate,d=e.className,l=e.doNotContainWithinFocusZone,u=e.styles,f=e.cellMargin,p=s2(u,{theme:this.props.theme,className:d,cellMargin:f});return t.length<1||n<1?null:o.createElement(X3,Object(I.e)({},this.props,{id:this._id,items:this._getItemsWithIndex(t),columnCount:n,onRenderItem:this._onRenderItem,ariaPosInSet:i,ariaSetSize:s,shouldFocusCircularNavigate:c,doNotContainWithinFocusZone:l,onBlur:this._onSwatchColorPickerBlur,theme:this.props.theme,styles:{root:p.root,tableCell:p.tableCell,focusedContainer:p.focusedContainer}}))},t.defaultProps={cellShape:"circle",disabled:!1,shouldFocusCircularNavigate:!0,cellMargin:10},t}(o.Component);function d2(e,t){var n=Object(W3.a)(e,function(e){return e.id===t});return n>=0?n:void 0}var l2={focusedContainer:"ms-swatchColorPickerBodyContainer"},u2=Object(G3.e)(c2,function(e){var t=e.className,n=e.theme;return{root:{margin:"8px 0",borderCollapse:"collapse"},tableCell:{padding:e.cellMargin/2},focusedContainer:[Object(cc.I)(l2,n).focusedContainer,{clear:"both",display:"block",minWidth:"180px"},t]}},void 0,{scope:"SwatchColorPicker"});Object(Cl.n)([{rawString:".inkStylePicker_96c52854{border-radius:8px;width:336px}.inkSwatchColorPickerContainer_96c52854{clear:both;display:block;text-align:center}"}]);var f2=function(){return f2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},f2.apply(this,arguments)};function p2(e,t){var n=null!=t?t:{},a=n.colorCellSize,i=n.colorCellSVGRadius,r=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(n,["colorCellSize","colorCellSVGRadius"]),o={colorCell:{padding:"0px",borderRadius:"50%",height:"auto",width:"auto"},colorCellSVG:{border:"1px solid transparent","&:hover":{backgroundColor:e.palette.neutralQuaternary,borderRadius:"50%"},"&:active":{backgroundColor:e.palette.neutralQuaternaryAlt,borderRadius:"50%"}},colorCellSVGCircle:{strokeOpacity:"0.3",stroke:e.palette.black},colorCellSelected:{backgroundColor:e.palette.neutralQuaternaryAlt,border:"1px solid "+e.palette.neutralTertiary,borderRadius:"50%"}};return f2(f2({},Object(cc.g)(o,r)),{colorCellSize:null!=a?a:30,colorCellSVGRadius:null!=i?i:12})}var m2={root:{margin:"0px",padding:"0px"},tableCell:{padding:"0px",height:"40px",width:"40px",textAlign:"center",button:{margin:"0px"}}},_2=Object(o.memo)(function(e){var t=e.colorOptions,n=e.selectedHTMLColor,a=e.colorPickerGridCellButtonIdPrefix,i=e.colorTableAriaLabel,r=e.maxColumnCount,c=void 0===r?8:r,d=e.styles,l=e.doNotContainWithinFocusZone,u=e.disabled,f=void 0!==u&&u,p=e.setSelectedHtmlColor,m=Object(gc.e)(),_=function(e){if(!e)throw Error("Color of cell must not be falsy.");return e},h=function(e){var t=_(e.color),a=n===t,i=p2(m,null==d?void 0:d.colorPickerGridCellStyles),r=i.colorCellSVG,o=i.colorCellSVGCircle,c=i.colorCellSize,l=i.colorCellSVGRadius,u=i.colorCellSelected,p=i.colorCellDisabled,h=f?Object(cc.U)(p):Object(cc.U)(r,a&&u);return s.a.createElement("svg",{className:h,width:c,height:c,viewBox:"0 0 "+c+" "+c,fill:f?"inherit":e.color},s.a.createElement("circle",{className:Object(cc.U)(o),cx:"50%",cy:"50%",r:l}))},b=Object(o.useMemo)(function(){return Object(cc.g)(m2,null==d?void 0:d.colorPicker)},[null==d?void 0:d.colorPicker]);return s.a.createElement("div",{className:"inkSwatchColorPickerContainer_96c52854"},s.a.createElement(u2,{id:"inkColorPicker","aria-label":i,columnCount:Math.min(t.length,c),colorCells:t,styles:b,onRenderColorCell:function(e){var t;if(!e)throw Error("ColorPicker did not receive color options to display.");var i=_(e.color),r=p2(m,null==d?void 0:d.colorPickerGridCellStyles).colorCell;return s.a.createElement(z3,{item:e,id:a+"-"+e.id,label:e.label,index:e.index,key:e.id,role:"gridcell",className:Object(cc.U)(r,f&&(null===(t=null==d?void 0:d.colorPickerGridCellStyles)||void 0===t?void 0:t.colorCellDisabled)),onRenderItem:h,onClick:function(){return p(i)},selected:!f&&n===i,disabled:f})},isControlled:!0,doNotContainWithinFocusZone:l}))}),h2=function(){return h2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},h2.apply(this,arguments)},b2=s.a.memo(function(e){var t,n,a=e.inkConfiguration,i=e.inkBrushThicknessInCssPixels,r=e.layout,c=e.headerName,d=e.ariaLabel,l=e.onThicknessSliderChanged,u=e.disabled,f=void 0!==u&&u,p=e.styles,m=a.cssThicknesses.length-1,_=Object(o.useMemo)(function(){return Jv(i,a)},[i,a]),h=Object(o.useContext)(Le).localizeNumber,b=Xv(a);function g(e){return b(e).toString()}var v=Object(gc.e)(),y={value:_,maxValue:m,minValue:0,label:c,valueFormatter:g},S=!!(null==p?void 0:p.sliderHeader),D=Object(o.useMemo)(function(){var e,t=Ll(v),n=h2(h2({},t),{valueLabel:{width:"20px",margin:"0",textAlign:"end"},slideBox:Object(cc.U)(t.slideBox,{margin:"0 1em 0 0",padding:"0"}),line:f&&{display:"none"}});return Object(cc.g)(n,null===(e=null==p?void 0:p.getSliderStyles)||void 0===e?void 0:e.call(p,v,_))},[v,f,p,_]),I=h2(h2({},null==p?void 0:p.sliderHeader),{container:h2(h2({},null===(t=null==p?void 0:p.sliderHeader)||void 0===t?void 0:t.container),f&&{opacity:"0.25"}),labelValueHeader:h2(h2({},null===(n=null==p?void 0:p.sliderHeader)||void 0===n?void 0:n.labelValueHeader),f&&{display:"none"})});return s.a.createElement("div",null,S&&s.a.createElement(Hl,{headerProps:y,layout:r,styles:I}),s.a.createElement("div",{title:d,style:null==p?void 0:p.sliderWrapper},s.a.createElement(Al.e,{min:0,max:m,value:_,showValue:!S,styles:D,ariaLabel:d,ariaValueText:function(e){return h(b(e))},onChange:l,valueFormat:g,snapToStep:!0,disabled:f,originFromZero:!0})))}),g2=function(){return g2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},g2.apply(this,arguments)};Object(Cl.n)([{rawString:".container_1eb56737{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.disabled_1eb56737{display:none}.icon_1eb56737{font-size:18px;width:18px;height:18px;line-height:18px;margin:0}.iconLabelButton_1eb56737{min-width:32px;padding:0;border:none;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;display:-webkit-box;display:-ms-flexbox;display:flex;cursor:default}"}]);var v2="icon_1eb56737",y2="iconLabelButton_1eb56737",S2=s.a.memo(function(e){var t=e.styles,n=e.onArrowModeChanged,a=e.activeArrowMode,i=void 0===a?Lr.NoArrow:a,r=e.disabled,c=void 0!==r&&r,d=Object(o.useContext)(xc).localizationStrings,l=Object(gc.e)(),u=function(e){return e===i},f=Object(o.useCallback)(function(e){i!==e&&n(e)},[n,i]),p=Object(o.useMemo)(function(){return Object(cc.T)(function(e){var t=function(e){return{backgroundColor:"transparent",color:e.palette.neutralSecondary,fill:e.palette.neutralSecondary}}(e),n=function(e){return{backgroundColor:e.palette.neutralQuaternary,color:e.palette.black,fill:e.palette.black}}(e);return{root:g2(g2({},t),{height:"32px",width:"32px",margin:"8px"}),label:{display:"none"},rootFocused:g2({},t),rootPressed:{backgroundColor:e.palette.neutralLighter},rootChecked:g2({},n),rootHovered:g2({},t),rootCheckedHovered:g2({},n),rootCheckedPressed:g2(g2({},t),{backgroundColor:e.palette.neutralLighter})}}(l),null==t?void 0:t.iconLabelButton)},[null==t?void 0:t.iconLabelButton,l]),m=Object(o.useMemo)(function(){return Object(cc.T)(null==t?void 0:t.icon,c&&{root:{color:l.palette.neutralQuaternary}})},[c,l,null==t?void 0:t.icon]);return s.a.createElement("div",{className:c?"disabled_1eb56737":"container_1eb56737",style:null==t?void 0:t.container,role:"list"},s.a.createElement(vh.e,{iconProps:{iconName:"blocked",styles:m,className:v2},styles:p,onClick:function(){return f(Lr.NoArrow)},checked:u(Lr.NoArrow),text:d.markup_noArrowButtonText,className:y2,title:d.markup_noArrowButtonTooltip,ariaLabel:d.markup_noArrowButtonAriaLabel,disabled:c,role:"option"}),s.a.createElement(vh.e,{iconProps:{iconName:"ArrowTallUpRight",styles:m,className:v2},styles:p,onClick:function(){return f(Lr.SingleArrow)},checked:u(Lr.SingleArrow),text:d.markup_singleArrowButtonText,className:y2,title:d.markup_singleArrowButtonTooltip,ariaLabel:d.markup_singleArrowButtonAriaLabel,disabled:c,role:"option"}),s.a.createElement(vh.e,{iconProps:{iconName:"ArrowMaximize-Havana",styles:m,className:v2},styles:p,onClick:function(){return f(Lr.DoubleArrow)},checked:u(Lr.DoubleArrow),text:d.markup_doubleArrowButtonText,className:y2,title:d.markup_doubleArrowButtonTooltip,ariaLabel:d.markup_doubleArrowButtonAriaLabel,disabled:c,role:"option"}))}),D2=function(){return D2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},D2.apply(this,arguments)},I2=Object(o.memo)(function(e){var t,n=e.styles,a=e.colorOptions,i=e.inkBrush,r=i.thicknessInCssPixels,c=i.htmlColor,d=i.inkType,l=i.arrowMode,u=e.inkBrushIdForInkStyleChange,f=e.inkConfiguration,p=e.colorPickerGridCellButtonIdPrefix,m=e.colorPickerMaxColumnCount,_=e.doNotContainColorPickerWithinFocusZone,h=e.disabled,b=void 0!==h&&h,g=e.setInkBrush,v=e.isArrowModePickerDisabled,y=void 0!==v&&v,S=Object(gc.e)(),D=Object(Tl.e)(S),I=Object(o.useRef)(null),x=Object(o.useRef)(null),C=Object(o.useRef)(null),O=Object(cc.U)(null===(t=null==n?void 0:n.inkColorPickerStyles)||void 0===t?void 0:t.container),w=Object(o.useContext)(xc),E=w.localizationStrings,A=w.enableArrowhead,L=Object(o.useCallback)(function(e,t,n,a){var i,r,o,s,c,d={inkBrush:{thicknessInCssPixels:(i=e,r=f,o=r.cssThicknesses,s=o[i],c=o[Math.round(o.length/2)],-1===s?c:s),htmlColor:t,inkType:n,arrowMode:a},id:u};g(d)},[f,u,g]),k=Object(o.useCallback)(function(e){L(e,c,d,l)},[c,d,L,l]),M=Object(o.useCallback)(function(e){L(Jv(r,f),e,d,l)},[f,d,r,L,l]),P=Object(o.useCallback)(function(e){L(Jv(r,f),c,d,e)},[r,c,d,L,f]),T=Object(o.useMemo)(function(){var e;return Object(cc.U)(function(e){return{padding:"0 16px",minHeight:"170px",height:e?"auto":"217px",display:"inline-flex",flexDirection:"column",justifyContent:"space-evenly",boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)"}}(y),null===(e=null==n?void 0:n.getContentWrapperStyle)||void 0===e?void 0:e.call(n,y))},[n,y]),U=function(e,t,n){var a,i;e.preventDefault(),e.shiftKey?null===(a=null==t?void 0:t.current)||void 0===a||a.focus():null===(i=null==n?void 0:n.current)||void 0===i||i.focus()};return s.a.createElement("div",{className:"inkStylePicker_96c52854",style:D2({backgroundColor:S.palette.neutralLight},null==n?void 0:n.containerStyles),"data-test-id":"ink-style-picker"},s.a.createElement("div",{className:T},s.a.createElement(j3,{thickness:Jv(r,f)+1,inkBrushHtmlColor:b?S.palette.white:c,inkBrushInkType:d,flipHorizontally:D,disabled:b}),s.a.createElement(a3.e,{componentRef:C,onKeyDown:function(e){"Tab"===e.key&&U(e,I,x)}},s.a.createElement(b2,{inkConfiguration:f,inkBrushThicknessInCssPixels:r,layout:"Labeled",headerName:E.markup_inkThicknessSliderHeaderLabel,ariaLabel:x2(d,E),onThicknessSliderChanged:k,styles:null==n?void 0:n.sliderStyles,disabled:b})),s.a.createElement(a3.e,{componentRef:x,onKeyDown:function(e){"Tab"===e.key&&U(e,C,I)},direction:i3.e.domOrder,isCircularNavigation:!0,className:O},s.a.createElement(_2,{colorPickerGridCellButtonIdPrefix:p,styles:null==n?void 0:n.inkColorPickerStyles,colorTableAriaLabel:E.markup_colorTableAriaLabel,doNotContainWithinFocusZone:_,colorOptions:a,selectedHTMLColor:c,maxColumnCount:m,setSelectedHtmlColor:M,disabled:b})),A&&s.a.createElement(a3.e,{componentRef:I,onKeyDown:function(e){"Tab"===e.key&&U(e,x,C)},direction:i3.e.domOrder,isCircularNavigation:!0},s.a.createElement(S2,{styles:null==n?void 0:n.arrowModePickerStyles,onArrowModeChanged:P,activeArrowMode:l,disabled:b||y}))))});function x2(e,t){switch(e){case kr.Highlighter:return t.markup_inkHighlighterThicknessSliderAriaLabel;case kr.Pen:return t.markup_inkPenThicknessSliderAriaLabel;default:throw new ec(e)}}var C2=Object(o.memo)(function(e){var t=e.onCloseMenu,n=e.directionalHint,a=e.elementIdForContextMenuPosition,i=e.openTriggerContainerId,r=e.hostId,c=e.inkBrush,d=e.inkBrushIdForInkStyleChange,l=e.localizationStrings,u=e.inkConfiguration,f=e.isStylePickerDisabled,p=void 0!==f&&f,m=e.styles,_=e.showGapBetweenToolbarAndStylePicker,h=void 0!==_&&_,b=e.colorPickerMaxColumnCount,g=e.setInkBrush,v=e.isArrowModePickerDisabled,y=Object(ic.e)(d+"ContextualMenu"),S=Object(ic.e)("buttonGridCell"),D={style:{backgroundColor:"transparent",width:"auto",minWidth:"initial"},direction:i3.e.bidirectional,isCircularNavigation:!0},I=h?8:0,x=s.a.createElement(I2,{colorPickerGridCellButtonIdPrefix:S,doNotContainColorPickerWithinFocusZone:!0,styles:m,colorOptions:Yv(l),colorPickerMaxColumnCount:b,inkConfiguration:u,inkBrush:c,inkBrushIdForInkStyleChange:d,setInkBrush:g,key:d,disabled:p,isArrowModePickerDisabled:v}),C=[{key:"MenuComponent-"+a,onRender:function(){return x}}];return Object(o.useEffect)(function(){var e=!0,n=function(e){var n,r=document.getElementById(a),o=document.getElementById(y);i&&(n=document.getElementById(i));var s=null==r?void 0:r.contains(e.target),c=!(null==o?void 0:o.contains(e.target)),d=null==n?void 0:n.contains(e.target);s||!c||d||t()},r=function(e){var n,r;"Escape"===e.key&&(i?null===(n=document.getElementById(i))||void 0===n||n.focus():null===(r=document.getElementById(a))||void 0===r||r.focus(),t())},o=function(){t()};return window.addEventListener("pointerdown",n,e),window.addEventListener("keydown",r,e),window.addEventListener("resize",o,e),function(){window.removeEventListener("pointerdown",n,e),window.removeEventListener("keydown",r,e),window.removeEventListener("resize",o,e)}},[y,a,t,S,i]),s.a.createElement(P3.e,{directionalHint:n,calloutProps:{styles:null==m?void 0:m.callout,layerProps:{hostId:r}},focusZoneProps:D,gapSpace:I,id:y,items:C,target:"#"+a,isBeakVisible:!1,useTargetAsMinWidth:!0,shouldFocusOnMount:!0,alignTargetEdge:!0})});function O2(e,t){return!e||"Highlighter"===t}var w2=function(){return w2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},w2.apply(this,arguments)},E2={Left:n3.e.rightTopEdge,Right:n3.e.leftTopEdge,Bottom:n3.e.topCenter},A2={Left:4,Right:4,Bottom:8},L2=Object(o.memo)(function(e){var t,n=e.inkBrushes,a=e.activeInkBrushId,i=e.inkToolbarStyles,r=e.activeMarkupToolType,c=e.enableClearAllInk,d=e.clearAllInkConfirmationDialogHostId,l=e.clearAllInkConfirmationDialogType,u=e.showGapBetweenToolbarAndStylePicker,f=void 0!==u&&u,p=e.showStylePickerInFullWidth,m=void 0===p||p,_=e.showInkStylePicker,h=e.stylePickerHostId,b=e.stylePickerPopUpPositionSource,g=void 0===b?"SelectedInkBrushButton":b,v=e.clearAllInkContent,y=e.setAriaAnnouncement,S=e.setActiveMarkupInkBrushId,D=e.setActiveMarkupToolType,I=e.setInkBrush,x=e.setShowInkStylePicker,C=e.colorPickerMaxColumnCount,O=Object(gc.e)(),w=Object(o.useContext)(xc),E=w.localizationStrings,A=w.inkBrushConfigurations,k=w.inkConfigurations,M=w.getInkToolbarPosition,P=w.enableArrowhead,T=M(i),U=Object(o.useState)(),F=U[0],H=U[1],R=n[a],N=Object(ic.e)("inkStylePickerContainer"),B=Object(ic.e)("buttonsContainer"),j=Object(ic.e)("outerContainer"),V=Object(o.useState)(N),z=V[0],G=V[1],K=Object(o.useCallback)(function(e,t){H(e),t&&x(!_),G(m?N:{InkToolbarContainer:j,SelectedInkBrushButton:e}[g])},[j,m,x,_,N,g]),W=Object(o.useCallback)(function(){x(!1)},[x]),q=Object(o.useCallback)(function(){x(!1)},[x]);Object(o.useLayoutEffect)(function(){var e,t=null===(e=document.getElementById(B))||void 0===e?void 0:e.querySelector('button[aria-checked="true"]');H(null==t?void 0:t.id)},[B]);var Q,Y=m?{containerStyles:{display:"flex",justifyContent:" center",width:"100%",backgroundColor:"transparent"},callout:{root:{width:"100%",borderRadius:"8px",borderBottom:"1px solid "+O.palette.neutralLight},calloutMain:{borderRadius:"12px 12px 0 0"}}}:{callout:{root:{backgroundColor:"transparent",borderRadius:"8px"},calloutMain:{backgroundColor:"transparent"}}},J=w2(w2({},null==i?void 0:i.inkStylePicker),{callout:Object(L.e)(w2({},Y.callout),w2({},null==i?void 0:i.contextualMenuCallout)),containerStyles:Object(L.e)(w2({},Y.containerStyles),w2({},null===(t=null==i?void 0:i.inkStylePicker)||void 0===t?void 0:t.containerStyles))}),X=C||A2[T];return s.a.createElement("div",{className:"toolbar_2bbb1096",style:w2({backgroundColor:O.palette.neutralLight},null==i?void 0:i.container),"aria-label":E.markup_inkToolbarAriaLandmark,role:"region",id:j},s.a.createElement(a3.e,{direction:i3.e.domOrder,isCircularNavigation:!0,role:"toolbar",className:"focusZone_2bbb1096"},_&&s.a.createElement(hh.e,{id:N},s.a.createElement(C2,{inkBrush:n[a],elementIdForContextMenuPosition:z,inkBrushIdForInkStyleChange:a,directionalHint:E2[T],localizationStrings:E,inkConfiguration:k[R.inkType],onCloseMenu:q,setInkBrush:I,showGapBetweenToolbarAndStylePicker:f,styles:J,openTriggerContainerId:F,hostId:h,isStylePickerDisabled:(Q=r,!Object.keys(kr).includes(Q)),colorPickerMaxColumnCount:X,isArrowModePickerDisabled:O2(P,r)})),s.a.createElement(hh.e,{horizontal:!0,id:B,style:null==i?void 0:i.inkToolsContainer},s.a.createElement(C3,{inkBrushes:n,activeMarkupToolType:r,activeInkBrushId:a,setActiveMarkupInkBrushId:S,setActiveMarkupToolType:D,setInkBrush:I,inkToolbarToolsStyles:null==i?void 0:i.inkToolbarTools,inkToolbarButtonStyles:null==i?void 0:i.inkToolbarButton,iconSize:null==i?void 0:i.inkToolbarIconSize,inkBrushConfigurations:A,onBrushClick:K,showTooltip:!m,inkToolbarArrowIconStyle:null==i?void 0:i.inkToolbarArrowIconStyle}),s.a.createElement(l3,{inkToolbarToolsStyles:null==i?void 0:i.inkToolbarTools,activeMarkupToolType:r,setActiveMarkupToolType:D,onClick:W,getIcon:A.eraser.getIcon,inkToolbarButtonStyles:null==i?void 0:i.inkToolbarButton,iconSize:null==i?void 0:i.inkToolbarIconSize,showTooltip:!m}),s.a.createElement(M3,{styles:null==i?void 0:i.clearAllInk,enableClearAllInk:c,clearAllInkContent:v,setAriaAnnouncement:y,confirmationDialogType:l,getIcon:A.clearInk.getIcon,showTooltip:!m,confirmationDialogHostId:d}))))}),k2=function(){return k2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},k2.apply(this,arguments)},M2=Object(o.memo)(function(e){var t=e.inkToolbarStyles;return s.a.createElement(su,{style:k2({borderRadius:"8px",padding:"0",bottom:"0",left:"50%"},null==t?void 0:t.canvasContainer),visible:!0},s.a.createElement(L2,k2({},e)))}),P2=Vt([Od],function(e){return e.some(function(e){return e.contentType===Ss.InkContent})}),T2={setActiveMarkupInkBrushId:po,setActiveMarkupToolType:Bs,setInkBrush:Ns,setShowInkStylePicker:mo,clearAllInkContent:Ks,setAriaAnnouncement:Cs},U2=Object(R.connect)(function(e){return{activeMarkupToolType:e.markup.activeMarkupToolType,enableClearAllInk:P2({markup:e.markup}),showInkStylePicker:e.uiState.showInkStylePicker}},T2)(M2),F2=Object(o.memo)(function(e){var t=e.inkBrushes,n=e.activeInkBrushId,a=e.showGapBetweenToolbarAndStylePicker,i=e.showStylePickerInFullWidth,r=e.dialogType,o=e.styles,c=e.stylePickerPopUpPositionSource,d=Wv(t,n);return s.a.createElement(s.a.Fragment,null,s.a.createElement(U2,{inkToolbarStyles:o,inkBrushes:t,activeInkBrushId:n,showGapBetweenToolbarAndStylePicker:a,showStylePickerInFullWidth:i,clearAllInkConfirmationDialogType:r,stylePickerPopUpPositionSource:c}),s.a.createElement(t3,{inkBrush:d.inkBrush}))}),H2=Object(R.connect)(function(e){return{inkBrushes:e.markup.inkBrushes,activeInkBrushId:e.uiState.activeInkBrushId}})(F2),R2=function(){return R2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},R2.apply(this,arguments)},N2=Object(o.memo)(function(e){var t,n,a=e.markupContentItems,i=e.setAriaAnnouncement,r=e.removeMarkupContent,c=e.setShouldUpdateImageOverlay,d=e.disabled,l=Object(o.useContext)(xc).Canvas,u=a.length>0;t=!d,n=Object(o.useContext)(zc).setImageOverlay,Object(o.useEffect)(function(){t&&n(null)},[t,n]),function(e,t,n){Object(o.useEffect)(function(){n&&e(t)},[n,t,e])}(c,u,!d);var f=function(e,t,n){var a=Object(o.useRef)(e),i=Object(o.useContext)(xc).localizationStrings,r=Object(o.useCallback)(function(e){var r,o,s,c=(r=i,o=e.length,s=a.current.length,nu(r.markup_removedInkStrokesAriaLive,o.toString(),s.toString()));t(e),n(c)},[i,a,t,n]);return a.current=e,r}(a,r,i);return d?null:s.a.createElement(l,R2({},e,{removeMarkupContent:f}))}),B2=window.btoa("<svg width='48' height='47' viewBox='0 0 48 47' fill='none' xmlns='http://www.w3.org/2000/svg'>\n<g filter='url(#filter0_dd)'>\n  <circle cx='24' cy='20' r='16' fill='white' fill-opacity='0.8'/>\n</g>\n<defs>\n  <filter id='filter0_dd' x='0.8' y='2.38419e-07' width='46.4' height='46.4' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'>\n    <feFlood flood-opacity='0' result='BackgroundImageFix'/>\n    <feColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0'/>\n    <feOffset dy='3.2'/>\n    <feGaussianBlur stdDeviation='3.6'/>\n    <feColorMatrix type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.13 0'/>\n    <feBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow'/>\n    <feColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0'/>\n    <feOffset dy='0.6'/>\n    <feGaussianBlur stdDeviation='0.9'/>\n    <feColorMatrix type='matrix' values='0 \n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0'/>\n    <feBlend mode='normal' in2='effect1_dropShadow' result='effect2_dropShadow'/>\n    <feBlend mode='normal' in='SourceGraphic' in2='effect2_dropShadow' result='shape'/>\n  </filter>\n</defs>\n</svg>"),j2=Vt([function(e){return e.activeMarkupToolType},function(e,t){return e.inkBrushes},function(e,t){return t}],function(e,t,a){var i=Wv(t,a).inkBrush,r=i.thicknessInCssPixels,o=i.htmlColor,s=i.arrowMode,c=n(3803),d=n(3804);switch(e){case"Pen":return function(e,t,n){var a=t<12?3:2,i=Math.max(t/2+a,4);return"url(data:image/svg+xml;base64,"+window.btoa(function(e,t,n,a){var i=Math.max(1.5,Math.ceil(.2*t)),r=2*t+30;return"\n    <svg\n      height='"+r+"'\n      width='"+r+"'\n      xmlns='http://www.w3.org/2000/svg'\n      viewBox='0 0 "+r+" "+r+"'\n    >\n      <circle\n        cx='50%'\n        cy='50%'\n        r='"+t+"'\n        stroke='white'\n        stroke-width='"+i+"'\n        fill='"+e+"'\n        shape-rendering='geometricPrecision'\n      />\n      '"+function(e,t,n,a,i){var r=e/2+n+t+1,o=e/2;switch(i){case Lr.NoArrow:return;case Lr.SingleArrow:return function(e,t){return"\n    <svg x='"+e+"' y='"+t+'\' width="9" height="9" viewBox="0 0 9 9" fill="black" xmlns="http://www.w3.org/2000/svg">\n      <path d="M6.648 4.803V3.27614L4.4554 5.46867L2.60123 7.32314L2.25744 7.66661C1.48119 8.5 0.481196 7.5 1.31463 6.7238L5.70515 2.33333H4.14777C3.77958 2.33333 3.4811 2.03486 3.4811 1.66667C3.4811 1.29848 3.77958 1 4.14777 1H7.2257C7.2412 1 7.2565 1.00046 7.2717 1.00138C7.4563 0.989535 7.6449 1.05416 7.786 1.19526C7.9271 1.33636 7.9918 1.52497 7.9799 1.70959C7.9808 1.7248 7.9813 1.74012 7.9813 1.75556V4.803C7.9813 5.17119 7.6828 5.46967 7.3146 5.46967C6.9464 5.46967 6.648 5.17119 6.648 4.803Z" fill="black"/>\n      <path d="M2.61668 8.01447L2.95461 7.67687L4.80895 5.82223L4.81034 5.82084L6.148 4.48324V4.803C6.148 5.44733 6.6703 5.96967 7.3146 5.96967C7.959 5.96967 8.4813 5.44733 8.4813 4.803V1.75556C8.4813 1.74038 8.481 1.72526 8.4805 1.71018C8.4921 1.3982 8.3785 1.08066 8.1396 0.841709C7.9006 0.602758 7.5831 0.489234 7.2711 0.500811C7.256 0.500271 7.2409 0.5 7.2257 0.5H4.14777C3.50344 0.5 2.9811 1.02233 2.9811 1.66667C2.9811 2.311 3.50344 2.83333 4.14777 2.83333H4.49803L0.966869 6.36445C0.685479 6.62925 0.522129 6.9496 0.502069 7.28601C0.482019 7.62218 0.608909 7.93241 0.828849 8.15235C1.04879 8.3723 1.35902 8.49919 1.69519 8.47915C2.03157 8.4591 2.35189 8.29579 2.61668 8.01447Z" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>\n    </svg>'}(r,o);case Lr.DoubleArrow:return function(e,t){return"\n    <svg x='"+e+"' y='"+t+'\' width="10" height="10" viewBox="0 0 10 10" fill="black" xmlns="http://www.w3.org/2000/svg">\n      <path d="M4.4835 7.16661L5.82698 5.8229L5.82702 5.82287L5.82972 5.82017L7.1667 4.48324V4.803C7.1667 5.44733 7.689 5.96966 8.3333 5.96966C8.9777 5.96966 9.5 5.44733 9.5 4.803V1.75555C9.5 1.74038 9.4997 1.72526 9.4992 1.71018C9.5108 1.3982 9.3972 1.08066 9.1583 0.841709C8.9193 0.602756 8.6018 0.489233 8.2898 0.50081C8.2747 0.500271 8.2596 0.5 8.2444 0.5H5.16647C4.52214 0.5 3.99981 1.02233 3.99981 1.66667C3.99981 2.311 4.52214 2.83333 5.16647 2.83333H5.51674L2.83333 5.5167V5.15776C2.83333 4.51343 2.311 3.9911 1.66667 3.9911C1.02234 3.9911 0.5 4.51343 0.5 5.15776V8.24438C0.5 8.25955 0.50027 8.27468 0.50081 8.28975C0.48923 8.60174 0.60276 8.91928 0.84171 9.15823C1.08066 9.39718 1.3982 9.51071 1.71019 9.49913C1.72527 9.49967 1.74039 9.49994 1.75556 9.49994H4.8219C5.46623 9.49994 5.98857 8.9776 5.98857 8.33327C5.98857 7.68894 5.46623 7.16661 4.8219 7.16661H4.4835Z" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>\n    </svg>'}(r,o)}}(r,i,t,0,a)+"'\n      </svg>"}(e,i,0,n))+") "+(i+15)+" "+(i+15)}(o,r,s)+", url("+c.default+"), crosshair";case"Highlighter":return function(e,t){var n=Math.max(10,t),a=n/2,i=n/5;return"url(data:image/svg+xml;base64,"+window.btoa(function(e,t){var n=t/2;return"<svg\n      height='"+t+"'\n      width='"+n+"'\n      xmlns='http://www.w3.org/2000/svg'\n      viewBox='0 0 "+n+" "+t+"'\n    >\n      <rect\n        height='"+t+"'\n        width='"+n+"'\n        cx='50%'\n        cy='50%'\n        stroke='white'\n        stroke-width='"+Math.min(.1*t,1.5)+"'\n        fill='"+e+"'\n      />\n    </svg>"}(e,n))+") "+(a-i)+" "+a}(o,r)+", url("+c.default+"), crosshair";case"Eraser":return"url(data:image/svg+xml;base64,"+B2+") 24 20, url("+d.default+"), default";default:throw new ec(e)}}),V2={removeMarkupContent:Gs,setActiveMarkupToolType:Bs,setAriaAnnouncement:Cs,setShouldUpdateImageOverlay:co},z2=Object(R.connect)(function(e){var t=e.transformTools,n=t.view,a=n.viewportPixelSize,i=n.viewportCssSize,r=t.image.originalPixelSize,o=t.device.pixelRatio;return{cropViewTransform:Pm(e.transformTools),imageViewTransform:F_(e.transformTools),originalImagePixelSize:r,cssToPhysicalPixelRatio:o,width:a.x,height:a.y,cssWidth:i.width,cssHeight:i.height,markupContentItems:e.markup.markupContentItems,shouldSetMarkupOverlayWithFinalContent:""!==e.uiState.nextEditorActivity&&e.uiState.activeEditorActivity===di,activeMarkupToolType:e.markup.activeMarkupToolType,cursor:j2(e.markup,e.uiState.activeInkBrushId),hidden:e.uiState.activeEditorActivity!==di,disabled:e.uiState.activeEditorActivity!==di&&(0===e.markup.markupContentItems.length||!e.uiState.waitingForMarkupOverlayTexture)}},V2)(N2),G2=Object(o.memo)(function(e){var t=e.showGapBetweenToolbarAndStylePicker,n=void 0!==t&&t,a=e.showStylePickerInFullWidth,i=void 0!==a&&a,r=e.dialogType,c=e.stylePickerPopUpPositionSource,d=Object(o.useContext)(G1).enableMarkup,l=Object(o.useContext)(xc),u=l.inkToolbarStyles,f=(0,l.getInkToolbarPosition)(u);return d?s.a.createElement(s.a.Fragment,null,s.a.createElement(z2,null),s.a.createElement(lh,{match:di},s.a.createElement(H2,{key:f+"InkConnect",styles:u,showGapBetweenToolbarAndStylePicker:n,showStylePickerInFullWidth:i,dialogType:r,stylePickerPopUpPositionSource:c}))):null}),K2={defName:$u,levelUniformName:Ku,mapNormalizedToShaderValue:function(e){return e}},W2=function(){return W2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},W2.apply(this,arguments)},q2=Object(R.connect)(function(e){var t=e.autoEnhance,n=t.autoEnhanceLevel,a=t.autoEnhanceStatus;return{alpha:f1(W2(W2({},e.transformTools),e.uiState))||"on"!==a?0:n}})(function(e){var t=e.alpha,n=void 0===t?0:t;return Object(o.useContext)(Pu).textures.blend||(n=0),w0(K2,n),null}),Q2={defName:ef,levelUniformName:qu,mapNormalizedToShaderValue:function(e){return e}},Y2=function(e){var t=e.alpha,n=void 0===t?1:t;return Object(o.useContext)(Pu).textures.overlay||(n=0),w0(Q2,n),null},J2=Object(o.memo)(function(e){var t=e.disable,n=Object(o.useContext)(zc).image,a=!t&&Rc(n)&&n.overlay?1:0;return s.a.createElement(Y2,{alpha:a})}),X2=function(){return X2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},X2.apply(this,arguments)},Z2=Object(R.connect)(function(e){var t=f1(X2(X2({},e.transformTools),e.uiState)),n=e.uiState,a=n.waitingForActiveEditorActivityToComplete,i=n.activeEditorActivity;return{disable:t||a&&i===di}})(J2),$2=function(){return $2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},$2.apply(this,arguments)},ey=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},ty=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},ny=function(e,t){e.width=t.x,e.height=t.y};function ay(e,t,n,a){n(),iy(e,t),a.renderNow()}var iy=function(e,t){e.width=t.x,e.height=t.y};function ry(e,t,n,a){return ey(this,void 0,void 0,function(){var i,r,o,s,c;return ty(this,function(d){switch(d.label){case 0:return i=[null,function(){}],n&&e?(o=function(){},s=new Promise(function(e){return o=e}),c=function(e){r=e,o()},n.getTexture(e,c,t,!0,a),[4,s]):[3,2];case 1:d.sent(),r&&r.texture&&(i=[r.texture,function(){r&&n.releaseTexture(r.id)}]),d.label=2;case 2:return[2,i]}})})}function oy(e,t,n){return ey(this,void 0,void 0,function(){var a,i,r,o,s,c,d,l,u,f,p,m;return ty(this,function(_){switch(_.label){case 0:return a={main:null,blend:null,overlay:null},i=[],(r=Nc(e)).main?[4,ry(r.main,_f.main,t,n)]:[3,2];case 1:o=_.sent(),s=o[0],c=o[1],s&&(a.main=s,i.push(c)),_.label=2;case 2:return r.blend?[4,ry(r.blend,_f.blend,t,n)]:[3,4];case 3:d=_.sent(),l=d[0],u=d[1],l&&(a.blend=l,i.push(u)),_.label=4;case 4:return r.overlay?[4,ry(r.overlay,_f.overlay,t,n)]:[3,6];case 5:f=_.sent(),p=f[0],m=f[1],p&&(a.overlay=p,i.push(m)),_.label=6;case 6:return[2,[a,function(){i.forEach(function(e){return e()})}]]}})})}function sy(e){return function(e,t,n,a){return new(n||(n=Promise))(function(t,i){function r(e){try{s(a.next(e))}catch(e){i(e)}}function o(e){try{s(a.throw(e))}catch(e){i(e)}}function s(e){var a;e.done?t(e.value):(a=e.value,a instanceof n?a:new n(function(e){e(a)})).then(r,o)}s((a=a.apply(e,[])).next())})}(this,0,void 0,function(){var t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(I){switch(I.label){case 0:return t=e.image,n=e.renderList,a=e.canvas,i=e.renderImage,r=e.textures,o=e.customEdits,s=e.errorCallback,c=e.engine,d=e.waitForRenderingToBeReady,l=e.setEffectLevels,u=e.restoreOverlayCanvas,f=e.cropTransformValues,p=e.imageTransformValues,[4,oy(t,r,s)];case 1:return m=I.sent(),_=m[0],h=m[1],null==u||u(),a&&(null==_?void 0:_.main)?(o&&(f=Ea(o.cropRectangle),p=Cr(o.imageTransform)),[4,d()]):[2,null];case 2:return I.sent(),b={x:a.width,y:a.height},g=Aa(f),ny(a,{x:g.width,y:g.height}),c&&(v=function(e,t,n,a){var i=n.getRenderWidth(),r=n.getRenderHeight(),o=Aa(e),s=o.width,c=o.height;kc(s)&&kc(c)||a({id:"InvalidInput",message:"Expected integer input values for getTransformsToFitOutputImageInCanvas(). Received cropRectangle values of (width: "+s+", height: "+c+")."});var d=Math.min(i/s,r/c);return d<1?(a({id:"ImageTooBig",message:"Output image was resized because it exceeds max canvas drawing buffer size (width: "+i+", height: "+r+"), use getEditedImageBytes to get the full image data"}),{scaledCropTransform:Vn(Cn(d),e),scaledImageTransform:Vn(Cn(d),t)}):void 0}(f,p,c,s),v&&(f=v.scaledCropTransform,p=v.scaledImageTransform,g=Aa(f),ny(a,{x:g.width,y:g.height}))),y=Vn(wn(-g.left,-g.top),p),S=Vn(wn(-g.left,-g.top),f),i(y,_,S,l),D=function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");return null==n||n.drawImage(e,0,0),t}(a),ay(a,b,h,n),D||s({id:"CreateEditedImageFailed",message:"Could not create edited image in HTMLCanvasElement format."}),[2,D]}})})}function cy(e){return function(e,t,n,a){return new(n||(n=Promise))(function(t,i){function r(e){try{s(a.next(e))}catch(e){i(e)}}function o(e){try{s(a.throw(e))}catch(e){i(e)}}function s(e){var a;e.done?t(e.value):(a=e.value,a instanceof n?a:new n(function(e){e(a)})).then(r,o)}s((a=a.apply(e,[])).next())})}(this,0,void 0,function(){var t,n,a;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(i){switch(i.label){case 0:return t=e.getRenderWidth(),n=e.getRenderHeight(),[4,e.readPixels(0,0,t,n,!0)];case 1:return a=i.sent(),[2,Uc(t,n,Mc.RGBA,new Uint8Array(a.buffer))]}})})}var dy=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},ly=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};function uy(e){return dy(this,void 0,void 0,function(){var t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D=this;return ly(this,function(I){switch(I.label){case 0:return t=e.image,n=e.renderList,a=e.canvas,i=e.renderImage,r=e.textures,o=e.customEdits,s=e.errorCallback,c=e.engine,d=e.waitForRenderingToBeReady,l=e.setEffectLevels,u=e.restoreOverlayCanvas,f=e.cropTransformValues,p=e.imageTransformValues,[4,oy(t,r,s)];case 1:return m=I.sent(),_=m[0],h=m[1],null==u||u(),a&&(null==_?void 0:_.main)&&c?(o&&(f=Ea(o.cropRectangle),p=Cr(o.imageTransform)),[4,d()]):[2,null];case 2:I.sent(),b={x:a.width,y:a.height},g=function(e,t){return pi(Dn(e),xn,Ma(t).y)}(p,f),v=Aa(f),y=I_(v,2048),S=Uc(v.width,v.height,Mc.RGBA);try{return y.forEach(function(e){return dy(D,void 0,void 0,function(){var t,n,r,o,s;return ly(this,function(d){switch(d.label){case 0:return ny(a,{x:e.width,y:e.height}),t=wn(-e.left,-e.top),n=Vn(t,g),r=Vn(t,f),i(n,_,r,l),[4,cy(c)];case 1:if(!(o=d.sent()))throw new Error("Error: Could not create edited image in ImageBytes format.");return u=e,p=-v.top,m=-v.left,(s=ga(ga({},u),{top:u.top+p,left:u.left+m})).top=v.height-s.top-s.height,function(e,t,n){if(!Ia({top:t.y,left:t.x,width:e.width,height:e.height},{top:0,left:0,width:n.width,height:n.height}))throw new RangeError("Src of "+e.width+"x"+e.height+" at ("+t.x+","+t.y+") is not within dst "+n.width+"x"+n.height+" to be copied.");if(!Vc(e.width,e.height,e.format,e.bytes)||!Vc(n.width,n.height,n.format,n.bytes))throw Error("Byte array does not have a valid length.");for(var a=e.bytes,i=n.bytes,r=jc(e.format),o=e.width*r,s=(n.width-e.width)*r,c=0,d=(t.y*n.width+t.x)*r,l=e.bytes.byteLength;c<l;)i.set(a.subarray(c,c+o),d),c+=o,d+=o+s}(o,{x:s.left,y:s.top},S),[2]}var u,p,m})})}),ay(a,b,h,n),[2,S]}catch(e){return s({id:"CreateEditedImageFailed",message:e.message}),ay(a,b,h,n),[2,null]}return[2]}})})}function fy(e,t,n,a){if(void 0===n&&(n={left:0,top:0,width:t.x,height:t.y}),e){var i=e({x:n.width,y:n.height},function(e,t,n){return Vn(wn(-t.left,-t.top),Cn(e.x,e.y),Tn(df(n)))}(t,n,a));return i&&(i.id=As().toString()),null!=i?i:void 0}}function py(e,t){if(!t.getHTMLCanvas)return null;var n=H_(e);return n?{width:n.x,height:n.y,canvasMethods:t,renderCanvas:fy,id:"markupOverlay"+As().toString(),orientation:E_(e)}:null}var my=function(){return my=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},my.apply(this,arguments)},_y=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},hy=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},by=Object(o.forwardRef)(function(e,t){var n=Object(o.useContext)(pf),a=n.canvasContextIsValid,i=n.canvas,r=n.engine,s=n.effectRenderer,c=n.textures;if(!a)throw new SyntaxError("Invalid BabylonCanvasComponentContext.  The BabylonOffscreenImageRenderConnectImpl component must be used within an BabylonCanvas component");var d=Object(o.useContext)(Pu).registry;if(!d)throw new SyntaxError("Invalid ImageEffectContext.  The BabylonOffscreenImageRenderConnect component must be used within an BabylonImage component");var l=nf(d),u=mf(l[0],l[1],l[2],l[3],l[4],l[5]),f=Object(o.useContext)(r1),p=Object(o.useRef)(f);p.current=f;var m=function(){var e,t,n,a,i=Object(o.useContext)(G1).enableFilters,r=Object(o.useContext)(r1),s=r.textures,c=r.urlsById,d=r.loadUrls,l=!i||0!==Object.keys(s).length&&0!==Object.keys(c).length;return e=l,t=l?void 0:d,n=Object(o.useRef)(function(){}),a=Object(o.useState)(function(){return new Promise(function(e){return n.current=e})})[0],Object(o.useEffect)(function(){e&&n.current()},[e]),Object(o.useCallback)(function(){return t&&t(),a},[t,a])}();if(!Ch().getState().transformTools)throw new Error("Invalid redux store in BabylonOffscreenImageRenderConnect, must contain ITransformToolsState");return function(e,t,n,a,i,r){var s=this,c=Object(o.useContext)(_e).logFailedToGetEditedImageEvent,d=Object(o.useContext)(bf).renderList,l=Object(o.useContext)(xc).canvasMethods,u=Object(o.useContext)(zc).image;Object(o.useRef)(u).current=u;var f=Se(),p=Ch(),m=Object(o.useCallback)(function(e,t){if(e){var n=py(e,l);if(n)return my(my({},Nc(e)),{overlay:n})}return Nc(e)},[l]);Object(o.useImperativeHandle)(i,function(){var i={renderList:d,canvas:e,textures:t,renderImage:n,engine:r,waitForRenderingToBeReady:a};return{getEditedImageBytes:function(e,t,n){return _y(s,void 0,void 0,function(){var a,o,s,d,u,_,h,b;return hy(this,function(g){switch(g.label){case 0:return a=null,r?(o=p.getState(),s=o.transformTools,d=s.cropInteraction.uvToWorld,u=s.image,_=u._preciseUvToWorld,h=u.originalPixelSize,b=m(e,h),[4,uy(my(my({},i),{image:b,cropTransformValues:d,imageTransformValues:_,customEdits:t,errorCallback:f,setEffectLevels:n,restoreOverlayCanvas:l.restoreHTMLCanvas}))]):[3,2];case 1:a=g.sent(),g.label=2;case 2:return a||c(),[2,a]}})})},getEditedImage:function(t,n,a){return _y(s,void 0,void 0,function(){var r,o,s,d,u,_,h,b;return hy(this,function(g){switch(g.label){case 0:return r=null,e?(o=p.getState(),s=o.transformTools,d=s.cropInteraction.uvToWorld,u=s.image,_=u._preciseUvToWorld,h=u.originalPixelSize,b=m(t,h),[4,sy(my(my({},i),{image:b,cropTransformValues:d,imageTransformValues:_,customEdits:n,errorCallback:f,setEffectLevels:a,restoreOverlayCanvas:l.restoreHTMLCanvas}))]):[3,2];case 1:r=g.sent(),g.label=2;case 2:return r||c(),[2,r]}})})}}},[d,e,t,n,r,a,p,m,f,l,c])}(i,c,Object(o.useCallback)(function(e,t,n,a){var i,o,c,l=void 0,f=(i=n,o=void 0,(c=d.getEffects().find(function(e){return e.getName()===C1}))&&i&&(o=c.getTransform(),c.setTransform(i)),function(){c&&o&&c.setTransform(o)}),m=wv(d,t.overlay?1:0);a&&(l=a(d,{lutTextures:p.current.textures,lutUrlsById:p.current.urlsById})),uf(e,d,rf,u,t,r,s,!0),l&&l(),f(),m()},[d,u,r,s]),m,t,r),null}),gy=s.a.memo(function(e){e.originalImagePixelSize;var t=e.shouldSetMarkupOverlay,n=e.setWaitingForMarkupOverlayTexture,a=Object(o.useContext)(zc),i=a.image,r=a.setImageOverlay,s=Object(o.useContext)(xc),c=s.canvasMethods,d=s.wetCanvasIsReady,l=s.setCanvasMethods,u=Object(o.useRef)(function(){throw new Error("generateMarkupOverlayImage function is empty")});return Object(o.useEffect)(function(){u.current=function(){if(!(c.getHTMLCanvas&&c.restoreHTMLCanvas&&i))throw new Error("canvasMethods missing in generateMarkupOverlayImage");r(py(i,c))}},[c,i,r]),Object(o.useEffect)(function(){var e=Rc(i)&&i.overlay;t&&!e&&(n(!0),d&&(u.current(),l(Ic)))},[d,i,l,n,t]),null}),vy={setWaitingForMarkupOverlayTexture:so},yy=Object(R.connect)(function(e){var t=e.markup.markupContentItems.length>0,n=e.uiState.activeEditorActivity===di,a=t&&!n&&!!_d(e.transformTools),i=t&&n&&""!==e.uiState.nextEditorActivity;return{originalImagePixelSize:e.transformTools.image.originalPixelSize,shouldSetMarkupOverlay:a||i}},vy)(gy),Sy=Object(o.memo)(Object(o.forwardRef)(function(e,t){var n,a=e.componentSize,i=e.onSave,r=e.onClose,c=e.pivotItems,d=e.onEditsChanged,l=e.onUiStateChanged,u=e.cssToPhysicalPixelRatio,f=e.layout,p=e.animationSpeedMultiplier,m=e.hideCanvas,_=Object(gc.e)(),h=fb(t),b=h.editOperationsRef,g=h.editUiStateRef,v=Object(o.useContext)(zc),y=v.image,S=v.setOffscreenRenderer,D=Object(o.useContext)(G1).enableAutoEnhance,I=Object(o.useContext)(xc),x=I.inkToolbarStyles,C=(0,I.getInkToolbarPosition)(x),O=null===(n=null==x?void 0:x.clearAllInk)||void 0===n?void 0:n.confirmationDialog,w=Object(o.useMemo)(function(){return function(e){var t,n=function(e){switch(e){case"Left":case"Right":return $2($2({},ua(0)),{left:90,right:90});case"Bottom":return $2($2({},ua(0)),{bottom:56});default:throw new ec(e)}}(e);return(t={}).Crop=$2($2({},ua(42)),{bottom:162}),t.Markup=n,t}(C)},[C]);return s.a.createElement("div",{className:"layout_desktop_46fde051"},s.a.createElement("div",{role:"banner"},c.length>1&&s.a.createElement(cb,{componentSize:a,onSave:i,onCancel:r,controlPivot:s.a.createElement(Lu,{pivotItems:c,styles:db(_)}),confirmationDialogStyles:O}),c.length<=1&&s.a.createElement(cb,{componentSize:a,onSave:i,onCancel:r,confirmationDialogStyles:O})),s.a.createElement("div",{className:"content_container_46fde051"},s.a.createElement("div",{className:"canvas_container_46fde051",role:"main"},s.a.createElement(jm,null),s.a.createElement(Bm,null),!m&&s.a.createElement(ch,{canvasSize:a,cssToPhysicalPixelRatio:u},s.a.createElement(U_,{animationSpeedMultiplier:p},s.a.createElement(lh,{match:oi},s.a.createElement(Gm,{handleSizeCss:28,handleHitAreaSizeCss:50}),s.a.createElement(Um,null)),s.a.createElement(V_,{image:y,color:of,zIndex:1},s.a.createElement(fv,null,s.a.createElement(by,{ref:S}),s.a.createElement(rv,null),s.a.createElement(q2,null),s.a.createElement(Z2,null))),s.a.createElement(G2,{showGapBetweenToolbarAndStylePicker:!0,stylePickerPopUpPositionSource:"Bottom"===C?"SelectedInkBrushButton":"InkToolbarContainer"}),s.a.createElement(yy,null))),s.a.createElement(lh,{match:si},s.a.createElement(v0,null),s.a.createElement(ph,null)),s.a.createElement(lh,{match:ci},s.a.createElement(v0,null),s.a.createElement(ph,null)),s.a.createElement(lh,{match:oi},s.a.createElement(y_,null),s.a.createElement(p0,{buttonStyles:{root:{justifyContent:"center"}}}),s.a.createElement(hu,null),s.a.createElement(th,null))),s.a.createElement(lh,{match:si},s.a.createElement(Hv,{theme:_},s.a.createElement(eu,{styles:{adjustmentSlider:{getSliderHeaderStyles:function(e){return{container:{paddingBottom:"2.5px"}}},getSliderStyles:function(e,t){return{container:{marginBottom:"17.5px"}}}}}}))),s.a.createElement(lh,{match:ci},s.a.createElement(Hv,{theme:_},s.a.createElement(Uv,{styles:Nv(f)},D&&s.a.createElement(Kv,null))))),s.a.createElement(q_,{ref:b,onEditsChanged:d}),s.a.createElement(Z_,{ref:g,onUiStateChanged:l}),s.a.createElement(D0,{cssPixelMarginByActivity:w}))}));Object(Cl.n)([{rawString:".aspectRatioContainer_29990fec{margin-bottom:8px}.rotateFlipContainer_29990fec{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}"}]),Object(Cl.n)([{rawString:".aspectRatioContainer_650aab95{margin:0 -16px;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;gap:4px}"}]);var Dy=Object(o.memo)(function(e){var t=e.panelStyle,n=e.aspectRatioConstraint,a=e.setAspectRatioConstraint,i=e.setAriaAnnouncement,r=Object(o.useContext)(Le),c=r.localizeNumber,d=r.strings,l=Xg(a,i,lg(d,c)),u=Object(o.useCallback)(function(e,t){l(t,e)},[l]),f=Object(o.useCallback)(function(e){return e===we.None?t.freeformButton:t.tile},[t]);return s.a.createElement("div",{className:"aspectRatioContainer_650aab95"},e0(pg(),f,lg(d,c),fg,u,mg(n),void 0,void 0,void 0,void 0,_g))});Object(Cl.n)([{rawString:".RotationBarContainer_aefad19a{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:5px}.RotateFlipButtons_aefad19a{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:12px}"}]);var Iy=s.a.memo(function(e){var t=e.panelStyle,n=e.rotationAngle,a=e.rotateCropAndImageBy90,i=e.handleMirrorXClick,r=e.handleMirrorYClick,c=e.setAriaAnnouncement,d=Object(o.useContext)(Le).strings,l=Object(gc.e)(),u=Object(o.useState)(null),f=u[0],p=u[1],m=U3(f,{width:500,height:35}),_=bg(n,a,i,r,c),h=_.handleRotateCropRectAndImageBy90ClockwiseWithTelemetry,b=_.handleRotateCropRectAndImageBy90CounterClockwiseWithTelemetry,g=_.handleMirrorXWithTelemetry,v=_.handleMirrorYWithTelemetry;return s.a.createElement(s.a.Fragment,null,s.a.createElement(Hg,{rotationAngle:n,styles:{container:{height:"16px"}}}),s.a.createElement("div",{className:"RotationBarContainer_aefad19a",ref:p},s.a.createElement(Tg,{styles:Fg(l),layout:Ug,boundingSize:m})),s.a.createElement("div",{className:"RotateFlipButtons_aefad19a"},s.a.createElement(gh.e,{iconProps:{iconName:"Rotate90CounterClockwise",styles:t.icon},title:d.rotate_left90,ariaLabel:d.rotate_left90AriaLabel,onClick:b,styles:t.iconButton}),s.a.createElement(gh.e,{iconProps:{iconName:"Rotate90Clockwise",styles:t.icon},title:d.rotate_right90,ariaLabel:d.rotate_right90AriaLabel,onClick:h,styles:t.iconButton}),s.a.createElement(gh.e,{iconProps:{iconName:"FlipHorizontal-Havana",styles:t.icon},title:d.flip_horizontal,ariaLabel:d.flip_horizontalAriaLabel,onClick:g,styles:t.iconButton}),s.a.createElement(gh.e,{iconProps:{iconName:"FlipVertical-Havana",styles:t.icon},title:d.flip_vertical,ariaLabel:d.flip_verticalAriaLabel,onClick:v,styles:t.iconButton})))}),xy=Object(o.createContext)({type:nc.DuoDouble,hingeStartOffset:0,hingeGap:0,orientation:"Portrait",isOrderInverted:!1}),Cy=Object(o.memo)(function(e){var t=e.size,n=e.styles,a=e.header,i=e.footer,r=e.aspectRatioConstraint,c=e.setAspectRatioConstraint,d=e.rotationAngle,l=e.rotateCropAndImageBy90,u=e.handleMirrorXClick,f=e.handleMirrorYClick,p=e.setAriaAnnouncement,m=Object(o.useContext)(xy),_=Object(gc.e)(),h=Object(o.useMemo)(function(){return function(e,t){return{icon:Bb,iconButton:Nb(t),tile:Pb(e,t),tileButton:Ub(e,t),freeformButton:Tb(e,t)}}(m,_)},[m,_]);return s.a.createElement(wl,{size:t,styles:n,header:a,footer:i},s.a.createElement("div",{className:"aspectRatioContainer_29990fec",style:{marginTop:("Landscape"===m.orientation?16:7)+"px"}},s.a.createElement(Dy,{panelStyle:h,aspectRatioConstraint:r,setAspectRatioConstraint:c,setAriaAnnouncement:p})),s.a.createElement("div",{className:"rotateFlipContainer_29990fec",style:{margin:"0px "+("Landscape"===m.orientation?0:106)+"px"}},s.a.createElement(Iy,{panelStyle:h,rotationAngle:d,rotateCropAndImageBy90:l,handleMirrorXClick:u,handleMirrorYClick:f,setAriaAnnouncement:p})))}),Oy={setAspectRatioConstraint:Wo,rotateCropAndImageBy90:Bo,handleMirrorXClick:Oo,handleMirrorYClick:wo,setAriaAnnouncement:Cs},wy=Object(R.connect)(function(e){return{aspectRatioConstraint:e.transformTools.cropInteraction.aspectRatioConstraint,rotationAngle:vg(e.transformTools)}},Oy)(Cy),Ey=function(e){var t=e.duoLayoutData,n=e.children;return s.a.createElement(xy.Provider,{value:t},n)},Ay=Object(o.memo)(function(e){var t=e.onBack,n=Object(o.useContext)(Le).strings,a=Object(gc.e)(),i=Object(Tl.e)(a),r=wh(t),c=i?"Forward-Havana":"Back-Havana";return s.a.createElement(gh.e,{key:"Cancel",styles:Ob(a),theme:Object(gc.e)(),iconProps:{iconName:c},ariaLabel:n.toolbar_cancelAriaLabel,title:n.toolbar_cancelTooltip,role:"button",onClick:r})}),Ly=function(){return Ly=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ly.apply(this,arguments)},ky=Object(o.memo)(function(e){var t=e.resetDisabled,n=e.isConfirmationDialogVisible,a=e.toggleIsConfirmationDialogVisible,i=e.resetEdits,r=e.setAriaAnnouncement,c=e.resetButtonStyles,d=e.confirmationDialogStyles,l=e.dialogHostId,u=Object(o.useContext)(Le).strings,f=Mh(i,r,u.toolbar_imageResetFinishedAriaLive),p=Object(gc.e)(),m=Object(o.useMemo)(function(){return Object(cc.g)(function(e){var t=Object(Tl.e)(e),n={border:"none",backgroundColor:"transparent"};return{label:vb({},Ib),root:vb(vb(vb({},xb(e)),n),{height:"28px",margin:"14px 8px 14px 16px",marginRight:t?"16px":"8px",color:e.palette.neutralPrimaryAlt,minWidth:"52px",padding:"6px 8px 6px 8px"}),rootPressed:vb(vb({},n),{color:e.palette.neutralTertiary}),rootHovered:vb(vb({},n),{color:e.palette.neutralPrimaryAlt}),rootDisabled:vb(vb({},n),{color:e.palette.neutralQuaternary})}}(p),c)},[p,c]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(vh.e,{key:"Reset","data-test-id":"reset",styles:m,text:u.toolbar_imageReset,ariaLabel:u.toolbar_imageResetAriaLabel,title:u.toolbar_imageResetTooltip,onClick:function(){a()},disabled:t,role:"button",theme:p,allowDisabledFocus:!0}),n&&s.a.createElement(Nh,{isVisible:n,hostId:l,dialogType:Ph.e.normal,styles:d,onConfirm:function(e){f(e),a()},onCancel:function(){a()}}))}),My={resetEdits:Hr,setAriaAnnouncement:Cs,toggleIsConfirmationDialogVisible:_o},Py=Object(R.connect)(function(e){var t=Ly(Ly({},e.transformTools),{colorAdjustments:e.colorAdjustments,filters:e.filters,autoEnhance:e.autoEnhance,markup:e.markup});return{resetDisabled:Ed(t),isConfirmationDialogVisible:e.uiState.isResetEditsConfirmationDialogVisible}},My)(ky),Ty=Object(o.memo)(function(e){var t=e.onSave,n=e.styles,a=Object(o.useContext)(Le).strings,i=$h(t).onSaveOriginal,r=Object(gc.e)(),c=!Object(o.useContext)(Ad).has(nd.SaveAsOriginal),d=Object(o.useMemo)(function(){return Object(cc.g)(function(e){var t=Object(Tl.e)(e);return{label:vb({},Ib),root:vb(vb({},xb(e)),{height:"28px",borderRadius:"160px",minWidth:"63px",marginRight:t?"0px":"4px",marginLeft:t?"4px":"8px",marginBottom:"14px",marginTop:"14px",padding:"6px 16px",border:"none"}),rootHovered:vb({},xb(e)),rootPressed:{color:e.palette.white,border:"none",backgroundColor:e.palette.neutralLighter},rootDisabled:{color:e.palette.neutralQuaternary,backgroundColor:"transparent",border:"none"}}}(r),n)},[r,n]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(vh.e,{text:a.toolbar_imageSave,title:a.toolbar_imageSaveTooltip,styles:d,disabled:c,onClick:i,role:"button",theme:r,allowDisabledFocus:!0}))}),Uy=s.a.memo(function(e){var t=e.onSave,n=e.onBack,a=e.style,i=e.dialogHostId,r=Object(gc.e)();return s.a.createElement(hh.e,{className:"MobileCommandBarStack_e8ecbb5e",horizontal:!0,theme:r},s.a.createElement(hh.e.Item,{grow:!0,className:_h},s.a.createElement(Ay,{onBack:n})),s.a.createElement(hh.e.Item,{grow:!0,className:"MobileCommandBarEndStackItem_e8ecbb5e"},s.a.createElement(Py,{resetButtonStyles:null==a?void 0:a.resetButton,confirmationDialogStyles:null==a?void 0:a.confirmationDialog,dialogHostId:i}),s.a.createElement(Ty,{onSave:t,styles:null==a?void 0:a.saveButton})))});Uy.displayName="MobileEditorCommandBar";var Fy=function(){return Fy=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Fy.apply(this,arguments)};function Hy(e,t,n,a,i){var r=function(e,t,n,a){return{height:t+"px",lineHeight:n+"px",color:e.palette.black,width:"100%",marginInlineEnd:0,fontWeight:"500",borderRadius:"20px",margin:"0px",cursor:"default",fontSize:a+"px"}}(e,t,n,i);return{count:{},icon:{display:"none"},link:Fy(Fy({},r),{"&:hover":{backgroundColor:e.palette.neutralLighterAlt},"&:active":{backgroundColor:e.palette.neutralLighterAlt},"&:after":{height:"0px"}}),linkContent:{},linkIsSelected:Fy(Fy({},r),{backgroundColor:e.palette.neutralQuaternary,"&::before":{display:"none"},"&:hover":{backgroundColor:e.palette.neutralQuaternary,cursor:"default"},"&:active":{backgroundColor:e.palette.neutralQuaternary},"&:after":{height:"0px"}}),root:{display:"flex",justifyContent:"space-evenly",backgroundColor:a,borderRadius:"20px"},text:{marginInlineStart:"0"}}}Object(Cl.n)([{rawString:".layout_duo_21dae3f4{width:100%;height:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:-webkit-box;display:-ms-flexbox;display:flex}.content_container_21dae3f4{display:grid;width:100%;height:calc(100% - 44px);grid-template-columns:1fr auto auto;grid-template-rows:1fr}.canvas_container_21dae3f4{position:relative}"}]);var Ry,Ny=function(){return Ny=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ny.apply(this,arguments)},By=Object(o.memo)(function(e){var t=e.size,n=e.styles,a=e.header,i=e.footer,r=e.inkBrushes,c=e.activeInkBrushId,d=e.dialogHostId,l=e.layoutOrientation,u=Wv(r,c),f=Object(ic.e)("markupActionPane"),p=Object(o.useContext)(xc),m=p.inkToolbarStyles,_=p.enableArrowhead?"Landscape"===l?8:4:void 0;return s.a.createElement(wl,{size:t,styles:n,header:a,footer:i,containerId:f},s.a.createElement(L2,Ny({},e,{inkToolbarStyles:m,stylePickerHostId:f,showInkStylePicker:!0,clearAllInkConfirmationDialogHostId:d,clearAllInkConfirmationDialogType:Ph.e.normal,colorPickerMaxColumnCount:_})),s.a.createElement(t3,{inkBrush:u.inkBrush}))}),jy={setActiveMarkupInkBrushId:po,setActiveMarkupToolType:Bs,setInkBrush:Ns,setShowInkStylePicker:mo,clearAllInkContent:Ks,setAriaAnnouncement:Cs},Vy=Object(R.connect)(function(e){return{inkBrushes:e.markup.inkBrushes,activeInkBrushId:e.uiState.activeInkBrushId,activeMarkupToolType:e.markup.activeMarkupToolType,enableClearAllInk:P2({markup:e.markup}),showInkStylePicker:e.uiState.showInkStylePicker}},jy)(By),zy=((Ry={}).Crop={top:24,bottom:24,left:24,right:24},Ry),Gy=Object(o.memo)(Object(o.forwardRef)(function(e,t){var n,a=e.layout,i=e.componentSize,r=e.onSave,c=e.onClose,d=e.pivotItems,l=e.onEditsChanged,u=e.onUiStateChanged,f=e.cssToPhysicalPixelRatio,p=e.animationSpeedMultiplier,m=Object(ic.e)("canvasContainerId"),_=Object(gc.e)(),h=fb(t),b=h.editOperationsRef,g=h.editUiStateRef,v=Object(o.useContext)(zc),y=v.image,S=v.setOffscreenRenderer,D=Object(o.useContext)(xc).inkToolbarStyles,I=null===(n=null==D?void 0:D.clearAllInk)||void 0===n?void 0:n.confirmationDialog,x=a,C=Object(o.useMemo)(function(){if(a){var e=s.a.createElement(Uy,{onSave:r,onBack:c,style:{saveButton:jb,resetButton:Vb,confirmationDialog:I},dialogHostId:m}),t=s.a.createElement(Lu,{pivotItems:d,styles:Hy(_,40,24,"transparent",16)}),n=function(e,t){var n,a,i,r,o=e.hingeStartOffset,s=e.orientation,c=e.hingeGap,d=e.isOrderInverted,l="Landscape"===s,u=l?"width":"height",f=l?"height":"width",p=Math.floor(o),m=Math.floor(t[u]-p-c),_=l?"row":"column";return d&&(p=(n=[m,p])[0],m=n[1],_=l?"row-reverse":"column-reverse"),{mainContainerStyle:{flexDirection:_},canvasContainerStyle:(a={},a[u]=p+"px",a[f]="100%",a.flexShrink=0,a.flexBasis="auto",a.position="relative",a),hingeStyle:(i={},i[l?"minWidth":"minHeight"]=c+"px",i.flexShrink=0,i.flexBasis="auto",i),paneSize:(r={},r[u]=m,r[f]=t[f],r)}}(x,i);return{header:e,footer:t,styles:n}}},[a,r,c,I,m,d,_,x,i]);return s.a.createElement(Ey,{duoLayoutData:a},s.a.createElement("div",{className:"layout_duo_21dae3f4",style:null==C?void 0:C.styles.mainContainerStyle},s.a.createElement("div",{style:null==C?void 0:C.styles.canvasContainerStyle,id:m},s.a.createElement(ch,{canvasSize:i,cssToPhysicalPixelRatio:f},s.a.createElement(U_,{backgroundColor:Uf(_.semanticColors.bodyBackground),animationSpeedMultiplier:p},s.a.createElement(lh,{match:oi},s.a.createElement(Gm,{handleSizeCss:16,handleHitAreaSizeCss:29}),s.a.createElement(Um,null)),s.a.createElement(V_,{image:y,color:of,zIndex:1},s.a.createElement(fv,null,s.a.createElement(by,{ref:S}),s.a.createElement(rv,null),s.a.createElement(Z2,null))),s.a.createElement(z2,null),s.a.createElement(yy,null))),s.a.createElement(lh,{match:oi},s.a.createElement(y_,null),s.a.createElement(hu,null),s.a.createElement(th,null)),s.a.createElement(lh,{match:si},s.a.createElement(v0,null),s.a.createElement(ph,{gutterSize:16})),s.a.createElement(lh,{match:ci},s.a.createElement(v0,null),s.a.createElement(ph,{gutterSize:16}))),s.a.createElement("div",{style:null==C?void 0:C.styles.hingeStyle}),s.a.createElement(lh,{match:oi},s.a.createElement(wy,{size:null==C?void 0:C.styles.paneSize,header:null==C?void 0:C.header,footer:null==C?void 0:C.footer,styles:kb})),s.a.createElement(lh,{match:si},s.a.createElement(eu,{size:null==C?void 0:C.styles.paneSize,header:null==C?void 0:C.header,footer:null==C?void 0:C.footer,styles:Rb(_)})),s.a.createElement(lh,{match:ci},s.a.createElement(Uv,{size:null==C?void 0:C.styles.paneSize,header:null==C?void 0:C.header,footer:null==C?void 0:C.footer,styles:Nv(a)})),s.a.createElement(lh,{match:di},s.a.createElement(Vy,{size:null==C?void 0:C.styles.paneSize,header:null==C?void 0:C.header,footer:null==C?void 0:C.footer,styles:Mb,dialogHostId:m,layoutOrientation:x.orientation})),s.a.createElement(q_,{ref:b,onEditsChanged:l}),s.a.createElement(Z_,{ref:g,onUiStateChanged:u}),s.a.createElement(D0,{cssPixelMarginByActivity:zy})))})),Ky={margin:"0px 16px",display:"flex",height:"40px",flexGrow:1,justifyContent:"center"},Wy={container:{marginBottom:"0.5rem"}},qy=Object(o.memo)(function(e){var t=e.showAspectRatioOptions,n=e.activeAspectRatio,a=e.setAspectRatioConstraint,i=e.setAriaAnnouncement,r=e.styles,o=Object(gc.e)(),c=null==r?void 0:r.getAspectRatioTilesStyles,d=c?c(o):ng(o);return s.a.createElement(hb,{styles:Wy},!t&&s.a.createElement(lh,{match:"Crop"},s.a.createElement(Ng,{componentStyles:{rotationAngleDisplay:r0,rotationBarRoot:{display:"flex",justifyContent:"center",margin:"0px 16px 12px 16px"},rotate90AspectFlipBar:{container:Ky,iconButton:Sb(o),icon:Db,aspectRatioButton:Cb}},rotate90AspectFlipBarIcons:{rotate90CounterClockwise:"Rotate90CounterClockwise",rotate90Clockwise:"Rotate90Clockwise",flipHorizontally:"FlipHorizontal-Havana",flipVertically:"FlipVertical-Havana"},styles:r})),t&&s.a.createElement(n0,{activeAspectRatio:n,setAspectRatioConstraint:a,scrollContainerType:Zg.AutoCenterSelected,setAriaAnnouncement:i,aspectRatioTilesStyles:d}))}),Qy={setAspectRatioConstraint:Wo,setAriaAnnouncement:Cs},Yy=Object(R.connect)(function(e){return{showAspectRatioOptions:e.uiState.showAspectRatioOptions,activeAspectRatio:e.transformTools.cropInteraction.aspectRatioConstraint}},Qy)(qy);Object(Cl.n)([{rawString:".layout_mobile_9d5f99c9{width:100%;height:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:grid;grid-template-rows:1fr auto}.canvas_container_9d5f99c9{position:relative;width:100%;height:100%}"}]),Object(Cl.n)([{rawString:".crop_commandBar_container_97d33469{position:absolute;z-index:3;width:100%}.adjustments_commandBar_container_97d33469{position:absolute;z-index:3;width:100%}"}]);var Jy=Object(o.memo)(function(e){var t=e.activePivot,n=e.onSave,a=e.onBack,i=e.style,r=Object(gc.e)(),o=Object(iu.e)(r.palette.white);return s.a.createElement("div",{className:t===oi?"crop_commandBar_container_97d33469":Object(cc.U)("adjustments_commandBar_container_97d33469",{background:o&&ru(o,Yb)}),role:"banner"},s.a.createElement(Uy,{onSave:n,onBack:a,style:i}))}),Xy=Object(R.connect)(function(e){return{activePivot:e.uiState.activeEditorActivity}})(Jy);Object(Cl.n)([{rawString:".mobileActionStackBar_6472d122{padding:.5rem 1rem;text-align:center}"}]);var Zy=Object(o.memo)(function(e){var t=e.children,n=e.styles;return s.a.createElement("div",{className:"mobileActionStackBar_6472d122",style:n},t)});Zy.displayName="MobileActionStackBar",Object(Cl.n)([{rawString:".footerButton_5925a347{border:0;font-size:1.1rem}.pivotContainer_5925a347{overflow-x:auto;position:relative;-ms-overflow-style:none;overflow:-moz-scrollbars-none;scrollbar-width:none}.pivotContainer_5925a347::-webkit-scrollbar{display:none}"}]);var $y="pivotContainer_5925a347",e6={actionStackBar:{display:"table",minWidth:"calc(100% - 2rem)"}},t6=Object(o.memo)(function(e){var t=e.showAspectRatioOptions,n=e.setShowAspectRatioOptions,a=e.pivotItems,i=e.pivotStyles,r=e.footerButtonStyle,c=Object(gc.e)(),d=Object(o.useContext)(Le).strings,l=Object(o.useCallback)(function(){n(!1)},[n]),u=Object(o.useMemo)(function(){return Object(cc.g)(r,{label:{fontSize:"16px",fontWeight:"500"}})},[r]),f=t?{borderTop:"solid 1px #292929"}:{};return s.a.createElement("div",{className:$y,style:f},s.a.createElement(Zy,{styles:e6.actionStackBar},t?s.a.createElement(vh.e,{text:d.footer_done,onClick:l,theme:c,className:"footerButton_5925a347",styles:u}):s.a.createElement(Lu,{pivotItems:a,styles:i})))});t6.displayName="TransformToolMobileFooter";var n6={setShowAspectRatioOptions:no},a6=Object(R.connect)(function(e){return{showAspectRatioOptions:e.uiState.showAspectRatioOptions}},n6)(t6),i6=function(){return i6=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i6.apply(this,arguments)},r6=Object(o.memo)(function(e){var t,n=e.setActiveAdjustment,a=e.activeAdjustment,i=e.getTileStyles,r=e.scrollContainerStyle,c=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["setActiveAdjustment","activeAdjustment","getTileStyles","scrollContainerStyle"]),d=Object(o.useContext)(Le).strings,l=Object(gc.e)(),u=i?i(l):ng(l),f=e0(ts(),u,kl(d),ns,n,function(e){return function(t){return e===t}}(a),(t=c,function(e){return t[e]!==es})),p=Object(iu.e)(l.palette.white);return s.a.createElement(zg,{direction:"horizontal",style:i6(i6({},r),{background:p&&ru(p,Yb)})},f)});r6.displayName="AdjustmentActionsBar";var o6={setActiveAdjustment:ao},s6=Object(R.connect)(function(e){var t=e.colorAdjustments;return{brightness:t.brightness,exposure:t.exposure,saturation:t.saturation,highlights:t.highlights,shadows:t.shadows,contrast:t.contrast,temperature:t.temperature,tint:t.tint,vignette:t.vignette,activeAdjustment:e.uiState.activeAdjustmentKey}},o6)(r6),c6=function(){return{container:{position:"absolute",width:"calc(100% - 56px)",right:0,left:0,marginLeft:"auto",marginRight:"auto",height:"16px",zIndex:1,bottom:"20px"},slideBox:{margin:"0px",padding:"0px"}}},d6={height:"16px",fontSize:"12px",lineHeight:"16px",position:"absolute",width:"calc(100% - 56px)",right:0,left:0,marginLeft:"auto",marginRight:"auto",bottom:"40px"},l6=function(e){var t=Object(iu.e)(e.palette.white);return{getSliderHeaderStyles:function(){return{container:d6}},getSliderStyles:c6,container:{background:t&&ru(t,Yb),height:"64px",position:"absolute",width:"100%",bottom:"154px"}}},u6=Object(o.memo)(function(e){var t=e.adjustmentValue,n=e.activeAdjustmentKey,a=e.setAdjustmentValue,i=e.getStyles,r=e.hideSliderValueAfterInactivity,o=Object(gc.e)(),c=(null==i?void 0:i(o))||l6(o);return s.a.createElement("div",{style:c.container},s.a.createElement(Kl,{adjustmentKey:n,layout:"ValueOnly",normalizedValue:t,setAdjustmentValue:a,styles:c,hideSliderValueAfterInactivity:r}))});u6.displayName="MobileAdjustmentsSlider";var f6={setAdjustmentValue:ms},p6=Object(R.connect)(function(e,t){return{adjustmentValue:e.colorAdjustments[t.activeAdjustmentKey],key:e.uiState.numberOfResets}},f6)(u6),m6=Object(o.memo)(function(e){var t=e.activeAdjustmentKey,n=e.pivotItems,a=e.pivotStyles,i=e.getTileStyles,r=e.getSliderStyles,o=e.hideSliderValueAfterInactivity,c=e.scrollContainerStyle;return s.a.createElement(s.a.Fragment,null,t&&s.a.createElement(p6,{activeAdjustmentKey:t,getStyles:r,hideSliderValueAfterInactivity:o}),s.a.createElement(s6,{getTileStyles:i,scrollContainerStyle:c}),s.a.createElement("div",{className:$y},s.a.createElement(Zy,{styles:e6.actionStackBar},s.a.createElement(Lu,{pivotItems:n,styles:a}))))});m6.displayName="AdjustmentMobileFooter";var _6=Object(R.connect)(function(e){return{activeAdjustmentKey:e.uiState.activeAdjustmentKey}})(m6),h6=function(){return h6=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},h6.apply(this,arguments)},b6=Object(o.memo)(function(e){var t=e.availableFilters,n=e.imageTransformValues,a=e.cropTransformValues,i=e.cssToPhysicalPixelRatio,r=e.activeFilter,c=e.setActiveFilter,d=e.getTileStyles,l=e.thumbnailSizeCss,u=e.scrollContainerStyle,f=Object(o.useMemo)(function(){return t.map(function(){return Object(o.createRef)()})},[t]),p=Object(gc.e)(),m=d?d(p):ag(p),_=Cv(r,f,kv(t,n,a,i,l,l),l,c,m),h=Object(iu.e)(p.palette.white);return s.a.createElement(zg,{direction:"horizontal",style:h6(h6({},u),{background:h?ru(h,Yb):void 0})},t.map(_))});b6.displayName="FiltersActionsBar";var g6={setAriaAnnouncement:Cs},v6=Object(R.connect)(function(e){return{availableFilters:e.filters.availableFilters,cropTransformValues:e.transformTools.cropInteraction.uvToWorld,imageTransformValues:e.transformTools.image._preciseUvToWorld,cssToPhysicalPixelRatio:e.transformTools.device.pixelRatio}},g6)(b6),y6=Object(o.memo)(function(e){var t=e.showIntensitySlider,n=e.filterLevelsByName,a=e.activeFilter,i=e.setActiveFilterAndLevel,r=e.setAriaAnnouncement,c=e.pivotItems,d=e.pivotStyles,l=e.getTileStyles,u=e.getSliderStyles,f=e.thumbnailSizeCss,p=e.hideSliderValueAfterInactivity,m=e.scrollContainerStyle,_=Object(o.useContext)(Le).strings,h=Object(gc.e)(),b=Mv(r),g=Object(o.useCallback)(function(e){i({activeFilter:a,filterLevel:e})},[i,a]),v=Object(o.useCallback)(function(e){i({activeFilter:e,filterLevel:n[e.name]}),b(e,_v(n[e.name]).toString())},[b,n,i]),y=(null==u?void 0:u(h))||l6(h);return s.a.createElement(s.a.Fragment,null,t&&s.a.createElement(hv,{key:a.name,filterLevel:n[a.name],setFilterLevel:g,layout:"ValueOnly",style:y,headerName:_.filter_intensitySliderHeader,ariaLabel:nu(_.filter_intensitySliderAriaLabelFormatString,_[a.ariaLabelLocStringKey]),hideSliderValueAfterInactivity:p}),s.a.createElement(v6,{activeFilter:a,setActiveFilter:v,getTileStyles:l,thumbnailSizeCss:f,scrollContainerStyle:m}),s.a.createElement("div",{className:$y},s.a.createElement(Zy,{styles:e6.actionStackBar},s.a.createElement(Lu,{pivotItems:c,styles:d}))))});y6.displayName="FilterMobileFooter";var S6={setActiveFilterAndLevel:jr,setAriaAnnouncement:Cs},D6=Object(R.connect)(function(e){var t=e.filters.activeFilter;return{showIntensitySlider:qc(t),filterLevelsByName:e.uiState.filterLevelsByName,activeFilter:t}},S6)(y6),I6=Object(o.memo)(function(e){var t=e.pivotItems,n=e.pivotStyles;return s.a.createElement("div",{className:$y},s.a.createElement(Zy,{styles:e6.actionStackBar},s.a.createElement(Lu,{pivotItems:t,styles:n})))});I6.displayName="MarkupMobileFooter";var x6=function(e){var t=e.componentSize,n=e.cssToPhysicalPixelRatio,a=e.animationSpeedMultiplier,i=Object(o.useContext)(zc),r=i.image,c=i.setOffscreenRenderer,d=Object(gc.e)();return s.a.createElement(ch,{canvasSize:t,cssToPhysicalPixelRatio:n},s.a.createElement(U_,{backgroundColor:Uf(d.semanticColors.bodyBackground),animationSpeedMultiplier:a},s.a.createElement(lh,{match:oi},s.a.createElement(Gm,{handleSizeCss:16,handleHitAreaSizeCss:29}),s.a.createElement(Um,null)),s.a.createElement(V_,{image:r,color:of,zIndex:1},s.a.createElement(fv,null,s.a.createElement(by,{ref:c}),s.a.createElement(rv,null),s.a.createElement(Z2,null))),s.a.createElement(G2,{showStylePickerInFullWidth:!0,dialogType:Ph.e.normal}),s.a.createElement(yy,null)))},C6=function(){return C6=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},C6.apply(this,arguments)},O6=Object(o.memo)(Object(o.forwardRef)(function(e,t){var n,a=e.componentSize,i=e.onSave,r=e.onClose,c=e.pivotItems,d=e.onEditsChanged,l=e.onUiStateChanged,u=e.cssToPhysicalPixelRatio,f=e.actionsStackStyles,p=e.getAdjustmentTileStyle,m=e.getAdjustmentSliderStyle,_=e.getFilterTileStyle,h=e.getFilterSliderStyle,b=e.footerButtonStyle,g=e.pivotLinkHeight,v=e.pivotLinkLineHeight,y=e.pivotLinkFontSize,S=e.commandBarStyle,D=e.hideSliderValueAfterInactivity,I=e.thumbnailSizeCss,x=e.scrollContainerStyle,C=e.cssPixelMarginByActivity,O=Object(gc.e)(),w=fb(t),E=w.editOperationsRef,A=w.editUiStateRef,L=Object(o.useContext)(xc).inkToolbarStyles,k=null===(n=null==L?void 0:L.clearAllInk)||void 0===n?void 0:n.confirmationDialog,M=Object(o.useMemo)(function(){return Hy(O,g,v,O.palette.neutralLighterAlt,y)},[O,g,v,y]);return s.a.createElement("div",{className:"layout_mobile_9d5f99c9"},s.a.createElement(Xy,{onSave:i,onBack:r,style:C6(C6({},S),{confirmationDialog:k})}),s.a.createElement("div",{className:"canvas_container_9d5f99c9",role:"main"},s.a.createElement(x6,{componentSize:a,cssToPhysicalPixelRatio:u}),s.a.createElement(lh,{match:oi},s.a.createElement(y_,null),s.a.createElement(hu,null),s.a.createElement(th,null)),s.a.createElement(Yy,{styles:f}),s.a.createElement(lh,{match:si},s.a.createElement(v0,null),s.a.createElement(ph,{gutterSize:16})),s.a.createElement(lh,{match:ci},s.a.createElement(v0,null),s.a.createElement(ph,{gutterSize:16}))),s.a.createElement(lh,{match:oi},s.a.createElement(a6,{pivotItems:c,pivotStyles:M,footerButtonStyle:b})),s.a.createElement(lh,{match:si},s.a.createElement(_6,{pivotItems:c,pivotStyles:M,getTileStyles:p,getSliderStyles:m,hideSliderValueAfterInactivity:D,scrollContainerStyle:x})),s.a.createElement(lh,{match:ci},s.a.createElement(D6,{pivotItems:c,pivotStyles:M,getTileStyles:_,getSliderStyles:h,hideSliderValueAfterInactivity:D,thumbnailSizeCss:I,scrollContainerStyle:x})),s.a.createElement(lh,{match:di},s.a.createElement(I6,{pivotItems:c,pivotStyles:M})),s.a.createElement(q_,{ref:E,onEditsChanged:d}),s.a.createElement(Z_,{ref:A,onUiStateChanged:l}),s.a.createElement(D0,{cssPixelMarginByActivity:C}))})),w6={position:"absolute",top:-1,width:1,height:1,margin:-1,padding:0,border:0,overflow:"hidden"},E6=s.a.memo(function(e){var t=e.message;return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{role:"status","aria-live":"assertive","aria-atomic":"true",style:w6},t))}),A6=s.a.memo(function(e){var t=e.cropWidth,n=e.cropHeight,a=e.cropTopLeftCornerFromImageOrigin,i=e.panViewTopLeftCornerFromCropOrigin,r=e.currentZoom,c=e.ariaAnnouncementScenario,d=e.ariaAnnouncementMessage,l=e.setAriaAnnouncement,u=e.setAriaAnnouncementScenario;return function(e,t,n,a,i){var r=Object(o.useContext)(Le).strings;Object(o.useEffect)(function(){"CropImageDimension"===(null==i?void 0:i.type)&&(i.cropDimension.width===n&&i.cropDimension.height===a||e(nu(r.editor_imageDimensionAriaLive,n.toString(),a.toString())),t(void 0))},[e,t,i,n,a,r])}(l,u,t,n,c),function(e,t,n,a){var i=Object(o.useContext)(Le).strings;Object(o.useEffect)(function(){if("CropImageMove"===(null==a?void 0:a.type)){var r=_n(n,a.cropTopLeftCornerFromImageOrigin),o=n.x.toString(),s=n.y.toString();e(nu(r?i.crop_rectangleCannotMoveInCurrentDirectionAriaLive:i.crop_rectanglePositionAriaLive,o,s)),t(void 0)}},[a,n,e,t,i])}(l,u,a,c),function(e,t,n,a){var i=Object(o.useContext)(Le).strings;Object(o.useEffect)(function(){if("Zoom"===(null==a?void 0:a.type)){var r=Math.round(100*a.zoom),o=Math.round(100*n);if(r!==o){var s=nu(i.editor_zoomPercentAriaLive,o.toString());e(s)}t(void 0)}},[a,n,i,e,t])}(l,u,r,c),function(e,t,n,a){var i=Object(o.useContext)(Le).strings;Object(o.useEffect)(function(){if("PanView"===(null==a?void 0:a.type)){var r=n.x.toString(),o=n.y.toString();e(nu(i.nonCrop_panViewPositionAriaLive,r,o)),t(void 0)}},[a,n,e,t,i])}(l,u,i,c),s.a.createElement(E6,{message:d})}),L6={setAriaAnnouncement:Cs,setAriaAnnouncementScenario:Os},k6=Object(R.connect)(function(e){var t=e.ariaAnnouncement,n=t.ariaAnnouncementScenario,a=t.ariaAnnouncementMessage;return{cropWidth:Wm(e.transformTools),cropHeight:qm(e.transformTools),cropTopLeftCornerFromImageOrigin:b_(e.transformTools),panViewTopLeftCornerFromCropOrigin:h0(e.transformTools),currentZoom:h_(e.transformTools),ariaAnnouncementScenario:n,ariaAnnouncementMessage:a}},L6)(A6),M6=function(e){var t=e.enableAdjustments,n=e.enableFilters,a=e.enableAutoEnhance,i=e.enableMarkup,r=e.children;return s.a.createElement(G1.Provider,{value:{enableAdjustments:!!t,enableFilters:!!n,enableAutoEnhance:!!a,enableMarkup:!!i}},r)},P6=Object(R.connect)(function(e){return{activeEditorActivity:e.uiState.activeEditorActivity,activeEditorActivityInputType:e.uiState.activeEditorActivityInputType}})(function(e){var t=e.activeEditorActivity,n=e.activeEditorActivityInputType,a=Object(o.useRef)(t),i=Object(o.useContext)(_e).logEditorActivityEvent;return Object(o.useLayoutEffect)(function(){var e,r=window.requestAnimationFrame(function(){e=setTimeout(function(){var e=function(e){var t=performance.getEntriesByName(e);if(1===t.length){var n=performance.now()-t[0].startTime;return performance.clearMarks(e),n}performance.clearMarks(e)}(t);e&&i({editorActivityName:t,previousEditorActivityName:a.current,loadTimeInMs:e,inputType:n}),a.current=t})});return function(){clearTimeout(e),window.cancelAnimationFrame(r)}},[t,n,i]),s.a.createElement(s.a.Fragment,null)}),T6=function(){return T6=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},T6.apply(this,arguments)};function U6(e){var t=ng(e);return T6(T6({},t),{container:{minWidth:"92px"},background:T6(T6({},t.background),{width:"76px",height:"76px",marginTop:"0px"}),icon:{fontSize:"26px",width:"26px",height:"26px",color:e.palette.neutralPrimaryAlt,fill:e.palette.neutralPrimaryAlt}})}var F6={transformToolsContainer:{left:"50%",transform:"translate(-50%, 0)",width:"calc(100% - 128px)",minWidth:"412PX"},getAspectRatioTilesStyles:U6},H6={root:{height:"40px"}},R6={saveButton:jb,resetButton:Vb},N6={bottom:"56px",position:"absolute",overflowY:"hidden",width:"100%",paddingBottom:"8px"},B6=function(e){var t=Object(iu.e)(e.palette.white);return{getSliderStyles:Kb,getSliderHeaderStyles:Wb,container:{background:t&&ru(t,Yb),height:"72px",position:"absolute",width:"100%",bottom:"190px"}}},j6={bottom:"48px",position:"absolute",overflowY:"hidden",width:"100%",paddingBottom:"8px"},V6=function(){return V6=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},V6.apply(this,arguments)};xl||(Object(cc.N)({icons:{"OneByTwoAspect-Havana":Kd,"TwoByOneAspect-Havana":Wd,"TwoByThreeAspect-Havana":qd,"ThreeByTwoAspect-Havana":Qd,"ThreeByFourAspect-Havana":Yd,"FourByThreeAspect-Havana":Jd,"FourByFiveAspect-Havana":Xd,"FiveByFourAspect-Havana":Zd,"NineBySixteenAspect-Havana":$d,"SixteenByNineAspect-Havana":el,"FreeformAspect-Havana":nl,"OriginalAspect-Havana":al,"SquareAspect-Havana":tl,"Brightness-Havana":il,"Highlights-Havana":ol,"Exposure-Havana":sl,"Contrast-Havana":cl,"Saturation-Havana":rl,"Shadows-Havana":ul,"Tint-Havana":dl,"Vignette-Havana":ll,"Temperature-Havana":fl,"FlipHorizontal-Havana":pl,"FlipVertical-Havana":ml,"ImageFilter-Havana":_l,"FitPageRoundedEdge-Havana":bl,"ActualSizeRoundedEdge-Havana":hl,"ActiveFilterCheckmark-Havana":gl,"Back-Havana":vl,"Forward-Havana":yl,"ArrowMaximize-Havana":Sl,"SmallArrowMaximize-Havana":Dl,"SmallSingleArrow-Havana":Il}}),xl=!0);var z6=Object(o.forwardRef)(function(e,t){var n=e.image,a=e.componentSize,i=e.onSave,r=e.localization,c=e.telemetryCallback,d=e.onError,l=e.onClose,u=e.onEditsChanged,f=e.onUiStateChanged,p=e.defaultEdits,m=e.initialEdits,_=e.initialUiState,h=e.serializedState,b=e.layout,g=void 0===b?{type:nc.Desktop}:b,v=e.enableAdjustments,y=e.enableFilters,S=e.enableAutoEnhance,D=e.cssToPhysicalPixelRatio,I=e.onDecideEnabledSaveTypes,x=e.sessionFullImageSize,C=e.animationSpeedMultiplier,O=e.children;Object(o.useEffect)(function(){performance.mark(H.Editor)},[]);var w,E,A,L,k=Object(gc.e)(),M=Object(o.useContext)(xc).enableMarkup;w=!0,E=null!=y&&y,A=M,L=Object(o.useContext)(xc).scriptsToLoadJSBundles,Object(o.useEffect)(function(){E&&E===w&&ov()},[E,w]),Object(o.useEffect)(function(){A&&A===w&&L.forEach(function(e){e()})},[A,w,L]);var P,T=Object(o.useMemo)(function(){return function(e,t,n){var a=[{itemIcon:"Crop",itemKey:oi,localizationKey:"pivot_crop"}];return e&&a.push({itemIcon:"Equalizer",itemKey:si,localizationKey:"pivot_adjustment"}),t&&a.push({itemIcon:"ImageFilter-Havana",itemKey:ci,localizationKey:"pivot_filter"}),n&&a.push({itemIcon:"Brush",itemKey:di,localizationKey:"pivot_markup"}),a}(v,y,M)},[v,y,M]),U=k.semanticColors.bodyBackground,F={layout:g,componentSize:a,onSave:i,onClose:l,pivotItems:T,onEditsChanged:u,onUiStateChanged:f,cssToPhysicalPixelRatio:D,animationSpeedMultiplier:C},R=g.hideCanvas||!1;switch(g.type){case nc.Desktop:P=s.a.createElement(Sy,V6({ref:t},F,{hideCanvas:R}));break;case nc.Mobile:P=s.a.createElement(O6,V6({ref:t},F,{pivotLinkHeight:32,pivotLinkLineHeight:16,pivotLinkFontSize:14,thumbnailSizeCss:48,scrollContainerStyle:j6,cssPixelMarginByActivity:Qb}));break;case nc.DuoDouble:P=s.a.createElement(Gy,V6({ref:t},F));break;case nc.DuoSingle:P=s.a.createElement(O6,V6({ref:t},F,{actionsStackStyles:F6,getAdjustmentTileStyle:U6,getAdjustmentSliderStyle:B6,getFilterTileStyle:ig,getFilterSliderStyle:B6,footerButtonStyle:H6,pivotLinkHeight:40,pivotLinkLineHeight:24,pivotLinkFontSize:16,commandBarStyle:R6,hideSliderValueAfterInactivity:!0,thumbnailSizeCss:76,cssPixelMarginByActivity:Lb,scrollContainerStyle:N6}))}return s.a.createElement("div",{style:{width:a.width,height:a.height,backgroundColor:U}},s.a.createElement(M6,{enableAdjustments:v,enableFilters:y,enableAutoEnhance:S,enableMarkup:M},s.a.createElement(jd,{image:n,localization:r,telemetryCallback:c,onComponentError:d,defaultEdits:p,initialEdits:m,initialUiState:_,serializedState:h,sessionFullImageSize:x,onDecideEnabledSaveTypes:I},P,O,s.a.createElement(P6,null),s.a.createElement(k6,null))))});z6.displayName="ImageEditor";var G6=n(89),K6=Object(cc.y)({palette:{themePrimary:"#2899f5",themeLighterAlt:"#02060a",themeLighter:"#092c47",themeLight:"#043862",themeTertiary:"#004c87",themeSecondary:"#007bd4",themeDarkAlt:"#3aa0f3",themeDark:"#6cb8f6",themeDarker:"#82c7ff",neutralLighterAlt:"#1b1a19",neutralLighter:"#252423",neutralLight:"#292827",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondary:"#a19f9d",neutralPrimaryAlt:"#c8c6c4",neutralPrimary:"#f3f2f1",neutralDark:"#faf9f8",black:"#ffffff",white:"#000000"}}),W6={themePrimary:"#0086f0",themeLighterAlt:"#02060a",themeLighter:"#092c47",themeLight:"#043862",themeTertiary:"#004c87",themeSecondary:"#0078d4",themeDarkAlt:"#1890f1",themeDark:"#3aa0f3",themeDarker:"#6cb8f6",neutralLighterAlt:"#141414",neutralLighter:"#212121",neutralLight:"#292929",neutralQuaternaryAlt:"#303030",neutralQuaternary:"#404040",neutralTertiaryAlt:"#6e6e6e",neutralTertiary:"#acacac",neutralSecondary:"#c8c8c8",neutralPrimaryAlt:"#e1e1e1",neutralPrimary:"#f1f1f1",neutralDark:"#f8f8f8",black:"#ffffff",white:"#000000"},q6=Object(cc.y)({palette:W6}),Q6=(Object(cc.y)({palette:W6,defaultFontStyle:{fontFamily:"Roboto"}}),n(3805)),Y6=n(1694),J6=n(11),X6=n(1106),Z6=Object(o.createContext)({fabricCanvas:null,setFabricCanvas:function(e){}}),$6=Object(o.createContext)({fabric:null,loadFabric:function(){}}),e7=function(e){var t=e.children,n=function(){var e=Object(o.useState)(null),t=e[0],n=e[1],a=Object(o.useRef)(null),i=Object(o.useContext)($6).fabric,r=Object(o.useCallback)(function(e){var t;if(i)if(e){var r=new i.Canvas(e,{enableRetinaScaling:!1,stopContextMenu:!0});a.current=r,r.renderOnAddRemove=!1,n(r);var o=r.getElement().parentElement;o&&(o.style.position="absolute")}else null===(t=a.current)||void 0===t||t.dispose(),a.current=null,n(null)},[i]);return[t,r]}(),a=n[0],i=n[1];return s.a.createElement(Z6.Provider,{value:{fabricCanvas:a,setFabricCanvas:i}},t)},t7=Object(o.createContext)({wetInkCanvas:void 0,setWetInkCanvas:function(e){}}),n7=function(e){var t=e.children,n=Object(o.useState)(),a=n[0],i=n[1];return s.a.createElement(t7.Provider,{value:{wetInkCanvas:a,setWetInkCanvas:i}},t)};function a7(e,t,n){var a=Aa(n);t.clipPath=new e.Rect(a)}function i7(e,t,n){if(Da(e,n)){var a=Bn(Ea(n)),i=a[0],r=a[1],o=a[2],s=a[3],c=[{lineStart:i,lineEnd:r},{lineStart:r,lineEnd:o},{lineStart:o,lineEnd:s},{lineStart:s,lineEnd:i}],d=Math.min.apply(Math,c.map(function(n){var a,i=n.lineStart,r=n.lineEnd;return null!==(a=Ta(e,t,i,r))&&void 0!==a?a:1}));return{x:e.x+(t.x-e.x)*d,y:e.y+(t.y-e.y)*d}}}function r7(e,t,n){var a=e.util.qrDecompose(n),i=new e.Point(a.translateX,a.translateY);t.flipX=!1,t.flipY=!1,t.set(a),t.setPositionByOrigin(i,"center","center"),t.setCoords()}function o7(e,t,n){t.id&&r7(e,t,Yn(Vn(n,t.fabricToViewTransform)))}var s7=function(){return s7=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s7.apply(this,arguments)};function c7(e,t,n,a,i){a&&t.getObjects().forEach(function(t){o7(e,t,a)}),n&&t.setDimensions({width:n.x,height:n.y},{backstoreOnly:!0}),i?a7(e,t,i):a&&a7(e,t,a),t.renderAll()}var d7=function(){return d7=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},d7.apply(this,arguments)},l7=Object(o.memo)(function(e){var t,n,a,i=e.cropViewTransform,r=e.imageViewTransform,c=e.width,d=e.height,l=e.cssWidth,u=e.cssHeight,f=e.styles,p=e.activeMarkupToolType,m=e.markupContentItems,_=e.removeMarkupContent,h=e.convertToFabricContent,b=Object(o.useContext)(Z6).setFabricCanvas;return t=Object(o.useContext)($6).loadFabric,Object(o.useLayoutEffect)(function(){t()},[t]),n=Object(o.useContext)(Z6).fabricCanvas,a=Object(o.useContext)(xc).setWetCanvasIsReady,Object(o.useEffect)(function(){return n&&a(!0),function(){a(!1)}},[n,a]),function(e,t,n,a,i){var r=Object(o.useContext)(Z6).fabricCanvas,s=Object(o.useContext)($6).fabric;Object(o.useLayoutEffect)(function(){(null==r?void 0:r.getContext())&&(null==r||r.setDimensions({width:e,height:t},{backstoreOnly:!0}),null==r||r.setDimensions({width:n,height:a},{cssOnly:!0}),null==r||r.renderAll())},[e,t,n,a,r]),Object(o.useEffect)(function(){s&&(null==r?void 0:r.getContext())&&(a7(s,r,i),r.renderAll())},[i,s,r])}(c,d,l,u,i),function(e,t,n){var a=Object(o.useContext)(Z6).fabricCanvas,i=Object(o.useContext)($6).fabric;Object(o.useEffect)(function(){if(a&&i&&(a.isDrawingMode=function(e){switch(e){case"Eraser":case"Highlighter":case"Pen":return!0;default:throw new ec(e)}}(e),"Eraser"===e)){var r=Aa(t);a.freeDrawingBrush=new(function(e){return e.util.createClass(e.PencilBrush,{color:"rgb(255, 255, 255)",opacity:0,width:32,initialize:function(e,t,n,a){this.canvas=e,this.width=t,this._points=[],this.bounds=n,this.removeMarkupContent=a},_render:function(){},_finalizeAndAddPath:function(){this._resetShadow(),this.canvas.clearContext(this.canvas.contextTop),this.canvas.requestRenderAll(),this.previousPoint=null},getIdsAtBrushLocation:function(t){var n=[],a=this.width/2,i=this.canvas.getObjects(),r=function(e,t){for(var n=Math.asin(1.5/t),a=[],i=0;i<2*Math.PI;i+=n)a.push({x:e.x+t*Math.cos(i),y:e.y+t*Math.sin(i)});return a}(t,a),o=new e.Circle({radius:a,top:t.y-a,left:t.x-a,fill:"rgba(255,0,255,0)"});o.setCoords();for(var s=0,c=i;s<c.length;s++){var d=c[s];d&&d.visible&&(d.isContainedWithinObject(o)||d.intersectsWithObject(o)&&this.objectCollidesWithPoints(d,r))&&n.push(d.id)}return n},objectCollidesWithPoints:function(e,t){for(var n=0,a=t;n<a.length;n++){var i=a[n];if(!this.canvas.isTargetTransparent(e,i.x,i.y))return!0}return!1},getPointsToEraseBetween:function(e,t){var n=Da(e,this.bounds),a=Da(t,this.bounds);if(n){if(a)return[t,e];var i=i7(e,t,this.bounds);if(i)return[i,e]}else if(a){var r=i7(t,e,this.bounds);if(r)return[t,r]}},erase:function(e){var t=this;if(Da(e,this.bounds)&&this.eraseIdsFromCanvas(this.getIdsAtBrushLocation(e)),this.previousPoint){var n=this.getPointsToEraseBetween(e,this.previousPoint);n&&window.requestAnimationFrame(function(){t.eraseIdsFromCanvas(t.getIdsBetweenPoints(n[0],n[1]))})}},getIdsBetweenPoints:function(t,n){var a=[],i=Math.hypot(n.x-t.x,n.y-t.y);if(i>this.width){var r=Math.atan2(n.y-t.y,n.x-t.x),o=dn(cn(n,t)),s={x:-1*o.y*this.width/2,y:o.x*this.width/2},c=new e.Rect({width:i,height:this.width,left:t.x-s.x,top:t.y-s.y,angle:180*r/Math.PI,fill:"rgba(255,255,0,0)"});c.setCoords();for(var d=[],l=0,u=this.canvas.getObjects();l<u.length;l++)if((_=u[l])&&_.id&&_.visible){if(_.isContainedWithinObject(c)){a.push(_.id);continue}if(_.intersectsWithObject(c)){d.push(_);continue}}if(d.length>0)for(var f=function(e,t,n,a){void 0===a&&(a=1);for(var i=[],r=on(cn(e,t)),o=dn(cn(t,e)),s=-1*o.y*n/2,c=o.x*n/2,d=0;d<r;d+=a)i.push({x:e.x+d*o.x+s,y:e.y+d*o.y+c}),i.push({x:e.x+d*o.x-s,y:e.y+d*o.y-c});return i}(t,n,this.width),p=0,m=d;p<m.length;p++){var _;(_=m[p]).id&&this.objectCollidesWithPoints(_,f)&&a.push(_.id)}}return a},eraseIdsFromCanvas:function(e){e.length>0&&this.removeMarkupContent(e)},onMouseDown:function(e,t){this.canvas._isMainEvent(t.e)&&(this.previousPoint=e,this.erase(e))},onMouseMove:function(e,t){if(this.canvas._isMainEvent(t.e)&&(!this.limitedToCanvasSize||!this._isOutSideCanvas(e))){if(void 0!==(n=t.e.buttons)&&!n_(n,t_))return this._finalizeAndAddPath(),void(this.canvas._isCurrentlyDrawing=!1);this._captureDrawingPath(e)&&this._points.length>1&&(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this._render()):this.erase(e),this.previousPoint=e)}var n}})}(i))(a,32,r,n),a.freeDrawingCursor="inherit",a.defaultCursor="inherit"}},[t,a,e,n,i])}(p,i,_),function(e,t){var n=Object(o.useContext)(Z6).fabricCanvas,a=Object(o.useRef)(null),i=Object(o.useContext)($6).fabric;Object(o.useLayoutEffect)(function(){a.current=new Set},[n]),Object(o.useLayoutEffect)(function(){if((null==n?void 0:n.getContext())&&a.current&&i){for(var r=[],o=new Set(a.current),s=0,c=e;s<c.length;s++){var d=c[s];o.delete(d.id),a.current.has(d.id)||(r.push(d),a.current.add(d.id))}for(var l=0,u=Array.from(o);l<u.length;l++){var f=u[l];a.current.delete(f)}var p=t?r.map(t):r;!function(e,t,n){e.util.enlivenObjects(n,function(e){e.forEach(function(e){t.add(e)}),t.requestRenderAll()},"fabric")}(i,n,p),function(e,t){for(var n=0,a=e.getObjects();n<a.length;n++){var i=a[n];if(i&&i.id&&t.has(i.id)&&(t.delete(i.id),e.remove(i)),t.size<1)break}e.requestRenderAll()}(n,o)}},[t,i,n,e])}(m,h),function(e){var t=Object(o.useContext)(Z6).fabricCanvas,n=Object(o.useContext)($6).fabric;Object(o.useLayoutEffect)(function(){t&&n&&t.getObjects().forEach(function(t){o7(n,t,e)})},[n,t,e])}(r),function(e,t){var n=Object(o.useContext)(Z6).fabricCanvas,a=Object(o.useContext)(xc).setCanvasMethods,i=Object(o.useContext)($6).fabric,r=Object(o.useRef)(n);n&&(r.current=n);var s=Object(o.useRef)(void 0);Object(o.useEffect)(function(){return a(function(e){return s7(s7({},e),{getHTMLCanvas:function(e,t){if(r.current&&i){var n=r.current.getElement();if(n)return(e||t)&&(s.current={x:r.current.getWidth(),y:r.current.getHeight()},c7(i,r.current,e,t),n=r.current.getElement()),n}return null}})}),function(){r.current=null}},[i,a]),Object(o.useEffect)(function(){return a(function(n){return s7(s7({},n),{restoreHTMLCanvas:function(){r.current&&i&&r.current.getElement()&&c7(i,r.current,s.current,e,t)}})}),function(){r.current=null}},[t,i,e,a])}(r,i),s.a.createElement("canvas",{ref:b,style:d7({},f)})});function u7(e,t){e.output=t}function f7(e,t,n){u7(e,t),u7(t,n)}function p7(e,t,n,a){u7(e,t),f7(t,n,a)}var m7=.5;function _7(e){return{x:e.offsetX,y:e.offsetY,pressure:e.pressure,tiltX:e.tiltX,tiltY:e.tiltY,timestamp:e.timeStamp}}function h7(e){return{x:e.offsetX,y:e.offsetY,pressure:m7,tiltX:e.tiltX,tiltY:e.tiltY,timestamp:e.timeStamp}}var b7=function(){function e(){}return e.prototype.onPointerDown=function(e){this.output.beginStroke(h7(e))},e.prototype.onPointerMove=function(e){this.output.addPoint(h7(e))},e.prototype.onPointerUp=function(e){this.output.endStroke(h7(e))},e}(),g7=function(){function e(){}return e.prototype.onPointerDown=function(e){this.output.beginStroke(_7(e))},e.prototype.onPointerMove=function(e){this.output.addPoint(_7(e))},e.prototype.onPointerUp=function(e){this.output.endStroke(_7(e))},e}();function v7(){return-1===navigator.userAgent.indexOf("Firefox")?new g7:new b7}var y7=function(){function e(){}return e.prototype.beginStroke=function(e){this.output.beginStroke(e),this.point=e},e.prototype.addPoint=function(e){this.point.x===e.x&&this.point.y===e.y||(this.output.addPoint(e),this.point=e)},e.prototype.endStroke=function(e){this.output.endStroke(e)},e}(),S7=function(){function e(){}return e.prototype.beginStroke=function(e){this.out1={x:e.x,y:e.y},this.out2=this.out1,this.output.beginStroke(e)},e.prototype.addPoint=function(e){this.output.addPoint(this.filter(e))},e.prototype.endStroke=function(e){this.output.endStroke(this.filter(e))},e.prototype.filter=function(e){var t={x:D7(e.x,this.out1.x,this.out2.x),y:D7(e.y,this.out1.y,this.out2.y)};return this.out2=this.out1,this.out1=t,{x:t.x,y:t.y,pressure:e.pressure,tiltX:e.tiltX,tiltY:e.tiltY,timestamp:e.timestamp}},e}();function D7(e,t,n){return.16999999999999993*e+1.33*t+-.5*n}function I7(e,t,n,a){var i=(e+t)/2,r=(t+n)/2,o=(n+a)/2,s=(i+r)/2,c=(r+o)/2;return[e,i,s,(s+c)/2,c,o,a]}function x7(e,t,n,a){return[(n-e)/6+t,(t-a)/6+n]}var C7=function(){function e(){this.began=!1}return e.prototype.beginStroke=function(e){this.output.beginStroke(e),this.cp=[e,e,e,e],this.began=!0},e.prototype.addPoint=function(e){var t=this.push(e),n=t[0],a=t[1];this.began?this.began=!1:this.output.addSegment(n,a,this.cp[2])},e.prototype.endStroke=function(e){this.addPoint(e);var t=this.push(e),n=t[0],a=t[1];this.output.endStroke(n,a,this.cp[2])},e.prototype.push=function(e){return this.cp.shift(),this.cp.push(e),t=this.cp[0],n=this.cp[1],a=this.cp[2],i=this.cp[3],o=(r=x7(t.x,n.x,a.x,i.x))[0],s=r[1],d=(c=x7(t.y,n.y,a.y,i.y))[0],l=c[1],f=(u=O7(n.pressure,a.pressure))[0],p=u[1],_=(m=O7(n.tiltX,a.tiltX))[0],h=m[1],g=(b=O7(n.tiltY,a.tiltY))[0],v=b[1],[{x:o,y:d,pressure:f,tiltX:_,tiltY:g,timestamp:(y=O7(n.timestamp,a.timestamp))[0]},{x:s,y:l,pressure:p,tiltX:h,tiltY:v,timestamp:y[1]}];var t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y},e}();function O7(e,t){var n=(t-e)/3;return[e+n,t-n]}function w7(e,t){return e.x*t.x+e.y*t.y}function E7(e,t){return{x:e.x-t.x,y:e.y-t.y}}function A7(e,t){var n=E7(e,t);return w7(n,n)}var L7=function(){function e(e){this.flatness=e*e}return e.prototype.beginStroke=function(e){this.output.beginStroke(e),this.beginPoint=e},e.prototype.addSegment=function(e,t,n){k7(this.beginPoint,e,t,n,this.flatness,this.output),this.output.addPoint(n),this.beginPoint=n},e.prototype.endStroke=function(e,t,n){k7(this.beginPoint,e,t,n,this.flatness,this.output),this.output.endStroke(n)},e}();function k7(e,t,n,a,i,r){var o=function(e,t,n,a){var i=I7(e.x,t.x,n.x,a.x),r=i[0],o=i[1],s=i[2],c=i[3],d=i[4],l=i[5],u=i[6],f=I7(e.y,t.y,n.y,a.y),p=f[0],m=f[1],_=f[2],h=f[3],b=f[4],g=f[5],v=f[6],y=I7(e.pressure,t.pressure,n.pressure,a.pressure),S=y[0],D=y[1],I=y[2],x=y[3],C=y[4],O=y[5],w=y[6],E=I7(e.tiltX,t.tiltX,n.tiltX,a.tiltX),A=E[0],L=E[1],k=E[2],M=E[3],P=E[4],T=E[5],U=E[6],F=I7(e.tiltY,t.tiltY,n.tiltY,a.tiltY),H=F[0],R=F[1],N=F[2],B=F[3],j=F[4],V=F[5],z=F[6],G=I7(e.timestamp,t.timestamp,n.timestamp,a.timestamp);return[{x:r,y:p,pressure:S,tiltX:A,tiltY:H,timestamp:G[0]},{x:o,y:m,pressure:D,tiltX:L,tiltY:R,timestamp:G[1]},{x:s,y:_,pressure:I,tiltX:k,tiltY:N,timestamp:G[2]},{x:c,y:h,pressure:x,tiltX:M,tiltY:B,timestamp:G[3]},{x:d,y:b,pressure:C,tiltX:P,tiltY:j,timestamp:G[4]},{x:l,y:g,pressure:O,tiltX:T,tiltY:V,timestamp:G[5]},{x:u,y:v,pressure:w,tiltX:U,tiltY:z,timestamp:G[6]}]}(e,t,n,a),s=o[0],c=o[1],d=o[2],l=o[3],u=o[4],f=o[5],p=o[6];(function(e,t,n){var a=A7(t,e);if(0===a)return A7(n,e);var i=(n.x-t.x)*(t.y-e.y)-(t.x-e.x)*(n.y-t.y);return i*i/a})(s,p,l)<=i||(k7(s,c,d,l,i,r),r.addPoint(l),k7(l,u,f,p,i,r))}var M7=function(){function e(){this.lastPressure=m7}return e.prototype.beginStroke=function(e){this.output.beginStroke(e),this.lastPressure=e.pressure},e.prototype.addPoint=function(e){this.output.addPoint(e),this.lastPressure=e.pressure},e.prototype.endStroke=function(e){this.output.endStroke(0===e.pressure?{x:e.x,y:e.y,pressure:this.lastPressure,tiltX:e.tiltX,tiltY:e.tiltY,timestamp:e.timestamp}:e)},e}(),P7=function(){function e(e){var t,n,a,i,r,o;this.pointerToStroke=v7(),this.deduper=new y7,this.endStrokePressure=new M7,this.jitter=new S7,this.fitter=new C7,this.flattener=new L7(e),t=this.pointerToStroke,n=this.deduper,a=this.endStrokePressure,i=this.jitter,r=this.fitter,o=this.flattener,f7(t,n,a),p7(a,i,r,o)}return e.prototype.onPointerDown=function(e){u7(this.flattener,this.output),this.pointerToStroke.onPointerDown(e)},e.prototype.onPointerMove=function(e){this.pointerToStroke.onPointerMove(e)},e.prototype.onPointerUp=function(e){this.pointerToStroke.onPointerUp(e)},e}(),T7=function(){function e(e){var t=this;this.onPointerDown=function(e){t.output.onPointerDown(e)},this.onTouchStart=function(e){t.output.onTouchStart(e)},this.element=e}return e.prototype.activate=function(){this.element.addEventListener("pointerdown",this.onPointerDown,!0),this.element.addEventListener("touchstart",this.onTouchStart,!0)},e.prototype.deactivate=function(){this.element.removeEventListener("pointerdown",this.onPointerDown,!0),this.element.removeEventListener("touchstart",this.onTouchStart,!0)},e}(),U7=function(){function e(){this.active=!1}return e.prototype.onMouseDown=function(e){this.output.onMouseDown(e),this.active=!0},e.prototype.onMouseMove=function(e){this.active&&this.output.onMouseMove(e)},e.prototype.onMouseUp=function(e){this.active=!1,this.output.onMouseUp(e)},e}(),F7=function(){function e(e){var t=this;this.onMouseDown=function(e){t.output.onMouseDown(e)},this.onMouseMove=function(e){t.output.onMouseMove(e)},this.onMouseUp=function(e){t.output.onMouseUp(e)},this.element=e}return e.prototype.activate=function(){this.element.addEventListener("mousedown",this.onMouseDown),this.element.addEventListener("mousemove",this.onMouseMove),this.element.addEventListener("mouseup",this.onMouseUp)},e.prototype.deactivate=function(){this.element.removeEventListener("mousedown",this.onMouseDown),this.element.removeEventListener("mousemove",this.onMouseMove),this.element.removeEventListener("mouseup",this.onMouseUp)},e}();function H7(e){e.preventDefault()}function R7(e){e.preventDefault(),e.stopPropagation()}var N7=function(){function e(){}return e.prototype.onMouseDown=function(e){this.output.onMouseDown(e),R7(e)},e.prototype.onMouseMove=function(e){this.output.onMouseMove(e),R7(e)},e.prototype.onMouseUp=function(e){this.output.onMouseUp(e),R7(e)},e}(),B7=function(){function e(e){f7(this.head=new F7(e),new N7,this.tail=new U7)}return e.prototype.activate=function(){this.head.activate()},e.prototype.deactivate=function(){this.head.deactivate()},Object.defineProperty(e.prototype,"output",{set:function(e){this.tail.output=e},enumerable:!1,configurable:!0}),e}();function j7(e){return{offsetX:e.offsetX,offsetY:e.offsetY,pressure:.5,tiltX:0,tiltY:0,timeStamp:e.timeStamp,pointerType:"mouse"}}var V7=function(){function e(){}return e.prototype.onMouseDown=function(e){this.output.onPointerDown(j7(e))},e.prototype.onMouseMove=function(e){this.output.onPointerMove(j7(e))},e.prototype.onMouseUp=function(e){this.output.onPointerUp(j7(e))},e}(),z7=function(){function e(){this.activePointerId=-1}return e.prototype.onPointerDown=function(e){-1===this.activePointerId&&(this.activePointerId=e.pointerId,this.output.onPointerDown(e))},e.prototype.onPointerMove=function(e){this.activePointerId===e.pointerId&&this.output.onPointerMove(e)},e.prototype.onPointerUp=function(e){this.activePointerId===e.pointerId&&(this.output.onPointerUp(e),this.activePointerId=-1)},e}(),G7=function(){function e(e){this.element=e}return e.prototype.onPointerDown=function(e){try{this.element.setPointerCapture(e.pointerId)}finally{this.output.onPointerDown(e)}},e.prototype.onPointerMove=function(e){this.output.onPointerMove(e)},e.prototype.onPointerUp=function(e){this.output.onPointerUp(e)},e}(),K7=function(){function e(){}return e.prototype.onPointerDown=function(e){this.output.onPointerDown(e)},e.prototype.onPointerMove=function(e){var t=this;(function(e){if("getCoalescedEvents"in e){var t=e.getCoalescedEvents();if(t.length>=1)return t}return[e]})(e).forEach(function(e){t.output.onPointerMove(e)})},e.prototype.onPointerUp=function(e){this.output.onPointerUp(e)},e}(),W7=function(){function e(e){var t=this;this.onPointerDown=function(e){t.output.onPointerDown(e)},this.onPointerMove=function(e){t.output.onPointerMove(e)},this.onPointerUp=function(e){t.output.onPointerUp(e)},this.element=e}return e.prototype.activate=function(){this.element.addEventListener("pointerdown",this.onPointerDown),this.element.addEventListener("pointermove",this.onPointerMove),this.element.addEventListener("pointerup",this.onPointerUp)},e.prototype.deactivate=function(){this.element.removeEventListener("pointerdown",this.onPointerDown),this.element.removeEventListener("pointermove",this.onPointerMove),this.element.removeEventListener("pointerup",this.onPointerUp)},e}(),q7=function(){function e(e){this.element=e}return e.prototype.activate=function(){this.element.addEventListener("touchmove",H7)},e.prototype.deactivate=function(){this.element.removeEventListener("touchmove",H7)},e}(),Q7=function(){function e(){}return e.prototype.onPointerDown=function(e){this.output.onPointerDown(e),R7(e)},e.prototype.onPointerMove=function(e){this.output.onPointerMove(e),R7(e)},e.prototype.onPointerUp=function(e){this.output.onPointerUp(e),R7(e)},e}(),Y7=function(){function e(e){var t,n,a,i,r;t=this.head=new W7(e),n=new G7(e),a=new Q7,i=new z7,r=this.tail=new K7,f7(t,n,a),f7(a,i,r),(/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&(this.preventDefaultOnTouchMove=new q7(e))}return e.prototype.activate=function(){var e;this.head.activate(),null===(e=this.preventDefaultOnTouchMove)||void 0===e||e.activate()},e.prototype.deactivate=function(){var e;this.head.deactivate(),null===(e=this.preventDefaultOnTouchMove)||void 0===e||e.deactivate()},Object.defineProperty(e.prototype,"output",{set:function(e){this.tail.output=e},enumerable:!1,configurable:!0}),e}(),J7=function(){function e(){this.wasPenDown=!1}return e.prototype.onPointerDown=function(e){this.wasPenDown=function(e){return"pen"===e.pointerType}(e)},e.prototype.onTouchStart=function(e){this.wasPenDown&&R7(e)},e}(),X7=function(){function e(){this.activeIdentifier=-1}return e.prototype.onTouchStart=function(e,t){-1===this.activeIdentifier&&(this.activeIdentifier=t.identifier,this.output.onTouchStart(e,t))},e.prototype.onTouchMove=function(e,t){this.activeIdentifier===t.identifier&&this.output.onTouchMove(e,t)},e.prototype.onTouchEnd=function(e,t){this.activeIdentifier===t.identifier&&(this.output.onTouchEnd(e,t),this.activeIdentifier=-1)},e}(),Z7=function(){function e(){}return e.prototype.onTouchStart=function(e){for(var t=0;t<e.changedTouches.length;t+=1)this.output.onTouchStart(e,e.changedTouches[t])},e.prototype.onTouchMove=function(e){for(var t=0;t<e.changedTouches.length;t+=1)this.output.onTouchMove(e,e.changedTouches[t])},e.prototype.onTouchEnd=function(e){for(var t=0;t<e.changedTouches.length;t+=1)this.output.onTouchEnd(e,e.changedTouches[t])},e}(),$7=function(){function e(e){var t=this;this.onTouchStart=function(e){t.output.onTouchStart(e)},this.onTouchMove=function(e){t.output.onTouchMove(e)},this.onTouchEnd=function(e){t.output.onTouchEnd(e)},this.element=e}return e.prototype.activate=function(){this.element.addEventListener("touchstart",this.onTouchStart),this.element.addEventListener("touchmove",this.onTouchMove),this.element.addEventListener("touchend",this.onTouchEnd)},e.prototype.deactivate=function(){this.element.removeEventListener("touchstart",this.onTouchStart),this.element.removeEventListener("touchmove",this.onTouchMove),this.element.removeEventListener("touchend",this.onTouchEnd)},e}(),eS=function(){function e(){}return e.prototype.onTouchStart=function(e){this.output.onTouchStart(e),R7(e)},e.prototype.onTouchMove=function(e){this.output.onTouchMove(e),R7(e)},e.prototype.onTouchEnd=function(e){this.output.onTouchEnd(e),R7(e)},e}(),tS=function(){function e(e){p7(this.head=new $7(e),new eS,new Z7,this.tail=new X7)}return e.prototype.activate=function(){this.head.activate()},e.prototype.deactivate=function(){this.head.deactivate()},Object.defineProperty(e.prototype,"output",{set:function(e){this.tail.output=e},enumerable:!1,configurable:!0}),e}();function nS(e){return 180*e/Math.PI}function aS(e,t){var n=t.target.getBoundingClientRect();return{offsetX:t.clientX-n.left,offsetY:t.clientY-n.top,pressure:t.force,tiltX:nS(Math.atan(Math.cos(t.azimuthAngle)/Math.tan(t.altitudeAngle))),tiltY:nS(Math.atan(Math.sin(t.azimuthAngle)/Math.tan(t.altitudeAngle))),timeStamp:e.timeStamp,pointerType:"touch"}}var iS=function(){function e(){}return e.prototype.onTouchStart=function(e,t){this.output.onPointerDown(aS(e,t))},e.prototype.onTouchMove=function(e,t){this.output.onPointerMove(aS(e,t))},e.prototype.onTouchEnd=function(e,t){this.output.onPointerUp(aS(e,t))},e}(),rS={type:0},oS={width:4,height:4,color:{r:0,g:0,b:0,a:1},effect:rS,tip:"ellipse",rasterOperation:"copy"};function sS(e){return{width:e.width,height:e.height,color:e.color,effect:e.effect,tip:e.tip,rasterOperation:e.rasterOperation}}var cS=function(){function e(e){this.attributes=sS(void 0!==e?e:oS)}return e.prototype.setWidth=function(e){return this.attributes.width=e,this},e.prototype.setHeight=function(e){return this.attributes.height=e,this},e.prototype.setColor=function(e){return this.attributes.color=e,this},e.prototype.setEffect=function(e){return this.attributes.effect=e,this},e.prototype.setTip=function(e){return this.attributes.tip=e,this},e.prototype.setRasterOperation=function(e){return this.attributes.rasterOperation=e,this},e.prototype.build=function(){return sS(this.attributes)},e}(),dS=function(){function e(){this.offsetX=0,this.offsetY=0}return e.prototype.setDrawingAttributes=function(e){this.output.setDrawingAttributes(1===e.effect.type?new cS(e).setEffect({type:1,pattern:e.effect.pattern,offsetX:this.offsetX,offsetY:this.offsetY}).build():e)},e.prototype.beginStroke=function(e){this.output.beginStroke(e),this.begin=e},e.prototype.addPoint=function(e){this.output.addPoint(e)},e.prototype.endStroke=function(e){this.output.endStroke(e);var t=e.x-this.begin.x,n=e.y-this.begin.y,a=t>0?48:-48;this.offsetX+=t+a,this.offsetY+=n+a,this.offsetX%=540,this.offsetY%=540},e}(),lS=function(){function e(){this.attributes=oS,this.offset=new dS}return e.prototype.setDrawingAttributes=function(e){this.attributes=e},e.prototype.beginStroke=function(e){u7(this.offset,this.output),this.out=1===this.attributes.effect.type?this.offset:this.output,this.out.setDrawingAttributes(this.attributes),this.out.beginStroke(e)},e.prototype.addPoint=function(e){this.out.addPoint(e)},e.prototype.endStroke=function(e){this.out.endStroke(e)},e}(),uS=function(){function e(e,t,n){this.wetCanvas=e,this.wetInkDryer=t,this.pointerEventInputPipelineSource=n,this.ignoreStroke=!1,this.drawingBounds=Sa}return e.prototype.getShouldIgnoreStrokeOnPointerDown=function(e){if(!function(e){return void 0===(t=e.button)||function(e,t){return e===t.initiatingButtonId}(t,t_);var t}(e))return!0;var t=this.pointerEventInputPipelineSource.getBoundingClientRect();return!Da({x:e.clientX-t.left,y:e.clientY-t.top},this.drawingBounds)},e.prototype.onPointerDown=function(e){if((function(e){return 5===e.button||32==(32&e.buttons)}(e)||function(e){return 2===e.button||2==(2&e.buttons)}(e))&&this.wetInkDryer.dryAllStrokes(),this.ignoreStroke=this.getShouldIgnoreStrokeOnPointerDown(e),!this.ignoreStroke){try{this.wetCanvas.setPointerCapture(e.pointerId)}catch(e){}this.output.onPointerDown(e)}},e.prototype.onPointerMove=function(e){this.ignoreStroke||this.output.onPointerMove(e)},e.prototype.onPointerUp=function(e){if(this.ignoreStroke)this.ignoreStroke=!1;else{this.output.onPointerUp(e);try{this.wetCanvas.releasePointerCapture(e.pointerId)}catch(e){}}},e.prototype.setDrawingBounds=function(e){this.drawingBounds=e},e}(),fS=function(){function e(e){var t=this;this.onPointerOut=function(e){t.output.onPointerOut(e)},this.element=e}return e.prototype.activate=function(){this.element.addEventListener("pointerout",this.onPointerOut)},e.prototype.deactivate=function(){this.element.removeEventListener("pointerout",this.onPointerOut)},e}(),pS=function(){function e(){}return e.prototype.onPointerDown=function(e){this.output.onPointerDown(e),this.lastStrokeInProgressEvent=e},e.prototype.onPointerMove=function(e){this.output.onPointerMove(e),this.lastStrokeInProgressEvent=e},e.prototype.onPointerUp=function(e){this.output.onPointerUp(e),this.lastStrokeInProgressEvent=void 0},e.prototype.getLastStrokeInProgressEvent=function(){return this.lastStrokeInProgressEvent},e}(),mS=function(){function e(e,t,n,a,i,r,o){if(r?f7(this.drawer=new P7(o),this.injector=new lS,n):p7(this.drawer=v7(),new y7,this.injector=new lS,n),void 0!==window.PointerEvent){var s=e,c=new Y7(s),d=new uS(i,a,s),l=new pS;p7(this.input=c,this.pointerEventTransform=d,l,this.drawer),u7(this.inputPointerUpOnPointerOut=new fS(e),function(e,t){return{onPointerOut:function(n){var a=t.getLastStrokeInProgressEvent();a&&e.head.onPointerUp(a)}}}(c,l))}else if(void 0!==window.TouchEvent){var u=new tS(e);f7(u,new iS,this.drawer),this.input=u}else{var f=new B7(e);f7(f,new V7,this.drawer),this.input=f}u7(this.preventTouchStartOnStylusDown=new T7(t),new J7)}return e.prototype.activate=function(){var e;this.input.activate(),null===(e=this.inputPointerUpOnPointerOut)||void 0===e||e.activate(),this.activateStylus()},e.prototype.deactivate=function(){var e;this.deactivateStylus(),null===(e=this.inputPointerUpOnPointerOut)||void 0===e||e.deactivate(),this.input.deactivate()},e.prototype.activateStylus=function(){this.preventTouchStartOnStylusDown.activate()},e.prototype.deactivateStylus=function(){this.preventTouchStartOnStylusDown.deactivate()},e.prototype.setDrawingAttributes=function(e){this.injector.setDrawingAttributes(e)},e.prototype.setDrawingBounds=function(e){var t;null===(t=this.pointerEventTransform)||void 0===t||t.setDrawingBounds(e)},e}(),_S=function(){function e(e){var t=this;this.isLoopActive=!1,this.animationCallback=function(){t.delegate(),t.isLoopActive&&window.requestAnimationFrame(t.animationCallback)},this.delegate=e}return e.prototype.onStrokeBegin=function(){this.isLoopActive=!0,window.requestAnimationFrame(this.animationCallback)},e.prototype.onStrokeEnd=function(){this.isLoopActive=!1},e}();function hS(e){throw e}var bS=function(){function e(e){this.context=e}return e.prototype.beginPath=function(){this.context.beginPath()},e.prototype.arc=function(e,t,n,a,i,r){this.context.arc(e,t,n,a,i,r)},e.prototype.circularArc=function(e,t,n,a,i,r,o,s,c){var d=Math.atan2(t-a,e-n),l=Math.atan2(o-a,r-n);d=d<0?2*Math.PI+d:d,l=l<0?2*Math.PI+l:l,this.arc(n,a,i,d,l,c)},e.prototype.lineTo=function(e,t){this.context.lineTo(e,t)},e.prototype.moveTo=function(e,t){this.context.moveTo(e,t)},e.prototype.closePath=function(){this.context.closePath()},e}(),gS=function(){function e(){}return e.prototype.toCSSColor=function(e){return function(e){return"rgba("+e.r+","+e.g+","+e.b+","+e.a+")"}(e)},e}(),vS=1e-6;function yS(e,t,n){return void 0===n&&(n=vS),function(e,t){return void 0===t&&(t=vS),-t<=e&&e<=t}(e-t,n)}function SS(e){return 1.5*e+.25}var DS=function(e,t,n){this.incomingTangent1={x:Number.NaN,y:Number.NaN},this.incomingTangent2={x:Number.NaN,y:Number.NaN},this.outgoingTangent1={x:Number.NaN,y:Number.NaN},this.outgoingTangent2={x:Number.NaN,y:Number.NaN},this.center={x:e,y:t},this.radius=n},IS=function(){function e(e,t){this.stroke=[],this.builder=e,this.tipRadius=t.width/2}return e.prototype.beginStroke=function(e){this.builder.beginPath(),this.stroke=[],this.addPoint(e)},e.prototype.addPoint=function(e){var t=new DS(e.x,e.y,this.tipRadius*SS(e.pressure));this.stroke.push(t)},e.prototype.endStroke=function(e){this.addPoint(e),function(e){for(var t=1;t<e.length;t++){var n=e[t-1],a=e[t],i=n.center.x,r=n.center.y,o=n.radius,s=a.center.x,c=a.center.y,d=a.radius,l=i-s,u=r-c,f=Math.sqrt(l*l+u*u),p=Math.abs(d-o);if(!(p>f)){var m=1/f,_=p*m,h=Math.sqrt(1-_*_),b=l*m,g=u*m;o>d&&(h=-h,b=-b,g=-g);var v=b*_,y=g*_,S=b*h,D=g*h,I=v+D,x=y-S,C=v-D,O=y+S;n.outgoingTangent1.x=i+o*I,n.outgoingTangent1.y=r+o*x,n.outgoingTangent2.x=i+o*C,n.outgoingTangent2.y=r+o*O,a.incomingTangent1.x=s+d*I,a.incomingTangent1.y=c+d*x,a.incomingTangent2.x=s+d*C,a.incomingTangent2.y=c+d*O}}}(this.stroke),function(e,t){for(var n=0,a=0;a<t.length;a++)(a===t.length-1||isNaN(t[a].outgoingTangent1.x))&&(xS(e,t,n,a),n=a+1)}(this.builder,this.stroke),this.builder.closePath()},e}();function xS(e,t,n,a){if(n===a){var i=t[n];return e.moveTo(i.center.x-i.radius,i.center.y),e.circularArc(i.center.x-i.radius,i.center.y,i.center.x,i.center.y,i.radius,i.center.x+i.radius,i.center.y,!1,!0),void e.circularArc(i.center.x+i.radius,i.center.y,i.center.x,i.center.y,i.radius,i.center.x-i.radius,i.center.y,!1,!0)}var r=t[n];e.moveTo(r.outgoingTangent1.x,r.outgoingTangent1.y);var o,s=r;r=t[n+1];for(var c=n+1;c<a;c++)o=t[c+1],void 0!==(l=CS(s.outgoingTangent1,r.incomingTangent1,r.outgoingTangent1,o.incomingTangent1))?e.lineTo(l.x,l.y):(e.lineTo(r.incomingTangent1.x,r.incomingTangent1.y),e.circularArc(r.incomingTangent1.x,r.incomingTangent1.y,r.center.x,r.center.y,r.radius,r.outgoingTangent1.x,r.outgoingTangent1.y,!1,!0)),s=r,r=o;var d=r.radius>t[a-1].radius;for(e.lineTo(r.incomingTangent1.x,r.incomingTangent1.y),e.circularArc(r.incomingTangent1.x,r.incomingTangent1.y,r.center.x,r.center.y,r.radius,r.incomingTangent2.x,r.incomingTangent2.y,d,!0),s=r,r=t[a-1],c=a-1;c>n;c--){var l;o=t[c-1],void 0!==(l=CS(s.incomingTangent2,r.outgoingTangent2,r.incomingTangent2,o.outgoingTangent2))?e.lineTo(l.x,l.y):(e.lineTo(r.outgoingTangent2.x,r.outgoingTangent2.y),e.circularArc(r.outgoingTangent2.x,r.outgoingTangent2.y,r.center.x,r.center.y,r.radius,r.incomingTangent2.x,r.incomingTangent2.y,!1,!0)),s=r,r=o}var u=r.radius>t[n+1].radius;e.lineTo(r.outgoingTangent2.x,r.outgoingTangent2.y),e.circularArc(r.outgoingTangent2.x,r.outgoingTangent2.y,r.center.x,r.center.y,r.radius,r.outgoingTangent1.x,r.outgoingTangent1.y,u,!0)}function CS(e,t,n,a){if(!((a.x-n.x)*(t.y-e.y)-(t.x-e.x)*(a.y-n.y)>0)){var i=t.y-e.y,r=e.x-t.x,o=i*e.x+r*e.y,s=a.y-n.y,c=n.x-a.x,d=s*n.x+c*n.y,l=i*c-s*r;if(void 0===_&&(_=vS),(m=l)<-_||_<m){var u=1/l,f=(c*o-r*d)*u,p=(i*d-s*o)*u;if(OS(f,p,e,t)&&OS(f,p,n,a))return{x:f,y:p}}}var m,_}function OS(e,t,n,a){return(Math.min(n.x,a.x)<e||yS(Math.min(n.x,a.x),e))&&(Math.max(n.x,a.x)>e||yS(Math.max(n.x,a.x),e))&&(Math.min(n.y,a.y)<t||yS(Math.min(n.y,a.y),t))&&(Math.max(n.y,a.y)>t||yS(Math.max(n.y,a.y),t))}function wS(e,t,n,a,i,r,o){var s=e.x-t,c=e.y-n,d=e.x+t,l=e.y+n,u=a.x-i,f=a.y-r,p=a.x+i,m=a.y+r;if(u>=s&&f>=c&&p<=d&&m<=l||s>=u&&c>=f&&d<=p&&l<=m)return!1;var _=a.x-e.x>0?1:-1,h=a.y-e.y>0?1:-1;return o.p1.x=e.x-h*t,o.p1.y=e.y+_*n,o.p2.x=e.x+h*t,o.p2.y=e.y-_*n,o.p3.x=a.x+h*i,o.p3.y=a.y-_*r,o.p4.x=a.x-h*i,o.p4.y=a.y+_*r,!0}var ES=2*Math.PI;function AS(e,t,n){e.arc(t.x,t.y,n,0,ES)}function LS(e,t,n,a){var i=t.x-n,r=t.x+n,o=t.y-a,s=t.y+a;e.moveTo(i,o),e.lineTo(r,o),e.lineTo(r,s),e.lineTo(i,s),e.lineTo(i,o)}function kS(e,t){e.moveTo(t.p1.x,t.p1.y),e.lineTo(t.p2.x,t.p2.y),e.lineTo(t.p3.x,t.p3.y),e.lineTo(t.p4.x,t.p4.y),e.lineTo(t.p1.x,t.p1.y)}var MS=function(){function e(e,t){this.quad={p1:{x:0,y:0},p2:{x:0,y:0},p3:{x:0,y:0},p4:{x:0,y:0}},this.builder=e,this.tipRadius=t.width/2}return e.prototype.beginStroke=function(e){this.builder.beginPath(),this.updateRadius(e),AS(this.builder,e,this.radius),this.lastPoint=e},e.prototype.addPoint=function(e){this.updateRadius(e),function(e,t,n,a,i){var r=n.x-e.x,o=n.y-e.y,s=Math.sqrt(r*r+o*o);if(s<=Math.abs(a-t))return!1;var c=r/s,d=-o/s,l=(a-t)/s,u=Math.sqrt(1-l*l),f=d*u+c*l,p=c*u-d*l,m=d*u-c*l,_=c*u+d*l;return i.p1.x=e.x-f*t,i.p1.y=e.y-p*t,i.p2.x=n.x-f*a,i.p2.y=n.y-p*a,i.p3.x=n.x+m*a,i.p3.y=n.y+_*a,i.p4.x=e.x+m*t,i.p4.y=e.y+_*t,!0}(e,this.radius,this.lastPoint,this.lastRadius,this.quad)&&(kS(this.builder,this.quad),AS(this.builder,e,this.radius)),this.lastPoint=e},e.prototype.endStroke=function(e){this.addPoint(e),this.builder.closePath()},e.prototype.updateRadius=function(e){this.lastRadius=this.radius,this.radius=this.tipRadius*SS(e.pressure)},e}(),PS=function(){function e(e){this.builder=e}return e.prototype.beginStroke=function(e){this.builder.beginPath(),this.builder.moveTo(e.x,e.y)},e.prototype.addPoint=function(e){this.builder.lineTo(e.x,e.y)},e.prototype.endStroke=function(e){this.addPoint(e)},e}(),TS=function(e,t,n,a){this.center={x:e,y:t},this.halfWidth=n,this.halfHeight=a},US=function(){function e(e,t){this.stroke=[],this.quads=[],this.builder=e,this.tipWidth=t.width/2,this.tipHeight=t.height/2}return e.prototype.beginStroke=function(e){this.builder.beginPath(),this.stroke=[],this.quads=[],this.addPoint(e)},e.prototype.addPoint=function(e){var t,n,a,i,r=SS(e.pressure),o=new TS(e.x,e.y,this.tipWidth*r,this.tipHeight*r),s=this.stroke.length;s>0&&(t=this.stroke[s-1],n=o,a=this.quads,i={p1:{x:0,y:0},p2:{x:0,y:0},p3:{x:0,y:0},p4:{x:0,y:0}},wS(t.center,t.halfWidth,t.halfHeight,n.center,n.halfWidth,n.halfHeight,i)&&a.push(i)),this.stroke.push(o)},e.prototype.endStroke=function(e){this.addPoint(e),function(e,t,n){if(FS(e,t[0]),0!==n.length){e.moveTo(n[0].p1.x,n[0].p1.y);for(var a=0;a<n.length;a++)e.lineTo(n[a].p2.x,n[a].p2.y),e.lineTo(n[a].p3.x,n[a].p3.y);for(a=n.length-1;a>=0;a--)e.lineTo(n[a].p4.x,n[a].p4.y),e.lineTo(n[a].p1.x,n[a].p1.y);t.length>2&&FS(e,t[t.length-2]),FS(e,t[t.length-1])}}(this.builder,this.stroke,this.quads),this.builder.closePath()},e}();function FS(e,t){LS(e,t.center,t.halfWidth,t.halfHeight)}var HS=function(){function e(e,t){this.quad={p1:{x:0,y:0},p2:{x:0,y:0},p3:{x:0,y:0},p4:{x:0,y:0}},this.builder=e,this.tipHalfWidth=t.width/2,this.tipHalfHeight=t.height/2}return e.prototype.beginStroke=function(e){this.builder.beginPath(),this.updateSize(e),LS(this.builder,e,this.halfWidth,this.halfHeight),this.lastPoint=e},e.prototype.addPoint=function(e){this.updateSize(e),wS(e,this.halfWidth,this.halfHeight,this.lastPoint,this.lastHalfWidth,this.lastHalfHeight,this.quad)&&(kS(this.builder,this.quad),LS(this.builder,e,this.halfWidth,this.halfHeight)),this.lastPoint=e},e.prototype.endStroke=function(e){this.addPoint(e),this.builder.closePath()},e.prototype.updateSize=function(e){this.lastHalfWidth=this.halfWidth,this.lastHalfHeight=this.halfHeight;var t=SS(e.pressure);this.halfWidth=this.tipHalfWidth*t,this.halfHeight=this.tipHalfHeight*t},e}(),RS=function(){function e(e,t,n){void 0===n&&(n=new gS),this.renderMode=0,this.context=e,this.canvasPathBuilder=new bS(e),this.effectResolver=t,this.colorResolver=n}return e.prototype.setDrawingAttributes=function(e){this.attributes=e},e.prototype.beginStroke=function(e){this.pathBuilder=this.makeNewPathBuilder(),this.pathBuilder.beginStroke(e),this.beginPoint=e},e.prototype.addPoint=function(e){this.pathBuilder.addPoint(e)},e.prototype.endStroke=function(e){this.pathBuilder.endStroke(e),this.context.save(),function(e,t,n,a,i){e.lineWidth=t.height;var r=function(e,t,n,a,i){if(1===t.effect.type){var r=t.effect,o=n.toCanvasImageSource(r);if(void 0!==o){var s=e.createPattern(o,"repeat");if(null!==s)return e.scale(.5,.5),e.lineWidth=t.width/.5,e.translate(i.x-r.offsetX,i.y-r.offsetY),s}}return a.toCSSColor(t.color,t)}(e,t,n,a,i);switch(e.strokeStyle=r,e.fillStyle=r,t.tip){case"ellipse":e.lineCap="round",e.lineJoin="round";break;case"rectangle":e.lineCap="butt",e.lineJoin="miter";break;default:hS(t.tip)}switch(t.rasterOperation){case"copy":e.globalCompositeOperation="source-over";break;case"mask":e.globalCompositeOperation="darken";break;default:hS(t.rasterOperation)}}(this.context,this.attributes,this.effectResolver,this.colorResolver,this.beginPoint),2===this.renderMode?this.context.stroke():this.context.fill(),this.context.restore()},e.prototype.makeNewPathBuilder=function(){switch(this.renderMode){case 0:return"ellipse"===this.attributes.tip?new MS(this.canvasPathBuilder,this.attributes):new HS(this.canvasPathBuilder,this.attributes);case 1:return"ellipse"===this.attributes.tip?new IS(this.canvasPathBuilder,this.attributes):new US(this.canvasPathBuilder,this.attributes);case 2:return new PS(this.canvasPathBuilder);default:hS(this.renderMode)}},e}(),NS=function(){function e(){}return e.prototype.toCanvasImageSource=function(){},e.prototype.toSVGImageElement=function(){},e}(),BS={alpha:!0,desynchronized:!1};function jS(e){return function(e,t){var n=e.getContext("2d",t);if(null===n)throw new Error("Could not get 2D context from canvas.");return n}(e,BS)}var VS=function(){function e(e,t){var n,a=this;this.strokeBeginEndListener={onStrokeBegin:function(){a.renderLoop.onStrokeBegin()},onStrokeEnd:function(){a.renderLoop.onStrokeEnd()}},this.isIncrementalRender=!0,this.render=function(){a.isIncrementalRender||a.clear(),a.store.streamWetStroke(a.wetRenderer,a.isIncrementalRender)},this.store=t,this.wetCanvasContext=jS(e),this.wetRenderer=(n=this.wetCanvasContext,new RS(n,new NS)),this.renderLoop=new _S(this.render)}return e.prototype.clear=function(){var e;(e=this.wetCanvasContext).save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.restore()},e.prototype.setIncrementalRender=function(e){this.isIncrementalRender=e},e.prototype.onStrokeBegin=function(){this.strokeBeginEndListener.onStrokeBegin()},e.prototype.onStrokeEnd=function(){this.strokeBeginEndListener.onStrokeEnd()},e}();function zS(){}var GS=function(){function e(){this.baseId=0}return e.prototype.generate=function(){return this.baseId+=1},e}(),KS=function(){function e(){this.id=0,this.drawingAttributes=oS,this.points=[]}return e.prototype.streamChannels=function(e){this.points.forEach(function(t){e.addPoint(t),e.addPressure(function(e){return e.pressure}(t)),e.addTilt(t),e.addTimestamp(function(e){return e.timestamp}(t))})},e.prototype.streamPoints=function(e){this.points.forEach(function(t){e.add(t)})},e.prototype.streamPath=function(e){WS(this,e,0)},e.prototype.stream=function(e){qS(this,e,0)},e.prototype.add=function(e){this.points.push(e)},e}();function WS(e,t,n){if(n+2>e.points.length)return n;t.beginStroke(e.points[n]);for(var a=n+1;a<e.points.length-1;a+=1)t.addPoint(e.points[a]);return t.endStroke(e.points[e.points.length-1]),e.points.length-1}function qS(e,t,n){return t.setDrawingAttributes(e.drawingAttributes),WS(e,t,n)}var QS=function(){function e(e){this.idGenerator=new GS,this.currentStroke=new KS,this.isLineMode=!1,this.inputStrokes=[],this.newPointsIndex=0,this.noop={add:zS},this.output=this.noop,this.beginEndSink=e}return e.prototype.setDrawingAttributes=function(e){this.currentStroke.drawingAttributes=e},e.prototype.beginStroke=function(e){this.newPointsIndex=0,this.currentStroke.id=this.idGenerator.generate(),this.beginEndSink.onStrokeBegin(),this.output=this.currentStroke,this.output.add(this.isLineMode?this.getConstantPressurePoint(e):e)},e.prototype.addPoint=function(e){this.isLineMode&&1===this.currentStroke.points.length?this.output.add(this.getConstantPressurePoint(e)):this.isLineMode&&this.currentStroke.points.length>1?this.currentStroke.points[this.currentStroke.points.length-1]=this.getConstantPressurePoint(e):this.output.add(e)},e.prototype.endStroke=function(e){this.output!==this.noop&&(this.isLineMode&&this.currentStroke.points.length>1?this.currentStroke.points[this.currentStroke.points.length-1]=this.getConstantPressurePoint(e):this.output.add(e),this.inputStrokes.push([this.currentStroke,this.newPointsIndex]),this.cancel())},e.prototype.makeCurrentStrokeStraight=function(){var e=this.currentStroke.points.length;e>=2&&(this.linePressure=this.getAveragePressureAcrossStroke(this.currentStroke),0===this.linePressure&&(this.linePressure=m7),this.currentStroke.points.splice(1,e-2),this.currentStroke.points[0]=this.getConstantPressurePoint(this.currentStroke.points[0]),this.currentStroke.points[1]=this.getConstantPressurePoint(this.currentStroke.points[1]))},e.prototype.cancel=function(){this.output!==this.noop&&(this.output=this.noop,this.linePressure=void 0,this.currentStroke=new KS,this.beginEndSink.onStrokeEnd())},e.prototype.streamCollectedStrokes=function(e){this.inputStrokes.forEach(function(t){e.add(t[0]),t[1]=t[0].points.length-1})},e.prototype.streamCollectedStrokesNewPoints=function(e){this.inputStrokes.forEach(function(t){t[1]=qS(t[0],e,t[1])})},e.prototype.resetCollectedStrokes=function(){this.inputStrokes=[]},e.prototype.streamCurrentStroke=function(e){this.newPointsIndex=qS(this.currentStroke,e,0)},e.prototype.streamCurrentStrokeNewPoints=function(e){this.newPointsIndex=qS(this.currentStroke,e,this.newPointsIndex)},e.prototype.getAveragePressureAcrossStroke=function(e){for(var t=0,n=0;n<e.points.length;n+=1)t+=e.points[n].pressure;return 0===t||0===e.points.length?0:t/e.points.length},e.prototype.getConstantPressurePoint=function(e){return void 0===this.linePressure&&(this.linePressure=0===e.pressure?m7:e.pressure),{x:e.x,y:e.y,pressure:this.linePressure,tiltX:e.tiltX,tiltY:e.tiltY,timestamp:e.timestamp}},e}(),YS=function(){function e(){var e=this;this.collectedWetStrokesSink=null,this.wetStrokeCollector=new QS({onStrokeBegin:function(){e.wetInkDryer.onStrokeBegin()},onStrokeEnd:function(){e.wetInkDryer.onStrokeEnd()}})}return e.prototype.streamWetStroke=function(e,t){t?(this.wetStrokeCollector.streamCurrentStrokeNewPoints(e),this.wetStrokeCollector.streamCollectedStrokesNewPoints(e)):(this.wetStrokeCollector.streamCurrentStroke(e),this.wetStrokeCollector.streamCollectedStrokes({add:function(t){t.stream(e)}}))},e.prototype.setCollectedWetStrokesSink=function(e){this.collectedWetStrokesSink=e},e.prototype.clearCollectedWetStrokesSink=function(){this.collectedWetStrokesSink=null},e.prototype.setInkDryer=function(e){this.wetInkDryer=e,this.initializeDryStrokesCallback()},e.prototype.initializeDryStrokesCallback=function(){var e=this;this.wetInkDryer.setTask(function(){e.wetStrokeCollector.streamCollectedStrokes({add:function(t){var n;null===(n=e.collectedWetStrokesSink)||void 0===n||n.add(t)}}),e.wetStrokeCollector.resetCollectedStrokes()})},e.prototype.dryAllStrokes=function(){this.wetInkDryer.dryAllStrokes()},e.prototype.getWetStrokeCollector=function(){return this.wetStrokeCollector},e}(),JS=function(){function e(e,t){var n=this;this.task=function(){},this.executeTask=function(){n.task(),n.renderer.clear(),n.resetPendingTask()},this.renderer=e,this.idleTimeToDryInkInMs=t}return e.prototype.setTask=function(e){this.task=e},e.prototype.onStrokeBegin=function(){this.renderer.onStrokeBegin(),void 0!==this.timeoutTask&&this.resetPendingTask()},e.prototype.onStrokeEnd=function(){this.renderer.onStrokeEnd(),this.timeoutTask=window.setTimeout(this.executeTask,this.idleTimeToDryInkInMs)},e.prototype.dryAllStrokes=function(){this.executeTask(),this.resetPendingTask()},e.prototype.resetPendingTask=function(){window.clearTimeout(this.timeoutTask)},e}();function XS(e,t){var n=Object(iu.e)(e);if(!n)throw new Error("A valid color must be provided: "+e);return{r:n.r,g:n.g,b:n.b,a:t}}function ZS(e){var t=jS(e),n=e.width/(e.clientWidth||1),a=e.height/(e.clientHeight||1);t.setTransform(1,0,0,1,0,0),t.scale(n,a)}var $S,e4=function(){function e(e,t,n,a,i){this.wetCanvas=e,ZS(e),this.store=new YS,this.renderer=new VS(this.wetCanvas,this.store);var r=new JS(this.renderer,n);this.store.setInkDryer(r),this.pipeline=new mS(this.wetCanvas,t,this.store.getWetStrokeCollector(),r,this.wetCanvas,a,i)}return e.prototype.startPipeline=function(){this.pipeline.activate(),this.enableCanvasPointerEvents()},e.prototype.stopPipeline=function(){this.disableCanvasPointerEvents(),this.renderer.clear(),this.pipeline.deactivate()},e.prototype.enableCanvasPointerEvents=function(){this.wetCanvas.style.pointerEvents="auto"},e.prototype.disableCanvasPointerEvents=function(){this.wetCanvas.style.pointerEvents="none"},e.prototype.updateInkAttributes=function(e){var t=function(e){var t=new cS,n=e.inkType,a=e.htmlColor,i=e.thicknessInCssPixels;switch(n){case kr.Highlighter:var r=XS(a,.5);t.setTip("rectangle").setWidth(i/2).setHeight(i).setColor(r).setRasterOperation("copy");break;case kr.Pen:r=XS(a,1),t.setTip("ellipse").setWidth(i).setHeight(i).setColor(r).setRasterOperation("copy");break;default:throw new ec(n)}return t.build()}(e);this.pipeline.setDrawingAttributes(t),this.renderer.setIncrementalRender(function(e){switch(e){case kr.Highlighter:return!1;case kr.Pen:return!0;default:throw new ec(e)}}(e.inkType))},e.prototype.setCollectedWetStrokesSink=function(e){this.store.setCollectedWetStrokesSink(e)},e.prototype.clearCollectedWetStrokesSink=function(){this.store.clearCollectedWetStrokesSink()},e.prototype.onCanvasDimensionsUpdated=function(e){ZS(e)},e.prototype.dryAllStrokes=function(){this.store.dryAllStrokes()},e.prototype.setDrawingBounds=function(e){this.pipeline.setDrawingBounds(e)},e}(),t4=function(){return t4=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},t4.apply(this,arguments)},n4=Object(o.memo)(function(e){var t=e.cropViewTransform,n=e.cssToPhysicalPixelRatio,a=e.width,i=e.height,r=e.cssWidth,c=e.cssHeight,d=e.styles,l=Object(o.useContext)(t7),u=l.wetInkCanvas,f=l.setWetInkCanvas,p=Object(o.useRef)(),m=Object(o.useState)(null),_=m[0],h=m[1],b=Object(o.useState)(null),g=b[0],v=b[1];return Zm(g),Object(o.useEffect)(function(){if(g&&_){var e=function(e,t){return new e4(e,t,0,!0,.5)}(g,_);e.startPipeline(),f(e)}return function(){var e;null===(e=p.current)||void 0===e||e.stopPipeline(),f(void 0)}},[g,_,f]),p.current=u,function(e,t,n,a){var i=Object(o.useCallback)(function(){if(e){var i=(null==t?void 0:t.clientWidth)||0,r=(null==t?void 0:t.clientHeight)||0;e.style.width=i+"px",e.style.height=r+"px",function(e,t){if(e){e.restore(),e.save(),e.beginPath();var n=Bn(t),a=n[0],i=n[1],r=n[2],o=n[3];e.moveTo(a.x,a.y),e.lineTo(i.x,i.y),e.lineTo(r.x,r.y),e.lineTo(o.x,o.y),e.clip()}}(e.getContext("2d"),a),null==n||n.onCanvasDimensionsUpdated(e)}},[e,a,t,n]);qg(t,i)}(g,_,u,t),function(e,t,n){Object(o.useEffect)(function(){var a=Aa(Vn(Cn(1/n),t));null==e||e.setDrawingBounds(a)},[t,n,e])}(u,t,n),s.a.createElement("div",{ref:h,style:{width:r,height:c,position:"absolute",top:0,left:0}},s.a.createElement("canvas",{ref:v,width:a,height:i,style:t4({touchAction:"none",pointerEvents:"none",position:"absolute",top:0,left:0},d)}))}),a4=function(){return a4=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a4.apply(this,arguments)},i4=function(){function e(e,t,n){this.arrowLength=e*Math.cos(t/2),this.arrowWidth=e*Math.sin(t/2),this.directionThreshold=n}return e.prototype.getArrowhead=function(e){var t=this.getDirection();if(null===t)return null;var n=Math.sqrt(w7(t,t)),a={x:t.x/n,y:t.y/n},i=-a.y,r=a.x,o=a4(a4({},e),{pressure:this.getPressure()});return{vertex:o,left:{x:o.x-this.arrowLength*a.x+this.arrowWidth*i,y:o.y-this.arrowLength*a.y+this.arrowWidth*r,pressure:o.pressure,tiltX:o.tiltX,tiltY:o.tiltY,timestamp:o.timestamp},right:{x:o.x-this.arrowLength*a.x-this.arrowWidth*i,y:o.y-this.arrowLength*a.y-this.arrowWidth*r,pressure:o.pressure,tiltX:o.tiltX,tiltY:o.tiltY,timestamp:o.timestamp}}},e}(),r4=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),o4=function(e){function t(t,n,a){var i=e.call(this,t,n,a)||this;return i.candidatePoints=[],i}return r4(t,e),t.prototype.addPoint=function(e){if(0===this.candidatePoints.length)this.candidatePoints.push(e);else{for(;this.candidatePoints.length>0&&A7(this.candidatePoints[0],e)>this.directionThreshold;)this.nearestPointFartherThanThreshold=this.candidatePoints[0],this.candidatePoints.shift();this.candidatePoints.push(e)}},t.prototype.getDirection=function(){return void 0===this.nearestPointFartherThanThreshold?null:E7(this.candidatePoints[this.candidatePoints.length-1],this.nearestPointFartherThanThreshold)},t.prototype.getPressure=function(){return Math.max.apply(Math,Array.from(this.candidatePoints).map(function(e){return e.pressure}))},t}(i4),s4=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),c4=function(e){function t(t,n,a){var i=e.call(this,t,n,a)||this;return i.pressure=m7,i.nextPoints=[],i}return s4(t,e),t.prototype.addPoint=function(e){0===this.nextPoints.length?(this.nextPoints.push(e),this.pressure=e.pressure):1===this.nextPoints.length&&(A7(this.nextPoints[0],e)>this.directionThreshold?this.nextPoints.push(e):this.pressure=Math.max(this.pressure,e.pressure))},t.prototype.getDirection=function(){return this.nextPoints.length<=1?null:E7(this.nextPoints[0],this.nextPoints[1])},t.prototype.getPressure=function(){return this.pressure},t}(i4),d4=function(){function e(e,t,n,a){this.strokeLengthThreshold=n,this.startArrowAdder=new c4(e,t,a),this.endArrowAdder=new o4(e,t,a),this.pendingPoints=[],this.strokeLength=0}return e.prototype.beginStroke=function(e){this.prevPoint=e,this.endArrowAdder.addPoint(e),this.startArrowAdder.addPoint(e),this.pendingPoints.push(e)},e.prototype.addPoint=function(e){this.strokeLength+=A7(e,this.prevPoint),this.startArrowAdder.addPoint(e),null!==this.startArrowAdder.getDirection()&&this.strokeLength>this.strokeLengthThreshold?this.validateAndAddStartArrowhead(!0):this.pendingPoints.push(e),this.endArrowAdder.addPoint(e),0===this.pendingPoints.length&&this.output.addPoint(e),this.prevPoint=e},e.prototype.endStroke=function(e){if(this.strokeLength+=A7(e,this.prevPoint),this.startArrowAdder.addPoint(e),this.validateAndAddStartArrowhead(this.strokeLength>this.strokeLengthThreshold),this.endArrowAdder.addPoint(e),this.strokeLength>this.strokeLengthThreshold){var t=this.endArrowAdder.getArrowhead(e);null!==t&&(this.output.addPoint(t.vertex),this.output.addPoint(t.left),this.output.addPoint(t.vertex),this.output.addPoint(t.right))}this.output.endStroke(e)},e.prototype.validateAndAddStartArrowhead=function(e){var t=this;0!==this.pendingPoints.length&&(this.pendingPoints.forEach(function(n,a){if(0===a){t.output.beginStroke(n);var i=t.startArrowAdder.getArrowhead(n);null!==i&&e&&(t.output.addPoint(i.left),t.output.addPoint(i.vertex),t.output.addPoint(i.right),t.output.addPoint(i.vertex))}else t.output.addPoint(n)}),this.pendingPoints=[])},e}(),l4=function(){function e(e,t,n,a){this.strokeLengthThreshold=n,this.endArrowAdder=new o4(e,t,a),this.strokeLength=0}return e.prototype.beginStroke=function(e){this.prevPoint=e,this.endArrowAdder.addPoint(e),this.output.beginStroke(e)},e.prototype.addPoint=function(e){this.strokeLength+=A7(e,this.prevPoint),this.endArrowAdder.addPoint(e),this.prevPoint=e,this.output.addPoint(e)},e.prototype.endStroke=function(e){if(this.strokeLength+=A7(e,this.prevPoint),this.endArrowAdder.addPoint(e),this.strokeLength>this.strokeLengthThreshold){var t=this.endArrowAdder.getArrowhead(e);null!==t&&(this.output.addPoint(t.vertex),this.output.addPoint(t.left),this.output.addPoint(t.vertex),this.output.addPoint(t.right))}this.output.endStroke(e)},e}();!function(e){e[e.NoArrow=0]="NoArrow",e[e.InkSingleArrow=1]="InkSingleArrow",e[e.InkDoubleArrow=2]="InkDoubleArrow"}($S||($S={}));var u4=3*Math.sqrt(2),f4=Math.PI/2,p4=function(){function e(e){void 0===e&&(e=1),this.path="",this.precision=e}return e.prototype.beginPath=function(){this.path=""},e.prototype.arc=function(e,t,n){var a=this.format(n),i=this.format(t),r=this.format(e-n),o=this.format(e+n);this.path+="M"+r+","+i,this.path+="A"+a+","+a+" 0 0,1 "+o+","+i,this.path+="A"+a+","+a+" 0 0,1 "+r+","+i},e.prototype.circularArc=function(e,t,n,a,i,r,o,s,c){this.path+="A"+this.format(i)+","+this.format(i)+" 0 "+(s?1:0)+" "+(c?0:1)+" "+this.format(r)+","+this.format(o)},e.prototype.lineTo=function(e,t){this.path+="L"+this.format(e)+","+this.format(t)},e.prototype.moveTo=function(e,t){this.path+="M"+this.format(e)+","+this.format(t)},e.prototype.closePath=function(){},e.prototype.getPath=function(){return this.path},e.prototype.format=function(e){return t=e,n=this.precision,""+parseFloat(t.toFixed(n));var t,n},e}(),m4=function(){function e(e,t){void 0===t&&(t=1),this.attributes=e,this.svgPathBuilder=new p4(t)}return e.prototype.beginStroke=function(e){this.output="ellipse"===this.attributes.tip?new IS(this.svgPathBuilder,this.attributes):new HS(this.svgPathBuilder,this.attributes),this.output.beginStroke(e)},e.prototype.addPoint=function(e){this.output.addPoint(e)},e.prototype.endStroke=function(e){this.output.endStroke(e)},e.prototype.getSvgAttributes=function(){var e=new gS;return{path:this.svgPathBuilder.getPath(),fill:e.toCSSColor(this.attributes.color)}},e}();function _4(e){switch(e){case Lr.SingleArrow:return 40;case Lr.DoubleArrow:return 50;default:throw new ec(e)}}var h4=function(){return h4=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},h4.apply(this,arguments)};var b4=function(){return b4=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},b4.apply(this,arguments)},g4=Object(o.memo)(function(e){var t=Object(o.useContext)(Z6).fabricCanvas,n=function(e){switch(e){case"Eraser":return!1;case"Highlighter":case"Pen":return!0;default:throw new ec(e)}}(e.activeMarkupToolType)&&null!==t,a=Object(o.useContext)($6).fabric,i=Object(o.useMemo)(function(){if(a)return function(e,t){return function(n){return function(e,t,n){if(t.contentType===Ss.InkContent)return function(e,t,n){var a=function(e,t,n){var a=t.fill,i=t.path;return new e.Path(i,{fill:a,id:n})}(e,function(e){var t=e.points,n=e.drawingAttributes,a=e.arrowMode,i=h4(h4({},n),{effect:rS}),r=function(e,t){var n=new KS;return n.points=e,n.drawingAttributes=t,n}(t,i),o=n.width,s=new m4(i);if(a===Lr.NoArrow)r.streamPath(s);else{var c=function(e,t,n){var a,i,r,o,s=t*(null!==(a=null==n?void 0:n.arrowSize)&&void 0!==a?a:u4),c=null!==(i=null==n?void 0:n.arrowAngle)&&void 0!==i?i:f4,d=null!==(r=null==n?void 0:n.directionThreshold)&&void 0!==r?r:5,l=null!==(o=null==n?void 0:n.strokeLengthThreshold)&&void 0!==o?o:50;if(c<0||c>=Math.PI)return null;switch(e){case $S.InkSingleArrow:return new l4(s,c,l,d);case $S.InkDoubleArrow:return new d4(s,c,l,d);case $S.NoArrow:default:return null}}(function(e){switch(e){case Lr.NoArrow:return $S.NoArrow;case Lr.SingleArrow:return $S.InkSingleArrow;case Lr.DoubleArrow:return $S.InkDoubleArrow;default:throw new ec(e)}}(a),o,{directionThreshold:100,strokeLengthThreshold:_4(a)});if(null===c)throw new Error("Arrow head transformer should not be null");u7(c,s),r.streamPath(c)}return s.getSvgAttributes()}(t),t.id);return function(e,t,n,a){var i,r=function(e,t,n,a){var i=Vn(t,n);return e.util.multiplyTransformMatrices(Yn(i),a)}(e,t,n,a.calcTransformMatrix());r7(e,a,r),a.fabricToViewTransform=Vn(Tn(t),[(i=function(e){if(6!==e.length)throw new TypeError("Invalid number array: must contain 6 elements");return[e[0],e[1],e[2],e[3],e[4],e[5]]}(a.calcTransformMatrix()))[0],i[2],i[4],i[1],i[3],i[5]])}(e,n,t.initialInvertedPhysicalImageTransform,a),a}(e,t,n);throw new Error("To be implemented for "+t.contentType)}(e,n,t)}}(a,e.imageViewTransform)},[a,e.imageViewTransform]);return s.a.createElement("div",{style:{cursor:e.cursor,display:e.hidden?"none":void 0}},s.a.createElement(l7,b4({},e,{convertToFabricContent:i})),n&&s.a.createElement(n4,b4({},e)))}),v4=Object(o.memo)(function(e){var t=e.inkBrush;return function(e,t){Object(o.useLayoutEffect)(function(){e&&e.updateInkAttributes(t)},[e,t])}(Object(o.useContext)(t7).wetInkCanvas,t),null}),y4=function(){return y4=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},y4.apply(this,arguments)},S4=Object(o.memo)(function(e){var t=e.imageViewTransform,n=e.cssToPhysicalPixelRatio,a=e.addInkContent,i=e.inkBrush,r=Object(o.useContext)(t7).wetInkCanvas,c=Object(o.useContext)($6).fabric;return function(e,t){Object(o.useEffect)(function(){return e&&e.setCollectedWetStrokesSink({add:function(e){t(e)}}),function(){null==e||e.clearCollectedWetStrokesSink()}},[e,t])}(r,Object(o.useCallback)(function(e){c&&a(y4(y4({},e),{arrowMode:i.arrowMode||Lr.NoArrow,contentType:Ss.InkContent,initialInvertedPhysicalImageTransform:Vn(Tn(t),Cn(n))}))},[a,n,c,t,i.arrowMode])),s.a.createElement(v4,y4({},e))}),D4={Pen:{cssThicknesses:[1,2,4,6,8,12],minSliderValue:1},Highlighter:{cssThicknesses:[8,12,16,24,28,32],minSliderValue:1}},I4=function(e){var t=e.children,a=Object(o.useState)(null),i=a[0],r=a[1],c=Se(),d=Object(o.useCallback)(function(){n.e(365).then(n.t.bind(null,4114,7)).then(function(e){r(e.default.fabric)}).catch(function(e){return c({id:"CodeSplitFailed",message:"Failed to load Fabric package"})})},[c]);return s.a.createElement($6.Provider,{value:{fabric:i,loadFabric:d}},t)};function x4(){return n.e(365).then(n.t.bind(null,4114,7))}var C4={markup_inkToolbarPenTooltip:"",markup_inkToolbarPenAriaLabel:"",markup_inkToolbarPenAriaDescription:"",markup_inkToolbarEraserTooltip:"",markup_inkToolbarEraserAriaLabel:"",markup_inkToolbarEraserAriaDescription:"",markup_inkToolbarHighlighterTooltip:"",markup_inkToolbarHighlighterAriaLabel:"",markup_inkToolbarHighlighterAriaDescription:"",markup_inkToolbarClearAllInkTooltip:"",markup_inkToolbarClearAllInkAriaLabel:"",markup_inkToolbarThickness:"",markup_clearAllInkDialogCloseButtonAriaLabel:"",markup_clearAllInkDialogTitle:"",markup_clearAllInkDialogSubText:"",markup_clearAllInkDialogConfirmButtonText:"",markup_clearAllInkDialogConfirmButtonAriaLabel:"",markup_clearAllInkDialogCancelButtonText:"",markup_clearAllInkDialogCancelButtonAriaLabel:"",markup_inkToolbarBrushFormatString:"",markup_inkToolbarTooltipChangeInkProperties:"",markup_inkThicknessSliderHeaderLabel:"",markup_inkThicknessSliderAriaLabel:"",markup_addedInkStrokeAriaLive:"",markup_removedInkStrokesAriaLive:"",markup_clearedAllInkStrokesAriaLive:"",markup_inkPenThicknessSliderAriaLabel:"",markup_inkHighlighterThicknessSliderAriaLabel:"",markup_inkToolbarAriaLandmark:"",markup_colorDarkYellow:"",markup_colorLightOrange:"",markup_colorOrange:"",markup_colorRed:"",markup_colorDarkPurple:"",markup_colorPurple:"",markup_colorMagenta:"",markup_colorDarkRed:"",markup_colorLightBlue:"",markup_colorBlue:"",markup_colorDarkBlue:"",markup_colorLightGreen:"",markup_colorGreen:"",markup_colorLightGray:"",markup_colorGray:"",markup_colorBlack:"",markup_colorTableAriaLabel:"",markup_noArrowButtonText:"",markup_noArrowButtonTooltip:"",markup_noArrowButtonAriaLabel:"",markup_singleArrowButtonText:"",markup_singleArrowButtonTooltip:"",markup_singleArrowButtonAriaLabel:"",markup_doubleArrowButtonText:"",markup_doubleArrowButtonTooltip:"",markup_doubleArrowButtonAriaLabel:"",markup_inkToolbarSingleArrowTip:"",markup_inkToolbarDoubleArrowTips:""};function O4(e){var t;return null!==(t=null==e?void 0:e.inkToolbarPosition)&&void 0!==t?t:"Bottom"}var w4=function(e){var t=e.enableMarkup,n=void 0===t||t,a=e.inkConfigurations,i=void 0===a?D4:a,r=e.localizationStrings,c=void 0===r?C4:r,d=e.getInkToolbarPosition,l=void 0===d?O4:d,u=e.initialInkBrushConfigurations,f=void 0===u?Sc:u,p=e.inkToolbarStyles,m=void 0===p?void 0:p,_=e.children,h=e.enableArrowhead,b=void 0!==h&&h,g=Object(o.useState)(Ic),v=g[0],y=g[1],S=Object(o.useState)(!1),D=S[0],I=S[1],x=wc(f);return s.a.createElement(xc.Provider,{value:{enableMarkup:n,Canvas:g4,canvasMethods:v,setCanvasMethods:y,InkCanvasInteraction:S4,inkConfigurations:i,getInkToolbarPosition:l,localizationStrings:c,scriptsToLoadJSBundles:[x4],inkBrushConfigurations:x,inkToolbarStyles:m,enableArrowhead:b,wetCanvasIsReady:D,setWetCanvasIsReady:I}},s.a.createElement(n7,null,s.a.createElement(I4,null,s.a.createElement(e7,null,_))))},E4=function(){return E4=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},E4.apply(this,arguments)},A4={width:24,height:24};function L4(e,t){return{valueLabel:{width:"auto"}}}var k4=function(){return k4=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},k4.apply(this,arguments)};function M4(e){return{inkStylePicker:{inkColorPickerStyles:{container:{marginLeft:"-8px",marginRight:"-8px"}},containerStyles:{width:"176px"},getContentWrapperStyle:H4,arrowModePickerStyles:{container:k4(k4({},F4(e)),{justifyContent:"flex-start"}),iconLabelButton:{root:{marginRight:"4px",marginLeft:"4px"}}}},canvasContainer:{top:"50%",bottom:"inherit",transform:"translateY(-50%)"},container:{padding:"8px 0",borderRadius:"8px"},inkToolsContainer:{flexDirection:"column",width:"56px"}}}var P4={inkToolbarPosition:"Left",canvasContainer:{left:"0",right:"inherit",marginLeft:"24px",marginRight:"inherit"},inkToolbarButton:{root:{transform:"rotate(90deg)"}}},T4={root:{left:4}},U4={inkToolbarPosition:"Right",canvasContainer:{left:"inherit",right:"0",marginLeft:"inherit",marginRight:"24px"},inkToolbarButton:{root:{transform:"rotate(270deg)"}},inkToolbarArrowIconStyle:{singleArrow:T4,doubleArrow:T4}};function F4(e){return{borderTop:"1px solid "+e.palette.neutralTertiaryAlt}}function H4(e){return{minHeight:"260px",height:e?"auto":"280px"}}var R4={markup_inkToolbarPenTooltip:Q6.vt,markup_inkToolbarPenAriaLabel:Q6.gt,markup_inkToolbarPenAriaDescription:Q6.bt,markup_inkToolbarEraserTooltip:Q6.pt,markup_inkToolbarEraserAriaLabel:Q6.ft,markup_inkToolbarEraserAriaDescription:Q6.ut,markup_inkToolbarHighlighterTooltip:Q6.ht,markup_inkToolbarHighlighterAriaLabel:Q6._t,markup_inkToolbarHighlighterAriaDescription:Q6.mt,markup_inkToolbarClearAllInkTooltip:Q6.dt,markup_inkToolbarClearAllInkAriaLabel:Q6.ct,markup_inkToolbarThickness:Q6.St,markup_clearAllInkDialogCloseButtonAriaLabel:Q6.Le,markup_clearAllInkDialogTitle:Q6.Te,markup_clearAllInkDialogSubText:Q6.Pe,markup_clearAllInkDialogConfirmButtonText:Q6.Me,markup_clearAllInkDialogConfirmButtonAriaLabel:Q6.ke,markup_clearAllInkDialogCancelButtonText:Q6.Ae,markup_clearAllInkDialogCancelButtonAriaLabel:Q6.Ee,markup_inkToolbarBrushFormatString:Q6.st,markup_inkToolbarTooltipChangeInkProperties:Q6.Dt,markup_inkThicknessSliderHeaderLabel:Q6.rt,markup_inkThicknessSliderAriaLabel:Q6.it,markup_addedInkStrokeAriaLive:Q6.we,markup_removedInkStrokesAriaLive:Q6.Ot,markup_clearedAllInkStrokesAriaLive:Q6.Ue,markup_inkPenThicknessSliderAriaLabel:Q6.at,markup_inkHighlighterThicknessSliderAriaLabel:Q6.nt,markup_inkToolbarAriaLandmark:Q6.ot,markup_colorDarkYellow:Q6.je,markup_colorLightOrange:Q6.qe,markup_colorOrange:Q6.Ye,markup_colorRed:Q6.Xe,markup_colorDarkPurple:Q6.Ne,markup_colorPurple:Q6.Je,markup_colorMagenta:Q6.Qe,markup_colorDarkRed:Q6.Be,markup_colorLightBlue:Q6.Ge,markup_colorBlue:Q6.He,markup_colorDarkBlue:Q6.Re,markup_colorLightGreen:Q6.We,markup_colorGreen:Q6.ze,markup_colorLightGray:Q6.Ke,markup_colorGray:Q6.Ve,markup_colorBlack:Q6.Fe,markup_colorTableAriaLabel:Q6.Ze,markup_noArrowButtonText:Q6.xt,markup_noArrowButtonTooltip:Q6.Ct,markup_noArrowButtonAriaLabel:Q6.It,markup_singleArrowButtonText:Q6.Et,markup_singleArrowButtonTooltip:Q6.At,markup_singleArrowButtonAriaLabel:Q6.wt,markup_doubleArrowButtonText:Q6.et,markup_doubleArrowButtonTooltip:Q6.tt,markup_doubleArrowButtonAriaLabel:Q6.$e,markup_inkToolbarSingleArrowTip:Q6.yt,markup_inkToolbarDoubleArrowTips:Q6.lt},N4={strings:{toolbar_imageSave:Q6.en,toolbar_imageSaveTooltip:Q6.cn,toolbar_imageSaveAsOriginal:Q6.rn,toolbar_imageSaveAsOriginalAriaLabel:Q6.on,toolbar_imageSaveAsOriginalTooltip:Q6.sn,toolbar_imageSaveAsCopy:Q6.tn,toolbar_imageSaveAsCopyAriaLabel:Q6.nn,toolbar_imageSaveAsCopyTooltip:Q6.an,toolbar_imageReset:Q6.Jt,toolbar_imageResetAriaLabel:Q6.Xt,toolbar_imageResetFinishedAriaLive:Q6.Zt,toolbar_imageResetTooltip:Q6.$t,toolbar_resetConfirmDialogContentTitle:Q6._n,toolbar_resetConfirmDialogContentSubText:Q6.mn,toolbar_resetConfirmDialogCloseButtonAriaLabel:Q6.un,toolbar_resetConfirmDialogConfirmText:Q6.pn,toolbar_resetConfirmDialogConfirmAriaLabel:Q6.fn,toolbar_resetConfirmDialogCancelText:Q6.ln,toolbar_resetConfirmDialogCancelAriaLabel:Q6.dn,toolbar_zoomLevelAriaLabel:Q6.yn,toolbar_zoomInAriaLabel:Q6.gn,toolbar_zoomInTooltip:Q6.vn,toolbar_zoomOutTooltip:Q6.Dn,toolbar_zoomOutAriaLabel:Q6.Sn,toolbar_cancelAriaLabel:Q6.qt,toolbar_cancelTooltip:Q6.Qt,toolbar_fitToViewTooltip:Q6.Yt,toolbar_saveMenuSplitButtonAriaLabel:Q6.hn,toolbar_viewActualSizeTooltip:Q6.bn,rotate_left90:Q6.Nt,rotate_left90AriaLabel:Q6.Bt,rotate_left90FinishedAriaLive:Q6.jt,rotate_right90:Q6.Vt,rotate_right90AriaLabel:Q6.zt,rotate_right90FinishedAriaLive:Q6.Gt,rotate_sliderAriaLabel:Q6.Kt,rotate_degree:Q6.Rt,rotate_sliderTooltip:Q6.Wt,flip_horizontal:Q6.he,flip_horizontalAriaLabel:Q6.be,flip_horizontalFinishedAriaLive:Q6.ge,flip_vertical:Q6.Ie,flip_verticalAriaLabel:Q6.xe,flip_verticalFinishedAriaLive:Q6.Ce,aspectRatio_listTitle:Q6.h,aspectRatio_freeform:Q6.m,aspectRatio_freeformAriaLabel:Q6._,aspectRatio_original:Q6.b,aspectRatio_originalAriaLabel:Q6.g,aspectRatio_square:Q6.S,aspectRatio_squareAriaLabel:Q6.D,aspectRatio_ratioAriaLabelFormatString:Q6.v,aspectRatio_ratioLabelFormatString:Q6.y,aspectRatio_tooltip:Q6.I,aspectRatio_changedAriaLive:Q6.p,footer_done:Q6.Oe,flip_portrait:Q6.Se,flip_portraitAriaLabel:Q6.De,flip_landscape:Q6.ve,flip_landscapeAriaLabel:Q6.ye,crop_topLeftCornerAriaLabel:Q6.H,crop_topRightCornerAriaLabel:Q6.R,crop_bottomLeftCornerAriaLabel:Q6.L,crop_bottomRightCornerAriaLabel:Q6.k,crop_cornerTooltip:Q6.M,crop_rectangleAriaLabel:Q6.P,crop_rectangleTooltip:Q6.F,crop_rectanglePositionAriaLive:Q6.U,crop_rectangleCannotMoveInCurrentDirectionAriaLive:Q6.T,adjustment_brightness:Q6.e,adjustment_color:Q6.t,adjustment_lightAriaLandmark:Q6.s,adjustment_colorAriaLandmark:Q6.n,adjustment_contrast:Q6.a,adjustment_exposure:Q6.i,adjustment_highlights:Q6.r,adjustment_light:Q6.o,adjustment_saturation:Q6.c,adjustment_shadows:Q6.d,adjustment_temperature:Q6.l,adjustment_tint:Q6.u,adjustment_vignette:Q6.f,editor_viewingOriginal:Q6.V,editor_viewingOriginalAriaLive:Q6.z,editor_zoomPercentAriaLive:Q6.G,editor_imageDimensionLabelFormatString:Q6.j,editor_imageDimensionAriaLabelFormatString:Q6.N,editor_imageDimensionAriaLive:Q6.B,pivot_crop:Q6.Ut,pivot_adjustment:Q6.Tt,pivot_filter:Q6.Ft,pivot_markup:Q6.Ht,nonCrop_imageTooltip:Q6.Mt,nonCrop_imageAriaLabelWithEdits:Q6.Lt,nonCrop_imageAriaLabelWithoutEdits:Q6.kt,nonCrop_panViewPositionAriaLive:Q6.Pt,filter_listTitle:Q6.Y,filter_intensitySliderHeader:Q6.Y,filter_intensitySliderAriaLabelFormatString:Q6.Q,filter_nameOriginal:Q6.le,filter_nameBurn:Q6.J,filter_nameBw:Q6.X,filter_nameBwAriaLabel:Q6.Z,filter_nameBwCool:Q6.$,filter_nameBwCoolAriaLabel:Q6.ee,filter_nameBwHighContrast:Q6.te,filter_nameBwHighContrastAriaLabel:Q6.ne,filter_nameBwWarm:Q6.ae,filter_nameBwWarmAriaLabel:Q6.ie,filter_nameCoolLight:Q6.oe,filter_nameCalm:Q6.re,filter_nameDramaticCool:Q6.se,filter_nameFilm:Q6.ce,filter_nameGolden:Q6.de,filter_namePunch:Q6.ue,filter_nameRadiate:Q6.fe,filter_nameVintage:Q6.pe,filter_nameVividCool:Q6.me,filter_nameWarmContrast:Q6._e,filter_filtersAriaLandmark:Q6.q,filter_changedAriaLive:Q6.K,filter_changedAriaLiveWithIntensity:Q6.W,autoEnhance_name:Q6.E,autoEnhance_generatingAriaLive:Q6.C,autoEnhance_appliedAriaLive:Q6.x,autoEnhance_removedAriaLive:Q6.A,autoEnhance_intensitySliderHeader:Q6.w,autoEnhance_intensitySliderAriaLabel:Q6.O}};t.default=function(e){var t,n,a,i,s=function(e){var t=this,n=Object(o.useState)(null),a=n[0],i=n[1],r=Object(o.useCallback)(function(e){!function(e,t,n,a){new(n||(n=Promise))(function(t,i){function r(e){try{s(a.next(e))}catch(e){i(e)}}function o(e){try{s(a.throw(e))}catch(e){i(e)}}function s(e){var a;e.done?t(e.value):(a=e.value,a instanceof n?a:new n(function(e){e(a)})).then(r,o)}s((a=a.apply(e,[])).next())})}(t,0,void 0,function(){var t;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(n){switch(n.label){case 0:return e?[4,sv(e)]:[3,2];case 1:t=n.sent(),i(t),n.label=2;case 2:return[2]}})})},[]);return Object(o.useEffect)(function(){r(e)},[r,e]),[a,r]}(e.imageUrl)[0],c=Object(o.useRef)(null),d=e.platformDetection.isMobile,l=Object(o.useCallback)(function(t){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var n,a;return Object(r.__generator)(this,function(i){switch(i.label){case 0:return n=t===nd.SaveAs,c.current?[4,c.current.getEditedImage()]:[3,2];case 1:(a=i.sent())?e.executeSave(a,n):u({id:"SaveFailed",message:"unable to get canvas from getEditedImage"}),i.label=2;case 2:return[2]}})})},[s,c]),u=Object(o.useCallback)(function(t){var n=t.id,a=t.message;G6.e.logData({isIntentional:!1,name:"Error",extraData:{id:n.toString(),message:a},currentPage:e.engagementCurrentPage})},[]),f=Object(o.useCallback)(function(){e.onClose()},[]),p=Object(o.useCallback)(function(t){var n=t.name,a=t.isIntentional,i=Object(r.__rest)(t,["name","isIntentional"]);G6.e.logData({isIntentional:a,name:n,extraData:Object(r.__assign)({},i),currentPage:e.engagementCurrentPage})},[]),m=(n=(t=Object(o.useState)({width:window.innerWidth,height:window.innerHeight}))[0],a=t[1],i=Object(o.useCallback)(function(){a({width:window.innerWidth,height:window.innerHeight})},[]),Object(o.useEffect)(function(){return window.addEventListener("resize",i),function(){window.removeEventListener("resize",i)}},[i]),n),_=d?q6:K6,h=d?nc.Mobile:nc.Desktop,b=e.desktopInkToolbarPosition,g=Object(o.useMemo)(function(){var e,t,n=(e=b,t=Object(Tl.e)(),"Bottom"!==e&&t?"Left"===e?"Right":"Left":e);return d?function(e,t){switch(void 0===t&&(t="Bottom"),t){case"Bottom":return E4(E4({inkToolbarPosition:"Bottom"},function(e){return{canvasContainer:{width:"100%",display:"flex",justifyContent:"center"},container:{backgroundColor:e.palette.white,width:"100%",padding:0}}}(e)),{clearAllInk:pc(e,"48px",A4),inkToolbarTools:{activeToolbarIcon:{backgroundColor:e.palette.neutralLighter},toolbarIcon:fc(e)},inkToolbarButton:{root:{margin:lc}},inkStylePicker:{getContentWrapperStyle:function(){return{width:"100%",padding:"0px 28px"}},sliderStyles:{getSliderStyles:L4},inkColorPickerStyles:{container:{marginLeft:"-8px",marginRight:"-8px"},colorPicker:{root:{width:"100%"}},colorPickerGridCellStyles:mc(e,29,11)}}});case"Left":case"Right":throw new Error("MobileInkToolbarStyles does not support this inkToolbarPosition: "+t);default:throw new ec(t)}}(_,"Bottom"):function(e,t){switch(t){case"Left":return Object(L.e)(M4(e),P4);case"Right":return Object(L.e)(M4(e),U4);case"Bottom":return function(e){return{inkStylePicker:{arrowModePickerStyles:{container:k4({},F4(e))}}}}(e);default:throw new ec(t)}}(_,n)},[b,d,Object(Tl.e)(),_]);return o.createElement(X6.e,null,o.createElement(Y6.e,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!0},o.createElement(F,{theme:_},o.createElement(w4,{enableMarkup:Object(J6.isFeatureEnabled)(J6.EnableEditControlMarkup),localizationStrings:R4,inkToolbarStyles:g,enableArrowhead:Object(J6.isFeatureEnabled)(J6.EnableEditControlArrowHead)},o.createElement(z6,{ref:c,componentSize:m,image:s,onDecideEnabledSaveTypes:function(t,n,a){var i=new Set(Md(0,n,a));return e.canSaveCopy||i.delete(nd.SaveAs),e.canSaveOriginal||i.delete(nd.SaveAsOriginal),i},onSave:l,onClose:f,onError:u,telemetryCallback:p,localization:N4,enableAdjustments:Object(J6.isFeatureEnabled)(J6.EnableEditControlAdjustments),enableFilters:Object(J6.isFeatureEnabled)(J6.EnableEditControlFilters),layout:{type:h}})))))}}}]);